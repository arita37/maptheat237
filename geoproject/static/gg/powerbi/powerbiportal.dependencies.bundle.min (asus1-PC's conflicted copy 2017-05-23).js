"use strict";
window.parseTimeMarkers = window.parseTimeMarkers || {};
window.parseTimeMarkers['powerbiportal.dependencies.bundle.min.js'] = {
    nominalStart: Date.now(),
    start: Date.now()
};
!(function(e){function t(a){if(i[a])return i[a].exports;var r=i[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)})([function(e,t,i){i(441),i(404),i(464),e.exports=i(142)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){var i,i=(window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug);window.jasmine,window.Microsoft;!(function(e){function t(e,t){e!==!0&&n(t||"condition: "+e)}function i(e,t){null!==e&&void 0!==e||n(t||"condition: "+e)}function a(e,t){null!=e&&e.length>0||n(t||"condition: "+e)}function r(e,t){}function n(t){(e.assertFailFunction||alert)("Debug Assert failed: "+t)}function o(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i]}e.assert=t,e.assertValue=i,e.assertNonEmpty=a,e.assertAnyValue=r,e.assertFail=n,e.log=o})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(e){void 0===e&&(e=1);var t,i;try{throw new Error}catch(a){t=a.stack,null!=t&&(i=t.split("\n"),i.splice(1,e),t=i.join("\n"))}return t}var i;!(function(e){function i(){return{name:"infoNavAppAlreadyPresent",message:"Cannot initialize embedded scenario when the InfoNav App is already present in this context",stack:c()}}function a(e){return{name:"invalidOperation",message:e,stack:c()}}function r(e,t){return{name:"invalidArgumentError",argument:e,message:t,stack:c()}}function n(e){return{name:"argumentNull",argument:e,message:"Argument was null",stack:c()}}function o(e){return{name:"argumentUndefined",argument:e,message:"Argument was undefined",stack:c()}}function s(e){return{name:"argumentOutOfRange",argument:e,message:"Argument was out of range",stack:c()}}function l(e,t){return{name:"pureVirtualMethodException",message:"This method must be overriden by the derived class:"+e+"."+t,stack:c()}}function u(e){return{name:"notImplementedException",message:e,stack:c()}}function c(){return t(2)}e.infoNavAppAlreadyPresent=i,e.invalidOperation=a,e.argument=r,e.argumentNull=n,e.argumentUndefined=o,e.argumentOutOfRange=s,e.pureVirtualMethodException=l,e.notImplementedException=u})(i=e.Errors||(e.Errors={})),e.getStackTrace=t})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(t){e.Utility.throwIfNullOrUndefined(t,this,"constructor","factoryMethod"),this.factoryMethod=t}return t.prototype.getValue=function(){return null!==this.factoryMethod&&(this.value=this.factoryMethod(),this.factoryMethod=null),this.value},t})();e.Lazy=t})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){function i(){}i.prototype=e;var a=new i;return t&&t(a),a}function i(e){var i=Object.getPrototypeOf(e);return i!==Object.prototype&&i!==Array.prototype||(e=t(e)),e}function a(e,i){if(e){for(var a,r=0,n=e.length;r<n;r++){var o=i(e[r]);o&&(a||(a=t(e)),a[r]=o)}return a}}e.inherit=t,e.inheritSingle=i,e.overrideArray=a})(t=e.Prototype||(e.Prototype={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.OK=200]="OK",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge"})(e.HttpStatusCode||(e.HttpStatusCode={}));var t;e.HttpStatusCode;!(function(e){e.ApplicationOctetStream="application/octet-stream",e.MultiPartFormData="multipart/form-data"})(t=e.HttpConstants||(e.HttpConstants={}));var i;!(function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i=e[0];if(c(i))return i;for(var a=0;a<e.length-1;a++){var r=new RegExp("\\{"+a+"\\}","gm");i=i.replace(r,e[a+1])}return i}function i(t,i){return e.normalizeCase(t)===e.normalizeCase(i)}function r(t,i){var a=e.normalizeCase(i);return 0===e.normalizeCase(t).indexOf(a)}function n(e,t){return 0===e.indexOf(t)}function o(e,t){return null!=e&&e.indexOf(t)!==-1}function s(e,t){return null!=e&&o(l(e),l(t))}function l(t){return a.throwIfNullOrUndefined(t,e,"normalizeCase","value"),t.toUpperCase()}function u(e){if(_.isEmpty(e))return null;for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),a=0,r=e.length;a<r;a++)i[a]=e.charCodeAt(a);return i}function c(e){return _.isEmpty(e)||_.isEmpty(e.trim())}function d(e){a.throwIfNullOrUndefined(e,a,"containsWhitespace","str");var t=/\s/;return t.test(e)}function p(e){return a.throwIfNullOrUndefined(e,a,"isWhitespace","str"),""===e.trim()}function h(e){return a.throwIfNullOrUndefined(e,a,"trimTrailingWhitespace","str"),e.replace(/\s+$/,"")}function g(e){return a.throwIfNullOrUndefined(e,a,"trimWhitespace","str"),e.replace(/^\s+/,"").replace(/\s+$/,"")}function f(e,t){return a.throwIfNullOrUndefined(e,a,"getLengthDifference","left"),a.throwIfNullOrUndefined(t,a,"getLengthDifference","right"),Math.abs(e.length-t.length)}function m(e,t){for(var i="",a=0;a<t;a++)i+=e;return i}function y(e,t,i){if(!t)return e;var a=S(t);return e.replace(new RegExp(a,"gi"),i)}function v(e){for(var t={},i=0,a=e;i<a.length;i++){var r=a[i];t[r]=!1}for(var n=[],o=0,s=e;o<s.length;o++){var l=s[o],u=l;if(t[u])for(var c=0;void 0!==t[u];)u=l+"."+ ++c;n.push(u),t[u]=!0}return n}function w(e,t){for(var i=0,a=t;e[a];)a=t+ ++i;return a}function b(e,t,i){for(var a,r=[],n=0,o=0,s=e;o<s.length;o++){var l=s[o];if(n+l.length>i&&r.length>0){a=!0;break}r.push(l),n+=l.length}var u=" "+t+" ",c=r.join(u);return a&&(c+=u+"..."),c}function C(t,i,a){if(!t||0===t.length)return"";null!==a&&void 0!==a||(a=Number.MAX_VALUE);for(var r=Math.min(a,t.length),n=[],o=0;o<2;o++)for(var s="{"+o+"}",l="_|_<"+o+">_|_",u=0;u<r;u++)t[u].indexOf(s)>-1&&(t[u]=t[u].replace(s,l),n.push({targetValue:s,replaceValue:l}));for(var c="",u=0;u<r;u++)c=0===u?t[u]:e.format(i.get("FilterRestatement_Comma"),c,t[u]);for(var u=0;u<n.length;u++)c=c.replace(n[u].replaceValue,n[u].targetValue);return c}function S(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}function x(e){return e.replace(/[\<\>\:"\/\\\|\?*]/g,"")}function P(e){return JSON.stringify(e)}function D(e,t){var i=e.replace(/^[^A-Za-z]*/g,"").replace(/[ :\.\/\\\-\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000]/g,"_").replace(/[\W]/g,"");return i.length>0?i:t}function T(e){return e.replace(V,"")}var V=new RegExp("[<>]","g");e.format=t,e.equalIgnoreCase=i,e.startsWithIgnoreCase=r,e.startsWith=n,e.contains=o,e.containsIgnoreCase=s,e.normalizeCase=l,e.stringToArrayBuffer=u,e.isNullOrUndefinedOrWhiteSpaceString=c,e.containsWhitespace=d,e.isWhitespace=p,e.trimTrailingWhitespace=h,e.trimWhitespace=g,e.getLengthDifference=f,e.repeat=m,e.replaceAll=y,e.ensureUniqueNames=v,e.findUniqueName=w,e.constructNameFromList=b,e.constructCommaSeparatedList=C,e.escapeStringForRegex=S,e.normalizeFileName=x,e.stringifyAsPrettyJSON=P,e.deriveClsCompliantName=D,e.stripTagDelimiters=T})(i=e.StringExtensions||(e.StringExtensions={}));var a=(function(){function a(){}return a.throwIfNullOrUndefined=function(t,i,r,n){null===t?a.throwException(e.Errors.argumentNull(a.getComponentName(i)+r+"."+n)):typeof t===a.Undefined&&a.throwException(e.Errors.argumentUndefined(a.getComponentName(i)+r+"."+n))},a.throwIfNullOrEmpty=function(t,i,r,n){a.throwIfNullOrUndefined(t,i,r,n),t.length||a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(i)+r+"."+n))},a.throwIfNullOrEmptyString=function(t,i,r,n){a.throwIfNullOrUndefined(t,i,r,n),t.length<1&&a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(i)+r+"."+n))},a.throwIfNullEmptyOrWhitespaceString=function(t,r,n,o){a.throwIfNullOrUndefined(t,r,n,o),i.isNullOrUndefinedOrWhiteSpaceString(t)&&a.throwException(e.Errors.argumentOutOfRange(a.getComponentName(r)+n+"."+o))},a.throwIfNotTrue=function(t,i,r,n){t||a.throwException(e.Errors.argument(n,a.getComponentName(i)+r+"."+n))},a.valueOrDefault=function(e,t){return null!=e?e:t},a.urlCombine=function(e,t){if(a.throwIfNullOrUndefined(e,null,"urlCombine","baseUrl"),a.throwIfNullOrUndefined(t,null,"urlCombine","path"),i.isNullOrUndefinedOrWhiteSpaceString(t))return e;if(i.isNullOrUndefinedOrWhiteSpaceString(e))return t;var r=e;return"/"===r.charAt(r.length-1)?"/"===t.charAt(0)&&(t=t.slice(1)):"/"!==t.charAt(0)&&(t="/"+t),r+t},a.getAbsoluteUri=function(e){a.throwIfNullOrUndefined(e,null,"getAbsoluteUri","path");var t=e;return t&&t.indexOf("http")===-1&&(t=a.urlCombine(clusterUri,t)),t},a.getStaticResourceUri=function(t){a.throwIfNullOrUndefined(t,null,"getStaticResourceUri","path");var i=t;return i&&i.indexOf("http")===-1&&(i=e.Utility.urlCombine(a.staticContentLocation,i)),i},a.getComponentName=function(e){return e?(typeof e).toString()+".":""},a.throwException=function(t){throw e.Trace.error(i.format("Throwing exception: {0}",JSON.stringify(t)),null==t.stack),t},a.createClassSelector=function(e){return a.throwIfNullOrEmptyString(e,null,"CreateClassSelector","className"),"."+e},a.createIdSelector=function(e){return a.throwIfNullOrEmptyString(e,null,"CreateIdSelector","id"),"#"+e},a.generateGuid=function(){var e="",t=0;for(t=0;t<32;t+=1){var i=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=i.toString(16)}return e},a.getCookieValue=function(e){for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var a=t[i],r=a.split("=");if(r.length>0&&r[0].trim()===e)return a.substr(a.indexOf("=")+1)}return null},a.getDomainForUrl=function(e){var t=a.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+t.prop("hostname")},a.getHostNameForUrl=function(e){var t=a.getHrefObjectFromUrl(e);return a.urlCombine(t.prop("hostname"),t.prop("pathname"))},a.getUrlWithoutQueryString=function(e){var t=a.getHrefObjectFromUrl(e);return t.prop("protocol")+"//"+a.urlCombine(t.prop("host"),t.prop("pathname"))},a.getProtocolFromUrl=function(e){return a.getHrefObjectFromUrl(e).prop("protocol").replace(":","")},a.getHrefObjectFromUrl=function(e){var t=$("<a>");return t=t.prop("href",e)},a.getDateFromWcfJsonString=function(e,t){if(_.isEmpty(e))return null;var i=e.indexOf("("),a=e.indexOf(")");if(i!==-1&&a!==-1){var r=parseInt(e.substring(i+1,a),10);if(isNaN(r)&&(r=0),t)return new Date(r);var n=new Date(0);return n.setUTCMilliseconds(r),n}return null},a.isValidImageDataUrl=function(e){var t=new RegExp("data:(image/(png|jpg|jpeg|gif|svg))");return t.test(e)},a.isLocalUrl=function(e){return _.startsWith(e,"data:")||_.startsWith(e,"blob:")},a.saveAsFile=function(e,i){var a=new Blob([e],{type:t.ApplicationOctetStream}),r=window.webkitURL||URL,n=r.createObjectURL(a),o=i||n;if(window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(a,o);var s=document.createElement("a");s.href=n,s.target="_blank",s.download=o,document.body.appendChild(s),s.click(),document.body.removeChild(s)},a.getFileExtension=function(e){if(e){var t=e.lastIndexOf(".");if(t>=0)return e.substr(t+1)}return""},a.extractFileNameFromPath=function(e){return e.replace(/^.*[\\\/]/,"")},a.canUseClipboard=function(){return"undefined"==typeof MSApp},a.is64BitOperatingSystem=function(){return navigator.userAgent.indexOf("WOW64")!==-1||navigator.userAgent.indexOf("Win64")!==-1},a.parseNumber=function(e,t){if(null===e)return null;if(void 0===e)return t;var i=Number(e);return isFinite(i)?i:isNaN(i)&&"number"!=typeof e&&"NaN"!==e?t:i},a.getURLParamValue=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},a.getLocalTimeZoneString=function(){var e,t=new Date(Date.UTC(2005,6,30,0,0,0,0)),i=-1*t.getTimezoneOffset(),a=new Date(Date.UTC(2005,12,30,0,0,0,0)),r=-1*a.getTimezoneOffset();return e=-720===i&&-720===r?"Dateline Standard Time":-660===i&&-660===r?"UTC-11":-660===i&&-660===r?"Samoa Standard Time":-600===i&&-600===r?"Hawaiian Standard Time":-480===i&&-540===r?"Alaskan Standard Time":-420===i&&-480===r?"Pacific Standard Time":-420===i&&-420===r?"US Mountain Standard Time":-360===i&&-420===r?"Mountain Standard Time":-360===i&&-360===r?"Central America Standard Time":-300===i&&-360===r?"Central Standard Time":-300===i&&-300===r?"SA Pacific Standard Time":-240===i&&-300===r?"Eastern Standard Time":-270===i&&-270===r?"Venezuela Standard Time":-240===i&&-240===r?"SA Western Standard Time":-240===i&&-180===r?"Central Brazilian Standard Time":-180===i&&-240===r?"Atlantic Standard Time":-180===i&&-180===r?"Montevideo Standard Time":-180===i&&-120===r?"E. South America Standard Time":-150===i&&-210===r?"Mid-Atlantic Standard Time":-120===i&&-120===r?"SA Eastern Standard Time":0===i&&0===r?"UTC":60===i&&0===r?"GMT Standard Time":60===i&&120===r?"Namibia Standard Time":120===i&&60===r?"Romance Standard Time":120===i&&120===r?"South Africa Standard Time":180===i&&120===r?"GTB Standard Time":180===i&&180===r?"E. Africa Standard Time":240===i&&180===r?"Russian Standard Time":240===i&&240===r?"Arabian Standard Time":270===i&&210===r?"Iran Standard Time":270===i&&270===r?"Afghanistan Standard Time":300===i&&240===r?"Pakistan Standard Time":300===i&&300===r?"West Asia Standard Time":330===i&&330===r?"India Standard Time":345===i&&345===r?"Nepal Standard Time":360===i&&300===r?"N. Central Asia Standard Time":360===i&&360===r?"Central Asia Standard Time":390===i&&390===r?"Myanmar Standard Time":420===i&&360===r?"North Asia Standard Time":420===i&&420===r?"SE Asia Standard Time":480===i&&420===r?"North Asia East Standard Time":480===i&&480===r?"China Standard Time":540===i&&480===r?"Yakutsk Standard Time":540===i&&540===r?"Tokyo Standard Time":570===i&&570===r?"Cen. Australia Standard Time":600===i&&600===r?"E. Australia Standard Time":600===i&&660===r?"AUS Eastern Standard Time":660===i&&600===r?"Tasmania Standard Time":660===i&&660===r?"West Pacific Standard Time":690===i&&690===r?"Central Pacific Standard Time":720===i&&660===r?"Magadan Standard Time":720===i&&720===r?"Fiji Standard Time":720===i&&780===r?"New Zealand Standard Time":780===i&&780===r?"Tonga Standard Time":"UTC"},a.JsonContentType="application/json",a.JpegContentType="image/jpeg",a.XJavascriptContentType="application/x-javascript",a.JsonDataType="json",a.BlobDataType="blob",a.ArrayBufferDataType="arraybuffer",a.HttpGetMethod="GET",a.HttpPostMethod="POST",a.HttpPutMethod="PUT",a.HttpDeleteMethod="DELETE",a.HttpContentTypeHeader="Content-Type",a.HttpAcceptHeader="Accept",a.Undefined="undefined",a.staticContentLocation=window.location.protocol+"//"+window.location.host,a})();e.Utility=a;var r=(function(){function e(){}return e.compareVersions=function(e,t){for(var i=e.split(".").map(parseFloat),a=t.split(".").map(parseFloat),r=Math.max(i.length,a.length),n=0;n<r;n++){var o=i[n]||0,s=a[n]||0;if(o>s)return 1;if(o<s)return-1}return 0},e})();e.VersionUtility=r;var n;!(function(e){function t(e){var t=window.performance;if(!t||!t.mark)return _.noop;console.time;var i="Begin "+e;return t.mark(i),function(){var a="End "+e;t.mark(a),t.measure&&t.measure(e,i,a),console.timeEnd}}e.start=t})(n=e.PerfTimer||(e.PerfTimer={}));var o;!(function(e){function t(e){var t,i,a;return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,20)}),function(){t||(t=!0,i=arguments,a=this,window.requestAnimationFrame((function(){t=!1,e.apply(a,i)})))}}e.deferUntilNextFrame=t})(o=e.DeferUtility||(e.DeferUtility={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(e,t,i,a){this.text=e,this.type=t,this.sessionId=i,this.requestId=a,this.timeStamp=new Date}return t.prototype.toString=function(){var i="";return i+=e.StringExtensions.format("{0} ({1}): {2}",t.traceTypeStrings[this.type],this.timeStamp.toUTCString(),this.text),this.requestId&&(i+="\n(Request id: "+this.requestId+")"),i},t.traceTypeStrings=["INFORMATION","VERBOSE","WARNING","ERROR","EXPECTEDERROR","UNEXPECTEDERROR","FATAL"],t})();e.TraceItem=t})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){return(e&t)===t}function i(e,t){return e|=t}function a(e,t){return e&=~t}function r(e,t){return e[t]}function n(e){if(null===e||e%1!==0)return 0;for(var t=0,i=e;0!==i;)1===(1&i)&&t++,i>>>=1;return t}e.hasFlag=t,e.setFlag=i,e.resetFlag=a,e.toString=r,e.getBitCount=n})(t=e.EnumExtensions||(e.EnumExtensions={}));var i;!(function(e){function t(e,t){return e.indexOf(t,e.length-t.length)!==-1}e.endsWith=t})(i=e.StringExtensions||(e.StringExtensions={}));var a;!(function(e){function t(e,t){return(e||t)&&!(e&&t)}e.XOR=t})(a=e.LogicExtensions||(e.LogicExtensions={}));var r;!(function(e){function t(e,t){return e===t||JSON.stringify(e)===JSON.stringify(t)}e.equals=t})(r=e.JsonComparer||(e.JsonComparer={}));var n;!(function(e){function t(t){return(t-e.TextSizeMin)/i}e.TextSizeMin=8,e.TextSizeMax=40;var i=e.TextSizeMax-e.TextSizeMin;e.getScale=t})(n=e.TextSizeDefaults||(e.TextSizeDefaults={}));var o;!(function(e){function t(e){return e+o}function i(e){return t(a(e))}function a(e){return n*e}function r(e){return e/n}var n=4/3,o="px";e.toString=t,e.fromPoint=i,e.fromPointToPixel=a,e.toPoint=r})(o=e.PixelConverter||(e.PixelConverter={}));var s;!(function(e){function t(e,t,i){return e.lastIndex=i||0,e.exec(t)}e.run=t})(s=e.RegExpExtensions||(e.RegExpExtensions={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.visitEntity=function(e,t){return this.visitDefault(e,t)},e.prototype.visitSubqueryRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitColumnRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitMeasureRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAggr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitPercentile=function(e,t){return this.visitDefault(e,t)},e.prototype.visitGroupRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchy=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchyLevel=function(e,t){return this.visitDefault(e,t)},e.prototype.visitPropertyVariationSource=function(e,t){return this.visitDefault(e,t)},e.prototype.visitSelectRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitBetween=function(e,t){return this.visitDefault(e,t)},e.prototype.visitIn=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitOr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitCompare=function(e,t){return this.visitDefault(e,t)},e.prototype.visitContains=function(e,t){return this.visitDefault(e,t)},e.prototype.visitExists=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNot=function(e,t){return this.visitDefault(e,t)},e.prototype.visitStartsWith=function(e,t){return this.visitDefault(e,t)},e.prototype.visitConstant=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateSpan=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateAdd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNow=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefaultValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnyValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitArithmetic=function(e,t){return this.visitDefault(e,t)},e.prototype.visitFloor=function(e,t){return this.visitDefault(e,t)},e.prototype.visitFillRule=function(e,t){return this.visitDefault(e,t)},e.prototype.visitThemeColor=function(e,t){return this.visitDefault(e,t)},e.prototype.visitResourcePackageItem=function(e,t){return this.visitDefault(e,t)},e.prototype.visitScopedEval=function(e,t){return this.visitDefault(e,t)},e.prototype.visitWithRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitTransformTableRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitTransformOutputRoleRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitRoleRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefault=function(e,t){},e})();e.DefaultSQExprVisitorWithArg=t;var i=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t})(t);e.DefaultSQExprVisitor=i;var r=(function(){function e(){}return e.prototype.visitEntity=function(e){this.visitDefault(e)},e.prototype.visitSubqueryRef=function(e){this.visitDefault(e)},e.prototype.visitColumnRef=function(e){e.source.accept(this)},e.prototype.visitMeasureRef=function(e){e.source.accept(this)},e.prototype.visitAggr=function(e){e.arg.accept(this)},e.prototype.visitPercentile=function(e){e.arg.accept(this)},e.prototype.visitGroupRef=function(e){e.source.accept(this);for(var t=0,i=e.groupedExprs;t<i.length;t++){var a=i[t];a.accept(this)}},e.prototype.visitHierarchy=function(e){e.arg.accept(this)},e.prototype.visitHierarchyLevel=function(e){e.arg.accept(this)},e.prototype.visitPropertyVariationSource=function(e){e.arg.accept(this)},e.prototype.visitSelectRef=function(e){this.visitDefault(e)},e.prototype.visitBetween=function(e){e.arg.accept(this),e.lower.accept(this),e.upper.accept(this)},e.prototype.visitIn=function(e){for(var t=e.args,i=0,a=t.length;i<a;i++)t[i].accept(this);var r=e.values;if(r)for(var i=0,a=r.length;i<a;i++)for(var n=r[i],o=0,s=n.length;o<s;o++)n[o].accept(this);else e.table.accept(this)},e.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitCompare=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitContains=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitExists=function(e){e.arg.accept(this)},e.prototype.visitNot=function(e){e.arg.accept(this)},e.prototype.visitStartsWith=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitConstant=function(e){this.visitDefault(e)},e.prototype.visitDateSpan=function(e){e.arg.accept(this)},e.prototype.visitDateAdd=function(e){e.arg.accept(this)},e.prototype.visitNow=function(e){this.visitDefault(e)},e.prototype.visitDefaultValue=function(e){this.visitDefault(e)},e.prototype.visitAnyValue=function(e){this.visitDefault(e)},e.prototype.visitArithmetic=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitFloor=function(e){e.arg.accept(this)},e.prototype.visitFillRule=function(e){e.input.accept(this);var t=e.rule,i=t.linearGradient2,a=t.linearGradient3;i&&this.visitLinearGradient2(i),a&&this.visitLinearGradient3(a)},e.prototype.visitLinearGradient2=function(e){this.visitFillRuleStop(e.min),this.visitFillRuleStop(e.max),this.visitFillNullStrategy(e.nullColoringStrategy)},e.prototype.visitLinearGradient3=function(e){this.visitFillRuleStop(e.min),this.visitFillRuleStop(e.mid),this.visitFillRuleStop(e.max),this.visitFillNullStrategy(e.nullColoringStrategy)},e.prototype.visitThemeColor=function(e){this.visitDefault(e)},e.prototype.visitResourcePackageItem=function(e){this.visitDefault(e)},e.prototype.visitScopedEval=function(e){e.expression.accept(this);for(var t=0,i=e.scope;t<i.length;t++){var a=i[t];a.accept(this)}},e.prototype.visitWithRef=function(e){this.visitDefault(e)},e.prototype.visitTransformTableRef=function(e){this.visitDefault(e)},e.prototype.visitTransformOutputRoleRef=function(e){this.visitDefault(e)},e.prototype.visitRoleRef=function(e){this.visitDefault(e)},e.prototype.visitDefault=function(e){},e.prototype.visitFillRuleStop=function(e){e.color.accept(this);var t=e.value;t&&t.accept(this)},e.prototype.visitFillNullStrategy=function(e){e&&(e.strategy.accept(this),e.color&&e.color.accept(this))},e})();e.DefaultSQExprVisitorWithTraversal=r})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(e){return e&m}function i(e){return(e&y)===e}function r(e){if(i(e))return null;var t=f[e];if(t){var a=t.lastIndexOf("_");if(a>0){var r=t.slice(0,a);f[r]&&(t=r)}}return t||null}function n(e,i){var a=u[e],r=f[a];if(null==r&&(r=0),e&&i){var n=f[i];if(n){var o=t(n);0===o?(n=r|n,f[n]&&(r=n)):o===e&&(r=n)}}return r}function o(e,t){return(e&v)===(t&v)}var s=a.EnumExtensions,l=(function(){function e(e,t,i,a){this.underlyingType=e,this.category=t,s.hasFlag(e,512)&&(this.temporalType=new d(e)),s.hasFlag(e,1024)&&(this.geographyType=new p(e)),s.hasFlag(e,2048)&&(this.miscType=new h(e)),s.hasFlag(e,4096)&&(this.formattingType=new g(e)),s.hasFlag(e,26214401)&&(this.enumType=i),s.hasFlag(e,8192)&&(this.scriptingType=new c(e)),s.hasFlag(e,13)&&(this.variationTypes=a)}return e.fromDescriptor=function(t){if(t=t||{},t.text)return e.fromExtendedType(1);if(t.integer)return e.fromExtendedType(260);if(t.numeric)return e.fromExtendedType(259);if(t.bool)return e.fromExtendedType(5);if(t.dateTime)return e.fromExtendedType(519);if(t.duration)return e.fromExtendedType(10);if(t.binary)return e.fromExtendedType(11);if(t.none)return e.fromExtendedType(12);if(t.scripting&&t.scripting.source)return e.fromExtendedType(32776193);if(t.enumeration)return e.fromEnum(t.enumeration);if(t.temporal){if(t.temporal.year)return e.fromExtendedType(66308);if(t.temporal.quarter)return e.fromExtendedType(262916);if(t.temporal.month)return e.fromExtendedType(131844);if(t.temporal.day)return e.fromExtendedType(328452);if(t.temporal.paddedDateTableDate)return e.fromExtendedType(197127)}if(t.geography){if(t.geography.address)return e.fromExtendedType(6554625);if(t.geography.city)return e.fromExtendedType(6620161);if(t.geography.continent)return e.fromExtendedType(6685697);if(t.geography.country)return e.fromExtendedType(6751233);if(t.geography.county)return e.fromExtendedType(6816769);if(t.geography.region)return e.fromExtendedType(6882305);if(t.geography.postalCode)return e.fromExtendedType(6947841);if(t.geography.stateOrProvince)return e.fromExtendedType(7013377);if(t.geography.place)return e.fromExtendedType(7078913);if(t.geography.latitude)return e.fromExtendedType(7144707);if(t.geography.longitude)return e.fromExtendedType(7210243)}if(t.misc){if(t.misc.image)return e.fromExtendedType(13109259);if(t.misc.imageUrl)return e.fromExtendedType(13174785);if(t.misc.webUrl)return e.fromExtendedType(13240321);if(t.misc.barcode)return e.fromExtendedType(13305857)}if(t.formatting){if(t.formatting.color)return e.fromExtendedType(19664897);if(t.formatting.formatString)return e.fromExtendedType(19730433);if(t.formatting.alignment)return e.fromExtendedType(20058113);if(t.formatting.labelDisplayUnits)return e.fromExtendedType(20123649);if(t.formatting.fontSize)return e.fromExtendedType(20189443);if(t.formatting.labelDensity)return e.fromExtendedType(20254979);if(t.formatting.bubbleSize)return e.fromExtendedType(20320515)}if(t.extendedType)return e.fromExtendedType(t.extendedType);if(t.operations&&t.operations.searchEnabled)return e.fromExtendedType(65541);if(t.variant){var i=_.map(t.variant,(function(t){return e.fromDescriptor(t)}));return e.fromVariant(i)}return e.fromExtendedType(0)},e.fromExtendedType=function(i){i=i||0;var a=t(i),n=r(i);return e.fromPrimitiveTypeAndCategory(a,n)},e.fromPrimitiveTypeAndCategory=function(t,i){t=t||0,i=i||null;var a=t.toString();return i&&(a+="|"+i),e.typeCache[a]||(e.typeCache[a]=new e(n(t,i),i))},e.fromEnum=function(t){return new e(26214401,null,t)},e.fromVariant=function(t){return new e(13,null,null,t)},e.isCompatibleTo=function(t,i){for(var a=e.fromDescriptor(t),r=0,n=i;r<n.length;r++){var o=n[r],s=e.fromDescriptor(o);if(s.isCompatibleFrom(a))return!0}return!1},e.prototype.isCompatibleFrom=function(e){var t=e.primitiveType;return!!(this===e||this.primitiveType===t||0===t||this.numeric&&e.numeric)},e.prototype.equals=function(e){return _.isEqual(this,e)},Object.defineProperty(e.prototype,"primitiveType",{get:function(){return t(this.underlyingType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendedType",{get:function(){return this.underlyingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryString",{get:function(){return this.category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return 1===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numeric",{get:function(){return s.hasFlag(this.underlyingType,256)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"integer",{get:function(){return 4===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bool",{get:function(){return 5===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateTime",{get:function(){return 7===this.primitiveType||6===this.primitiveType||9===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return 10===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binary",{get:function(){return 11===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return 12===this.primitiveType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporal",{get:function(){return this.temporalType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geography",{get:function(){return this.geographyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"misc",{get:function(){return this.miscType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatting",{get:function(){return this.formattingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enum",{get:function(){return this.enumType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scripting",{get:function(){return this.scriptingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"variant",{get:function(){return this.variationTypes},enumerable:!0,configurable:!0}),e.typeCache={},e})();e.ValueType=l;var u,c=(function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"source",{get:function(){return o(this.underlyingType,32776193)},enumerable:!0,configurable:!0}),e})(),d=(function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"year",{get:function(){return o(this.underlyingType,66048)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quarter",{get:function(){return o(this.underlyingType,262656)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return o(this.underlyingType,131584)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"day",{get:function(){return o(this.underlyingType,328192)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddedDateTableDate",{get:function(){return o(this.underlyingType,197127)},enumerable:!0,configurable:!0}),e})(),p=(function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"address",{get:function(){return o(this.underlyingType,6554625)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return o(this.underlyingType,6620161)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"continent",{get:function(){return o(this.underlyingType,6685697)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"country",{get:function(){return o(this.underlyingType,6751233);
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"county",{get:function(){return o(this.underlyingType,6816769)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"region",{get:function(){return o(this.underlyingType,6882305)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"postalCode",{get:function(){return o(this.underlyingType,6947840)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateOrProvince",{get:function(){return o(this.underlyingType,7013377)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"place",{get:function(){return o(this.underlyingType,7078913)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitude",{get:function(){return o(this.underlyingType,7144448)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return o(this.underlyingType,7209984)},enumerable:!0,configurable:!0}),e})(),h=(function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"image",{get:function(){return o(this.underlyingType,13109259)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return o(this.underlyingType,13174785)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return o(this.underlyingType,13240321)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"barcode",{get:function(){return o(this.underlyingType,13305856)},enumerable:!0,configurable:!0}),e})(),g=(function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"color",{get:function(){return o(this.underlyingType,19664897)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatString",{get:function(){return o(this.underlyingType,19730433)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return o(this.underlyingType,20058113)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplayUnits",{get:function(){return o(this.underlyingType,20123649)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return o(this.underlyingType,20189443)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDensity",{get:function(){return o(this.underlyingType,20254979)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbleSize",{get:function(){return o(this.underlyingType,20320515)},enumerable:!0,configurable:!0}),e})();!(function(e){e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=2]="Decimal",e[e.Double=3]="Double",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=6]="Date",e[e.DateTime=7]="DateTime",e[e.DateTimeZone=8]="DateTimeZone",e[e.Time=9]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None",e[e.Variant=13]="Variant"})(u||(u={}));var f;!(function(e){e[e.Numeric=256]="Numeric",e[e.Temporal=512]="Temporal",e[e.Geography=1024]="Geography",e[e.Miscellaneous=2048]="Miscellaneous",e[e.Formatting=4096]="Formatting",e[e.Scripting=8192]="Scripting",e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=258]="Decimal",e[e.Double=259]="Double",e[e.Integer=260]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=518]="Date",e[e.DateTime=519]="DateTime",e[e.DateTimeZone=520]="DateTimeZone",e[e.Time=521]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None",e[e.Variant=13]="Variant",e[e.Years=66048]="Years",e[e.Years_Text=66049]="Years_Text",e[e.Years_Integer=66308]="Years_Integer",e[e.Years_Date=66054]="Years_Date",e[e.Years_DateTime=66055]="Years_DateTime",e[e.Months=131584]="Months",e[e.Months_Text=131585]="Months_Text",e[e.Months_Integer=131844]="Months_Integer",e[e.Months_Date=131590]="Months_Date",e[e.Months_DateTime=131591]="Months_DateTime",e[e.PaddedDateTableDates=197127]="PaddedDateTableDates",e[e.Quarters=262656]="Quarters",e[e.Quarters_Text=262657]="Quarters_Text",e[e.Quarters_Integer=262916]="Quarters_Integer",e[e.Quarters_Date=262662]="Quarters_Date",e[e.Quarters_DateTime=262663]="Quarters_DateTime",e[e.DayOfMonth=328192]="DayOfMonth",e[e.DayOfMonth_Text=328193]="DayOfMonth_Text",e[e.DayOfMonth_Integer=328452]="DayOfMonth_Integer",e[e.DayOfMonth_Date=328198]="DayOfMonth_Date",e[e.DayOfMonth_DateTime=328199]="DayOfMonth_DateTime",e[e.Address=6554625]="Address",e[e.City=6620161]="City",e[e.Continent=6685697]="Continent",e[e.Country=6751233]="Country",e[e.County=6816769]="County",e[e.Region=6882305]="Region",e[e.PostalCode=6947840]="PostalCode",e[e.PostalCode_Text=6947841]="PostalCode_Text",e[e.PostalCode_Integer=6948100]="PostalCode_Integer",e[e.StateOrProvince=7013377]="StateOrProvince",e[e.Place=7078913]="Place",e[e.Latitude=7144448]="Latitude",e[e.Latitude_Decimal=7144706]="Latitude_Decimal",e[e.Latitude_Double=7144707]="Latitude_Double",e[e.Longitude=7209984]="Longitude",e[e.Longitude_Decimal=7210242]="Longitude_Decimal",e[e.Longitude_Double=7210243]="Longitude_Double",e[e.Image=13109259]="Image",e[e.ImageUrl=13174785]="ImageUrl",e[e.WebUrl=13240321]="WebUrl",e[e.Barcode=13305856]="Barcode",e[e.Barcode_Text=13305857]="Barcode_Text",e[e.Barcode_Integer=13306116]="Barcode_Integer",e[e.Color=19664897]="Color",e[e.FormatString=19730433]="FormatString",e[e.Alignment=20058113]="Alignment",e[e.LabelDisplayUnits=20123649]="LabelDisplayUnits",e[e.FontSize=20189443]="FontSize",e[e.LabelDensity=20254979]="LabelDensity",e[e.BubbleSize=20320515]="BubbleSize",e[e.Enumeration=26214401]="Enumeration",e[e.ScriptSource=32776193]="ScriptSource",e[e.SearchEnabled=65541]="SearchEnabled"})(f||(f={}));var m=255,y=65535,v=4294901760})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(t){switch(t){case 0:return"Add";case 1:return"Subtract";case 2:return"Multiply";case 3:return"Divide"}return e.contract.fail("Unexpected ArithmeticOperatorKind: "+t)}function a(e){switch(e){case 0:return"Sum";case 1:return"Avg";case 2:return"Count";case 3:return"Min";case 4:return"Max";case 5:return"CountNonNull";case 6:return"Median";case 7:return"StandardDeviation";case 8:return"Variance"}}!(function(e){e[e.Table=0]="Table",e[e.Pod=1]="Pod",e[e.Expression=2]="Expression"})(t.EntitySourceType||(t.EntitySourceType={}));t.EntitySourceType;t.getArithmeticOperatorName=i,t.aggregateFunctionName=a,(function(e){e[e.Default=0]="Default",e[e.Period=1]="Period"})(t.FilterKind||(t.FilterKind={}));t.FilterKind})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=e.Prototype.inherit,n=e.Prototype.inheritSingle,o=a.ArrayExtensions,s=a.EnumExtensions;!(function(i){function a(e){Se=e}function l(e){var i=e.prototype,a=e.objectDescriptors,r=e.transforms,n=e.colorAllocatorFactory;if(!i)return d(a,r,n);if(!r)return[i];var o=t.DataViewTransformContext.create(i.metadata,a,e.dataViewMappings,e.dataRoles,e.drillCapabilities,r,n),s=u(i,o),l=c(s,o);return l=t.DataViewRegression.run({visualDataViews:l,dataRoles:o.dataRoles,objectDescriptors:a,objectDefinitions:r.objects,colorAllocatorFactory:n,transformSelects:r.selects,applicableDataViewMappings:o.applicableRoleMappings,roleKindByQueryRef:o.roleKindByQueryRef,queryProjectionsByRole:o.queryProjectionsByRole})}function u(e,i){var a=i.transforms,r=i.applicableRoleMappings,n=t.DataViewPivotCategoricalToPrimaryGroups.unpivotResult(e,i.selectTransforms,i.roleKindByQueryRef,i.queryProjectionsByRole,r);return n=t.DataViewUpgradeFromCY16SU09Map.detectAndApply(n,a,r,i.drillCapabilities&&i.drillCapabilities.roles)}function c(e,t){var i=[],a=t.transforms.splits;if(_.isEmpty(a))i.push(p(e,t));else for(var r=0,n=a;r<n.length;r++){var o=n[r],s=p(e,t,o.selects);i.push(s)}return i}function d(e,t,i){if(t&&t.objects){var a={metadata:{columns:[]}};return M(a,0,e,t.objects,t.selects,i),[a]}return[]}function p(e,i,a){var n=r(e);n.metadata=r(e.metadata),n=g(n,i);var o=i.visualCapabilitiesDataViewKinds,s=i.visualCapabilitiesRoleMappings,l=i.selectTransforms,u=i.objectDescriptors,c=i.projectionOrdering,d={rowHierarchyRewritten:!1,columnHierarchyRewritten:!1,hierarchyTreesRewritten:!1};return n=f(n,o,s,l,c,d),M(n,i.visualCapabilitiesDataViewKinds,u,i.transforms.objects,l,i.colorAllocatorFactory),n=h(n,i,d,a),n=t.DataViewHierarchyLevelBackfill.apply(n,Se.quarterPrefix),n=t.DataViewConcatenateCategoricalColumns.detectAndApply(n,u,i.applicableRoleMappings,c,i.projectionActiveItems),t.DataViewNormalizeValues.apply({dataview:n,dataViewMappings:s,dataRoles:i.dataRoles}),n}function h(e,i,a,r){var o=i.projectionOrdering,l=i.applicableRoleMappings,u=n(e);if(u.matrix&&s.hasFlag(i.applicableDataViewKinds,2)){var c=_.filter(l,(function(e){return!!e.matrix}));u.matrix=t.DataViewMatrixProjectionOrder.apply(u.matrix,c[0].matrix,o,a),ye(u.matrix,l)&&t.DataViewPivotMatrix.apply(u.matrix,a)}return u=t.DataViewCategoricalProjectionOrder.apply(u,l,i.dataRoles,o,r)}function g(e,t){var i=s.getBitCount(t.visualCapabilitiesDataViewKinds);if(i<=1)return e;var a=t.applicableDataViewKinds,r=s.getBitCount(a);if(0===r)return e;var o=n(e);return o.categorical&&!s.hasFlag(a,1)&&(o.categorical=void 0),o.matrix&&!s.hasFlag(a,2)&&(o.matrix=void 0),o.table&&!s.hasFlag(a,8)&&(o.table=void 0),o.tree&&!s.hasFlag(a,16)&&(o.tree=void 0),o.single&&!s.hasFlag(a,4)&&(o.single=void 0),o}function f(e,t,i,a,r,n){var o=[];return a&&(e.metadata.columns=m(e.metadata.columns,a,o),v(e,a)),e.categorical&&s.hasFlag(t,1)&&(e.categorical=S(e.categorical,o),e=fe(e,i)),e.matrix&&s.hasFlag(t,2)&&(e.matrix=D(e.matrix,o,r,n)),e.table&&s.hasFlag(t,8)&&(e.table=x(e.table,o,r)),e}function m(e,t,i){if(!t)return e;for(var a=r(e),n=0,o=e.length;n<o;n++){var s=e[n],l=t[s.index];if(l){var u=a[n]=y(s,l);i.push({from:s,to:u})}}return a}function y(e,t){var i=r(e);return t.roles&&(i.roles=t.roles),t.type&&(i.type=t.type),i.format=C(t,i),t.displayName&&(i.displayName=t.displayName),t.queryName&&(i.queryName=t.queryName),t.expr&&(i.expr=t.expr),t.kpi&&t.kpi.graphic&&(i.kpi=t.kpi),t.sort&&(i.sort=t.sort),null!=t.sortOrder&&(i.sortOrder=t.sortOrder),t.discourageAggregationAcrossGroups&&(i.discourageAggregationAcrossGroups=t.discourageAggregationAcrossGroups),i}function v(i,a){if(a)for(var r,n=i.metadata.columns,o=0,s=a.length;o<s;o++){var l=a[o],u=l&&l.aggregateSources;if(u){r||(r=t.createStaticEvalContext(t.createColorAllocatorCache(),i,a));var c=w(n,o,l),d=c.aggregates={},p=e.ValueType.fromDescriptor(c.type),h=b(r,a,p,u.min);void 0!==h&&(d.min=h),h=b(r,a,p,u.max),void 0!==h&&(d.max=h)}}}function w(e,t,i){for(var a=0,r=e;a<r.length;a++){var n=r[a];if(n.index===t&&void 0===n.groupName)return n}var o=y({displayName:i.displayName},i);return e.push(o),o}function b(e,i,a,r){var n=i[r.index];if(n)return t.DataViewObjectEvaluator.evaluateValue(e,n.expr,a)}function C(e,t){return e.format||t.format}function S(i,a){function o(e){var t=V(e.source,a);if(t){var i=r(e);return i.source=t,i}}var s=r(i),l=e.Prototype.overrideArray(i.categories,o);if(l&&(s.categories=l),i.values){var u=e.Prototype.overrideArray(i.values,o)||n(i.values);if(s.values=u,u.source){var c=V(u.source,a);c&&(u.source=c)}}return t.DataViewCategoricalEvalGrouped.apply(s),s}function x(t,i,a){var n=r(t),o=function(e){return V(e,i)},s=e.Prototype.overrideArray(t.columns,o);if(s&&(n.columns=s),!a)return n;var l=P(a,i);if(!l)return n;for(var u=s.slice(0),c=Object.keys(l),d=0,p=c.length;d<p;d++){var h=u[l[c[d]]];d===s.length?s.push(h):s[d]=h}var g=e.Prototype.overrideArray(n.rows,(function(e){for(var t=[],i=0,a=c.length;i<a;++i)t[i]=e[l[c[i]]];return t}));return g&&(n.rows=g),n}function P(e,t){var i=Object.keys(e);if(1===i.length){var a=i[0],r=_.map(t,(function(e){return e.from.index})),n=e[a];return T(r,n)}}function D(t,i,a,n){function o(e){return V(e,i)}function s(t){var i=null,a=e.Prototype.overrideArray(t.levels,(function(t){var i=null,a=e.Prototype.overrideArray(t.sources,o);return a&&(i=L(i,t,(function(e){return e.sources=a}))),i}));return a&&(i=L(i,t,(function(e){return e.levels=a}))),i}var l=r(t),u=s(l.rows);u&&(l.rows=u,n.rowHierarchyRewritten=!0);var c=s(l.columns);c&&(l.columns=c,n.columnHierarchyRewritten=!0);var d=e.Prototype.overrideArray(l.valueSources,o);return d&&(l.valueSources=d),l}function T(e,t){if(!o.sequenceEqual(e,t,(function(e,t){return e===t}))){for(var i={},a=0,r=t.length;a<r;++a){var n=t[a];i[a]=e.indexOf(n)}return i}}function V(e,t){for(var i=0,a=t.length;i<a;i++){var r=t[i];if(r.from===e)return r.to}}function L(e,t,i){return e||(e=r(t)),i&&i(e),e}function M(e,i,a,r,n,o){if(a){var s=t.DataViewObjectEvaluationUtils.groupObjectsBySelector(r);t.DataViewObjectEvaluationUtils.addImplicitObjects(s,a,e.metadata.columns,n);var l=s.metadataOnce,u=s.data;if(l)for(var c=0,d=l.length;c<d;c++){var p=l[c],h=p.objects;I(e,n,a,p.selector,h,u,o)}var g=s.metadata;if(g)for(var c=0,d=g.length;c<d;c++){var f=g[c],h=f.objects,m=j(e,n,h,o);se(e,n,a,f.selector,h,m)}for(var c=0,d=u.length;c<d;c++){var y=u[c],h=y.objects,m=j(e,n,h,o);H(e,i,n,a,y.selector,y.rules,h,m)}}}function N(e,t,i){if(!_.isEmpty(t))for(var a in t){var r=t[a];if(i&&void 0!==i.id){var n=e[a];n||(n=e[a]={});var o=n.$instances;o||(o=n.$instances={}),o[i.id]=r}else e[a]=r}}function I(e,i,a,r,n,o,s){var l=j(e,i,n,s),u=t.createStaticEvalContext(l,e,i),c=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(u,a,n);if(c){var d=e.metadata.objects;d||(d=e.metadata.objects={}),N(d,c,r);for(var p in c){var h=c[p],g=a[p];for(var f in h){var m=g.properties[f],y=m.rule;if(y){var v=A(e,s,y,p,h[f],m.type);_.isEmpty(v)||o.push.apply(o,v)}}}}}function A(e,t,i,a,r,n){var o=i.output;if(o){var s=ue(e,o.selector);if(!_.isEmpty(s))return n.fillRule?O(e,t,i,s,a,r):void 0}}function O(e,i,a,r,n,o){var s=R(e,i,a.inputRole,1,o);if(s){var l=new t.ColorRuleEvaluation(a.inputRole,s),u={};u[a.output.property]={solid:{color:l}};for(var c=[],d=0,p=r.length;d<p;d++)c.push({selector:r[d],rules:[l],objects:[{name:n,properties:u}]});return c}}function R(e,t,i,a,r){return r.linearGradient2?E(e,t,i,a,r,r.linearGradient2):r.linearGradient3?F(e,t,i,a,r,r.linearGradient3):void 0}function E(e,t,i,a,r,n){if(n=r.linearGradient2,void 0===n.min.value||void 0===n.max.value){var o=de(e,i,a);if(!o)return;void 0===n.min.value&&(n.min.value=o.min),void 0===n.max.value&&(n.max.value=o.max)}return t.linearGradient2(r.linearGradient2)}function F(e,t,i,a,r,n){var o;if(n=r.linearGradient3,void 0===n.min.value||void 0===n.mid.value||void 0===n.max.value){var s=de(e,i,a);if(!s)return;if(o=void 0===n.min.value&&void 0===n.max.value&&void 0!==n.mid.value,void 0===n.min.value&&(n.min.value=s.min),void 0===n.max.value&&(n.max.value=s.max),void 0===n.mid.value){var l=(n.max.value+n.min.value)/2;n.mid.value=l}}return t.linearGradient3(r.linearGradient3,o)}function j(e,i,a,r){for(var n=t.createColorAllocatorCache(),o=t.createStaticEvalContext(),s=0,l=a.length;s<l;s++){var u=a[s].properties;for(var c in u){var d=u[c];if(d&&d.solid&&d.solid.color&&24===d.solid.color.kind){var p=d.solid.color,h=ce(i,p.input);if(!h)continue;var g=t.DataViewObjectEvaluator.evaluateProperty(o,Ce,p.rule),f=R(e,r,h,0,g);f&&n.register(p,f)}}}return n}function H(e,i,a,r,n,o,l,u){var c=t.Selector.containsWildcard(n),d=e.categorical;if(d&&s.hasFlag(i,1)){var p=z(d,n);J(d,a,r,p,o,c,l,u),X(d,a,r,p,o,c,l,u)}var h=e.matrix;if(h&&s.hasFlag(i,2)){var p=k(h,n),g=$(h,r,p,c,l,u);g&&(e.matrix=g)}var f=e.table;if(f&&s.hasFlag(i,8)){var p=G(f,n),m=ne(f,a,r,p,c,l,u);m&&(e.table=m)}}function G(e,i){return t.Selector.hasRoleWildcard(i)&&(i=U(i,(function(t){return B(t,e)}))),i}function k(e,i){return t.Selector.hasRoleWildcard(i)&&(i=U(i,(function(t){return W(t,e)}))),i}function z(e,i){return t.Selector.hasRoleWildcard(i)&&(i=U(i,(function(t){return K(t,e)}))),i}function U(e,i){for(var a={data:[],id:e.id,metadata:e.metadata},r=0,n=e.data;r<n.length;r++){var o=n[r];if(t.Selector.isRoleWildcard(o)){var s=i(o.roles);if(!_.isEmpty(s)){a.data.push(t.DataViewScopeWildcard.fromExprs(s));continue}}Q(a.data,o)&&a.data.push(o)}return a}function B(e,t){var i=Y(t.columns,e),a=t.identityFields;if(i&&a)return a}function W(e,t){if(t){var i=[];return i.push.apply(i,q(e,t.rows)),i.push.apply(i,q(e,t.columns)),i}}function q(e,t){var i=[];if(!e||!t)return i;for(var a=0,r=t.levels;a<r.length;a++)for(var n=r[a],o=0,s=n.sources;o<s.length;o++){var l=s[o];l.identityExprs&&Y([l],e)&&i.push.apply(i,l.identityExprs)}return i}function K(e,t){if(t.categories)for(var i=0,a=t.categories;i<a.length;i++){var r=a[i];if(r.source&&Y([r.source],e))return r.identityFields}}function Q(e,t){return!!_.isEmpty(e)||!_.any(e,(function(e){return e.key===t.key}))}function Y(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i],n=r.roles;if(!n||!_.any(t,(function(e){return n[e]})))return!1}return!0}function J(e,i,a,r,n,o,s,l){if(e.categories&&0!==e.categories.length){var u=le(e,r);if(u){var c,d=u.identities,p=t.createCategoricalEvalContext(l,e,i);if(d){for(var h=0,g=d.length;h<g;h++){var f=d[h];if(o||t.Selector.matchesData(r,[f])){p.setCurrentRowIndex(h);var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(p,a,s);if(m){var y=u.column.objects;y||(y=u.column.objects=[],u.column.objects.length=g),y[h]||(y[h]={}),N(y[h],m,r)}if(!o)return!0;c=!0}}return c}}}}function X(i,a,r,n,o,s,l,u){var c=i.values;if(c&&c.identityFields&&t.Selector.matchesKeys(n,[c.identityFields])){var d=c.grouped();if(d){for(var p,h=t.createCategoricalEvalContext(u,i,a),g=0,f=d.length;g<f;g++){var m=d[g],y=n.metadata,v=m.values;if(s||t.Selector.matchesData(n,[m.identity])){var w=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(h,r,l);if(w)if(y)for(var b=0,C=v.length;b<C;b++){var S=v[b],x=S.source;if(x.queryName===y){var P=e.Prototype.inherit(x),D=P.objects;D||(D=P.objects={}),N(D,w,n),S.source=P,p=!0;break}}else{var T=m.objects;T||(T=m.objects={}),N(T,w,n),he(c,d),p=!0}if(!s)return!0}}return p}}}function $(e,i,a,r,o,s){var l,u,c=t.createMatrixEvalContext(s,e);u=ee(1,c,e.columns,i,a,r,o);var d=[];d.push.apply(d,Z(e.rows)),d.push.apply(d,Z(e.columns));var p=t.Selector.matchesKeys(a,[d]),h=e.valueSources;if(p&&a.metadata&&e.columns&&e.columns.root&&!_.isEmpty(h)&&_.any(h,(function(e){return e.queryName===a.metadata}))){var g=t.DataViewMatrixUtils.getLeafNodes(e.columns.root);l=ee(0,c,e.rows,i,a,r,o,g,h)}else l=ee(0,c,e.rows,i,a,r,o);if(l||u){var f=n(e);return l&&(f.rows=l),u&&(f.columns=u),f}}function Z(e){var t=[];if(!e)return t;for(var i=0,a=e.levels;i<a.length;i++)for(var r=a[i],n=0,o=r.sources;n<o.length;n++){var s=o[n];s.identityExprs&&t.push.apply(t,s.identityExprs)}return t}function ee(e,t,i,a,r,o,s,l,u){if(i){var c=i.root;if(c){var d=te(e,t,c,a,r,o,s,l,u);if(d){var p=n(i);return p.root=d,p}}}}function te(e,i,a,r,n,o,s,l,u){var c;return t.DataViewMatrixUtils.isLeafNode(a)?a.isSubtotal||_.isEmpty(a.values)||_.isEmpty(l)||_.isEmpty(u)||(c=ae(i,a,r,n,o,s,l,u)):c=ie(e,i,a,r,n,o,s,l,u),c}function ie(e,i,a,r,o,s,l,u,c){var d,p,h=!1,g=a.childIdentityFields;if(!_.isEmpty(g)){var f=_.last(g).ref;h=t.Selector.matchesKeys(o,[g])&&(!o.metadata||o.metadata===f)}for(var m=a.children,y=0,v=m.length;y<v;y++){var w=m[y],b=w.identity;switch(e){case 0:i.setCurrentContext(null,w,null);break;case 1:i.setCurrentContext(null,null,w);break;default:h=!1}if(h){if(s||t.Selector.matchesData(o,[b])){var C=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(i,r,l);C&&(p=n(w),p.objects=C)}}else p=te(e,i,w,r,o,s,l,u,c);if(p&&(d||(d=re(a)),d.children[y]=p,!s))break}return d}function ae(e,i,a,r,o,s,l,u){var c,d=i.values;for(var p in d){var h=d[p],g=l[p];if(!g.isSubtotal&&h&&u[h.valueSourceIndex||0].queryName===r.metadata){var f=void 0;e.setCurrentContext(h,i,g);var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(e,a,s);m&&(f=n(h),f.objects=m,c||(c=n(i)),c.values[p]=f)}}return c}function re(e){if(Object.getPrototypeOf(e)!==Object.prototype)return e;var t=n(e);return t.children=r(e.children),t}function ne(e,i,a,r,o,s,l){var u=t.createTableEvalContext(l,e,i),c=oe(u,e.columns,e.rows,e.identity,e.identityFields,a,r,o,s);if(c){var d=n(e);return d.rows=c,d}}function oe(e,i,a,r,o,s,l,u,c){if(!_.isEmpty(r)&&!_.isEmpty(o)&&l.metadata&&t.Selector.matchesKeys(l,[o])){var d=_.findIndex(i,(function(e){return e.queryName===l.metadata}));if(!(d<0)){for(var p,h=i.length,g=0,f=r.length;g<f;g++){var m=r[g];if(u||t.Selector.matchesData(l,[m])){e.setCurrentRowIndex(g);var y=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(e,s,c);if(y){p||(p=n(a));var v=p[g]=n(p[g]),w=v.objects;w||(v.objects=w=new Array(h)),w[d]=y}if(!u)break}}return p}}}function se(e,i,a,r,n,o){for(var s=e.metadata.columns,l=r.metadata,u=t.createStaticEvalContext(o,e,i),c=0,d=s.length;c<d;c++){var p=s[c];if(p.queryName===l){var h=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(u,a,n),g=p.objects;g||(g=p.objects={}),N(g,h,r)}}}function le(e,i){var a=e.categories[0];if(a.identityFields&&t.Selector.matchesKeys(i,[a.identityFields])){var r=a.identity,n=a,o=i.metadata;if(o){var s=e.values;if(s)for(var l=0,u=s.length;l<u;l++){var c=s[l];if(c.source.queryName===o){n=c;break}}}return{column:n,identities:r}}}function ue(e,i){var a=e.categorical;if(a){var r=a.categories;if(r){for(var n,o=[],s=0,l=r.length;s<l;s++){var u=r[s],c=u.identityFields;if(n=u.source.roles,n&&c){var d=_.any(i,(function(e){return n[e]}));d&&o.push({data:[t.DataViewScopeWildcard.fromExprs(c)]})}}return o}}}function ce(e,i){if(t.SQExpr.isSelectRef(i))return i.expressionName;if(e)for(var a=0,r=e.length;a<r;a++){var n=e[a],o=n.expr;if(o&&t.SQExpr.equals(i,n.expr))return n.queryName}}function de(e,t,i){for(var a=e.metadata.columns,r=0,n=a.length;r<n;r++){var o=a[r];if(1===i){var s=o.roles;if(!s||!s[t])continue}else if(o.queryName!==t)continue;var l=o.aggregates;if(l){var u=l.min;if(void 0===u&&(u=l.minLocal),void 0!==u){var c=l.max;if(void 0===c&&(c=l.maxLocal),void 0!==c)return{min:u,max:c}}}}}function pe(e,t,i){void 0===e&&(e=[]);var a=e;return he(a),t&&(a.identityFields=t),i&&(a.source=i),a}function he(e,t){e.grouped=t?function(){return t}:function(){return ge(e)}}function ge(e){for(var t,i=[],a=0,r=e.length;a<r;a++){var n=e[a];if(!t||t.identity!==n.identity){if(t={values:[]},n.identity){t.identity=n.identity;var o=n.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}i.push(t)}t.values.push(n)}return i}function fe(e,i){var a,r=me(e.categorical,i);if(r)switch(r.type){case 1:a=t.DataViewPivotCategorical.apply(e);break;case 2:a=t.DataViewSelfCrossJoin.apply(e,r.selfCrossJoinCategory)}return a||e}function me(e,t){if(e&&!_.isEmpty(t)){var i=e.categories;if(!_.isEmpty(i)){var a=e.values;if(!_.isEmpty(a)&&!a.grouped().some((function(e){return!!e.identity})))for(var r=function(e,a){var r=t[e].categorical;if(!r)return"continue";for(var n=0,o=i;n<o.length;n++){var s=o[n],l=s.source.roles;if(be(l,r.values)){var u=r.categories,c=ve(l,u)||we(l,u);if(c)return{value:{type:2,selfCrossJoinCategory:s}};if(1===i.length)return{value:{type:1}}}}},n=0,o=t.length;n<o;n++){var s=r(n,o);if("object"==typeof s)return s.value}}}}function ye(e,t){if(e&&!_.isEmpty(t)){var i=e.rows.levels;if(!(i.length<1)){var a=e.rows.root.children;if(a&&0!==a.length)for(var r=i[0].sources[0].roles,n=0,o=t.length;n<o;n++){var s=t[n].matrix;if(s&&!we(r,s.rows)&&we(r,s.columns))return!0}}}}function ve(e,t){if(e&&t&&t.bind)return e[t.bind.to]}function we(e,t){if(e&&t&&t.for)return e[t.for.in]}function be(e,t){if(e&&t&&t.group)return e[t.group.by]}var Ce={type:{fillRule:{}}},Se={quarterPrefix:"Qtr {0}"};i.setLocalizationOptions=a,i.apply=l,i.transformObjects=M,i.mergeObjects=N,i.createValueColumns=pe,i.setGrouped=he})(i=t.DataViewTransform||(t.DataViewTransform={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function a(e,t,a){return e=e||null,t=t||null,e===t||!e==!t&&i.SQExpr.equals(e.expr,t.expr,a)}function r(e,t){if(!_.isEmpty(e)){for(var i=[],a=0,r=e;a<r.length;a++){var o=r[a];i.push(o.expr)}return n(i,t)}}function n(t,a){if(!_.isEmpty(t)){for(var r,n=0,o=t;n<o.length;n++){var s=o[n],l=i.ScopeIdentityExtractor.getInExpr(s);r=r?i.SQExprBuilder.or(r,l):l||s}return r&&a&&(r=e.data.SQExprBuilder.not(r)),e.data.SemanticFilter.fromSQExpr(r)}}t.equals=a,t.filterFromIdentity=r,t.filterFromExprs=n})(t=e.DataViewScopeIdentity||(e.DataViewScopeIdentity={}));var i;!(function(e){function t(e){return new r(e)}var i=a.Lazy;e.createDataViewScopeIdentity=t;var r=(function(){function t(t){this._expr=t,this._key=new i(function(){return e.SQExprShortSerializer.serialize(t)})}return Object.defineProperty(t.prototype,"expr",{get:function(){return this._expr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t})()})(i=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){return e+"M"}function i(e){return e+"D"}function r(e){return e+"L"}function n(e){var t=new Date(e.getTime()-6e4*e.getTimezoneOffset()),i=t.toISOString();return a.StringExtensions.endsWith(i,"Z")&&(i=i.substr(0,i.length-1)),"datetime'"+i+"'"}function o(e){return"'"+e.replace(u,"''")+"'"}function s(){return"null"}function l(e){return e?"true":"false"}var u=/'/g;e.decimal=t,e.double=i,e.integer=r,e.dateTime=n,e.text=o,e.nullEncoding=s,e.boolean=l})(t=e.PrimitiveValueEncoding||(e.PrimitiveValueEncoding={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.ArrayExtensions,i=(function(){function i(){}return i.prototype.visitColumnRef=function(t){var i=t.source,a=i.accept(this);return i===a?t:new e.SQColumnRefExpr(a,t.ref)},i.prototype.visitMeasureRef=function(t){var i=t.source,a=i.accept(this);return i===a?t:new e.SQMeasureRefExpr(a,t.ref)},i.prototype.visitAggr=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQAggregationExpr(a,t.func)},i.prototype.visitSelectRef=function(e){return e},i.prototype.visitPercentile=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQPercentileExpr(a,t.k,t.exclusive)},i.prototype.visitGroupRef=function(t){for(var i=t.source,a=t.source.accept(this),r=t.groupedExprs,n=new Array(r.length),o=0;o<r.length;o++)n[o]=r[o].accept(this);return i===a&&e.SQExprUtils.sequenceEqual(r,n)?t:new e.SQGroupRefExpr(t.ref,a,n)},i.prototype.visitHierarchy=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQHierarchyExpr(a,t.hierarchy)},i.prototype.visitHierarchyLevel=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQHierarchyLevelExpr(a,t.level)},i.prototype.visitPropertyVariationSource=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQPropertyVariationSourceExpr(a,t.name,t.property)},i.prototype.visitEntity=function(e){return e},i.prototype.visitSubqueryRef=function(e){return e},i.prototype.visitAnd=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQAndExpr(a,n)},i.prototype.visitBetween=function(t){var i=t.arg,a=i.accept(this),r=t.lower,n=r.accept(this),o=t.upper,s=o.accept(this);return i===a&&r===n&&o===s?t:new e.SQBetweenExpr(a,n,s)},i.prototype.visitIn=function(i){var a,r=i.args,n=this.rewriteAll(r),o=i.values,s=i.table,l=s;if(o)for(var u=0,c=o.length;u<c;u++){var d=o[u],p=this.rewriteAll(d);d===p||a||(a=t.take(o,u)),a&&a.push(p)}return s&&(l=s.accept(this)),r!==n||a||s!==l?new e.SQInExpr(n,a||o,l):i},i.prototype.rewriteAll=function(e){for(var i,a=0,r=e.length;a<r;a++){var n=e[a],o=n.accept(this);n===o||i||(i=t.take(e,a)),i&&i.push(o)}return i||e},i.prototype.visitOr=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQOrExpr(a,n)},i.prototype.visitCompare=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQCompareExpr(t.comparison,a,n)},i.prototype.visitContains=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQContainsExpr(a,n)},i.prototype.visitExists=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQExistsExpr(a)},i.prototype.visitNot=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQNotExpr(a)},i.prototype.visitStartsWith=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQStartsWithExpr(a,n)},i.prototype.visitConstant=function(e){return e},i.prototype.visitFloor=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQFloorExpr(a,t.size,t.timeUnit)},i.prototype.visitDateSpan=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQDateSpanExpr(t.unit,a)},i.prototype.visitDateAdd=function(t){var i=t.arg,a=i.accept(this);return i===a?t:new e.SQDateAddExpr(t.unit,t.amount,a)},i.prototype.visitNow=function(e){return e},i.prototype.visitDefaultValue=function(e){return e},i.prototype.visitAnyValue=function(e){return e},i.prototype.visitArithmetic=function(t){var i=t.left,a=i.accept(this),r=t.right,n=r.accept(this);return i===a&&r===n?t:new e.SQArithmeticExpr(a,n,t.operator)},i.prototype.visitScopedEval=function(t){var i=t.expression,a=i.accept(this),r=t.scope,n=this.rewriteAll(r);return i===a&&r===n?t:new e.SQScopedEvalExpr(a,n)},i.prototype.visitWithRef=function(e){return e},i.prototype.visitTransformTableRef=function(e){return e},i.prototype.visitTransformOutputRoleRef=function(e){return e},i.prototype.visitRoleRef=function(e){return e},i.prototype.visitFillRule=function(t){var i=t.input,a=i.accept(this),r=t.rule,n=r.linearGradient2,o=n;n&&(o=this.visitLinearGradient2(n));var s=r.linearGradient3,l=s;if(s&&(l=this.visitLinearGradient3(s)),i!==a||n!==o||s!==l){var u={};return o&&(u.linearGradient2=o),l&&(u.linearGradient3=l),new e.SQFillRuleExpr(a,u)}return t},i.prototype.visitLinearGradient2=function(e){var t=e.min,i=this.visitFillRuleStop(t),a=e.max,r=this.visitFillRuleStop(a),n=e.nullColoringStrategy,o=this.visitFillNullStrategy(n);if(t!==i||a!==r||n!==o){var s={min:i,max:r};return o&&(s.nullColoringStrategy=o),s}return e},i.prototype.visitLinearGradient3=function(e){var t=e.min,i=this.visitFillRuleStop(t),a=e.mid,r=this.visitFillRuleStop(a),n=e.max,o=this.visitFillRuleStop(n),s=e.nullColoringStrategy,l=this.visitFillNullStrategy(s);if(t!==i||a!==r||n!==o||s!==l){var u={min:i,mid:r,max:o};return l&&(u.nullColoringStrategy=l),u}return e},i.prototype.visitFillRuleStop=function(e){var t=e.color,i=e.color.accept(this),a=e.value,r=a;if(a&&(r=a.accept(this)),t!==i||a!==r){var n={color:i};return r&&(n.value=r),n}return e},i.prototype.visitFillNullStrategy=function(e){if(e){var t=e.strategy,i=t.accept(this),a=e.color,r=a;if(a&&(r=a.accept(this)),t!==i||a!==r){var n={strategy:i};return r&&(n.color=r),n}return e}},i.prototype.visitThemeColor=function(e){return e},i.prototype.visitResourcePackageItem=function(e){return e},i})();e.SQExprRewriter=i})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i=a.StringExtensions,n=(function(){function i(e){this._kind=e}return i.equals=function(e,t,i,a){return q.run(e,t,i,a)},i.prototype.validate=function(e,t,i){var a=new Q(e,t,i);return this.accept(a),a.errors},i.prototype.accept=function(e,t){},Object.defineProperty(i.prototype,"kind",{get:function(){return this._kind},enumerable:!0,configurable:!0}),i.isArithmetic=function(e){
return 23===e.kind},i.isFloor=function(e){return 34===e.kind},i.isColumn=function(e){return 2===e.kind},i.isConstant=function(e){return 17===e.kind},i.isEntity=function(e){return 0===e.kind},i.isHierarchy=function(e){return 6===e.kind},i.isHierarchyLevel=function(e){return 7===e.kind},i.isIn=function(e){return 10===e.kind},i.isAggregation=function(e){return 4===e.kind},i.isMinAggregation=function(e){return i.isAggregation(e)&&3===e.func},i.isMaxAggregation=function(e){return i.isAggregation(e)&&4===e.func},i.isAvgAggregation=function(e){return i.isAggregation(e)&&1===e.func},i.isMedianAggregation=function(e){return i.isAggregation(e)&&6===e.func},i.isMeasure=function(e){return 3===e.kind},i.isPercentile=function(e){return 28===e.kind},i.isSelectRef=function(e){return 29===e.kind},i.isScopedEval=function(e){return 26===e.kind},i.isSubqueryRef=function(e){return 1===e.kind},i.isWithRef=function(e){return 27===e.kind},i.isTransformTableRef=function(e){return 30===e.kind},i.isTransformOutputRoleRef=function(e){return 31===e.kind},i.isResourcePackageItem=function(e){return 25===e.kind},i.isCompareRef=function(e){return 13===e.kind},i.isGroupRef=function(e){return 33===e.kind},i.isRoleRef=function(e){return 35===e.kind},i.prototype.getMetadata=function(e){var a=t.SQExprConverter.asFieldPattern(this);if(a)return a.column||a.columnAggr||a.groupingColumn||a.groupingColumnAggr||a.measure?this.getMetadataForProperty(a,e):a.hierarchyLevel||a.hierarchyLevelAggr?this.getMetadataForHierarchyLevel(a,e):a.columnHierarchyLevelVariation?this.getMetadataForVariation(a,e):a.percentOfGrandTotal?this.getMetadataForPercentOfGrandTotal():i.getMetadataForEntity(a,e)},i.prototype.getKeyColumns=function(e){var t=J.getColumnRefSQExpr(e,this);if(t){var i=[],a=this.getPropertyKeys(e);if(a&&a.length>0)for(var r=0,n=a.length;r<n;r++)i.push(B.columnRef(t.source,a[r].name));else i.push(t);return i}},i.prototype.hasGroupOnKeys=function(e){var t=J.getColumnRefSQExpr(e,this);if(t){var a=this.getPropertyKeys(e);if(!a||a.length<1)return!1;if(a.length>1)return!0;var r=B.columnRef(t.source,a[0].name);return!i.equals(r,this)}},i.prototype.getPropertyKeys=function(e){var t=this.getConceptualProperty(e,!0);if(t)return t.column?t.column.keys:void 0},i.prototype.getConceptualProperty=function(e,i){var a=t.SQExprConverter.asFieldPattern(this);if(a){var r=t.FieldExprPattern.toFieldExprEntityItemPattern(a),n=t.FieldExprPattern.getPropertyName(a);if(n)return e.schema(r.schema).findProperty(r.entity,n);if(i){var o=a.hierarchyLevel||a.hierarchyLevelAggr;if(o){var s=t.FieldExprPattern.toFieldExprEntityItemPattern(a),l=e.schema(s.schema).findHierarchy(s.entity,o.name);if(l){var u=l.levels.withName(o.level);if(u)return u.column}}}}},i.prototype.getTargetEntityForVariation=function(e,t){var i=this.getConceptualProperty(e);if(i&&i.column&&!_.isEmpty(i.column.variations))for(var a=i.column.variations,r=0,n=a;r<n.length;r++){var o=n[r];if(o.name===t)return o.navigationProperty.targetEntity.name}},i.prototype.getTargetEntity=function(){return X.getEntityExpr(this)},i.prototype.getMetadataForVariation=function(e,i){var a=e.columnHierarchyLevelVariation,r=t.FieldExprPattern.toFieldExprEntityItemPattern(e),n=i.schema(r.schema).findProperty(r.entity,a.source.name);if(n&&n.column&&n.column.variations)for(var o=0,s=n.column.variations;o<s.length;o++){var l=s[o];if(l.defaultHierarchy&&l.defaultHierarchy.levels)for(var u=0,c=l.defaultHierarchy.levels;u<c.length;u++){var d=c[u];if(d.name===a.level.level){var p=d.column;return{kind:1===p.kind?1:0,type:p.type,format:p.format,idOnEntityKey:!!p.column&&p.column.idOnEntityKey,defaultAggregate:p.column?p.column.defaultAggregate:null}}}}},i.prototype.getMetadataForHierarchyLevel=function(e,t){var i=this.getConceptualProperty(t,!0);if(i)return this.getPropertyMetadata(e,i)},i.prototype.getMetadataForPercentOfGrandTotal=function(){return{kind:1,format:"#,##0.00%",type:e.ValueType.fromExtendedType(259)}},i.prototype.getPropertyMetadata=function(t,i){var a=i.format,r=i.type,n=t.columnAggr||t.groupingColumnAggr||t.hierarchyLevelAggr;if(n)switch(n.aggregate){case 2:case 5:r=e.ValueType.fromExtendedType(260),a=void 0;break;case 1:case 7:case 8:r.integer&&(r=e.ValueType.fromExtendedType(259),a=e.NumberFormat.getFormatForWholeNumberAverage(a))}return{kind:1===i.kind||n&&void 0!==n.aggregate?1:0,type:r,format:a,idOnEntityKey:!!i.column&&i.column.idOnEntityKey,aggregate:n?n.aggregate:void 0,defaultAggregate:i.column?i.column.defaultAggregate:null}},i.prototype.getMetadataForProperty=function(e,t){var i=this.getConceptualProperty(t);if(i)return this.getPropertyMetadata(e,i)},i.getMetadataForEntity=function(i,a){var r=t.FieldExprPattern.toFieldExprEntityItemPattern(i),n=a.schema(r.schema).entities.withName(r.entity);if(n&&i.entityAggr)switch(i.entityAggr.aggregate){case 2:case 5:return{kind:1,type:e.ValueType.fromExtendedType(260),format:void 0,idOnEntityKey:!1,aggregate:i.entityAggr.aggregate}}},i})();t.SQExpr=n;var o=(function(e){function t(t,i,a){e.call(this,0),this.schema=t,this.entity=i,a&&(this.variable=a)}return r(t,e),t.prototype.accept=function(e,t){return e.visitEntity(this,t)},t})(n);t.SQEntityExpr=o;var s=(function(e){function t(t){e.call(this,1),this.variable=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitSubqueryRef(this,t)},t})(n);t.SQSubqueryRefExpr=s;var l=(function(e){function t(t,i,a){e.call(this,23),this.left=t,this.right=i,this.operator=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitArithmetic(this,t)},t})(n);t.SQArithmeticExpr=l;var u=(function(e){function t(t,i,a){e.call(this,34),this.arg=t,this.size=i,null!=a&&(this.timeUnit=a)}return r(t,e),t.prototype.accept=function(e,t){return e.visitFloor(this,t)},t})(n);t.SQFloorExpr=u;var c=(function(e){function t(t,i){e.call(this,26),this.expression=t,this.scope=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitScopedEval(this,t)},t.prototype.getMetadata=function(e){return this.expression.getMetadata(e)},t})(n);t.SQScopedEvalExpr=c;var d=(function(e){function t(t){e.call(this,27),this.expressionName=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitWithRef(this,t)},t})(n);t.SQWithRefExpr=d;var p=(function(e){function t(t,i,a){e.call(this,t),this.source=i,this.ref=a}return r(t,e),t})(n);t.SQPropRefExpr=p;var h=(function(e){function t(t,i,a){e.call(this,a||2,t,i)}return r(t,e),t.prototype.accept=function(e,t){return e.visitColumnRef(this,t)},t})(p);t.SQColumnRefExpr=h;var g=(function(e){function t(t,i){e.call(this,3,t,i)}return r(t,e),t.prototype.accept=function(e,t){return e.visitMeasureRef(this,t)},t})(p);t.SQMeasureRefExpr=g;var f=(function(e){function t(t,i){e.call(this,4),this.arg=t,this.func=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitAggr(this,t)},t})(n);t.SQAggregationExpr=f;var m=(function(e){function t(t,i,a){e.call(this,28),this.arg=t,this.k=i,this.exclusive=a}return r(t,e),t.prototype.getMetadata=function(e){var t=this.arg.getMetadata(e);if(t)return{kind:1,type:t.type}},t.prototype.accept=function(e,t){return e.visitPercentile(this,t)},t})(n);t.SQPercentileExpr=m;var y=(function(e){function t(t,i,a){e.call(this,5),this.arg=t,this.name=i,this.property=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitPropertyVariationSource(this,t)},t})(n);t.SQPropertyVariationSourceExpr=y;var v=(function(e){function t(t,i,a){e.call(this,i,t,33),this.groupedExprs=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitGroupRef(this,t)},t})(h);t.SQGroupRefExpr=v;var w=(function(e){function t(t,i){e.call(this,6),this.arg=t,this.hierarchy=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitHierarchy(this,t)},t})(n);t.SQHierarchyExpr=w;var b=(function(e){function t(t,i){e.call(this,7),this.arg=t,this.level=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitHierarchyLevel(this,t)},t})(n);t.SQHierarchyLevelExpr=b;var C=(function(e){function t(t){e.call(this,29),this.expressionName=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitSelectRef(this,t)},t})(n);t.SQSelectRefExpr=C;var S=(function(e){function t(t,i){e.call(this,8),this.left=t,this.right=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitAnd(this,t)},t})(n);t.SQAndExpr=S;var x=(function(e){function t(t,i,a){e.call(this,9),this.arg=t,this.lower=i,this.upper=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitBetween(this,t)},t})(n);t.SQBetweenExpr=x;var P=(function(e){function t(t,i,a){e.call(this,10),this.args=t,i&&(this.values=i),a&&(this.table=a)}return r(t,e),t.prototype.accept=function(e,t){return e.visitIn(this,t)},t})(n);t.SQInExpr=P;var D=(function(e){function t(t,i){e.call(this,11),this.left=t,this.right=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitOr(this,t)},t})(n);t.SQOrExpr=D;var T=(function(e){function t(t,i,a){e.call(this,13),this.comparison=t,this.left=i,this.right=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitCompare(this,t)},t})(n);t.SQCompareExpr=T;var V=(function(e){function t(t,i){e.call(this,12),this.left=t,this.right=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitContains(this,t)},t})(n);t.SQContainsExpr=V;var L=(function(e){function t(t,i){e.call(this,14),this.left=t,this.right=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitStartsWith(this,t)},t})(n);t.SQStartsWithExpr=L;var M=(function(e){function t(t){e.call(this,15),this.arg=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitExists(this,t)},t})(n);t.SQExistsExpr=M;var N=(function(e){function t(t){e.call(this,16),this.arg=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitNot(this,t)},t})(n);t.SQNotExpr=N;var I=(function(e){function t(t,i,a){e.call(this,17),this.type=t,this.value=i,this.valueEncoded=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitConstant(this,t)},t.prototype.getMetadata=function(e){return{kind:1,type:this.type}},t})(n);t.SQConstantExpr=I;var A=(function(e){function t(t,i){e.call(this,18),this.unit=t,this.arg=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitDateSpan(this,t)},t})(n);t.SQDateSpanExpr=A;var O=(function(e){function t(t,i,a){e.call(this,19),this.unit=t,this.arg=a,this.amount=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitDateAdd(this,t)},t})(n);t.SQDateAddExpr=O;var R=(function(e){function t(){e.call(this,20)}return r(t,e),t.prototype.accept=function(e,t){return e.visitNow(this,t)},t})(n);t.SQNowExpr=R;var E=(function(e){function t(){e.call(this,22)}return r(t,e),t.prototype.accept=function(e,t){return e.visitDefaultValue(this,t)},t})(n);t.SQDefaultValueExpr=E;var F=(function(e){function t(t){e.call(this,21),this.defaultValueOverridesAncestors=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitAnyValue(this,t)},t})(n);t.SQAnyValueExpr=F;var j=(function(e){function t(t,i){e.call(this,24),this.input=t,this.rule=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitFillRule(this,t)},t})(n);t.SQFillRuleExpr=j;var H=(function(e){function t(t,i){e.call(this,32),this.color=t,this.percent=i}return r(t,e),t.prototype.accept=function(e,t){return e.visitThemeColor(this,t)},t})(n);t.SQThemeColorExpr=H;var G=(function(e){function t(t,i,a){e.call(this,25),this.packageName=t,this.packageType=i,this.itemName=a}return r(t,e),t.prototype.accept=function(e,t){return e.visitResourcePackageItem(this,t)},t})(n);t.SQResourcePackageItemExpr=G;var k=(function(e){function t(t){e.call(this,30),this.source=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitTransformTableRef(this,t)},t})(n);t.SQTransformTableRefExpr=k;var z=(function(e){function t(t,i){e.call(this,31),this.role=t,i&&(this.transform=i)}return r(t,e),t.prototype.accept=function(e,t){return e.visitTransformOutputRoleRef(this,t)},t.prototype.getMetadata=function(e){},t})(n);t.SQTransformOutputRoleRefExpr=z;var U=(function(e){function t(t){e.call(this,35),this.role=t}return r(t,e),t.prototype.accept=function(e,t){return e.visitRoleRef(this,t)},t})(n);t.SQRoleRefExpr=U;var B;!(function(i){function a(e,t,i){return new o(e,t,i)}function r(e){return new s(e)}function p(e,t){return new h(e,t)}function B(e,t){return new g(e,t)}function W(e,t){return new f(e,t)}function q(e){return new C(e)}function K(e,t,i){return new m(e,t,i)}function Q(e,t,i){return new l(e,t,i)}function Y(e,t,i){return new u(e,t,i)}function J(e,t){return new c(e,t)}function X(e){return new d(e)}function $(e,t,i){return new v(e,t,i)}function te(e,t){return new w(e,t)}function ne(e,t,i){return new y(e,t,i)}function oe(e,t){return new b(e,t)}function se(e){return new k(e)}function le(e,t){return new z(e,t)}function ue(e){return new U(e)}function ce(e,t){return e?t?new S(e,t):e:t}function de(e,t,i){return new x(e,t,i)}function pe(e,t){return new P(e,t,null)}function he(e,t){return new P(e,null,t)}function ge(e,t){if(!e)return t;if(!t)return e;if(e instanceof P&&t instanceof P){var i=fe(e,t);if(i)return i}return new D(e,t)}function fe(e,t){if(e.args&&t.args&&e.values&&t.values){var a=e.args.length,r=t.args.length;if(a===r){for(var o=0;o<a;++o)if(!n.equals(e.args[o],t.args[o]))return;var s=e.values.concat(t.values);return i.inValues(e.args,s)}}}function me(e,t,i){return new T(e,t,i)}function ye(e,t){return new V(e,t)}function ve(e){return new M(e)}function we(e,t){return me(0,e,t)}function be(e){return new N(e)}function Ce(e,t){return new L(e,t)}function Se(){return new I(e.ValueType.fromExtendedType(0),null,t.PrimitiveValueEncoding.nullEncoding())}function xe(){return new R}function Pe(){return new E}function De(e){return new F(e)}function Te(i){return new I(e.ValueType.fromExtendedType(5),i,t.PrimitiveValueEncoding.boolean(i))}function Ve(e,t,i){return new O(e,t,i)}function _e(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.dateTime(i)),new I(e.ValueType.fromExtendedType(519),i,a)}function Le(e,t){return new A(e,t)}function Me(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.decimal(i)),new I(e.ValueType.fromExtendedType(258),i,a)}function Ne(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.double(i)),new I(e.ValueType.fromExtendedType(259),i,a)}function Ie(i,a){return void 0===a&&(a=t.PrimitiveValueEncoding.integer(i)),new I(e.ValueType.fromExtendedType(260),i,a)}function Ae(i,a){return new I(e.ValueType.fromExtendedType(1),i,a||t.PrimitiveValueEncoding.text(i))}function Oe(t,i){return null==t?Se():_.isBoolean(t)?Te(t):_.isString(t)?Ae(t):_.isNumber(t)?i.integer&&e.Double.isInteger(t)?Ie(t):Ne(t):t instanceof Date?_e(t):void 0}function Re(e,t){return Z.rewrite(e,t)}function Ee(e){return ee.rewrite(e)}function Fe(e){return re.rewrite(e)}function je(e){return ae.rewrite(e)}function He(e){return ie.rewrite(e)}function Ge(e,t){return new j(e,t)}function ke(e,t){return new H(e,t)}function ze(e,t,i){return new G(e,t,i)}i.entity=a,i.subqueryRef=r,i.columnRef=p,i.measureRef=B,i.aggregate=W,i.selectRef=q,i.percentile=K,i.arithmetic=Q,i.floor=Y,i.scopedEval=J,i.withRef=X,i.groupRef=$,i.hierarchy=te,i.propertyVariationSource=ne,i.hierarchyLevel=oe,i.transformTableRef=se,i.transformOutputRoleRef=le,i.roleRef=ue,i.and=ce,i.between=de,i.inValues=pe,i.inTable=he,i.or=ge,i.compare=me,i.contains=ye,i.exists=ve,i.equal=we,i.not=be,i.startsWith=Ce,i.nullConstant=Se,i.now=xe,i.defaultValue=Pe,i.anyValue=De,i.boolean=Te,i.dateAdd=Ve,i.dateTime=_e,i.dateSpan=Le,i.decimal=Me,i.double=Ne,i.integer=Ie,i.text=Ae,i.typedConstant=Oe,i.setAggregate=Re,i.removeAggregate=Ee,i.setPercentOfGrandTotal=Fe,i.removePercentOfGrandTotal=je,i.removeEntityVariables=He,i.fillRule=Ge,i.themeColor=ke,i.resourcePackageItem=ze})(B=t.SQExprBuilder||(t.SQExprBuilder={}));var W;!(function(e){function t(e){return Y.getAggregate(e)}e.getAggregate=t})(W=t.SQExprInfo||(t.SQExprInfo={}));var q=(function(){function e(e,t){this.ignoreCase=e,this.ignoreVariables=t}return e.run=function(t,i,a,r){return t=t||null,i=i||null,t===i||!t==!i&&(r?a?t.accept(e.ignoreVariablesAndCaseInstance,i):t.accept(e.ignoreVariablesInstance,i):a?t.accept(e.ignoreCaseInstance,i):t.accept(e.instance,i))},e.prototype.visitColumnRef=function(e,t){if(n.isColumn(t)||n.isGroupRef(t))return e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitMeasureRef=function(e,t){return t instanceof g&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitAggr=function(e,t){return t instanceof f&&e.func===t.func&&this.equals(e.arg,t.arg)},e.prototype.visitPercentile=function(e,t){return t instanceof m&&e.exclusive===t.exclusive&&e.k===t.k&&this.equals(e.arg,t.arg)},e.prototype.visitGroupRef=function(e,t){var i=!1;return(n.isGroupRef(t)||n.isColumn(t))&&(i=e.ref===t.ref&&this.equals(e.source,t.source)),n.isGroupRef(t)&&(i=i&&this.equalsAll(e.groupedExprs,t.groupedExprs)),i},e.prototype.visitHierarchy=function(e,t){return t instanceof w&&e.hierarchy===t.hierarchy&&this.equals(e.arg,t.arg)},e.prototype.visitHierarchyLevel=function(e,t){return t instanceof b&&e.level===t.level&&this.equals(e.arg,t.arg)},e.prototype.visitPropertyVariationSource=function(e,t){return t instanceof y&&e.name===t.name&&e.property===t.property&&this.equals(e.arg,t.arg)},e.prototype.visitSelectRef=function(e,t){return t instanceof C&&e.expressionName===t.expressionName},e.prototype.visitBetween=function(e,t){return t instanceof x&&this.equals(e.arg,t.arg)&&this.equals(e.lower,t.lower)&&this.equals(e.upper,t.upper)},e.prototype.visitIn=function(e,t){if(!(t instanceof P&&this.equalsAll(e.args,t.args)))return!1;var i=t,a=e.values;if(a){var r=i.values;if(!r)return!1;if(a.length!==r.length)return!1;for(var n=0,o=a.length;n<o;n++)if(!this.equalsAll(a[n],r[n]))return!1}else{if(!i.table)return!1;if(!this.equals(e.table,i.table))return!1}return!0},e.prototype.visitEntity=function(e,t){return t instanceof o&&e.schema===t.schema&&e.entity===t.entity&&(this.ignoreVariables||this.optionalEqual(e.variable,t.variable))},e.prototype.visitSubqueryRef=function(e,t){return t instanceof s&&e.variable===t.variable},e.prototype.visitAnd=function(e,t){return t instanceof S&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitOr=function(e,t){return t instanceof D&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitCompare=function(e,t){return t instanceof T&&e.comparison===t.comparison&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitContains=function(e,t){return t instanceof V&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitDateSpan=function(e,t){return t instanceof A&&e.unit===t.unit&&this.equals(e.arg,t.arg)},e.prototype.visitDateAdd=function(e,t){return t instanceof O&&e.unit===t.unit&&e.amount===t.amount&&this.equals(e.arg,t.arg)},e.prototype.visitExists=function(e,t){return t instanceof M&&this.equals(e.arg,t.arg)},e.prototype.visitNot=function(e,t){return t instanceof N&&this.equals(e.arg,t.arg)},e.prototype.visitNow=function(e,t){return t instanceof R},e.prototype.visitDefaultValue=function(e,t){return t instanceof E},e.prototype.visitAnyValue=function(e,t){return t instanceof F},e.prototype.visitResourcePackageItem=function(e,t){return t instanceof G&&e.packageName===t.packageName&&e.packageType===t.packageType&&e.itemName===t.itemName},e.prototype.visitStartsWith=function(e,t){return t instanceof L&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitConstant=function(e,t){return t instanceof I&&e.type===t.type&&(e.type.text&&this.ignoreCase?i.equalIgnoreCase(e.valueEncoded,t.valueEncoded):e.valueEncoded===t.valueEncoded)},e.prototype.visitFillRule=function(e,t){if(t instanceof j&&this.equals(e.input,t.input)){var i=e.rule,a=t.rule;if(i===a)return!0;var r=i.linearGradient2,n=a.linearGradient2;if(r&&n)return this.visitLinearGradient2(r,n);var o=i.linearGradient3,s=a.linearGradient3;if(o&&s)return this.visitLinearGradient3(o,s)}return!1},e.prototype.visitLinearGradient2=function(e,t){var i=this;return this.equalsFillRuleStop(e.min,t.min)&&this.equalsFillRuleStop(e.max,t.max)&&this.equalsNullableObject(e.nullColoringStrategy,t.nullColoringStrategy,(function(e,t){return i.equalsNullStrategy(e,t)}))},e.prototype.visitLinearGradient3=function(e,t){var i=this;return this.equalsFillRuleStop(e.min,t.min)&&this.equalsFillRuleStop(e.mid,t.mid)&&this.equalsFillRuleStop(e.max,t.max)&&this.equalsNullableObject(e.nullColoringStrategy,t.nullColoringStrategy,(function(e,t){return i.equalsNullStrategy(e,t)}))},e.prototype.visitThemeColor=function(e,t){return t instanceof H&&e.color===t.color&&e.percent===t.percent},e.prototype.equalsFillRuleStop=function(e,t){return this.equals(e.color,t.color)&&this.equalsNullable(e.value,t.value)},e.prototype.equalsNullStrategy=function(e,t){return this.equals(e.strategy,t.strategy)&&this.equalsNullable(e.color,t.color)},e.prototype.visitArithmetic=function(e,t){return t instanceof l&&e.operator===t.operator&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitFloor=function(e,t){return n.isFloor(t)&&e.timeUnit===t.timeUnit&&e.size===t.size&&this.equals(e.arg,t.arg)},e.prototype.visitScopedEval=function(e,t){return t instanceof c&&this.equals(e.expression,t.expression)&&this.equalsAll(e.scope,t.scope)},e.prototype.visitWithRef=function(e,t){return t instanceof d&&e.expressionName===t.expressionName},e.prototype.visitTransformTableRef=function(e,t){return t instanceof k&&e.source===t.source},e.prototype.visitTransformOutputRoleRef=function(e,t){return t instanceof z&&e.role===t.role&&e.transform===t.transform},e.prototype.visitRoleRef=function(e,t){return t instanceof U&&e.role===t.role},e.prototype.optionalEqual=function(e,t){return!e||!t||e===t},e.prototype.equals=function(e,t){return e.accept(this,t)},e.prototype.equalsNullable=function(e,t){var i=this;return this.equalsNullableObject(e,t,(function(e,t){return i.equals(e,t)}))},e.prototype.equalsNullableObject=function(e,t,i){return null==e&&null==t||null!=e&&null!=t&&i(e,t)},e.prototype.equalsAll=function(e,t){var i=e.length;if(i!==t.length)return!1;for(var a=0;a<i;a++)if(!this.equals(e[a],t[a]))return!1;return!0},e.instance=new e((!1),(!1)),e.ignoreCaseInstance=new e((!0),(!1)),e.ignoreVariablesInstance=new e((!1),(!0)),e.ignoreVariablesAndCaseInstance=new e((!0),(!0)),e})(),K=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitDefault=function(e){return e},t})(t.DefaultSQExprVisitor),Q=(function(e){function i(t,i,a){e.call(this),this.schema=t,this.aggrUtils=i,a&&(this.errors=a)}return r(i,e),i.prototype.visitIn=function(t){var i=e.prototype.visitIn.call(this,t),a=i.args,r=i.values;if(r)for(var n=0,o=r;n<o.length;n++)for(var s=o[n],l=0,u=s.length;l<u;++l)this.validateCompatibleType(a[l],s[l]);else{var c=i.table;this.validateIsTableRef(c)}return i},i.prototype.visitCompare=function(t){var i=e.prototype.visitCompare.call(this,t);return this.validateCompatibleType(i.left,i.right),i},i.prototype.visitColumnRef=function(e){var i=t.SQExprConverter.asFieldPattern(e);if(i){var a=t.FieldExprPattern.toFieldExprEntityItemPattern(i),r=this.validateEntity(a.schema,a.entity);if(r){var n=r.properties.withName(i.column.name);n&&0===n.kind&&this.isQueryable(i)||this.register(3)}}return e},i.prototype.visitMeasureRef=function(e){var i=t.SQExprConverter.asFieldPattern(e);if(i){var a=t.FieldExprPattern.toFieldExprEntityItemPattern(i),r=this.validateEntity(a.schema,a.entity);if(r){var n=r.properties.withName(i.measure.name);n&&1===n.kind&&this.isQueryable(i)||this.register(5)}}return e},i.prototype.visitAggr=function(t){var i=e.prototype.visitAggr.call(this,t),a=J.getColumnRefSQExpr(this.schema,i.arg);return a&&(this.aggrUtils.isSupportedAggregate(t,this.schema,t.func,null,!0)||this.register(0)),i},i.prototype.visitGroupRef=function(e){var i=t.SQExprConverter.asFieldPattern(e);if(i){var a=t.FieldExprPattern.toFieldExprEntityItemPattern(i),r=this.validateEntity(a.schema,a.entity);if(r){var n=r.properties.withName(i.groupingColumn.name);n&&0===n.kind&&this.validateExprSequence(e.groupedExprs)&&n.column.groupingMetadata&&this.isQueryable(i)||this.register(4)}}return e},i.prototype.visitHierarchy=function(e){var i=t.SQExprConverter.asFieldPattern(e);if(i){var a=i.hierarchy;a?this.validateHierarchy(a.schema,a.entity,a.name):this.register(6)}return e},i.prototype.visitHierarchyLevel=function(e){var i=t.SQExprConverter.asFieldPattern(e);if(i){var a=i.hierarchyLevel;a?this.validateHierarchyLevel(a.schema,a.entity,a.name,a.level):i.columnHierarchyLevelVariation||this.register(7)}return e},i.prototype.visitPercentile=function(e){if(e.arg.accept(this),_.isEmpty(this.errors)){var t=e.arg.getMetadata(this.schema);t&&0===t.kind&&t.type&&(t.type.integer||t.type.numeric)||this.register(11)}return e},i.prototype.visitEntity=function(e){return this.validateEntity(e.schema,e.entity),e},i.prototype.visitSubqueryRef=function(e){return e},i.prototype.visitContains=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},i.prototype.visitStartsWith=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},i.prototype.visitArithmetic=function(e){return this.validateArithmeticTypes(e.operator,e.left,e.right),e},i.prototype.visitScopedEval=function(e){for(var t=0,i=e.scope;t<i.length;t++){var a=i[t];n.isWithRef(a)||n.isColumn(a)||this.register(12)}return e},i.prototype.visitWithRef=function(e){return e},i.prototype.visitTransformTableRef=function(e){return e},i.prototype.visitTransformOutputRoleRef=function(e){return e},i.prototype.visitRoleRef=function(e){return e},i.prototype.validateExprSequence=function(e){var t=this;return _.reduce(e,(function(e,i){return e=e&&_.isEmpty(i.validate(t.schema,t.aggrUtils,t.errors))}),!0)},i.prototype.validateOperandsAndTypeForStartOrContains=function(e,t){n.isColumn(e)?this.visitColumnRef(e):n.isGroupRef(e)?this.visitGroupRef(e):e instanceof b?this.visitHierarchyLevel(e):this.register(8),t instanceof I&&t.type.text?this.validateCompatibleType(e,t):this.register(9)},i.prototype.validateArithmeticTypes=function(e,i,a){t.SQExprUtils.supportsArithmetic(e,i,this.schema)||this.register(8),t.SQExprUtils.supportsArithmetic(e,a,this.schema)||this.register(9)},i.prototype.validateCompatibleType=function(e,t){var i=e.getMetadata(this.schema),a=i&&i.type,r=t.getMetadata(this.schema),n=r&&r.type;a&&n&&!a.isCompatibleFrom(n)&&this.register(10)},i.prototype.validateEntity=function(e,t){var i=this.schema.schema(e);if(i){var a=i.entities.withName(t);if(a)return a;this.register(2)}else this.register(1)},i.prototype.validateIsTableRef=function(e){1!==e.kind&&0!==e.kind&&this.register(13)},i.prototype.validateHierarchy=function(e,t,i){var a=this.validateEntity(e,t);if(a){var r=a.hierarchies.withName(i);if(r)return r;this.register(6)}},i.prototype.validateHierarchyLevel=function(e,t,i,a){var r=this.validateHierarchy(e,t,i);if(r){var n=r.levels.withName(a);if(n)return n;this.register(7)}},i.prototype.register=function(e){this.errors||(this.errors=[]),this.errors.push(e)},i.prototype.isQueryable=function(e){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(e);if(e.hierarchyLevel||e.hierarchyLevelAggr){var a=t.SQHierarchyExprUtils.getConceptualHierarchyLevelFromExpr(this.schema,e);return a&&1!==a.column.queryable}return 1!==this.schema.schema(i.schema).findProperty(i.entity,t.FieldExprPattern.getPropertyName(e)).queryable},i})(t.SQExprRewriter);t.SQExprValidationVisitor=Q;var Y=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitAggr=function(e){return e.func},t.prototype.visitDefault=function(e){},t.getAggregate=function(e){var i=new t;return e.accept(i)},t})(t.DefaultSQExprVisitor),J=(function(e){function i(t){e.call(this),this.schema=t}return r(i,e),i.prototype.visitColumnRef=function(e){return e},i.prototype.visitGroupRef=function(e){return e},i.prototype.visitHierarchyLevel=function(e){var i=e.level,a=e.arg,r=a.accept(this);if(a&&a.arg instanceof y){var n=a.arg,o=r.getTargetEntityForVariation(this.schema,n.name);if(r&&o){var s=r.source.schema,l=B.entity(s,o),u=this.schema.schema(s).findHierarchy(o,a.hierarchy);if(u)for(var c=0,d=u.levels;c<d.length;c++){var p=d[c];if(p.name===i)return new h(l,p.column.name)}}}else{var g=a.arg,f=t.SQHierarchyExprUtils.getConceptualHierarchyLevel(this.schema,g.schema,g.entity,a.hierarchy,e.level);if(f)return new h(a.arg,f.column.name)}},i.prototype.visitHierarchy=function(e){return e.arg.accept(this)},i.prototype.visitPropertyVariationSource=function(e){var t=e.property;return new h(e.arg,t)},i.prototype.visitAggr=function(e){return e.arg.accept(this)},i.prototype.visitDefault=function(e){},i.getColumnRefSQExpr=function(e,t){var a=new i(e);return t.accept(a)},i})(t.DefaultSQExprVisitor),X=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitEntity=function(e){var t=this.result;void 0===t||n.equals(t,e)?this.result=e:this.result=null},t.getEntityExpr=function(e){var i=new t;return e.accept(i),i.result||void 0},t})(t.DefaultSQExprVisitorWithTraversal),$=(function(e){function t(t){e.call(this),this.func=t}return r(t,e),t.prototype.visitAggr=function(e){return e.func===this.func?e:new f(e.arg,this.func)},t.prototype.visitColumnRef=function(e){return new f(e,this.func)},t.prototype.visitGroupRef=function(e){return new f(e,this.func)},t.prototype.visitHierarchyLevel=function(e){return new f(e,this.func)},t.rewrite=function(e,i){var a=new t(i);return e.accept(a)},t})(K),Z=(function(){function e(e,t){this.sqExpr=e,this.aggregate=t}return e.rewrite=function(i,a){return t.FieldExprPattern.visit(i,new e(i,a))},e.prototype.visitPercentOfGrandTotal=function(e){return e.baseExpr=t.SQExprConverter.asFieldPattern($.rewrite(B.fieldExpr(e.baseExpr),this.aggregate)),B.fieldExpr({percentOfGrandTotal:e})},e.prototype.visitColumn=function(e){return this.defaultRewrite()},e.prototype.visitColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitGroupingColumn=function(e){return this.defaultRewrite()},e.prototype.visitGroupingColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitColumnHierarchyLevelVariation=function(e){return this.defaultRewrite()},e.prototype.visitSelectRef=function(e){return this.defaultRewrite()},e.prototype.visitEntity=function(e){return this.defaultRewrite()},e.prototype.visitEntityAggr=function(e){return this.defaultRewrite()},e.prototype.visitHierarchy=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevel=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevelAggr=function(e){return this.defaultRewrite()},e.prototype.visitMeasure=function(e){return this.defaultRewrite()},e.prototype.visitPercentile=function(e){return this.defaultRewrite()},e.prototype.visitTransformOutputRoleRef=function(e){return this.defaultRewrite()},e.prototype.defaultRewrite=function(){return $.rewrite(this.sqExpr,this.aggregate)},e})(),ee=(function(){function e(e){this.sqExpr=e}return e.rewrite=function(i){return t.FieldExprPattern.visit(i,new e(i))},e.prototype.visitPercentOfGrandTotal=function(t){return e.rewrite(B.fieldExpr(t.baseExpr))},e.prototype.visitColumn=function(e){return this.defaultRewrite()},e.prototype.visitColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitGroupingColumn=function(e){return this.defaultRewrite()},e.prototype.visitGroupingColumnAggr=function(e){return this.defaultRewrite()},e.prototype.visitColumnHierarchyLevelVariation=function(e){return this.defaultRewrite()},e.prototype.visitSelectRef=function(e){return this.defaultRewrite()},e.prototype.visitEntity=function(e){return this.defaultRewrite()},e.prototype.visitEntityAggr=function(e){return this.defaultRewrite()},e.prototype.visitHierarchy=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevel=function(e){return this.defaultRewrite()},e.prototype.visitHierarchyLevelAggr=function(e){return this.defaultRewrite()},e.prototype.visitMeasure=function(e){return this.defaultRewrite()},e.prototype.visitPercentile=function(e){return this.defaultRewrite()},e.prototype.visitTransformOutputRoleRef=function(e){return this.defaultRewrite()},e.prototype.defaultRewrite=function(){return te.rewrite(this.sqExpr);
},e})(),te=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitAggr=function(e){return e.arg},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t})(K),ie=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitEntity=function(e){return e.variable?B.entity(e.schema,e.entity):e},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t})(t.SQExprRewriter),ae=(function(e){function i(){e.apply(this,arguments)}return r(i,e),i.rewrite=function(e){return e.accept(i.instance)},i.prototype.visitDefault=function(e){var i=t.SQExprConverter.asFieldPattern(e);return i&&i.percentOfGrandTotal&&(e=B.fieldExpr(i.percentOfGrandTotal.baseExpr)),e},i.instance=new i,i})(K),re=(function(e){function i(){e.apply(this,arguments)}return r(i,e),i.rewrite=function(e){return e.accept(i.instance)},i.prototype.visitDefault=function(e){var i=t.SQExprConverter.asFieldPattern(e);return i&&!i.percentOfGrandTotal&&(e=B.fieldExpr({percentOfGrandTotal:{baseExpr:t.SQExprConverter.asFieldPattern(e)}})),e},i.instance=new i,i})(K),ne=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitHierarchyLevel=function(e){return e.arg.accept(this)},t.prototype.visitHierarchy=function(e){return e.arg.accept(this)},t.prototype.visitPropertyVariationSource=function(e){return e.property},t.getProperty=function(e){var i=new t;return e.accept(i)},t})(t.DefaultSQExprVisitor);t.HierarchyVisitor=ne})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(){return new l}function a(e,i,a,r){var n=e.identities;return n?n[i]:t.createDataViewScopeIdentity(s.equal(e.fields[0],s.typedConstant(a,r)))}function r(e,t){_.contains(e,t)||e.push(t)}function n(e,t,i){var a=t.values;e.values=a;var r=t.highlights;r&&(e.highlights=r);var n;void 0!==t.minLocal&&(n||(n={}),n.minLocal=t.minLocal),void 0!==t.maxLocal&&(n||(n={}),n.maxLocal=t.maxLocal),n&&(e.source.aggregates=n,_.extend(e,n))}var o=e.data.DataViewTransform,s=e.data.SQExprBuilder;t.createCategoricalDataViewBuilder=i;var l=(function(){function e(){this.categories=[],this.staticMeasureColumns=[],this.dynamicMeasureColumns=[],this.columnIndex=0}return e.prototype.withCategory=function(e){var t=e.values,i=e.identityFrom,r=e.source.type,n={source:e.source,identityFields:e.identityFrom.fields,identity:e.identityFrom.identities||[],values:t};if(!e.identityFrom.identities)for(var o=0,s=t.length;o<s;o++)n.identity.push(a(i,o,t[o],r));return this.categories||(this.categories=[]),this.categories.push(n),this},e.prototype.withCategories=function(e){return _.isEmpty(this.categories)?this.categories=e:Array.prototype.push.apply(this.categories,e),this},e.prototype.withValues=function(e){for(var t=e.columns,i=0,a=t;i<a.length;i++){var r=a[i];this.staticMeasureColumns.push(r.source)}return this.staticSeriesValues=t,this},e.prototype.withGroupedValues=function(e){var t=e.groupColumn;this.dynamicSeriesMetadata={column:t.source,identityFrom:t.identityFrom,values:t.values};for(var i=e.valueColumns,a=0,r=i;a<r.length;a++){var n=r[a];this.dynamicMeasureColumns.push(n.source)}return this.dynamicSeriesValues=e.data,this},e.prototype.fillData=function(e){var t=_.first(this.categories),i=t&&t.values?t.values.length:0;if(this.hasDynamicSeries())for(var a=0,r=this.dynamicSeriesMetadata.values.length;a<r;a++)for(var o=this.dynamicSeriesValues[a],s=0,l=this.dynamicMeasureColumns.length;s<l;s++){var u=a*l+s;n(e[u],o[s],i)}if(this.hasStaticSeries())for(var c=this.hasDynamicSeries()?this.dynamicSeriesValues.length*this.dynamicMeasureColumns.length:0,s=0,l=this.staticMeasureColumns.length;s<l;s++)n(e[c+s],this.staticSeriesValues[s],i)},e.prototype.build=function(){for(var e=[],t={},i=this.categories,n=this.dynamicSeriesMetadata,s=0,l=i;s<l.length;s++){var u=l[s];r(e,u.source)}if(this.hasDynamicSeries()){r(e,n.column),t.values=o.createValueColumns([],n.identityFrom.fields,n.column);for(var c=n.values,d=0;d<c.length;d++)for(var p=c[d],h=a(n.identityFrom,d,p,n.column.type),g=0,f=this.dynamicMeasureColumns;g<f.length;g++){var m=f[g],y=_.toPlainObject(m);y.groupName=p,r(e,y),t.values.push({source:y,values:[],identity:h})}if(0===c.length)for(var v=0,w=this.dynamicMeasureColumns;v<w.length;v++){var m=w[v],y=_.toPlainObject(m);r(e,y),t.values.push({source:y,values:[]})}if(this.hasStaticSeries()){var b=t.values.grouped();t.values.grouped=function(){return b},this.appendStaticMeasureColumns(e,t.values)}}else t.values=o.createValueColumns(),this.appendStaticMeasureColumns(e,t.values);var C=this.categories;_.isEmpty(C)||(t.categories=C),this.fillData(t.values);var S={metadata:{columns:e},categorical:t};if(this.isLegalDataView(S))return S},e.prototype.appendStaticMeasureColumns=function(e,t){if(!_.isEmpty(this.staticMeasureColumns))for(var i=0,a=this.staticMeasureColumns;i<a.length;i++){var n=a[i];r(e,n),t.push({source:n,values:[]})}},e.prototype.isLegalDataView=function(t){return!(this.hasDynamicSeries()&&this.hasStaticSeries()&&e.isVisualDataView(t.metadata.columns))},e.isVisualDataView=function(e){return!_.isEmpty(e)&&_.any(e,(function(e){return!!e.queryName}))},e.prototype.hasDynamicSeries=function(){return!!this.dynamicSeriesMetadata},e.prototype.hasStaticSeries=function(){return!!this.staticSeriesValues},e})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function i(e){return JSON.stringify(e.accept(n.instance))}function r(e){for(var i="[",a=0,r=e.length;a<r;a++)a>0&&(i+=","),i+=t.serialize(e[a]);return i+"]"}t.serialize=i,t.serializeArray=r;var n=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.visitColumnRef=function(e){return{col:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitMeasureRef=function(e){return{measure:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitAggr=function(e){return{agg:{a:e.arg.accept(this),f:e.func}}},t.prototype.visitEntity=function(e){return{e:e.entity}},t.prototype.visitHierarchyLevel=function(e){return{h:e.arg.accept(this),l:e.level}},t.prototype.visitHierarchy=function(e){return{e:e.arg.accept(this),h:e.hierarchy}},t.prototype.visitPropertyVariationSource=function(e){return{e:e.arg.accept(this),n:e.name,p:e.property}},t.prototype.visitAnd=function(e){return{and:{l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitCompare=function(e){return{comp:{k:e.comparison,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitConstant=function(e){return{const:{t:e.type.primitiveType,v:e.value}}},t.prototype.visitArithmetic=function(e){return{arithmetic:{o:e.operator,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitScopedEval=function(e){return{scopedEval:{e:e.expression.accept(this),s:r(e.scope)}}},t.prototype.visitWithRef=function(e){return{withRef:{e:e.expressionName}}},t.prototype.visitTransformTableRef=function(e){return{transformTableRef:{source:e.source}}},t.prototype.visitTransformOutputRoleRef=function(e){var t={transformOutputRoleRef:{role:e.role}};return e.transform&&(t.transformOutputRoleRef.transform=e.transform),t},t.prototype.visitFloor=function(e){var t={floor:{a:e.arg.accept(this),s:e.size}};return null!=e.timeUnit&&(t.floor.timeunit=e.timeUnit),t},t.prototype.visitRoleRef=function(e){return{roleRef:{role:e.role}}},t.prototype.visitDefault=function(e){},t.instance=new t,t})(e.DefaultSQExprVisitor)})(t=e.SQExprShortSerializer||(e.SQExprShortSerializer={}))})(t=e.data||(e.data={}))})(i||(i={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;window.jsCommon=window.jsCommon||{},window.powerbi=window.powerbi||{},window.debug=window.debug||{},window.InJs=window.InJs||{},window.Microsoft=window.Microsoft||{},i(143),i(144),i(145),i(146),i(354),i(355)},function(e,t){},function(e,t){},function(e,t,i){e.exports=i.p+"images/locationButton.svg"},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;i(147),i(148),i(149),i(150),i(151),i(152),i(153),i(154),i(155),i(156),i(157),i(158),i(159),i(160),i(161),i(162),i(163),i(164),i(165),i(166),i(167),i(168),i(169),i(170),i(171),i(172),i(173),i(174),i(175),i(176),i(177),i(178),i(179),i(180),i(181),i(182),i(183),i(184),i(185),i(186),i(187),i(188),i(189),i(190),i(191),i(192),i(193),i(194),i(195),i(196),i(197),i(198),i(199),i(200),i(201),i(202),i(203),i(204),i(205),i(206),i(207),i(208),i(209),i(210),i(211),i(212),i(213),i(214),i(215),i(216),i(217),i(218),i(219),i(220),i(221),i(222),i(223),i(224),i(225),i(226),i(227),i(228),i(229),i(230),i(231),i(232),i(233),i(234),i(235),i(236),i(237),i(238),i(239),i(240),i(241),i(242),i(243),i(244),i(245),i(246),i(247),i(248),i(249),i(250),i(251),i(252),i(253),i(254),i(255),i(256),i(257),i(258),i(259),i(260),i(261),i(262),i(263),i(264),i(265),i(266),i(267),i(268),i(269),i(270),i(271),i(272),i(273),i(274),i(275),i(276),i(277),i(278),i(279),i(280),i(281),i(282),i(283),i(284),i(285),i(286),i(287),i(288),i(289),i(290),i(291),i(292),i(293),i(294),i(295),i(296),i(297),i(298),i(299),i(300),i(301),i(302),i(303),i(304),i(305),i(306),i(307),i(308),i(309),i(310),i(311),i(312),i(313),i(314),i(315),i(316),i(317),i(318),i(319),i(320),i(321),i(322),i(323),i(324),i(325),i(326),i(327),i(328),i(329),i(330),i(331),i(332),i(333),i(334),i(335),i(336),i(337),i(338),i(339),i(340),i(341),i(342),i(343),i(344),i(345),i(346);i(347);i(348),i(349),i(350),i(351),i(352),i(353)},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.x=e||0,this.y=t||0}return e})();e.Point=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e,t,i,a){this.left=e||0,this.top=t||0,this.width=i||0,this.height=a||0}return e})();e.Rect=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(r,n){if(void 0===n&&(n=!0),_.isEmpty(r))return r;if(r.indexOf(",")===-1)return r.indexOf(" ")===-1?r:n?a(r):i(r);var o=r.split(",");return o.map((function(e){return t(e.trim(),n)})).join(e.FamilyDelimiter)}function i(e){if(e)return e.replace(/['"]+/g,"")}function a(t){if(t)return e.FamilyQuote+t.replace(/['"]+/g,"")+e.FamilyQuote}e.FamilyQuote='"',e.FamilyDelimiter=", ";var r=(function(){function t(e){this.families=e}return Object.defineProperty(t.prototype,"family",{get:function(){return this.getFamily()},enumerable:!0,configurable:!0}),t.prototype.getFamily=function(){return this.families.join(e.FamilyDelimiter)},Object.defineProperty(t.prototype,"css",{get:function(){return this.getCSS()},enumerable:!0,configurable:!0}),t.prototype.getCSS=function(){return this.families?this.families.map((function(e){return e.indexOf(" ")>0?"'"+e+"'":e})).join(", "):null},t})();e.FamilyInfo=r,e.Family={light:new r(["Segoe UI Light","wf_segoe-ui_light","helvetica","arial","sans-serif"]),semilight:new r(["Segoe UI Semilight","wf_segoe-ui_semilight","helvetica","arial","sans-serif"]),regular:new r(["Segoe UI","wf_segoe-ui_normal","helvetica","arial","sans-serif"]),semibold:new r(["Segoe UI Semibold","wf_segoe-ui_semibold","helvetica","arial","sans-serif"]),bold:new r(["Segoe UI Bold","wf_segoe-ui_bold","helvetica","arial","sans-serif"]),lightSecondary:new r(["wf_standard-font_light","helvetica","arial","sans-serif"]),regularSecondary:new r(["wf_standard-font","helvetica","arial","sans-serif"]),boldSecondary:new r(["wf_standard-font_bold","helvetica","arial","sans-serif"])},e.normalizeFamily=t,e.unQuoteFamily=i,e.quoteFontFamily=a})(t=e.Font||(e.Font={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,t,i,a,r,n){return void 0===a&&(a=!1),void 0===r&&(r=s.Top),t?new d(e):new u(e,r,i,a,n)}var r=a.CssConstants.createClassAndSelector,n=a.PixelConverter;!(function(e){e[e.Box=0]="Box",e[e.Circle=1]="Circle",e[e.Line=2]="Line"})(t.LegendIcon||(t.LegendIcon={}));var o=t.LegendIcon;!(function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Right=2]="Right",e[e.Left=3]="Left",e[e.None=4]="None",e[e.TopCenter=5]="TopCenter",e[e.BottomCenter=6]="BottomCenter",e[e.RightCenter=7]="RightCenter",e[e.LeftCenter=8]="LeftCenter"})(t.LegendPosition||(t.LegendPosition={}));var s=t.LegendPosition;t.legendProps={show:"show",position:"position",titleText:"titleText",showTitle:"showTitle",labelColor:"labelColor",fontSize:"fontSize"},t.createLegend=i;var l;!(function(i){function a(e){switch(e){case s.Left:case s.LeftCenter:return!0;default:return!1}}function r(e){switch(e){case s.Top:case s.TopCenter:return!0;default:return!1}}function n(e){switch(e){case s.Bottom:case s.BottomCenter:return!0;default:return!1}}function l(e){switch(e){case s.Right:case s.RightCenter:return!0;default:return!1}}function u(e){switch(e){case s.BottomCenter:case s.LeftCenter:case s.RightCenter:case s.TopCenter:return!0;default:return!1}}function c(e){return i.isTop(e)||i.isBottom(e)}function d(e){return i.isLeft(e)||i.isRight(e)}function p(e,t){var a=t.getMargins(),r=t.getOrientation();e.style({"margin-left":i.isLeft(r)?a.width+"px":null,"margin-top":i.isTop(r)?a.height+"px":null})}function h(i,a,r){var n,s=e.data.createIDataViewCategoricalReader(i),l=[];n=s.getSeriesDisplayName();for(var u=s.getSeriesColumnIdentityFields(),c=0,d=s.getSeriesCount();c<d;c++){var p=s.getSeriesName(c),h=t.converterHelper.formatFromMetadataColumn(p,s.getSeriesMetadataColumn(),r),g=a.getColorForSeriesValue(s.getSeriesObjects(c),u,p),f=(new t.SelectionIdBuilder).withSeries(s.getSeriesValueColumns(),s.getSeriesValueColumnGroup(c)).createSelectionId();l.push({color:g,label:h,icon:o.Circle,identity:f,selected:!1})}var m={dataPoints:l,title:n,grouped:s.hasDynamicSeries()};return m}function g(i,a,r,n){var s,l=e.data.createIDataViewCategoricalReader(i),u=[];if(l.hasCategories()){s=l.getCategoryDisplayName(n);for(var c=l.getCategoryColumnIdentityFields(n),d=0,p=l.getCategoryCount();d<p;d++){var h=l.getCategoryValue(n,d),g=t.converterHelper.formatFromMetadataColumn(h,l.getCategoryMetadataColumn(n),r),f=a.getColorForSeriesValue(l.getCategoryObjects(n,d),c,h),m=(new t.SelectionIdBuilder).withCategory(l.getCategoryColumn(n),d).createSelectionId();u.push({color:f,label:g,icon:o.Circle,identity:m,selected:!1})}}var y={dataPoints:u,title:s};return y}function f(e,i,a){var r=e.matrix,n=[];if(_.isEmpty(r.rows.levels))return{dataPoints:[]};var s=r.rows.levels[0].sources[0],l=r.rows.root.childIdentityFields,u=r.rows.root.children;if(!u)return{dataPoints:[]};for(var c=s.displayName,d=0,p=u.length;d<p;d++){var h=u[d],g=h.value,f=t.converterHelper.formatFromMetadataColumn(g,s,a),m=i.getColorForSeriesValue(h.objects,l,g),y=new t.SelectionIdBuilder,v=y.withColumnIdentity(h.identity,s.queryName).createSelectionId();n.push({color:m,label:f,icon:o.Circle,identity:v,selected:!1})}var w={dataPoints:n,title:c};return w}i.isLeft=a,i.isTop=r,i.isBottom=n,i.isRight=l,i.isCentered=u,i.isTopOrBottom=c,i.isLeftOrRight=d,i.positionChartArea=p,i.buildSeriesLegendData=h,i.buildCategoryLegendData=g,i.buildFromFirstMatrixRowLevel=f})(l=t.Legend||(t.Legend={}));var u=(function(){function i(e,i,a,r,n){this.legendDataStartIndex=0,this.arrowPosWindow=1,this.lastCalculatedWidth=0,this.visibleLegendWidth=0,this.visibleLegendHeight=0,this.legendFontSizeMarginDifference=0,this.legendFontSizeMarginValue=0,this.svg=d3.select(e.get(0)).append("svg").style("position","absolute"),this.svg.style("display","inherit"),this.svg.classed("legend",!0),a&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.group=this.svg.append("g").attr("id","legendGroup"),this.interactivityService=a,this.isScrollable=r,this.element=e,this.changeOrientation(i),this.parentViewport={height:0,width:0},this.calculateViewport(),this.updateLayout(),this.legendSmallViewPortProperties=n}return i.prototype.updateLayout=function(){var e=this.viewport,t=this.orientation;this.svg.attr({height:e.height||(t===s.None?0:this.parentViewport.height),width:e.width||(t===s.None?0:this.parentViewport.width)});var i=t===s.Right||t===s.RightCenter,a=t===s.Bottom||t===s.BottomCenter;this.svg.style({"margin-left":i?this.parentViewport.width-e.width+"px":null,"margin-top":a?this.parentViewport.height-e.height+"px":null})},i.prototype.calculateViewport=function(){switch(this.orientation){case s.Top:case s.Bottom:case s.TopCenter:case s.BottomCenter:var e=n.fromPointToPixel(this.data&&this.data.fontSize?this.data.fontSize:i.DefaultFontSizeInPt),t=i.TopLegendHeight+(e-i.DefaultFontSizeInPt);return void(this.viewport={height:t,width:0});case s.Right:case s.Left:case s.RightCenter:case s.LeftCenter:var a=this.lastCalculatedWidth?this.lastCalculatedWidth:this.parentViewport.width*i.LegendMaxWidthFactor;return void(this.viewport={height:0,width:a});case s.None:this.viewport={height:0,width:0}}},i.prototype.getMargins=function(){return this.viewport},i.prototype.isVisible=function(){return this.orientation!==s.None},i.prototype.changeOrientation=function(e){e?this.orientation=e:this.orientation=s.Top,this.svg.attr("orientation",e)},i.prototype.getOrientation=function(){return this.orientation},i.prototype.drawLegend=function(t,i){for(var a=e.Prototype.inherit(t),r=[],n=0,o=t.dataPoints;n<o.length;n++){var s=o[n];r.push(e.Prototype.inherit(s))}a.dataPoints=r,this.setTooltipToLegendItems(a),this.drawLegendInternal(a,i,!0)},i.prototype.drawLegendInternal=function(a,r,n){this.parentViewport=r,this.data=a,this.interactivityService&&this.interactivityService.applySelectionStateToData(a.dataPoints),0===a.dataPoints.length&&this.changeOrientation(s.None),this.getOrientation()===s.None&&(a.dataPoints=[]),this.calculateViewport();var o=this.calculateLayout(a,n),u=o.title,c=u?[u]:[],d=this.interactivityService&&e.visuals.dataHasSelection(a.dataPoints),p=this.group,h=!1;if(this.legendSmallViewPortProperties&&(h=this.parentViewport.height<=this.legendSmallViewPortProperties.minHeightForTransform),l.isCentered(this.orientation)&&!h){var g=0;l.isTopOrBottom(this.orientation)?(g=Math.max(0,(this.parentViewport.width-this.visibleLegendWidth)/2),p.attr("transform",t.SVGUtil.translate(g,0))):(g=Math.max((this.parentViewport.height-this.visibleLegendHeight)/2),p.attr("transform",t.SVGUtil.translate(0,g)))}else p.attr("transform",null);var f=p.selectAll(i.LegendTitle.selector).data(c);f.enter().append("text").classed(i.LegendTitle.class,!0),f.style({fill:a.labelColor,"font-size":this.getFontSize(a.fontSize),"font-family":i.DefaultTitleFontFamily}).text((function(e){return e.text})).attr({x:function(e){return e.x},y:function(e){return e.y}}).append("title").text(a.title),f.exit().remove();var m=a.dataPoints.slice(this.legendDataStartIndex,this.legendDataStartIndex+o.numberOfItems),y=e.TextMeasurementService.estimateSvgTextHeight(i.getTextProperties(!1,"",this.data.fontSize))/i.LegendIconRadiusFactor;y=this.legendFontSizeMarginValue>i.DefaultTextMargin&&y>i.LegendIconRadius?y:i.LegendIconRadius;var v=p.selectAll(i.LegendItem.selector).data(m,(function(e){return e.identity.getKey()+(null!=e.layerNumber?e.layerNumber:"")})),w=v.enter().append("g").classed(i.LegendItem.class,!0);if(w.append("circle").classed(i.LegendIcon.class,!0),w.append("text").classed(i.LegendText.class,!0),w.append("title").text((function(e){return e.tooltip})),v.select(i.LegendIcon.selector).attr({cx:function(e,t){return e.glyphPosition.x},cy:function(e){return e.glyphPosition.y},r:y}).style({fill:function(e){return d&&!e.selected?t.LegendBehavior.dimmedLegendColor:e.color}}),v.select("title").text((function(e){return e.tooltip})),v.select(i.LegendText.selector).attr({x:function(e){return e.textPosition.x},y:function(e){return e.textPosition.y}}).text((function(e){return e.label})).style({fill:a.labelColor,"font-size":this.getFontSize(a.fontSize)}),this.interactivityService){var b=v.select(i.LegendIcon.selector),C={legendItems:v,legendIcons:b,clearCatcher:this.clearCatcher};this.interactivityService.bind(a.dataPoints,new t.LegendBehavior,C,{isLegend:!0})}v.exit().remove(),this.drawNavigationArrows(o.navigationArrows),this.updateLayout()},i.prototype.getFontSize=function(e){if(this.legendSmallViewPortProperties){if(this.parentViewport.width<=this.legendSmallViewPortProperties.maxWidthForSmallFont){var t=Math.min(e,i.LegendSmallFontSmallViewportInPt);return n.fromPoint(t)}if(this.parentViewport.width<=this.legendSmallViewPortProperties.maxWidthForMediumFont){var t=Math.min(e,i.LegendMediumFontSmallViewportInPt);return n.fromPoint(t)}}return n.fromPoint(e)},i.prototype.normalizePosition=function(e){this.legendDataStartIndex>=e.length&&(this.legendDataStartIndex=e.length-1),this.legendDataStartIndex<0&&(this.legendDataStartIndex=0)},i.prototype.calculateTitleLayout=function(t){var a=0,r=!_.isEmpty(t);if(r){var n=l.isTopOrBottom(this.orientation),o=void 0;if(n){var s=this.legendFontSizeMarginValue>i.DefaultTextMargin?i.TextAndIconPadding+this.legendFontSizeMarginDifference:i.TextAndIconPadding,u=i.TextAndIconPadding+i.LegendIconRadius,c=i.LegendIconRadius+s+u;o=this.parentViewport.width*i.LegendMaxWidthFactor-c-i.LegendEdgeMariginWidth}else o=this.legendFontSizeMarginValue<i.DefaultTextMargin?i.MaxTitleLength:i.MaxTitleLength+i.DefaultMaxLegendFactor*this.legendFontSizeMarginDifference;var d=i.getTextProperties(!0,t,this.data.fontSize),p=t;return a=e.TextMeasurementService.measureSvgTextWidth(d),a>o&&(p=e.TextMeasurementService.getTailoredTextOrDefault(d,o),d.text=p,a=e.TextMeasurementService.measureSvgTextWidth(d)),n?a+=i.TitlePadding:p=e.TextMeasurementService.getTailoredTextOrDefault(d,this.viewport.width),{x:0,y:0,text:p,width:a,height:e.TextMeasurementService.estimateSvgTextHeight(d)}}return null},i.prototype.calculateLayout=function(e,t){var a=e.dataPoints;if(0===e.dataPoints.length)return{numberOfItems:0,title:null,navigationArrows:[]};this.legendFontSizeMarginValue=n.fromPointToPixel(this.data&&void 0!==this.data.fontSize?this.data.fontSize:i.DefaultFontSizeInPt),this.legendFontSizeMarginDifference=this.legendFontSizeMarginValue-i.DefaultTextMargin,this.normalizePosition(a),this.legendDataStartIndex<a.length&&(a=a.slice(this.legendDataStartIndex));var r,o,s=this.calculateTitleLayout(e.title);return l.isTopOrBottom(this.orientation)?(r=this.isScrollable?this.calculateHorizontalNavigationArrowsLayout(s):[],o=this.calculateHorizontalLayout(a,s,r)):(r=this.isScrollable?this.calculateVerticalNavigationArrowsLayout(s):[],o=this.calculateVerticalLayout(a,s,r,t)),{numberOfItems:o,title:s,navigationArrows:r}},i.prototype.updateNavigationArrowLayout=function(e,t,i){0===this.legendDataStartIndex&&e.shift();var a=this.arrowPosWindow;this.arrowPosWindow=i,e&&e.length>0&&this.arrowPosWindow===t&&(this.arrowPosWindow=a,e.length=e.length-1)},i.prototype.calculateHorizontalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,n=this.viewport.height/2-a/2,o=[],s=e?e.x+e.width:0,l=t.SVGUtil.createArrow(r,a,180),u=t.SVGUtil.createArrow(r,a,0);return o.push({x:s,y:n,path:l.path,rotateTransform:l.transform,type:1}),o.push({x:this.parentViewport.width-r,y:n,path:u.path,rotateTransform:u.transform,type:0}),o},i.prototype.calculateVerticalNavigationArrowsLayout=function(e){var a=i.LegendArrowHeight,r=i.LegendArrowWidth,n=this.viewport.height/2,o=[],s=n+a/2,l=t.SVGUtil.createArrow(r,a,270),u=t.SVGUtil.createArrow(r,a,90),c=e?e.height:0;return o.push({x:s,y:r+c,path:l.path,rotateTransform:l.transform,type:1}),o.push({x:s,y:this.parentViewport.height-a,path:u.path,rotateTransform:u.transform,type:0}),o},i.calculateHorizontalLegendItemsWidths=function(t,a,r,n){var o=t.length,s=o>0?a/o|0:0,l=s-r;l<i.MaxTextLength&&(l=i.MaxTextLength,s=l+r),s>a&&(s=a,l=s-r);for(var u=0,c=[],d=0,p=t;d<p.length;d++){var h=p[d],g=i.getTextProperties(!1,h.label,n),f=e.TextMeasurementService.measureSvgTextWidth(g),m=f+r,y=m>s,v=y?s:m;if(u+=v,u>=a){0===c.length?(c.push({dataPoint:h,textProperties:g,desiredWidth:m,desiredOverMaxWidth:!0,width:m}),u=a):u-=v;break}c.push({dataPoint:h,textProperties:g,desiredWidth:m,desiredOverMaxWidth:y,width:m})}var w=_.filter(c,(function(e){return e.desiredOverMaxWidth})),b=w.length;if(b>0)for(var C=a-u,S=0,x=w;S<x.length;S++){var P=x[S],D=C/b,T=s+D,V=void 0;P.desiredWidth<=T?(P.desiredOverMaxWidth=!1,V=P.desiredWidth-s):(P.width=T,V=T-s),C-=V,b--}return c},i.prototype.calculateHorizontalLayout=function(t,a,r){var n=4+i.LegendIconRadius,o=this.legendFontSizeMarginDifference>0,s=o?i.TextAndIconPadding+this.legendFontSizeMarginDifference:i.TextAndIconPadding,l=s/(i.LegendIconRadiusFactor/2)+n,u=0,c=2*i.LegendIconRadius+1.5*s,d=t.length,p=i.getTextProperties(!1,"",this.data.fontSize),h=this.viewport.height/2,g=h+e.TextMeasurementService.estimateSvgTextHeight(p)/2-e.TextMeasurementService.estimateSvgTextBaselineDelta(p);a&&(u+=a.width,a.y=h+a.height/2-e.TextMeasurementService.estimateSvgTextBaselineDelta(i.getTextProperties(!0,a.text,this.data.fontSize))),this.legendDataStartIndex>0&&(u+=i.LegendArrowOffset);var f=t.length,m=this.parentViewport.width-u,y=i.calculateHorizontalLegendItemsWidths(t,m,c,this.data.fontSize);d=y.length,d!==f&&(m-=i.LegendArrowOffset,y=i.calculateHorizontalLegendItemsWidths(t,m,c,this.data.fontSize),d=y.length);for(var v=0,w=y;v<w.length;v++){var b=w[v],C=b.dataPoint;if(C.glyphPosition={x:u+i.LegendIconRadius+this.legendFontSizeMarginDifference/i.LegendIconRadiusFactor,y:this.viewport.height*i.LegendIconYRatio},C.textPosition={x:u+l,y:g},b.desiredOverMaxWidth){var S=b.width-c,x=e.TextMeasurementService.getTailoredTextOrDefault(b.textProperties,S);C.label=x}u+=b.width}return this.visibleLegendWidth=u,this.updateNavigationArrowLayout(r,f,d),d},i.prototype.calculateVerticalLayout=function(t,a,r,n){var o=this,s=this.legendFontSizeMarginDifference>0,l=s?this.legendFontSizeMarginDifference:0,u=20+l,c=15+l,d=4+l,p=u,h=i.TextAndIconPadding+i.LegendIconRadius+this.legendFontSizeMarginDifference/i.LegendIconRadiusFactor,g=2*h,f=n?this.parentViewport.width*i.LegendMaxWidthFactor-g-i.LegendEdgeMariginWidth:this.lastCalculatedWidth-g-i.LegendEdgeMariginWidth,m=t.length,y=0,v=this.parentViewport.height;a&&(p+=c,a.x=i.TextAndIconPadding,a.y=c,y=a.width||0),this.legendDataStartIndex>0&&(p+=i.LegendArrowOffset);for(var w=t.length,b=0;b<w;b++){var C=t[b],S=i.getTextProperties(!1,C.label,this.data.fontSize);C.glyphPosition={x:h,y:p+d-e.TextMeasurementService.estimateSvgTextBaselineDelta(S)},C.textPosition={x:g,y:p+d};var x=e.TextMeasurementService.measureSvgTextWidth(S);if(x>y&&(y=x),x>f){var P=e.TextMeasurementService.getTailoredTextOrDefault(S,f);C.label=P}if(p+=u,p>v){m=b;break}}return n?y<f?this.lastCalculatedWidth=this.viewport.width=Math.ceil(y+g+i.LegendEdgeMariginWidth):this.lastCalculatedWidth=this.viewport.width=Math.ceil(this.parentViewport.width*i.LegendMaxWidthFactor):this.viewport.width=this.lastCalculatedWidth,this.visibleLegendHeight=p,r.forEach((function(e){return e.x=o.lastCalculatedWidth/2})),this.updateNavigationArrowLayout(r,w,m),m},i.prototype.drawNavigationArrows=function(e){var a=this,r=this.group.selectAll(i.NavigationArrow.selector).data(e);r.enter().append("g").on("click",(function(e){var t=a.legendDataStartIndex;a.legendDataStartIndex=0===e.type?t+a.arrowPosWindow:t-a.arrowPosWindow,a.drawLegendInternal(a.data,a.parentViewport,!1)})).classed(i.NavigationArrow.class,!0).append("path"),r.attr("transform",(function(e){return t.SVGUtil.translate(e.x,e.y)})).select("path").attr({d:function(e){return e.path},transform:function(e){return e.rotateTransform}}),r.exit().remove()},i.prototype.reset=function(){},i.getTextProperties=function(e,t,a){return{text:t,fontFamily:e?i.DefaultTitleFontFamily:i.DefaultFontFamily,fontSize:n.fromPoint(a||i.DefaultFontSizeInPt)}},i.prototype.setTooltipToLegendItems=function(e){for(var t=0,i=e.dataPoints;t<i.length;t++){var a=i[t];a.tooltip=a.label}},i.DefaultFontSizeInPt=8,i.LegendSmallFontSmallViewportInPt=7,i.LegendMediumFontSmallViewportInPt=8,i.LegendIconRadius=5,i.LegendIconRadiusFactor=5,i.MaxTextLength=60,i.MaxTitleLength=80,i.TextAndIconPadding=5,i.TitlePadding=15,i.LegendEdgeMariginWidth=10,i.LegendMaxWidthFactor=.3,i.TopLegendHeight=24,i.DefaultTextMargin=n.fromPointToPixel(i.DefaultFontSizeInPt),i.DefaultMaxLegendFactor=i.MaxTitleLength/i.DefaultTextMargin,i.LegendIconYRatio=.52,i.LegendArrowOffset=10,i.LegendArrowHeight=15,i.LegendArrowWidth=7.5,i.DefaultFontFamily=t.Font.Family.regular.css,i.DefaultTitleFontFamily=t.Font.Family.semibold.css,i.LegendItem=r("legendItem"),i.LegendText=r("legendText"),i.LegendIcon=r("legendIcon"),i.LegendTitle=r("legendTitle"),i.NavigationArrow=r("navArrow"),i})();t.SVGLegend=u;var c,d=(function(){function i(e){this.legendContainerParent=d3.select(e.get(0))}return i.prototype.getMargins=function(){return{height:i.LegendHeight,width:0}},i.prototype.drawLegend=function(e){var t=e.dataPoints;if(!(t.length<1)){var a=this.legendContainerParent.select(i.LegendContainerSelector);if(a.empty()){if(!t.length)return;var r=$("<div></div>").height(this.getMargins().height).addClass(i.LegendContainerClass);$(this.legendContainerParent[0]).prepend(r),a=d3.select(r.get(0))}this.legendContainerDiv=a,this.drawTitle(t),this.drawLegendItems(t)}},i.prototype.reset=function(){this.legendContainerDiv&&(this.legendContainerDiv.remove(),this.legendContainerDiv=null)},i.prototype.isVisible=function(){return!0},i.prototype.changeOrientation=function(e){},i.prototype.getOrientation=function(){return s.Top},i.prototype.drawTitle=function(e){var t=this.legendContainerDiv.selectAll("div."+i.LegendTitleClass),a=t.data([e[0]]),r=a.enter(),n=r.append("div").attr("class",i.LegendTitleClass);n.filter((function(e){return e.iconOnlyOnLabel})).append("span").attr("class",i.legendIconClass).html(i.legendPlaceSelector),n.append("span"),a.filter((function(e){return e.iconOnlyOnLabel})).select("span."+i.legendIconClass).style(i.legendColorCss,(function(e){return e.color})),a.select("span:last-child").text((function(e){return e.category}))},i.prototype.drawLegendItems=function(t){this.ensureLegendTableCreated();var a=[t],r=this.legendContainerDiv.select("tbody").selectAll("tr").data(a),n=r.enter(),o=n.append("tr"),s=o.selectAll("td").data((function(e){return e}),(function(e){return e.label})).enter().append("td").attr("class",i.LegendItem),l=s.append("span");l.filter((function(e){return!e.iconOnlyOnLabel})).append("span").html(i.legendPlaceSelector).attr("class",i.legendIconClass).attr("white-space","nowrap").style({"font-size":"20px","margin-bottom":"7px"}),l.append("span").attr("class",i.legendItemNameClass),l.append("span").attr("class",i.legendItemMeasureClass);var u=r.selectAll("td").data((function(e){return e}),(function(e){return e.label}));u.select("span."+i.legendItemNameClass).html((function(t){return e.visuals.TextUtil.removeBreakingSpaces(t.label)})),u.select("span."+i.legendItemMeasureClass).html((function(e){return"&nbsp;"+e.measure})),u.select("span."+i.legendIconClass).style("color",(function(e){return e.color})),u.exit().remove()},i.prototype.ensureLegendTableCreated=function(){
if(this.legendContainerDiv.select("div table").empty()){var e=this.legendContainerDiv.append("div").append("table");e.style("table-layout","fixed").append("tbody"),this.setPanGestureOnLegend(e)}},i.prototype.setPanGestureOnLegend=function(e){var i=$(this.legendContainerParent[0]).width(),a=d3.scale.linear().domain([0,i]).range([0,i]),r=d3.behavior.zoom().scaleExtent([1,1]).x(a).on("zoom",(function(){if($(e[0]).width()>i){var a=r.translate(),n=a[0],o=a[1];n=Math.min(n,0),n=Math.max(n,i-$(e[0]).width()),r.translate([n,o]),e.style("-ms-transform",(function(){return t.SVGUtil.translateXWithPixels(n)})),e.style("-webkit-transform",(function(){return t.SVGUtil.translateXWithPixels(n)})),e.style("transform",(function(){return t.SVGUtil.translateXWithPixels(n)}))}}));this.legendContainerDiv?this.legendContainerDiv.call(r):e.call(r)},i.LegendHeight=70,i.LegendContainerClass="interactive-legend",i.LegendContainerSelector=".interactive-legend",i.LegendTitleClass="title",i.LegendItem="item",i.legendPlaceSelector="",i.legendIconClass="icon",i.legendColorCss="color",i.legendItemNameClass="itemName",i.legendItemMeasureClass="itemMeasure",i})();!(function(e){function i(e,i){if(null==i[t.legendProps.show]&&(i[t.legendProps.show]=!0),i[t.legendProps.show]===!1&&(e.dataPoints=[]),i[t.legendProps.show]===!0&&null==i[t.legendProps.position]&&(i[t.legendProps.position]=t.legendPosition.top),void 0!==i[t.legendProps.fontSize]&&(e.fontSize=i[t.legendProps.fontSize]),void 0!==i[t.legendProps.labelColor]){var a=i[t.legendProps.labelColor];null!=a&&(e.labelColor=a.solid.color)}i[t.legendProps.showTitle]===!1?e.title="":void 0!==i[t.legendProps.titleText]&&(e.title=i[t.legendProps.titleText])}e.DefaultLegendLabelFillColor="#666666",e.update=i})(c=t.LegendData||(t.LegendData={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.linear="linear",t.log="log",t.type=e.createEnumType([{value:t.linear,displayName:function(e){return e.get("Visual_Axis_Linear")}},{value:t.log,displayName:function(e){return e.get("Visual_Axis_Log")}}])})(i=t.axisScale||(t.axisScale={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.showBoth="showBoth",t.showTitleOnly="showTitleOnly",t.showUnitOnly="showUnitOnly",t.type=e.createEnumType([{value:t.showTitleOnly,displayName:function(e){return e.get("Visual_Axis_ShowTitleOnly")}},{value:t.showUnitOnly,displayName:function(e){return e.get("Visual_Axis_ShowUnitOnly")}},{value:t.showBoth,displayName:function(e){return e.get("Visual_Axis_ShowBoth")}}])})(i=t.axisStyle||(t.axisStyle={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.scalar="Scalar",t.categorical="Categorical",t.both="Both",t.type=e.createEnumType([{value:t.scalar,displayName:function(e){return e.get("Visual_Axis_Scalar")}},{value:t.categorical,displayName:function(e){return e.get("Visual_Axis_Categorical")}}])})(i=t.axisType||(t.axisType={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.rectangle="rectangle",t.oval="oval",t.line="line",t.arrow="arrow",t.triangle="triangle",t.type=e.createEnumType([{value:t.rectangle,displayName:"rectangle"},{value:t.oval,displayName:"oval"},{value:t.line,displayName:"line"},{value:t.arrow,displayName:"arrow"},{value:t.triangle,displayName:"triangle"}])})(i=t.basicShapeType||(t.basicShapeType={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.fill="fill",t.line="line",t.none="none",t.type=e.createEnumType([{value:t.fill,displayName:function(e){return e.get("Visual_Confidence_Band_Style_Fill")}},{value:t.line,displayName:function(e){return e.get("Visual_Confidence_Band_Style_Line")}},{value:t.none,displayName:function(e){return e.get("Visual_Confidence_Band_Style_None")}}])})(i=t.confidenceBandStyle||(t.confidenceBandStyle={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.year="year",t.quarter="quarter",t.month="month",t.day="day",t.hour="hour",t.minute="minute",t.second="second",t.point="point",t.type=e.createEnumType([{value:t.year,displayName:function(e){return e.get("Visual_Forecast_Units_Year")}},{value:t.quarter,displayName:function(e){return e.get("Visual_Forecast_Units_Quarter")}},{value:t.month,displayName:function(e){return e.get("Visual_Forecast_Units_Month")}},{value:t.day,displayName:function(e){return e.get("Visual_Forecast_Units_Day")}},{value:t.hour,displayName:function(e){return e.get("Visual_Forecast_Units_Hour")}},{value:t.minute,displayName:function(e){return e.get("Visual_Forecast_Units_Minute")}},{value:t.second,displayName:function(e){return e.get("Visual_Forecast_Units_Second")}},{value:t.point,displayName:function(e){return e.get("Visual_Forecast_Units_Point")}}])})(i=t.forecastUnits||(t.forecastUnits={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.ninetyNine="99%",t.ninetyFive="95%",t.ninety="90%",t.eightyFive="85%",t.eighty="80%",t.seventyfive="75%",t.type=e.createEnumType([{value:t.ninetyNine,displayName:function(e){return"99%"}},{value:t.ninetyFive,displayName:function(e){return"95%"}},{value:t.ninety,displayName:function(e){return"90%"}},{value:t.eightyFive,displayName:function(e){return"85%"}},{value:t.eighty,displayName:function(e){return"80%"}},{value:t.seventyfive,displayName:function(e){return"75%"}}])})(i=t.forecastConfidenceIntervals||(t.forecastConfidenceIntervals={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.normal="Normal",t.fit="Fit",t.fill="Fill",t.type=e.createEnumType([{value:t.normal,displayName:function(e){return e.get("Visual_ImageScalingType_Normal")}},{value:t.fit,displayName:function(e){return e.get("Visual_ImageScalingType_Fit")}},{value:t.fill,displayName:function(e){return e.get("Visual_ImageScalingType_Fill")}}])})(i=t.imageScalingType||(t.imageScalingType={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.type=e.createEnumType([{value:0,displayName:function(e){return e.get("Visual_LabelOrientation_Vertical")}},{value:1,displayName:function(e){return e.get("Visual_LabelOrientation_Horizontal")}}])})(i=t.labelOrientation||(t.labelOrientation={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.auto="Auto",t.insideEnd="InsideEnd",t.insideCenter="InsideCenter",t.outsideEnd="OutsideEnd",t.insideBase="InsideBase",t.type=e.createEnumType([{value:t.auto,displayName:function(e){return e.get("Visual_LabelPosition_Auto")}},{value:t.insideEnd,displayName:function(e){return e.get("Visual_LabelPosition_InsideEnd")}},{value:t.outsideEnd,displayName:function(e){return e.get("Visual_LabelPosition_OutsideEnd")}},{value:t.insideCenter,displayName:function(e){return e.get("Visual_LabelPosition_InsideCenter")}},{value:t.insideBase,displayName:function(e){return e.get("Visual_LabelPosition_InsideBase")}}])})(i=t.labelPosition||(t.labelPosition={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.category="Category",t.data="Data",t.both="Both",t.type=e.createEnumType([{value:t.category,displayName:function(e){return e.get("Visual_LabelStyle_Category")}},{value:t.data,displayName:function(e){return e.get("Visual_LabelStyle_DataValue")}},{value:t.both,displayName:function(e){return e.get("Visual_LabelStyle_Both")}}])})(i=t.labelStyle||(t.labelStyle={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.value="Value",t.name="Name",t.nameAndValue="ValueAndName",t.type=e.createEnumType([{value:t.value,displayName:function(e){return e.get("Visual_LabelText_Value")}},{value:t.name,displayName:function(e){return e.get("Visual_LabelText_Name")}},{value:t.nameAndValue,displayName:function(e){return e.get("Visual_LabelText_Name_Value")}}])})(i=t.labelText||(t.labelText={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.top="Top",t.bottom="Bottom",t.left="Left",t.right="Right",t.topCenter="TopCenter",t.bottomCenter="BottomCenter",t.leftCenter="LeftCenter",t.rightCenter="RightCenter",t.type=e.createEnumType([{value:t.top,displayName:function(e){return e.get("Visual_LegendPosition_Top")}},{value:t.bottom,displayName:function(e){return e.get("Visual_LegendPosition_Bottom")}},{value:t.left,displayName:function(e){return e.get("Visual_LegendPosition_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_LegendPosition_Right")}},{value:t.topCenter,displayName:function(e){return e.get("Visual_LegendPosition_TopCenter")}},{value:t.bottomCenter,displayName:function(e){return e.get("Visual_LegendPosition_BottomCenter")}},{value:t.leftCenter,displayName:function(e){return e.get("Visual_LegendPosition_LeftCenter")}},{value:t.rightCenter,displayName:function(e){return e.get("Visual_LegendPosition_RightCenter")}}])})(i=t.legendPosition||(t.legendPosition={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.positive="Positive",t.negative="Negative",t.type=e.createEnumType([{value:t.positive,displayName:function(e){return e.get("Visual_KPI_Direction_Positive")}},{value:t.negative,displayName:function(e){return e.get("Visual_KPI_Direction_Negative")}}])})(i=t.kpiDirection||(t.kpiDirection={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.dashed="dashed",t.solid="solid",t.dotted="dotted",t.type=e.createEnumType([{value:t.dashed,displayName:function(e){return e.get("Visual_LineStyle_Dashed")}},{value:t.solid,displayName:function(e){return e.get("Visual_LineStyle_Solid")}},{value:t.dotted,displayName:function(e){return e.get("Visual_LineStyle_Dotted")}}])})(i=t.lineStyle||(t.lineStyle={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(e){return[t.topOnly,t.topBottom,t.frame].some((function(t){return t===e}))}function a(e){return[t.rightOnly,t.leftRight,t.frame].some((function(t){return t===e}))}function r(e){return[t.bottomOnly,t.topBottom,t.frame].some((function(t){return t===e}))}function n(e){return[t.leftOnly,t.leftRight,t.frame].some((function(t){return t===e}))}t.none="None",t.bottomOnly="BottomOnly",t.topOnly="TopOnly",t.leftOnly="LeftOnly",t.rightOnly="RightOnly",t.topBottom="TopBottom",t.leftRight="LeftRight",t.frame="Frame",t.showTop=i,t.showRight=a,t.showBottom=r,t.showLeft=n,t.type=e.createEnumType([{value:t.none,displayName:function(e){return e.get("Visual_Outline_none")}},{value:t.bottomOnly,displayName:function(e){return e.get("Visual_Outline_bottom_only")}},{value:t.topOnly,displayName:function(e){return e.get("Visual_Outline_top_only")}},{value:t.leftOnly,displayName:function(e){return e.get("Visual_Outline_LeftOnly")}},{value:t.rightOnly,displayName:function(e){return e.get("Visual_Outline_RightOnly")}},{value:t.topBottom,displayName:function(e){return e.get("Visual_Outline_top_Bottom")}},{value:t.leftRight,displayName:function(e){return e.get("Visual_Outline_leftRight")}},{value:t.frame,displayName:function(e){return e.get("Visual_Outline_frame")}}])})(i=t.outline||(t.outline={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.back="back",t.front="front",t.type=e.createEnumType([{value:t.back,displayName:function(e){return e.get("Visual_Reference_Line_Behind")}},{value:t.front,displayName:function(e){return e.get("Visual_Reference_Line_InFront")}}])})(i=t.referenceLinePosition||(t.referenceLinePosition={}));var a;!(function(t){t.left="left",t.right="right",t.type=e.createEnumType([{value:t.left,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Right")}}])})(a=t.referenceLineDataLabelHorizontalPosition||(t.referenceLineDataLabelHorizontalPosition={}));var r;!(function(t){t.above="above",t.under="under",t.type=e.createEnumType([{value:t.above,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Above")}},{value:t.under,displayName:function(e){return e.get("Visual_Reference_Line_Data_Label_Under")}}])})(r=t.referenceLineDataLabelVerticalPosition||(t.referenceLineDataLabelVerticalPosition={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.type=e.createEnumType([{value:0,displayName:function(e){return e.get("Slicer_Orientation_Vertical")}},{value:1,displayName:function(e){return e.get("Slicer_Orientation_Horizontal")}}])})(i=t.slicerOrientation||(t.slicerOrientation={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.australiaStates="australia.states.topo",t.austriaStates="austria.states.topo",t.brazilStates="brazil.states.topo",t.canadaProvinces="canada.provinces.topo",t.franceRegions="france.regions.topo",t.germanyStates="germany.states.topo",t.irelandCounties="ireland.counties.topo",t.italyRegions="italy.regions.topo",t.mexicoStates="mexico.states.topo",t.netherlandsProvinces="netherlands.provinces.topo",t.ukCountries="uk.countries.topo",t.usaStates="usa.states.topo",t.type=e.createEnumType([{value:t.australiaStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_AustraliaStates")}},{value:t.austriaStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_AustriaStates")}},{value:t.brazilStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_BrazilStates")}},{value:t.canadaProvinces,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_CanadaProvinces")}},{value:t.franceRegions,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_FranceRegions")}},{value:t.germanyStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_GermanyStates")}},{value:t.irelandCounties,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_IrelandCounties")}},{value:t.italyRegions,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_ItalyRegions")}},{value:t.mexicoStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_MexicoStates")}},{value:t.netherlandsProvinces,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_NetherlandsProvinces")}},{value:t.ukCountries,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_UkCountries")}},{value:t.usaStates,displayName:function(e){return e.get("Visual_ShapeMap_StandardMaps_UsaStates")}}])})(i=t.standardGeoJson||(t.standardGeoJson={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.left="Left",t.right="Right",t.type=e.createEnumType([{value:t.left,displayName:function(e){return e.get("Visual_yAxis_Left")}},{value:t.right,displayName:function(e){return e.get("Visual_yAxis_Right")}}])})(i=t.yAxisPosition||(t.yAxisPosition={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(e){e.category="Category",e.series="Series",e.tooltips="Tooltips",e.value="Value"})(i=t.Role||(t.Role={}));var a;!(function(t){t.albersUsa="albersUsa",t.equirectangular="equirectangular",t.mercator="mercator",t.orthographic="orthographic",t.type=e.createEnumType([{value:t.albersUsa,displayName:function(e){return e.get("Visual_ShapeMap_Projection_AlbersUsa")}},{value:t.equirectangular,displayName:function(e){return e.get("Visual_ShapeMap_Projection_Equirectangular")}},{value:t.mercator,displayName:function(e){return e.get("Visual_ShapeMap_Projection_Mercator")}},{value:t.orthographic,displayName:function(e){return e.get("Visual_ShapeMap_Projection_Orthographic")}}])})(a=t.Projection||(t.Projection={}))})(i=t.ShapeMapType||(t.ShapeMapType={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.before="Before",t.after="After",t.between="Between",t.basic="Basic",t.dropdown="Dropdown",t.type=e.createEnumType([{value:t.between,displayName:function(e){return e.get("Visual_SliderMode_Between")}},{value:t.before,displayName:function(e){return e.get("Visual_SliderMode_Before")}},{value:t.after,displayName:function(e){return e.get("Visual_SliderMode_After")}},{value:t.basic,displayName:function(e){return e.get("Visual_SliderMode_Basic")}},{value:t.dropdown,displayName:function(e){return e.get("Visual_SliderMode_Dropdown")}}])})(i=t.slicerMode||(t.slicerMode={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){return t||!e?0:e.getDuration()}e.MinervaAnimationDuration=250,e.MaxDataPointsToAnimate=1e3,e.GetAnimationDuration=t})(t=e.AnimatorCommon||(e.AnimatorCommon={}));var i=(function(){function e(e){e&&e.duration&&(this.animationDuration=e.duration),this.animationDuration=this.animationDuration>=0?this.animationDuration:t.MinervaAnimationDuration}return e.prototype.getDuration=function(){return this.animationDuration},e.prototype.animate=function(e){return null},e.prototype.getEasing=function(){return"cubic-in-out"},e})();e.BaseAnimator=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(t){function i(e){t.call(this,e)}return a(i,t),i.prototype.animate=function(t){var i={failed:!0,shapes:null},a=t.viewModel,r=this.previousViewModel,n=a.categories.length*a.series.length;return n>e.AnimatorCommon.MaxDataPointsToAnimate?i:(r&&(a.hasHighlights&&!r.hasHighlights?i=this.animateNormalToHighlighted(t):a.hasHighlights&&r.hasHighlights?i=this.animateHighlightedToHighlighted(t):!a.hasHighlights&&r.hasHighlights&&(i=this.animateHighlightedToNormal(t))),this.previousViewModel=a,i)},i.prototype.animateNormalToHighlighted=function(t){var i=t.viewModel,a=t.itemCS,r=t.series.selectAll(a.selector),n=r.data((function(e){return e.data}),(function(e){return e.key})),o=i.hasHighlights;return n.enter().append("rect").attr("class",(function(e){return a.class.concat(e.highlight?" highlight":"")})).attr(t.layout.shapeLayoutWithoutHighlights),n.style("fill",(function(e){return e.color})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,!1,o)})).transition().duration(this.animationDuration).attr(t.layout.shapeLayout),n.exit().remove(),{failed:!1,shapes:n}},i.prototype.animateHighlightedToHighlighted=function(e){var t=this.animateDefaultShapes(e.viewModel,e.series,e.layout,e.itemCS);return{failed:!1,shapes:t}},i.prototype.animateHighlightedToNormal=function(t){var i=t.itemCS,a=t.series.selectAll(i.selector),r=a.data((function(e){return e.data}),(function(e){return e.key})),n=t.interactivityService&&t.interactivityService.hasSelection();return r.enter().append("rect").attr("class",(function(e){return i.class.concat(e.highlight?" highlight":"")})),r.style("fill",(function(e){return e.color})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,t.selected,!t.selected)})).transition().duration(this.animationDuration).attr(t.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,t.highlight,n,!1)})),r.exit().transition().duration(this.animationDuration).attr(n?t.layout.zeroShapeLayout:t.layout.shapeLayoutWithoutHighlights).remove(),{failed:!1,shapes:r}},i.prototype.animateDefaultShapes=function(t,i,a,r){var n=i.selectAll(r.selector),o=n.data((function(e){return e.data}),(function(e){return e.key}));return o.enter().append("rect").attr("class",(function(e){return r.class.concat(e.highlight?" highlight":"")})),o.style("fill",(function(e){return e.color})).style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,!1,t.hasHighlights)})).transition().duration(this.animationDuration).attr(a.shapeLayout),o.exit().remove(),o},i})(e.BaseAnimator);e.WebColumnChartAnimator=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(t){function i(e){t.call(this,e)}return a(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null},i=e.viewModel,a=this.previousViewModel;if(i.highlightsOverflow||a&&a.highlightsOverflow)return this.previousViewModel=i,t;var r=a&&a.hasHighlights,n=i.hasHighlights;return a&&(n&&!r?t=this.animateNormalToHighlighted(e):n&&r?t=this.animateHighlightedToHighlighted(e):!n&&r&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio})),(function(e){return e.data.identity.getKey()}));return a.enter().insert("path").classed("slice-highlight",!0).each((function(e){this._current=e})),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio}))),a.style("fill",(function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value})).style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)})).style("stroke-width",(function(e){return e.data.strokeWidth})).attr(t.layout.shapeLayout.attrs).style(t.layout.shapeLayout.styles).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout.attrs).style(t.layout.highlightShapeLayout.styles),a.exit().remove(),e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToHighlighted=function(t){var i=this.animateDefaultShapes(t),a=this.animateDefaultHighlightShapes(t);return e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:i,highlightShapes:a}},i.prototype.animateHighlightedToNormal=function(t){var i=t.interactivityService&&t.interactivityService.hasSelection(),a=this.animationDuration,r=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,(function(e){return e.data.identity.getKey()}));r.enter().insert("path").classed("slice",!0).each((function(e){this._current=e})),e.DonutChart.isSingleColor(t.viewModel.dataPoints),r.style("fill",(function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,t.data.selected,!t.data.selected)})).style("stroke-width",(function(e){return e.data.strokeWidth})).transition().duration(a).attr(t.layout.shapeLayout.attrs).style(t.layout.shapeLayout.styles).transition().duration(0).delay(a).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!1,i,!1)})),r.exit().remove();var n=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio})),(function(e){return e.data.identity.getKey()}));return n.enter().insert("path").classed("slice-highlight",!0).each((function(e){this._current=e})),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio}))),n.exit().style("fill",(function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(!1,!0,!1,!0)})).style("stroke-width",(function(e){return e.data.strokeWidth})).transition().duration(a).attr(i?t.layout.zeroShapeLayout.attrs:t.layout.shapeLayout.attrs).style(i?t.layout.zeroShapeLayout.styles:t.layout.shapeLayout.styles).remove(),e.NewDataLabelUtils.drawDefaultLabels(t.labelGraphicsContext,t.labels,!1,!0,!0),e.NewDataLabelUtils.drawLabelLeaderLines(t.labelGraphicsContext,t.labels),{failed:!1,shapes:r,highlightShapes:n}},i.prototype.animateDefaultShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice").data(t.viewModel.dataPoints,(function(e){return e.data.identity.getKey()}));return i.enter().insert("path").classed("slice",!0).each((function(e){this._current=e})),e.DonutChart.isSingleColor(t.viewModel.dataPoints),i.style("fill",(function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value})).style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,t.viewModel.hasHighlights)})).style("stroke-width",(function(e){return e.data.strokeWidth})).transition().duration(this.animationDuration).attr(t.layout.shapeLayout.attrs).style(t.layout.shapeLayout.styles),i.exit().remove(),i},i.prototype.animateDefaultHighlightShapes=function(t){var i=t.graphicsContext.select(".slices").selectAll("path.slice-highlight").data(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio})),(function(e){return e.data.identity.getKey()}));return i.enter().insert("path").classed("slice-highlight",!0).each((function(e){this._current=e})),e.DonutChart.isSingleColor(t.viewModel.dataPoints.filter((function(e){return null!=e.data.highlightRatio}))),i.style("fill",(function(e){return e.data.color?e.data.color:t.colors.getNewColorScale().getColor(e.data.identity.getKey()).value})).style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.data.selected,!0,!1,t.viewModel.hasHighlights)})).style("stroke-width",(function(e){return e.data.strokeWidth})).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout.attrs).style(t.layout.highlightShapeLayout.styles),i.exit().remove(),i},i})(e.BaseAnimator);e.WebDonutChartAnimator=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i=(function(i){function r(e){i.call(this,e)}return a(r,i),r.prototype.animate=function(e){var t={failed:!0,shapes:null,dataLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},r.prototype.animateNormalToHighlighted=function(e){var i=e.viewModel,a=e.layout,r=!0,n=!1;t.FunnelChart.drawDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var o=e.shapeGraphicsContext.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i.dataPoints,(function(e){return e.key}));o.enter().append("rect").attr("class",(function(e){return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars.class})).attr(a.shapeLayoutWithoutHighlights),o.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,n,r)})).transition().duration(this.animationDuration).attr(a.shapeLayout),o.exit().remove(),this.animatePercentBars(e);var s=t.NewDataLabelUtils.animateDefaultLabels(e.labelGraphicsContext,e.labelLayout,this.animationDuration);return{failed:!1,shapes:o,dataLabels:s}},r.prototype.animateHighlightedToHighlighted=function(e){var i=e.viewModel,a=e.layout;t.FunnelChart.drawDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var r=this.animateDefaultShapes(i,i.dataPoints,e.shapeGraphicsContext,a);this.animatePercentBars(e);var n=t.NewDataLabelUtils.animateDefaultLabels(e.labelGraphicsContext,e.labelLayout,this.animationDuration);return{failed:!1,shapes:r,dataLabels:n}},r.prototype.animateHighlightedToNormal=function(e){var i=e.viewModel,a=e.layout,r=!!e.interactivityService&&e.interactivityService.hasSelection();t.FunnelChart.drawDefaultAxis(e.axisGraphicsContext,e.axisOptions,e.isHidingPercentBars);var n=e.shapeGraphicsContext.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i.dataPoints,(function(e){return e.key}));n.enter().append("rect").attr("class",(function(e){
return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars.class})),n.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!e.selected)})).transition().duration(this.animationDuration).attr(a.shapeLayoutWithoutHighlights).transition().duration(0).delay(this.animationDuration).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,r,!1)}));var o=n.exit();o.transition().duration(this.animationDuration).attr(r?a.zeroShapeLayout:a.shapeLayoutWithoutHighlights).remove(),this.animatePercentBars(e);var s=t.NewDataLabelUtils.animateDefaultLabels(e.labelGraphicsContext,e.labelLayout,this.animationDuration);return{failed:!1,shapes:n,dataLabels:s}},r.prototype.animateDefaultShapes=function(e,i,a,r){var n=e.hasHighlights,o=a.selectAll(t.FunnelChart.Selectors.funnel.bars.selector).data(i,(function(e){return e.key}));return o.enter().append("rect").attr("class",(function(e){return e.highlight?t.FunnelChart.FunnelBarHighlightClass:t.FunnelChart.Selectors.funnel.bars.class})),o.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!1,n)})).transition().duration(this.animationDuration).attr(r.shapeLayout),o.exit().remove(),o},r.prototype.animatePercentBars=function(e){var i=e.viewModel,a=e.isHidingPercentBars;if(a||!i.dataPoints||(i.hasHighlights?i.dataPoints.length/2:i.dataPoints.length)<2)return void this.animatePercentBarComponents([],e);var r=[i.dataPoints[i.hasHighlights?1:0],i.dataPoints[i.dataPoints.length-1]],n=t.FunnelChart.getValueFromDataPoint(r[0]);if(n<=0)return void this.animatePercentBarComponents([],e);var o=r.map((function(e,i){return{value:t.FunnelChart.getValueFromDataPoint(e),percent:0===i?1:t.FunnelChart.getValueFromDataPoint(e)/n,isTop:0===i}}));this.animatePercentBarComponents(o,e)},r.prototype.animateToFunnelPercent=function(e,t,i){return e.data(t).transition().duration(this.animationDuration).attr(i)},r.prototype.animatePercentBarComponents=function(i,a){var r=a.percentGraphicsContext,n=a.layout,o=[{percent:0,value:0,isTop:!0},{percent:0,value:0,isTop:!1}],s=r.selectAll(t.FunnelChart.Selectors.percentBar.mainLine.selector).data(i);this.animateToFunnelPercent(s.exit(),o,n.percentBarLayout.mainLine).remove(),s.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.mainLine.class,!0).data(o).attr(n.percentBarLayout.mainLine),this.animateToFunnelPercent(s,i,n.percentBarLayout.mainLine);var l=r.selectAll(t.FunnelChart.Selectors.percentBar.leftTick.selector).data(i);this.animateToFunnelPercent(l.exit(),o,n.percentBarLayout.leftTick).remove(),l.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.leftTick.class,!0).data(o).attr(n.percentBarLayout.leftTick),this.animateToFunnelPercent(l,i,n.percentBarLayout.leftTick);var u=r.selectAll(t.FunnelChart.Selectors.percentBar.rightTick.selector).data(i);this.animateToFunnelPercent(u.exit(),o,n.percentBarLayout.rightTick).remove(),u.enter().append("line").classed(t.FunnelChart.Selectors.percentBar.rightTick.class,!0).data(o).attr(n.percentBarLayout.rightTick),this.animateToFunnelPercent(u,i,n.percentBarLayout.rightTick);var c=r.selectAll(t.FunnelChart.Selectors.percentBar.text.selector).data(i);this.animateToFunnelPercent(c.exit(),o,n.percentBarLayout.text).remove(),c.enter().append("text").classed(t.FunnelChart.Selectors.percentBar.text.class,!0).data(o).attr(n.percentBarLayout.text),this.animateToFunnelPercent(c,i,n.percentBarLayout.text).text((function(i){return e.formattingService.formatValue(i.percent,t.valueFormatter.getLocalizedString("Percentage1"))})),t.SVGUtil.flushAllD3TransitionsIfNeeded(a.visualInitOptions)},r})(t.BaseAnimator);t.WebFunnelAnimator=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=1500,i="linear",r=(function(r){function n(e){r.call(this,e),this.lastUpdateTime=null}return a(n,r),n.prototype.refreshLastUpdate=function(){this.lastUpdateTime=Date.now()},n.prototype.getDuration=function(){if(this.lastUpdateTime){var e=Math.min(Date.now()-this.lastUpdateTime,t);return Math.max(this.animationDuration,e)}return this.animationDuration},n.prototype.getEasing=function(){return i},n.prototype.animate=function(t){var i=t.mainGraphicsContext,a=this.getDuration();return i.transition().duration(a).ease(this.getEasing()).attrTween("transform",(function(i,a,r){return function(i){return e.SVGUtil.translate(-(t.xTranslation*i),0)}})),{failed:!1}},n})(e.BaseAnimator);e.RealTimeLineChartAnimator=r;var n=(function(t){function r(e){t.call(this,e)}return a(r,t),r.prototype.animate=function(t){var i={failed:!0,shapes:null},a=t.viewModel,r=this.previousViewModel,n=a.categories.length*a.series.length;return n>e.AnimatorCommon.MaxDataPointsToAnimate?i:(r&&(i=this.animateDefaultShapes(t.viewModel,t.series,t.layout,t.itemCS)),this.previousViewModel=a,i)},r.prototype.getEasing=function(){return i},r.prototype.animateDefaultShapes=function(t,i,a,r){var n=i.selectAll(r.selector),o=n.data((function(e){return e.data}),(function(e){return e.key}));return o.enter().append("rect").attr("class",(function(e){return r.class.concat(e.highlight?" highlight":"")})),o.style("fill",(function(e){return e.color})).style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,!1,t.hasHighlights)})).transition().ease(this.getEasing()).duration(this.animationDuration).attr(a.shapeLayout),o.exit().remove(),{failed:!1,shapes:o}},r})(e.BaseAnimator);e.DashboardColumnChartAnimator=n})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(t){function i(e){t.call(this,e)}return a(i,t),i.prototype.animate=function(e){var t={failed:!0,shapes:null,highlightShapes:null,majorLabels:null,minorLabels:null},i=e.viewModel,a=this.previousViewModel;return a&&(i.hasHighlights&&!a.hasHighlights?t=this.animateNormalToHighlighted(e):i.hasHighlights&&a.hasHighlights?t=this.animateHighlightedToHighlighted(e):!i.hasHighlights&&a.hasHighlights&&(t=this.animateHighlightedToNormal(e))),this.previousViewModel=i,t},i.prototype.animateNormalToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a,t.layout),n=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,(function(e){return e.key+"highlight"}));n.enter().append("rect").attr("class",t.layout.highlightShapeClass).attr(t.layout.shapeLayout),n.style("fill",(function(t){return e.Treemap.getFill(t,!0)})).style("fill-opacity",(function(t){return e.Treemap.getFillOpacity(t,i,a,!0)})).transition().duration(this.animationDuration).attr(t.layout.highlightShapeLayout),n.exit().remove();var o=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),s=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:r,highlightShapes:n,majorLabels:o,minorLabels:s}},i.prototype.animateHighlightedToHighlighted=function(t){var i=!1,a=!0,r=this.animateDefaultShapes(t.shapeGraphicsContext,t.nodes,i,a,t.layout);t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.highlightNodes,(function(e){return e.key+"highlight"}));var n=this.animateDefaultHighlightShapes(t.shapeGraphicsContext,t.highlightNodes,i,a,t.layout),o=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),s=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:r,highlightShapes:n,majorLabels:o,minorLabels:s}},i.prototype.animateHighlightedToNormal=function(t){var i=!!t.interactivityService&&t.interactivityService.hasSelection(),a=t.shapeGraphicsContext.selectAll("."+e.Treemap.TreemapNodeClassName).data(t.nodes,(function(e){return e.key}));a.enter().append("rect").attr("class",t.layout.shapeClass),a.transition().duration(this.animationDuration).style("fill",(function(t){return e.Treemap.getFill(t,!1)})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,t.selected,!t.selected)})).attr(t.layout.shapeLayout).transition().duration(0).delay(this.animationDuration).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,!1,i,!1)})),a.exit().remove();var r=t.shapeGraphicsContext.selectAll("."+e.Treemap.HighlightNodeClassName).data(t.nodes,(function(e){return e.key+"highlight"}));r.enter().append("rect").attr("class",t.layout.highlightShapeClass),r.style("fill",(function(t){return e.Treemap.getFill(t,!0)})).style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.selected,!0,t.selected,!t.selected)})).transition().duration(this.animationDuration).attr(i?t.layout.zeroShapeLayout:t.layout.shapeLayout).remove(),r.exit().remove();var n=this.animateDefaultMajorLabels(t.labelGraphicsContext,t.majorLabeledNodes,t.labelSettings,t.layout),o=this.animateDefaultMinorLabels(t.labelGraphicsContext,t.minorLabeledNodes,t.labelSettings,t.layout);return{failed:!1,shapes:a,highlightShapes:r,majorLabels:n,minorLabels:o}},i.prototype.animateDefaultShapes=function(t,i,a,r,n){var o=!1,s=t.selectAll("."+e.Treemap.TreemapNodeClassName).data(i,(function(e){return e.key}));return s.enter().append("rect").attr("class",n.shapeClass),s.transition().duration(this.animationDuration).style("fill",(function(t){return e.Treemap.getFill(t,o)})).style("fill-opacity",(function(t){return e.Treemap.getFillOpacity(t,a,r,o)})).attr(n.shapeLayout),s.exit().remove(),s},i.prototype.animateDefaultHighlightShapes=function(t,i,a,r,n){var o=!0,s=t.selectAll("."+e.Treemap.HighlightNodeClassName).data(i,(function(e){return e.key+"highlight"}));return s.enter().append("rect").attr("class",n.highlightShapeClass),s.transition().duration(this.animationDuration).style("fill",(function(t){return e.Treemap.getFill(t,o)})).style("fill-opacity",(function(t){return e.Treemap.getFillOpacity(t,a,r,o)})).attr(n.highlightShapeLayout),s.exit().remove(),s},i.prototype.animateDefaultMajorLabels=function(t,i,a,r){var n=t.selectAll("."+e.Treemap.MajorLabelClassName).data(i,(function(e){return e.key}));return n.enter().append("text").attr("class",r.majorLabelClass),n.text(r.majorLabelText).style("fill",(function(){return a.labelColor})).transition().duration(this.animationDuration).attr(r.majorLabelLayout),n.exit().remove(),n},i.prototype.animateDefaultMinorLabels=function(t,i,a,r){var n=t.selectAll("."+e.Treemap.MinorLabelClassName).data(i,(function(e){return e.key}));return n.enter().append("text").attr("class",r.minorLabelClass),n.text(r.minorLabelText).style("fill",(function(){return a.labelColor})).transition().duration(this.animationDuration).attr(r.minorLabelLayout),n.exit().remove(),n},i})(e.BaseAnimator);e.WebTreemapAnimator=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.StandardObjectProperties={axisEnd:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),description:e.data.createDisplayNameGetter("Visual_Axis_EndDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{variant:[{numeric:!0},{dateTime:!0}]},suppressFormatPainterCopy:!0},axisScale:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Scale"),type:{enumeration:t.axisScale.type}},axisStart:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),description:e.data.createDisplayNameGetter("Visual_Axis_StartDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{variant:[{numeric:!0},{dateTime:!0}]},suppressFormatPainterCopy:!0},axisStyle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Style"),type:{enumeration:t.axisStyle.type}},axisType:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Type"),type:{enumeration:t.axisType.type}},backColor:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColor"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColor_Desc"),type:{fill:{solid:{color:!0}}}},dataColor:{displayName:e.data.createDisplayNameGetter("Visual_LabelsFill"),description:e.data.createDisplayNameGetter("Visual_LabelsFillDescription"),type:{fill:{solid:{color:!0}}}},dataLabelColor:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Color"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Color_Description"),type:{fill:{solid:{color:!0}}}},dataLabelDecimalPoints:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Decimal_Points"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},dataLabelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}},suppressFormatPainterCopy:!0},dataLabelHorizontalPosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Horizontal_Position"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Horizontal_Position_Description"),type:{enumeration:t.referenceLineDataLabelHorizontalPosition.type}},dataLabelText:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Text"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Text_Description"),type:{enumeration:t.labelText.type}},dataLabelShow:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Show_Description"),type:{bool:!0}},dataLabelVerticalPosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Vertical_Position"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Data_Label_Vertical_Position_Description"),type:{enumeration:t.referenceLineDataLabelVerticalPosition.type}},defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_DefaultColor"),type:{fill:{solid:{color:!0}}}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},fontColor:{displayName:e.data.createDisplayNameGetter("Visual_FontColor"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColor_Desc"),type:{fill:{solid:{color:!0}}}},fontSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{formatting:{fontSize:!0}}},formatString:{type:{formatting:{formatString:!0}}},image:{type:{image:{}}},labelColor:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleColor"),type:{fill:{solid:{color:!0}}}},labelDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}}},labelPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),description:e.data.createDisplayNameGetter("Visual_PrecisionDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},legendPosition:{displayName:e.data.createDisplayNameGetter("Visual_LegendPosition"),description:e.data.createDisplayNameGetter("Visual_LegendPositionDescription"),type:{enumeration:t.legendPosition.type}},legendTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendName"),description:e.data.createDisplayNameGetter("Visual_LegendNameDescription"),type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},titleColor:{displayName:e.data.createDisplayNameGetter("Visual_AxisTitleColor"),type:{fill:{solid:{color:!0}}}},titleFontSize:{displayName:e.data.createDisplayNameGetter("Visual_AxisTitleTextSize"),type:{formatting:{fontSize:!0}}},outline:{displayName:e.data.createDisplayNameGetter("Visual_Outline"),type:{enumeration:t.outline.type}},outlineColor:{displayName:e.data.createDisplayNameGetter("Visual_OutlineColor"),description:e.data.createDisplayNameGetter("Visual_OutlineColor_Desc"),type:{fill:{solid:{color:!0}}}},outlineWeight:{displayName:e.data.createDisplayNameGetter("Visual_OutlineWeight"),description:e.data.createDisplayNameGetter("Visual_OutlineWeight_Desc"),type:{numeric:!0}},referenceLinePosition:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Arrange"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Arrange_Description"),type:{enumeration:t.referenceLinePosition.type}},referenceLineStyle:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},show:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},showAllDataPoints:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint_Show_All"),type:{bool:!0}},showLegendTitle:{displayName:e.data.createDisplayNameGetter("Visual_LegendShowTitle"),description:e.data.createDisplayNameGetter("Visual_LegendShowTitleDescription"),type:{bool:!0}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Background_Transparency"),description:e.data.createDisplayNameGetter("Visual_Background_TransparencyDescription"),type:{numeric:!0}},yAxisPosition:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),description:e.data.createDisplayNameGetter("Visual_YAxis_PositionDescription"),type:{enumeration:t.yAxisPosition.type}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.animatedTextObjectDescs={general:{properties:{formatString:e.StandardObjectProperties.formatString}}},e.animatedNumberCapabilities={objects:e.animatedTextObjectDescs,dataViewMappings:[{single:{role:"Values"}}],supportsSelection:!1}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.basicShapeCapabilities={objects:{line:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Line"),properties:{lineColor:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_LineColor"),type:{fill:{solid:{color:!0}}}},transparency:t.StandardObjectProperties.transparency,weight:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Weight"),type:{numeric:!0}},roundEdge:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_RoundEdges"),type:{numeric:!0}}}},fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),properties:{show:t.StandardObjectProperties.show,fillColor:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_FillColor"),type:{fill:{solid:{color:!0}}}},transparency:t.StandardObjectProperties.transparency}},rotation:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Rotate"),properties:{angle:{displayName:e.data.createDisplayNameGetter("Visual_BasicShape_Rotate"),type:{numeric:!0}}}},general:{properties:{shapeType:{type:{text:!0},suppressFormatPainterCopy:!0}}}},suppressDefaultTitle:!0,suppressDefaultPadding:!0,canRotate:!1,supportsSelection:!1},t.basicShapeProps={general:{shapeType:{objectName:"general",propertyName:"shapeType"}},line:{transparency:{objectName:"line",propertyName:"transparency"},weight:{objectName:"line",propertyName:"weight"},roundEdge:{objectName:"line",propertyName:"roundEdge"},lineColor:{objectName:"line",propertyName:"lineColor"}},fill:{transparency:{objectName:"fill",propertyName:"transparency"},fillColor:{objectName:"fill",propertyName:"fillColor"},show:{objectName:"fill",propertyName:"show"}},rotation:{angle:{objectName:"rotation",propertyName:"angle"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(i,a){void 0===i&&(i=!1),void 0===a&&(a=!1);var r={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}],joinPredicate:0},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:i?e.data.createDisplayNameGetter("Visual_YAxis"):e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:i?e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"):e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,concatenateLabels:{displayName:e.data.createDisplayNameGetter("Visual_Axis_ConcatenateLabels"),description:e.data.createDisplayNameGetter("Visual_Axis_ConcatenateLabelsDescription"),type:{bool:!0}},titleColor:t.StandardObjectProperties.titleColor}},valueAxis:{displayName:i?e.data.createDisplayNameGetter("Visual_XAxis"):e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,intersection:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Intersection"),type:{numeric:!0},placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto")},showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:i?e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"):e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,showSeries:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),labelOrientation:{displayName:e.data.createDisplayNameGetter("Visual_LabelOrientation"),type:{enumeration:t.labelOrientation.type}},labelPosition:{displayName:e.data.createDisplayNameGetter("Visual_Position"),type:{enumeration:t.labelPosition.type}},showAll:{displayName:e.data.createDisplayNameGetter("Visual_LabelSeriesShowAll"),type:{bool:!0}},fontSize:t.StandardObjectProperties.fontSize,labelDensity:{displayName:e.data.createDisplayNameGetter("Visual_LabelDensity"),type:{formatting:{labelDensity:!0}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),suppressFormatPainterCopy:!0,properties:{show:{type:{bool:!0}},displayName:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName_Description"),type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),type:{bool:!0}}}},filters:{properties:{filteredToUniqueValue:{type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0},Gradient:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},Y:{min:0,max:1},Gradient:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{window:{count:100}}},values:{group:{by:"Series",select:[{for:{in:"Y"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{count:60}}}},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0},Gradient:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Gradient:{max:0}},{Category:{max:1},Series:{max:0},Y:{min:0,max:1},Gradient:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{for:{in:"regression.X"}},values:{group:{by:"regression.Series",select:[{for:{in:"regression.Y"}}]}}}}],supportsHighlight:!0,sorting:{default:{}},drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},Y:{min:1,max:1},Series:{max:0},Gradient:{max:0}},groupingTargetRole:"Series",kind:0},{condition:{Category:{min:1,max:1},Y:{min:1},Series:{max:0},Gradient:{max:0}},groupingTargetRole:"Category",kind:1},{condition:{Category:{min:1,max:1},Y:{min:0,max:1},Series:{max:0},Gradient:{max:1}},groupingTargetRole:"Category",kind:1},{condition:{Category:{max:0},Y:{min:1,max:1},Series:{max:1},Gradient:{max:0}},groupingTargetRole:"Series",kind:0}]}};return a||(r.objects.referenceLine={displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,
dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}}),r}t.getColumnChartCapabilities=i,t.columnChartProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},general:{formatString:{objectName:"general",propertyName:"formatString"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(i){var a={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Category"),description:e.data.createDisplayNameGetter("Role_ComboChart_CategoryDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Series")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y"),description:e.data.createDisplayNameGetter("Role_ComboChart_YDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Y2",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_ComboChart_Y2"),description:e.data.createDisplayNameGetter("Role_ComboChart_Y2Description"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString,visualType1:{type:{text:!0}},visualType2:{type:{text:!0}}}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,axisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ColumnTitle"),type:{none:!0}},position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor,secShow:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_ShowSecondary"),type:{bool:!0}},secAxisLabel:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_LineTitle"),type:{none:!0}},secPosition:{displayName:e.data.createDisplayNameGetter("Visual_YAxis_Position"),type:{enumeration:t.yAxisPosition.type}},secAxisScale:t.StandardObjectProperties.axisScale,secStart:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Start"),description:e.data.createDisplayNameGetter("Visual_Axis_StartDescription"),type:{numeric:!0}},secEnd:{displayName:e.data.createDisplayNameGetter("Visual_Axis_End"),description:e.data.createDisplayNameGetter("Visual_Axis_EndDescription"),type:{numeric:!0}},secShowAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},secAxisStyle:t.StandardObjectProperties.axisStyle,secLabelColor:t.StandardObjectProperties.labelColor,secLabelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,secLabelPrecision:t.StandardObjectProperties.labelPrecision,secTitleColor:t.StandardObjectProperties.titleColor}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:$.extend({},t.StandardObjectProperties.defaultColor,{displayName:e.data.createDisplayNameGetter("Visual_DefaultColumnColor")}),showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize,labelDensity:{displayName:e.data.createDisplayNameGetter("Visual_LabelDensity"),type:{formatting:{labelDensity:!0}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{window:{count:100}}},values:{group:{by:"Series",select:[{for:{in:"Y"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{count:60}}}},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0},Y2:{min:1}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1},Y2:{min:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{window:{count:100}}},values:{select:[{for:{in:"Y2"}}]},rowCount:{preferred:{min:2},supported:{min:0}}}},{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{for:{in:"regression.X"}},values:{group:{by:"regression.Series",select:[{for:{in:"regression.Y"}}]}}}}],supportsHighlight:!0,sorting:{default:{}},drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},Y:{min:1,max:1},Series:{max:0},Gradient:{max:0}},groupingTargetRole:"Series",kind:0},{condition:{Category:{max:0},Y:{min:1,max:1},Series:{min:1,max:1},Gradient:{max:0}},groupingTargetRole:"Series",kind:0}]}};return i||(a.objects.trend={displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),properties:{show:{type:{bool:!0}},displayName:{type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),type:{bool:!0}}}}),a}t.getComboChartCapabilities=i,t.comboChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},valueAxis:{secShow:{objectName:"valueAxis",propertyName:"secShow"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},dataPoint:{showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.donutChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details"),description:e.data.createDisplayNameGetter("Role_DisplayName_DetailsDonutChartDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DetailLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:$.extend({},t.StandardObjectProperties.fontSize,{suppressFormatPainterCopy:!0}),labelStyle:{displayName:e.data.createDisplayNameGetter("Visual_LabelStyle"),type:{enumeration:t.labelStyle.type}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Y"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2},supported:{min:1}}}}],sorting:{default:{}},supportsHighlight:!0,drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},Y:{min:1,max:1},Series:{max:0}},groupingTargetRole:"Category",groupSourceTargetRole:"Series",kind:0},{condition:{Category:{min:1,max:1},Y:{min:1},Series:{max:0}},groupingTargetRole:"Category",kind:1},{condition:{Category:{max:0},Y:{min:1,max:1},Series:{max:1}},groupingTargetRole:"Series",kind:0}]}},t.donutChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.dataDotChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),requiredTypes:[{numeric:!0},{integer:!0}]}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{for:{in:"Y"}}]}}}]}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.filledMapCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),description:e.data.createDisplayNameGetter("Role_DisplayName_LocationFilledMapDescription"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LatitudeFilledMapDescription"),preferredTypes:[{geography:{latitude:!0}}]},{name:"X",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LongitudeFilledMapDescription"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),type:{fillRule:{}},rule:{conditions:[{Series:{max:0}}],inputRole:"Size",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),properties:{show:t.StandardObjectProperties.show}},mapControls:{displayName:e.data.createDisplayNameGetter("Visual_MapControls"),description:e.data.createDisplayNameGetter("Visual_MapControlsDescription"),properties:{autoZoom:{displayName:e.data.createDisplayNameGetter("Visual_AutoZoom"),type:{bool:!0}},zoomLevel:{type:{numeric:!0}},centerLatitude:{type:{numeric:!0}},centerLongitude:{type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Size",direction:2}]}},drilldown:{roles:["Category"]}},t.filledMapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}},labels:{show:{objectName:"labels",propertyName:"show"},color:{objectName:"labels",propertyName:"color"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}},mapControls:{autoZoom:{objectName:"mapControls",propertyName:"autoZoom"},zoomLevel:{objectName:"mapControls",propertyName:"zoomLevel"},centerLatitude:{objectName:"mapControls",propertyName:"centerLatitude"},centerLongitude:{objectName:"mapControls",propertyName:"centerLongitude"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.funnelChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group"),description:e.data.createDisplayNameGetter("Role_DisplayName_GroupFunnelDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}],joinPredicate:0},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],dataViewMappings:[{conditions:[{Category:{max:0},Gradient:{max:0}},{Category:{max:1},Y:{max:1},Gradient:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{for:{in:"Y"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}]},rowCount:{preferred:{min:1}}}}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelOptionsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelPosition:{displayName:e.data.createDisplayNameGetter("Visual_Position"),type:{enumeration:t.labelPosition.type},suppressFormatPainterCopy:!0},labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize}},percentBarLabel:{displayName:e.data.createDisplayNameGetter("Visual_PercentBarLabel"),description:e.data.createDisplayNameGetter("Visual_PercentBarLabelDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}}},supportsHighlight:!0,sorting:{default:{}},drilldown:{roles:["Category"]}},t.funnelChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.gaugeRoleNames={y:"Y",minValue:"MinValue",maxValue:"MaxValue",targetValue:"TargetValue"},t.gaugeCapabilities={dataRoles:[{name:t.gaugeRoleNames.y,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Value"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.minValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MinValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_MinValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.maxValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_MaxValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_MaxValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:t.gaugeRoleNames.targetValue,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_TargetValue"),description:e.data.createDisplayNameGetter("Role_DisplayName_TargetValueDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},axis:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis"),properties:{min:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Min"),type:{numeric:!0}},max:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Max"),type:{numeric:!0}},target:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Target"),type:{numeric:!0}}}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),properties:{fill:t.StandardObjectProperties.fill,target:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_Axis_Target"),type:{fill:{solid:{color:!0}}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,fontSize:t.StandardObjectProperties.fontSize}},calloutValue:{displayName:e.data.createDisplayNameGetter("Visual_Gauge_CalloutValue"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}}},dataViewMappings:[{conditions:[{Y:{max:1},MinValue:{max:1},MaxValue:{max:1},TargetValue:{max:1}}],categorical:{values:{select:[{bind:{to:"Y"}},{bind:{to:"MinValue"}},{bind:{to:"MaxValue"}},{bind:{to:"TargetValue"}},{for:{in:"Tooltips"}}]}}}],supportsSelection:!1},t.gaugeProps={dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"},target:{objectName:"dataPoint",propertyName:"target"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.imageVisualCapabilities={objects:{general:{properties:{imageUrl:{type:{misc:{imageUrl:!0}},suppressFormatPainterCopy:!0}}},imageScaling:{displayName:e.data.createDisplayNameGetter("Visual_Image_Scaling_Type"),properties:{imageScalingType:{displayName:e.data.createDisplayNameGetter("Visual_Image_Scaling_Type"),type:{enumeration:t.imageScalingType.type}}}}},suppressDefaultTitle:!0,supportsSelection:!1}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.realTimeLineChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription"),requiredTypes:[{numeric:!0},{dateTime:!0}],cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,duration:{type:{numeric:!0}}}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,showSeries:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),showAll:{displayName:e.data.createDisplayNameGetter("Visual_LabelSeriesShowAll"),type:{bool:!0}},fontSize:t.StandardObjectProperties.fontSize,labelDensity:{displayName:e.data.createDisplayNameGetter("Visual_LabelDensity"),type:{formatting:{labelDensity:!0}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{for:{in:"Y"}}],dataReductionAlgorithm:{top:{}}}}}}],sorting:{implicit:{clauses:[{role:"Category",direction:1}]}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.scriptVisualCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],dataViewMappings:[{scriptResult:{dataInput:{table:{rows:{for:{in:"Values"},dataReductionAlgorithm:{top:{}}}}},script:{source:{objectName:"script",propertyName:"source"},provider:{objectName:"script",propertyName:"provider"}}}}],objects:{script:{properties:{provider:{type:{text:!0}},source:{type:{scripting:{source:!0}}}}}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,
window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.consoleWriterCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YDescription")}],dataViewMappings:[{categorical:{categories:{for:{in:"Category"}}}}]}})(i=t.samples||(t.samples={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.converter=function(e){return window.console.log("converter"),window.console.log(e),{}},e.prototype.init=function(e){var t=d3.select(e.element.get(0)).append("div");t.append("h1").text("ConsoleWriter"),t.append("p").text("This IVisual writes messages passed to it to the javscript console output. Check your console for the actual messages passed. For more information, click below");var i=t.append("a");i.attr("href","http://microsoft.github.io/PowerBI-visuals/modules/powerbi.html").text("Online help"),window.console.log("init"),window.console.log(e)},e.prototype.onResizing=function(e){},e.prototype.update=function(e){window.console.log("update"),window.console.log(e)},e})();e.ConsoleWriter=t})(t=e.samples||(e.samples={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.cartesianRoleNames={category:"Category",series:"Series",y:"Y",gradient:"Gradient",tooltips:"Tooltips"},t.cartesianChartProps={scalarKey:{scalarKeyMin:e.data.scalarKeyMinPropertyIdentifier},filters:{filteredToUniqueValue:{objectName:"filters",propertyName:"filteredToUniqueValue"}},categoryAxis:{concatenateLabels:{objectName:"categoryAxis",propertyName:"concatenateLabels"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(i,a){var r={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription"),cartesianKind:0},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,axisType:t.StandardObjectProperties.axisType,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,concatenateLabels:{displayName:e.data.createDisplayNameGetter("Visual_Axis_ConcatenateLabels"),description:e.data.createDisplayNameGetter("Visual_Axis_ConcatenateLabelsDescription"),type:{bool:!0}},titleColor:t.StandardObjectProperties.titleColor}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,fill:t.StandardObjectProperties.fill}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,showSeries:{displayName:e.data.createDisplayNameGetter("Visual_Show"),type:{bool:!0}},color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),showAll:{displayName:e.data.createDisplayNameGetter("Visual_LabelSeriesShowAll"),type:{bool:!0}},fontSize:t.StandardObjectProperties.fontSize,labelDensity:{displayName:e.data.createDisplayNameGetter("Visual_LabelDensity"),type:{formatting:{labelDensity:!0}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName_Description"),type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}},useHighlightValues:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_UseHighlightValues_Description"),type:{bool:!0}}}},scalarKey:{properties:{min:{type:{dateTime:!0}}}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},filters:{properties:{filteredToUniqueValue:{type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{window:{count:100}}},values:{group:{by:"Series",select:[{for:{in:"Y"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{count:60}}}}}},{conditions:[{Category:{max:1},Series:{max:0}},{Category:{max:1},Series:{min:1,max:1},Y:{max:1}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{for:{in:"regression.X"}},values:{group:{by:"regression.Series",select:[{for:{in:"regression.Y"}}]}}}},{conditions:[{Category:{max:1},Series:{max:0},Y:{max:1}}],requiredProperties:[{objectName:"forecast",propertyName:"show"}],usage:{forecast:{}},categorical:{categories:{for:{in:"Category"}},values:{group:{by:"Series",select:[{for:{in:"forecast.ForecastValue"}},{for:{in:"forecast.ConfidenceHighBound"}},{for:{in:"forecast.ConfidenceLowBound"}}]}}}}],sorting:{default:{}},drilldown:{roles:["Category"]}};return i||(r.objects.referenceLine={displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}}),i||a||(r.objects.forecast={displayName:e.data.createDisplayNameGetter("Visual_Forecast"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Forecast_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Forecast_DisplayName_Description"),type:{text:!0}},confidenceBandStyle:{displayName:e.data.createDisplayNameGetter("Visual_Forecast_Confidence_Band_Style"),description:e.data.createDisplayNameGetter("Visual_Forecast_Confidence_Band_Style_Description"),type:{enumeration:t.confidenceBandStyle.type}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Forecast_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Forecast_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:t.StandardObjectProperties.transparency,style:t.StandardObjectProperties.referenceLineStyle,transform:{type:{queryTransform:{}}}}}),r}t.getLineChartCapabilities=i,t.lineChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},trend:{show:{objectName:"trend",propertyName:"show"}},forecast:{show:{objectName:"forecast",propertyName:"show"}},categoryAxis:{axisType:{objectName:"categoryAxis",propertyName:"axisType"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},labels:{labelDensity:{objectName:"labels",propertyName:"labelDensity"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(t,i,a){if(!i)return t;var r=e.Prototype.inherit(t);return r.capabilities=e.Prototype.inherit(t.capabilities),r.capabilities.dataViewMappings=_.map(t.capabilities.dataViewMappings,(function(e){return _.cloneDeep(e)})),a?(r.capabilities.dataViewMappings[0].conditions=[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{min:1,max:1}},{Category:{max:1},Series:{max:1},X:{min:1,max:1},Y:{max:1},Size:{max:1}},{Category:{max:1},Series:{max:1},X:{max:1},Y:{min:1,max:1},Size:{max:1}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1}}],r.capabilities.dataViewMappings.push({conditions:[{Category:{max:1},Series:{max:1,min:1},X:{max:0},Y:{max:0},Size:{max:0}}],matrix:{rows:{select:[{bind:{to:"Series"}},{composite:[{for:{in:"Category"}}]}],dataReductionAlgorithm:{top:{}}},dataVolume:4}})):(r.capabilities.dataViewMappings[0].conditions=[{Category:{min:1,max:1},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1,min:1},Gradient:{max:0}},{Category:{min:1,max:1},Series:{max:1},X:{max:1,min:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:0}},{Category:{min:1,max:1},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,min:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:0}},{Category:{min:1,max:1},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:0},Tooltips:{min:1}},{Category:{min:1,max:1},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:1}}],r.capabilities.dataViewMappings[1].conditions=[{Category:{max:0},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1,min:1},Gradient:{max:0}},{Category:{max:0},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:0},Tooltips:{min:1}},{Category:{max:0},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:1}}],r.capabilities.dataViewMappings.push({conditions:[{Category:{max:1,min:1},Series:{max:1,min:1},X:{max:0},Y:{max:0},Size:{max:0},Gradient:{max:0},Tooltips:{max:0}}],matrix:{rows:{select:[{bind:{to:"Series"}},{composite:[{for:{in:"Category"}}]}],dataReductionAlgorithm:{top:{}}},dataVolume:4}}),r.capabilities.dataViewMappings.push({conditions:[{Category:{max:0},Series:{max:1,min:1},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:0},Gradient:{max:0},Tooltips:{max:0}}],matrix:{rows:{select:[{bind:{to:"Series"}},{composite:[{bind:{to:"X"}},{bind:{to:"Y"}}]}],dataReductionAlgorithm:{top:{}}},dataVolume:4}})),r}t.mapCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),description:e.data.createDisplayNameGetter("Role_DisplayName_LocationMapDescription"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"Y",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Latitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LatitudeMapDescription"),preferredTypes:[{geography:{latitude:!0}}]},{name:"X",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Longitude"),description:e.data.createDisplayNameGetter("Role_DisplayName_LongitudeMapDescription"),preferredTypes:[{geography:{longitude:!0}}]},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Size"),description:e.data.createDisplayNameGetter("Role_DisplayName_SizeDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}],joinPredicate:0},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category","X","Y"]}}}}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},bubbles:{displayName:e.data.createDisplayNameGetter("Visual_Bubbles"),description:e.data.createDisplayNameGetter("Visual_BubblesDescription"),properties:{bubbleSize:{displayName:e.data.createDisplayNameGetter("Visual_BubbleSize"),type:{formatting:{bubbleSize:!0}}}}},mapControls:{displayName:e.data.createDisplayNameGetter("Visual_MapControls"),description:e.data.createDisplayNameGetter("Visual_MapControlsDescription"),properties:{autoZoom:{displayName:e.data.createDisplayNameGetter("Visual_AutoZoom"),type:{bool:!0}},zoomLevel:{type:{numeric:!0}},centerLatitude:{type:{numeric:!0}},centerLongitude:{type:{numeric:!0}}}}},dataViewMappings:[{conditions:[{Category:{min:1,max:1},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:0}},{Category:{min:1,max:1},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Measure},Y:{max:1,kind:e.VisualDataRoleKind.Measure},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}},{conditions:[{Category:{max:0},Series:{max:1},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:0}},{Category:{max:0},Series:{max:0},X:{max:1,kind:e.VisualDataRoleKind.Grouping},Y:{max:1,kind:e.VisualDataRoleKind.Grouping},Size:{max:1},Gradient:{max:1}}],categorical:{categories:{select:[{bind:{to:"X"}},{bind:{to:"Y"}}],dataReductionAlgorithm:{top:{}}},values:{group:{by:"Series",select:[{bind:{to:"Size"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Size",direction:2}]}},drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},X:{max:1},Y:{max:1},Gradient:{max:0}},groupingTargetRole:"Series",kind:0}]}},t.mapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}},bubbles:{bubbleSize:{objectName:"bubbles",propertyName:"bubbleSize"}},mapControls:{autoZoom:{objectName:"mapControls",propertyName:"autoZoom"},zoomLevel:{objectName:"mapControls",propertyName:"zoomLevel"},centerLatitude:{objectName:"mapControls",propertyName:"centerLatitude"},centerLongitude:{objectName:"mapControls",propertyName:"centerLongitude"}}},t.applyImprovedMapLegendMappings=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.multiRowCardCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldsDescription")}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},dataLabels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},cardTitle:{displayName:e.data.createDisplayNameGetter("Visual_CardTitle"),description:e.data.createDisplayNameGetter("Visual_CardTitleDescription"),properties:{color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},card:{displayName:e.data.createDisplayNameGetter("Card_ToolTip"),properties:{outline:{displayName:e.data.createDisplayNameGetter("Visual_Outline"),type:{enumeration:t.outline.type}},outlineColor:{displayName:e.data.createDisplayNameGetter("Visual_OutlineColor"),description:e.data.createDisplayNameGetter("Visual_OutlineColor_Desc"),type:{fill:{solid:{color:!0}}}},outlineWeight:{displayName:e.data.createDisplayNameGetter("Visual_OutlineWeight"),description:e.data.createDisplayNameGetter("Visual_OutlineWeight_Desc"),type:{numeric:!0}},barShow:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarShow"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarShow_Desc"),type:{bool:!0}},barColor:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarColor"),type:{fill:{solid:{color:!0}}}},barWeight:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarWeight"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_BarWeight_Desc"),type:{numeric:!0}},cardPadding:{displayName:e.data.createDisplayNameGetter("Visual_MultiRowCard_CardPadding"),description:e.data.createDisplayNameGetter("Visual_MultiRowCard_CardBackground"),type:{numeric:!0}},cardBackground:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{table:{rows:{for:{in:"Values"},dataReductionAlgorithm:{window:{}}},rowCount:{preferred:{min:1}}}}],sorting:{default:{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0},t.multiRowCardProps={card:{outline:{objectName:"card",propertyName:"outline"},outlineColor:{objectName:"card",propertyName:"outlineColor"},outlineWeight:{objectName:"card",propertyName:"outlineWeight"},barShow:{objectName:"card",propertyName:"barShow"},barColor:{objectName:"card",propertyName:"barColor"},barWeight:{objectName:"card",propertyName:"barWeight"},cardPadding:{objectName:"card",propertyName:"cardPadding"},cardBackground:{objectName:"card",propertyName:"cardBackground"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.textboxCapabilities={objects:{general:{properties:{paragraphs:{type:{paragraphs:{}},suppressFormatPainterCopy:!0}}}},suppressDefaultTitle:!0,supportsSelection:!1}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.cheerMeterCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Axis"),description:e.data.createDisplayNameGetter("Role_DisplayName_AxisDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,requiredTypes:[{numeric:!0},{integer:!0}],displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YDescription")}],dataViewMappings:[{categorical:{categories:{for:{in:"Category"}}}}],objects:{dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:t.StandardObjectProperties.fill}}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.scatterChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details"),description:e.data.createDisplayNameGetter("Role_DisplayName_DetailsScatterChartDescription")},{name:"Series",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:"X",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_X"),description:e.data.createDisplayNameGetter("Role_DisplayName_XScatterChartDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:0},{name:"Y",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y"),description:e.data.createDisplayNameGetter("Role_DisplayName_YScatterChartDescription"),requiredTypes:[{numeric:!0},{integer:!0}],cartesianKind:1},{name:"Size",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Size"),description:e.data.createDisplayNameGetter("Role_DisplayName_SizeDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}],joinPredicate:0},{name:"Play",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Play")},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,axisScale:t.StandardObjectProperties.axisScale,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),
description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Category"]}}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},trend:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_DisplayName_Description"),type:{text:!0}},lineColor:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Color"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Color_Description"),type:{fill:{solid:{color:!0}}}},transparency:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Transparency_Description"),type:{numeric:!0}},style:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Style"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Style_Description"),type:{enumeration:t.lineStyle.type}},combineSeries:{displayName:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series"),description:e.data.createDisplayNameGetter("Visual_Trend_Line_Combine_Series_Description"),type:{bool:!0}}}},xAxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_X"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Y"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},referenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),suppressFormatPainterCopy:!0,properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}},colorBorder:{displayName:e.data.createDisplayNameGetter("Visual_ColorBorder"),properties:{show:t.StandardObjectProperties.show}},fillPoint:{displayName:e.data.createDisplayNameGetter("Visual_FillPoint"),properties:{show:t.StandardObjectProperties.show}},colorByCategory:{displayName:e.data.createDisplayNameGetter("Visual_ColorByCategory"),properties:{show:t.StandardObjectProperties.show}},currentFrameIndex:{properties:{index:{type:{numeric:!0}}}},clustering:{suppressFormatPainterCopy:!0,properties:{transform:{type:{queryTransform:{}}}}}},dataViewMappings:[{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0},Play:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:1},Play:{max:0}}],categorical:{categories:{for:{in:"Category"}},values:{group:{by:"Series",select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}]}},rowCount:{preferred:{min:2}},dataReductionAlgorithm:{sample:{}},dataVolume:4}},{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:1},Gradient:{max:0},Play:{min:1,max:1}}],matrix:{rows:{select:[{bind:{to:"Play"}},{bind:{to:"Category"}}],dataReductionAlgorithm:{bottom:{count:5e3}}},columns:{for:{in:"Series"},dataReductionAlgorithm:{top:{count:60}}},values:{select:[{bind:{to:"X"}},{bind:{to:"Y"}},{bind:{to:"Size"}},{for:{in:"Tooltips"}}]}}},{conditions:[{Category:{max:1},Series:{max:1},X:{max:1},Y:{max:1},Size:{max:0},Gradient:{max:0},Play:{max:0}},{Category:{max:1},Series:{max:0},X:{max:1},Y:{max:1},Size:{max:0},Gradient:{max:1},Play:{max:0}}],requiredProperties:[{objectName:"trend",propertyName:"show"}],usage:{regression:{combineSeries:{objectName:"trend",propertyName:"combineSeries"}}},categorical:{categories:{for:{in:"regression.X"}},values:{group:{by:"regression.Series",select:[{for:{in:"regression.Y"}}]}},dataReductionAlgorithm:{sample:{}},dataVolume:4}}],sorting:{custom:{},implicit:{clauses:[{role:"Play",direction:1}]}},drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},X:{min:1,max:1},Y:{min:1,max:1},Play:{max:1}},groupingTargetRole:"Category",kind:1},{condition:{Category:{min:1,max:1},X:{max:1},Y:{max:1},Play:{max:1}},groupingTargetRole:"Series",kind:0},{condition:{Category:{min:1,max:1},X:{min:1,max:1},Y:{min:1,max:1},Series:{max:0},Gradient:{max:1},Play:{max:1}},groupingTargetRole:"Category",kind:1}],cluster:{clusteringRole:"Series",conditions:[{Category:{min:1,max:1},X:{min:1,max:1},Y:{min:1,max:1},Series:{max:0},Size:{max:1},Gradient:{max:0},Play:{max:0}}]}}},t.scatterChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}},trend:{show:{objectName:"trend",propertyName:"show"}},colorBorder:{show:{objectName:"colorBorder",propertyName:"show"}},fillPoint:{show:{objectName:"fillPoint",propertyName:"show"}},colorByCategory:{show:{objectName:"colorByCategory",propertyName:"show"}},currentFrameIndex:{index:{objectName:"currentFrameIndex",propertyName:"index"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}},plotArea:{image:{objectName:"plotArea",propertyName:"image"},transparency:{objectName:"plotArea",propertyName:"transparency"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.slicerRoles={value:"Values"},t.slicerCapabilities={dataRoles:[{name:t.slicerRoles.value,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Field"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldDescription")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{filter:{type:{filter:{}}},selfFilter:{type:{filter:{selfFilter:!0}}},defaultValue:{type:{expression:{defaultValue:!0}}},formatString:t.StandardObjectProperties.formatString,outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,orientation:{displayName:e.data.createDisplayNameGetter("Slicer_Orientation"),type:{enumeration:t.slicerOrientation.type}},count:{type:{integer:!0}},selfFilterEnabled:{type:{operations:{searchEnabled:!0}}}}},data:{properties:{startDate:{type:{dateTime:!0}},endDate:{type:{dateTime:!0}},mode:{type:{enumeration:t.slicerMode.type}}}},selection:{displayName:e.data.createDisplayNameGetter("Visual_SelectionControls"),properties:{selectAllCheckboxEnabled:{displayName:e.data.createDisplayNameGetter("Visual_SelectAll"),type:{bool:!0}},singleSelect:{displayName:e.data.createDisplayNameGetter("Visual_SingleSelect"),type:{bool:!0}}}},header:{displayName:e.data.createDisplayNameGetter("Visual_Header"),properties:{show:t.StandardObjectProperties.show,fontColor:t.StandardObjectProperties.fontColor,background:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}},outline:t.StandardObjectProperties.outline,textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},items:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Items"),properties:{fontColor:t.StandardObjectProperties.fontColor,background:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}},outline:t.StandardObjectProperties.outline,textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},date:{displayName:e.data.createDisplayNameGetter("Slicer_DateInputs"),properties:{fontColor:t.StandardObjectProperties.fontColor,textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}},background:{displayName:e.data.createDisplayNameGetter("Visual_Background"),type:{fill:{solid:{color:!0}}}}}},slider:{displayName:e.data.createDisplayNameGetter("Slicer_Slider"),properties:{show:t.StandardObjectProperties.show,color:{displayName:e.data.createDisplayNameGetter("Visual_LegendTitleColor"),type:{fill:{solid:{color:!0}}}}}}},dataViewMappings:[{conditions:[(i={},i[t.slicerRoles.value]={max:1},i)],categorical:{categories:{for:{in:t.slicerRoles.value},dataReductionAlgorithm:{window:{}}},includeEmptyGroups:!0}}],sorting:{default:{}},suppressDefaultTitle:!0,disableVisualDetails:!0},t.slicerProps={general:{filter:{objectName:"general",propertyName:"filter"},outlineColor:{objectName:"general",propertyName:"outlineColor"},outlineWeight:{objectName:"general",propertyName:"outlineWeight"},orientation:{objectName:"general",propertyName:"orientation"},count:{objectName:"general",propertyName:"count"},selfFilterEnabled:{objectName:"general",propertyName:"selfFilterEnabled"}},data:{startDate:{objectName:"data",propertyName:"startDate"},endDate:{objectName:"data",propertyName:"endDate"},mode:{objectName:"data",propertyName:"mode"}},selection:{selectAllCheckboxEnabled:{objectName:"selection",propertyName:"selectAllCheckboxEnabled"},singleSelect:{objectName:"selection",propertyName:"singleSelect"}},header:{show:{objectName:"header",propertyName:"show"},fontColor:{objectName:"header",propertyName:"fontColor"},background:{objectName:"header",propertyName:"background"},outline:{objectName:"header",propertyName:"outline"},textSize:{objectName:"header",propertyName:"textSize"}},items:{fontColor:{objectName:"items",propertyName:"fontColor"},background:{objectName:"items",propertyName:"background"},outline:{objectName:"items",propertyName:"outline"},textSize:{objectName:"items",propertyName:"textSize"}},date:{fontColor:{objectName:"date",propertyName:"fontColor"},textSize:{objectName:"date",propertyName:"textSize"},background:{objectName:"date",propertyName:"background"}},slider:{show:{objectName:"slider",propertyName:"show"},color:{objectName:"slider",propertyName:"color"}},filterPropertyIdentifier:{objectName:"general",propertyName:"filter"},selfFilterPropertyIdentifier:{objectName:"general",propertyName:"selfFilter"},formatString:{objectName:"general",propertyName:"formatString"},defaultValue:{objectName:"general",propertyName:"defaultValue"}};var i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.tableCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString,columnWidth:{type:{numeric:!0}},totals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Totals"),suppressFormatPainterCopy:!0},autoSizeColumnWidth:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Adjust_Column_Width"),suppressFormatPainterCopy:!0},textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},grid:{displayName:e.data.createDisplayNameGetter("Visual_Grid"),properties:{outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,gridVertical:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Desc"),type:{bool:!0}},gridVerticalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Color"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridVerticalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Weight"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Weight_Desc"),type:{numeric:!0}},gridHorizontal:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Desc"),type:{bool:!0}},gridHorizontalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridHorizontalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight_Desc"),type:{numeric:!0}},rowPadding:{displayName:e.data.createDisplayNameGetter("Visual_RowPadding"),description:e.data.createDisplayNameGetter("Visual_RowPadding_Desc"),type:{numeric:!0}},imageHeight:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight"),description:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight_Desc"),type:{numeric:!0}}}},columnHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor,wordWrap:{displayName:e.data.createDisplayNameGetter("Visual_Word_Wrap"),type:{bool:!0}}}},values:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_Values"),properties:{outline:t.StandardObjectProperties.outline,backColor:{type:{fill:{solid:{color:!0}}}},fontColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},backColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},fontColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},backColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},urlIcon:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_UrlIcon"),description:e.data.createDisplayNameGetter("Visual_Tablix_UrlIcon_Desc"),type:{bool:!0}}}},total:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_TotalGrand"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},columnFormatting:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting"),properties:{fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor,styleHeader:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorHeader"),type:{bool:!0}},styleValues:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorValues"),type:{bool:!0}},styleTotal:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorTotal"),type:{bool:!0}}}},clustering:{suppressFormatPainterCopy:!0,properties:{transform:{type:{queryTransform:{}}}}}},dataViewMappings:[{table:{rows:{for:{in:"Values"},dataReductionAlgorithm:{window:{count:500}}},rowCount:{preferred:{min:1}}}}],sorting:{custom:{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0,grouping:{cluster:{clusteringRole:"Values",conditions:[{Values:{min:2}}]}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.matrixRoleNames={rows:"Rows",columns:"Columns",values:"Values"},t.matrixCapabilities={dataRoles:[{name:t.matrixRoleNames.rows,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Rows"),description:e.data.createDisplayNameGetter("Role_DisplayName_RowsDescription")},{name:t.matrixRoleNames.columns,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Columns"),description:e.data.createDisplayNameGetter("Role_DisplayName_ColumnsDescription")},{name:t.matrixRoleNames.values,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString,columnWidth:{type:{numeric:!0}},rowSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_TotalRow"),suppressFormatPainterCopy:!0},columnSubtotals:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_TotalColumn"),suppressFormatPainterCopy:!0},autoSizeColumnWidth:{type:{bool:!0},displayName:e.data.createDisplayNameGetter("Visual_Adjust_Column_Width"),suppressFormatPainterCopy:!0},textSize:{displayName:e.data.createDisplayNameGetter("Visual_TextSize"),type:{numeric:!0}}}},grid:{displayName:e.data.createDisplayNameGetter("Visual_Grid"),properties:{outlineColor:t.StandardObjectProperties.outlineColor,outlineWeight:t.StandardObjectProperties.outlineWeight,gridVertical:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Desc"),type:{bool:!0}},gridVerticalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Color"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridVerticalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridVertical_Weight"),description:e.data.createDisplayNameGetter("Visual_GridVertical_Weight_Desc"),type:{numeric:!0}},gridHorizontal:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Desc"),type:{bool:!0}},gridHorizontalColor:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Color_Desc"),type:{fill:{solid:{color:!0}}}},gridHorizontalWeight:{displayName:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight"),description:e.data.createDisplayNameGetter("Visual_GridHorizontal_Weight_Desc"),type:{numeric:!0}},rowPadding:{displayName:e.data.createDisplayNameGetter("Visual_RowPadding"),description:e.data.createDisplayNameGetter("Visual_RowPadding_Desc"),type:{numeric:!0}},imageHeight:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight"),description:e.data.createDisplayNameGetter("Visual_Tablix_ImageHeight_Desc"),type:{numeric:!0}}}},columnHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},rowHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_RowHeaders"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},values:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_Values"),properties:{outline:t.StandardObjectProperties.outline,backColor:{type:{fill:{solid:{color:!0}}}},fontColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},backColorPrimary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorPrimary_Desc"),type:{fill:{solid:{color:!0}}}},fontColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_FontColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}},backColorSecondary:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary"),description:e.data.createDisplayNameGetter("Visual_Tablix_BackColorSecondary_Desc"),type:{fill:{solid:{color:!0}}}}}},subTotals:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_TotalSub"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor}},total:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_Matrix_TotalGrand"),properties:{outline:t.StandardObjectProperties.outline,fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor,applyToHeaders:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ApplyToHeaders"),type:{bool:!0}}}},columnFormatting:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting"),properties:{fontColor:t.StandardObjectProperties.fontColor,backColor:t.StandardObjectProperties.backColor,styleHeader:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorHeader"),type:{bool:!0}},styleValues:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorValues"),type:{bool:!0}},styleSubtotals:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorSubTotals"),type:{bool:!0}},styleTotal:{displayName:e.data.createDisplayNameGetter("Visual_Tablix_ColumnFormatting_ColorTotal"),type:{bool:!0}}}}},dataViewMappings:[{conditions:[{Rows:{max:0},Columns:{max:0},Values:{min:1}},{Rows:{min:1},Columns:{min:0},Values:{min:0}},{Rows:{min:0},Columns:{min:1},Values:{min:0}}],matrix:{rows:{for:{in:"Rows"},dataReductionAlgorithm:{window:{count:500}}},columns:{for:{in:"Columns"},dataReductionAlgorithm:{top:{count:100}}},values:{for:{in:"Values"}}}}],filterMappings:{measureFilter:{targetRoles:[t.matrixRoleNames.rows]}},sorting:{custom:{}},suppressDefaultTitle:!0,supportsSelection:!1,disableVisualDetails:!0}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.treemapRoles={group:"Group",details:"Details",values:"Values",gradient:"Gradient"},t.treemapCapabilities={dataRoles:[{name:"Group",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group"),description:e.data.createDisplayNameGetter("Role_DisplayName_GroupTreemapDescription")},{name:"Details",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Details")},{name:"Values",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:"Gradient",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}],joinPredicate:0},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:{type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Group"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Group:{max:1},Details:{max:0},Gradient:{max:1}},{Group:{max:1},Details:{min:1,max:1},Values:{max:1},Gradient:{max:0}}],categorical:{categories:{for:{in:"Group"},dataReductionAlgorithm:{top:{}}},values:{group:{by:"Details",select:[{bind:{to:"Values"}},{bind:{to:"Gradient"}},{for:{in:"Tooltips"}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],supportsHighlight:!0,sorting:{custom:{},implicit:{clauses:[{role:"Values",direction:2}]}},drilldown:{roles:["Group"]},grouping:{groupingRules:[{condition:{Group:{min:1,max:1},Details:{max:1},Values:{min:1,max:1},Gradient:{min:0}},groupingTargetRole:"Group",kind:1},{condition:{Group:{min:1,max:1},Details:{max:1},Values:{min:1,max:1},Gradient:{min:0}},groupingTargetRole:"Group",groupSourceTargetRole:"Details",kind:0},{condition:{Group:{min:1,max:1},Details:{min:0},Values:{min:1,max:1},Gradient:{min:1,max:1}},groupingTargetRole:"Group",kind:1}]}},t.treemapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}},labels:{show:{objectName:"labels",propertyName:"show"},color:{objectName:"labels",propertyName:"color"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.cardCapabilities={dataRoles:[{name:"Values",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Fields"),description:e.data.createDisplayNameGetter("Role_DisplayName_FieldsDescription")}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointLabel"),properties:{color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,fontSize:t.StandardObjectProperties.fontSize}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabel"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,fontSize:t.StandardObjectProperties.fontSize}},wordWrap:{displayName:e.data.createDisplayNameGetter("Visual_Word_Wrap"),
properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Values:{max:1}}],single:{role:"Values"}}],suppressDefaultTitle:!0,supportsSelection:!1},t.cardProps={categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"},color:{objectName:"categoryLabels",propertyName:"color"},fontSize:{objectName:"categoryLabels",propertyName:"fontSize"}},labels:{color:{objectName:"labels",propertyName:"color"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},fontSize:{objectName:"labels",propertyName:"fontSize"}},wordWrap:{show:{objectName:"wordWrap",propertyName:"show"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.waterfallChartCapabilities={dataRoles:[{name:"Category",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Category"),description:e.data.createDisplayNameGetter("Role_DisplayName_CategoryWaterfallDescription")},{name:"Y",kind:e.VisualDataRoleKind.Measure,requiredTypes:[{numeric:!0},{integer:!0}],displayName:e.data.createDisplayNameGetter("Role_DisplayName_Y")},{name:"Tooltips",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},categoryAxis:{displayName:e.data.createDisplayNameGetter("Visual_XAxis"),properties:{show:t.StandardObjectProperties.show,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_XTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,titleColor:t.StandardObjectProperties.titleColor}},valueAxis:{displayName:e.data.createDisplayNameGetter("Visual_YAxis"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.yAxisPosition,start:t.StandardObjectProperties.axisStart,end:t.StandardObjectProperties.axisEnd,showAxisTitle:{displayName:e.data.createDisplayNameGetter("Visual_Axis_Title"),description:e.data.createDisplayNameGetter("Visual_Axis_YTitleDescription"),type:{bool:!0}},axisStyle:t.StandardObjectProperties.axisStyle,labelColor:t.StandardObjectProperties.labelColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision,titleColor:t.StandardObjectProperties.titleColor}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits,labelPrecision:$.extend({},t.StandardObjectProperties.labelPrecision,{suppressFormatPainterCopy:!0}),fontSize:t.StandardObjectProperties.fontSize,labelOrientation:{displayName:e.data.createDisplayNameGetter("Visual_LabelOrientation"),type:{enumeration:t.labelOrientation.type}},labelPosition:{displayName:e.data.createDisplayNameGetter("Visual_Position"),type:{enumeration:t.labelPosition.type}}}},plotArea:{displayName:e.data.createDisplayNameGetter("Visual_Plot"),properties:{transparency:t.StandardObjectProperties.transparency,image:t.StandardObjectProperties.image}},sentimentColors:{displayName:e.data.createDisplayNameGetter("Waterfall_SentimentColors"),properties:{increaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_IncreaseLabel"),type:{fill:{solid:{color:!0}}}},decreaseFill:{displayName:e.data.createDisplayNameGetter("Waterfall_DecreaseLabel"),type:{fill:{solid:{color:!0}}}},totalFill:{displayName:e.data.createDisplayNameGetter("Waterfall_TotalLabel"),type:{fill:{solid:{color:!0}}}}}},y1AxisReferenceLine:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Description"),properties:{show:t.StandardObjectProperties.show,displayName:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_DisplayName_Description"),type:{text:!0}},value:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Value"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Value_Description"),type:{numeric:!0}},lineColor:t.StandardObjectProperties.lineColor,transparency:{displayName:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency"),description:e.data.createDisplayNameGetter("Visual_Reference_Line_Transparency_Description"),type:{numeric:!0}},style:t.StandardObjectProperties.referenceLineStyle,position:t.StandardObjectProperties.referenceLinePosition,dataLabelShow:t.StandardObjectProperties.dataLabelShow,dataLabelColor:t.StandardObjectProperties.dataLabelColor,dataLabelText:t.StandardObjectProperties.dataLabelText,dataLabelDecimalPoints:t.StandardObjectProperties.dataLabelDecimalPoints,dataLabelHorizontalPosition:t.StandardObjectProperties.dataLabelHorizontalPosition,dataLabelVerticalPosition:t.StandardObjectProperties.dataLabelVerticalPosition,dataLabelDisplayUnits:t.StandardObjectProperties.dataLabelDisplayUnits}}},dataViewMappings:[{conditions:[{Category:{max:1},Y:{max:1}}],categorical:{categories:{for:{in:"Category"},dataReductionAlgorithm:{top:{}}},values:{select:[{bind:{to:"Y"}},{for:{in:"Tooltips"}}]}}}],sorting:{default:{}},drilldown:{roles:["Category"]},grouping:{groupingRules:[{condition:{Category:{min:1,max:1},Y:{min:1,max:1}},groupingTargetRole:"Category",kind:1}]}},t.waterfallChartProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},sentimentColors:{increaseFill:{objectName:"sentimentColors",propertyName:"increaseFill"},decreaseFill:{objectName:"sentimentColors",propertyName:"decreaseFill"},totalFill:{objectName:"sentimentColors",propertyName:"totalFill"}},legend:{labelColor:{objectName:"legend",propertyName:"labelColor"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.sunburstCapabilities={dataRoles:[{name:"Nodes",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Group")},{name:"Values",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription")}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:t.StandardObjectProperties.legendTitle,labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:{type:{fill:{solid:{color:!0}}}},fillRule:{displayName:e.data.createDisplayNameGetter("Visual_Gradient"),type:{fillRule:{}},rule:{inputRole:"Gradient",output:{property:"fill",selector:["Group"]}}}}},labels:{displayName:e.data.createDisplayNameGetter("Visual_DataPointsLabels"),description:e.data.createDisplayNameGetter("Visual_DataPointsLabelsDescription"),properties:{show:t.StandardObjectProperties.show,color:t.StandardObjectProperties.dataColor,labelDisplayUnits:t.StandardObjectProperties.labelDisplayUnits,labelPrecision:t.StandardObjectProperties.labelPrecision}},categoryLabels:{displayName:e.data.createDisplayNameGetter("Visual_CategoryLabels"),description:e.data.createDisplayNameGetter("Visual_CategoryLabelsDescription"),properties:{show:t.StandardObjectProperties.show}}},dataViewMappings:[{conditions:[{Nodes:{min:0},Values:{max:1}}],matrix:{rows:{for:{in:"Nodes"}},columns:{for:{in:""}},values:{for:{in:"Values"}}}}],supportsHighlight:!0,sorting:{custom:{},implicit:{clauses:[{role:"Values",direction:2}]}}},t.sunburstProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},dataPoint:{fill:{objectName:"dataPoint",propertyName:"fill"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"},labelColor:{objectName:"legend",propertyName:"labelColor"}},labels:{show:{objectName:"labels",propertyName:"show"},color:{objectName:"labels",propertyName:"color"},labelDisplayUnits:{objectName:"labels",propertyName:"labelDisplayUnits"},labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}},categoryLabels:{show:{objectName:"categoryLabels",propertyName:"show"}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.bingNewsCapabilities={}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.bingSocialNewsCapabilities={dataViewMappings:[]}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.bingSocialTweetsCapabilities={dataViewMappings:[]}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.KPIStatusWithHistoryCapabilities={dataRoles:[{name:"Indicator",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Indicator"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_IndicatorDescription")},{name:"TrendLine",kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_TrendLine"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Trendline_Description")},{name:"Goal",kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goal"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_GoalDescription")}],dataViewMappings:[{conditions:[{Indicator:{max:1},TrendLine:{max:1},Goal:{max:2}}],categorical:{categories:{for:{in:"TrendLine"},dataReductionAlgorithm:{bottom:{}}},values:{select:[{bind:{to:"Indicator"}},{bind:{to:"Goal"}}]}}}],objects:{general:{properties:{formatString:t.StandardObjectProperties.formatString}},indicator:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Indicator"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_IndicatorDescription"),properties:{indicatorDisplayUnits:{displayName:e.data.createDisplayNameGetter("Visual_DisplayUnits"),description:e.data.createDisplayNameGetter("Visual_DisplayUnitsDescription"),type:{formatting:{labelDisplayUnits:!0}}},indicatorPrecision:{displayName:e.data.createDisplayNameGetter("Visual_Precision"),description:e.data.createDisplayNameGetter("Visual_PrecisionDescription"),placeHolderText:e.data.createDisplayNameGetter("Visual_Precision_Auto"),type:{numeric:!0}},kpiFormat:{displayName:e.data.createDisplayNameGetter("TaskPane_Format"),type:{text:!0}}}},trendline:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_TrendLine"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Trendline_Description"),properties:{show:t.StandardObjectProperties.show}},goals:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goals"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Goals"),properties:{showGoal:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Show_Goal"),type:{bool:!0}},showDistance:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Show_Distance"),type:{bool:!0}}}},status:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Color_Coding"),description:e.data.createDisplayNameGetter("Role_DisplayName_KPI_Color_Coding"),properties:{direction:{displayName:e.data.createDisplayNameGetter("Visual_KPI_Direction"),type:{enumeration:t.kpiDirection.type}},goodColor:{displayName:e.data.createDisplayNameGetter("Visual_KPI_Good_Color"),type:{fill:{solid:{color:!0}}}},neutralColor:{displayName:e.data.createDisplayNameGetter("Visual_KPI_Neutral_Color"),type:{fill:{solid:{color:!0}}}},badColor:{displayName:e.data.createDisplayNameGetter("Visual_KPI_Bad_Color"),type:{fill:{solid:{color:!0}}}}}}}}})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=t.ShapeMapType.Role;t.shapeMapCapabilities={dataRoles:[{name:i.category,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Location"),description:e.data.createDisplayNameGetter("Role_DisplayName_LocationMapDescription"),preferredTypes:[{geography:{address:!0}},{geography:{city:!0}},{geography:{continent:!0}},{geography:{country:!0}},{geography:{county:!0}},{geography:{place:!0}},{geography:{postalCode:!0}},{geography:{region:!0}},{geography:{stateOrProvince:!0}}]},{name:i.series,kind:e.VisualDataRoleKind.Grouping,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Legend"),description:e.data.createDisplayNameGetter("Role_DisplayName_LegendDescription")},{name:i.value,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Gradient"),description:e.data.createDisplayNameGetter("Role_DisplayName_GradientDescription"),requiredTypes:[{numeric:!0},{integer:!0}]},{name:i.tooltips,kind:e.VisualDataRoleKind.Measure,displayName:e.data.createDisplayNameGetter("Role_DisplayName_Tooltips"),joinPredicate:0}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{formatString:t.StandardObjectProperties.formatString}},legend:{displayName:e.data.createDisplayNameGetter("Visual_Legend"),description:e.data.createDisplayNameGetter("Visual_LegendDescription"),properties:{show:t.StandardObjectProperties.show,position:t.StandardObjectProperties.legendPosition,showTitle:t.StandardObjectProperties.showLegendTitle,titleText:$.extend({},t.StandardObjectProperties.legendTitle,{suppressFormatPainterCopy:!0}),labelColor:t.StandardObjectProperties.labelColor,fontSize:t.StandardObjectProperties.fontSize}},dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{defaultColor:t.StandardObjectProperties.defaultColor,showAllDataPoints:t.StandardObjectProperties.showAllDataPoints,fill:t.StandardObjectProperties.fill,fillRule:{displayName:e.data.createDisplayNameGetter("Role_DisplayName_Values"),description:e.data.createDisplayNameGetter("Role_DisplayName_ValuesDescription"),type:{fillRule:{}},rule:{conditions:[{Series:{max:0}}],inputRole:i.value,output:{property:"fill",selector:[i.category]}}}}},shape:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_Shape"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_Shape_Desc"),properties:{map:{type:{geoJson:{}}},projectionEnum:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_Projection"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_Projection_Desc"),type:{enumeration:t.ShapeMapType.Projection.type}}}},defaultColors:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultColor"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultColor_Desc"),properties:{defaultShow:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultShow"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultShow_Desc"),type:{bool:!0}},defaultColor:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultColorColor"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_DefaultColorColor_Desc"),type:{fill:{solid:{color:!0}}}},borderColor:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_BorderColor"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_BorderColor_Desc"),type:{fill:{solid:{color:!0}}}},borderThickness:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_BorderThickness"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_BorderThickness_Desc"),type:{numeric:!0}}}},zoom:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_Zoom"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_Zoom_Desc"),properties:{autoZoom:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_AutoZoom"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_AutoZoom_Desc"),type:{bool:!0}},selectionZoom:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_SelectionZoom"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_SelectionZoom_Desc"),type:{bool:!0}},manualZoom:{displayName:e.data.createDisplayNameGetter("Visual_ShapeMap_ManualZoom"),description:e.data.createDisplayNameGetter("Visual_ShapeMap_ManualZoom_Desc"),type:{bool:!0}}}}},dataViewMappings:[{conditions:[(a={},a[i.category]={min:0,max:1},a[i.series]={min:0,max:1},a[i.value]={min:0,max:1},a)],categorical:{categories:{for:{in:i.category},dataReductionAlgorithm:{top:{}}},values:{group:{by:i.series,select:[{bind:{to:i.value}},{for:{in:i.tooltips}}],dataReductionAlgorithm:{top:{}}}},rowCount:{preferred:{min:2}}}}],sorting:{custom:{},implicit:{clauses:[{role:i.value,direction:2}]}}},t.shapeMapProps={general:{formatString:{objectName:"general",propertyName:"formatString"}},legend:{show:{objectName:"legend",propertyName:"show"},position:{objectName:"legend",propertyName:"position"},showTitle:{objectName:"legend",propertyName:"showTitle"},titleText:{objectName:"legend",propertyName:"titleText"}},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},showAllDataPoints:{objectName:"dataPoint",propertyName:"showAllDataPoints"}},shape:{mapId:{objectName:"shape",propertyName:"mapId"},projectionEnum:{objectName:"shape",propertyName:"projectionEnum"},map:{objectName:"shape",propertyName:"map"}},zoom:{autoZoom:{objectName:"zoom",propertyName:"autoZoom"},selectionZoom:{objectName:"zoom",propertyName:"selectionZoom"},manualZoom:{objectName:"zoom",propertyName:"manualZoom"}},defaultColors:{defaultShow:{objectName:"defaultColors",propertyName:"defaultShow"},defaultColor:{objectName:"defaultColors",propertyName:"defaultColor"},borderColor:{objectName:"defaultColors",propertyName:"borderColor"},borderThickness:{objectName:"defaultColors",propertyName:"borderThickness"}}};var a})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){t.animatedNumber=e.visuals.animatedNumberCapabilities,t.areaChart=e.visuals.getLineChartCapabilities(!1,!0),t.barChart=e.visuals.getColumnChartCapabilities(!0,!0),t.card=e.visuals.cardCapabilities,t.multiRowCard=e.visuals.multiRowCardCapabilities,t.clusteredBarChart=e.visuals.getColumnChartCapabilities(!0),t.clusteredColumnChart=e.visuals.getColumnChartCapabilities(),t.columnChart=e.visuals.getColumnChartCapabilities(!1,!0),t.comboChart=e.visuals.getComboChartCapabilities(!1),t.dataDotChart=e.visuals.dataDotChartCapabilities,t.dataDotClusteredColumnComboChart=e.visuals.getComboChartCapabilities(!1),t.dataDotStackedColumnComboChart=e.visuals.getComboChartCapabilities(!0),t.donutChart=e.visuals.donutChartCapabilities,t.funnel=e.visuals.funnelChartCapabilities,t.gauge=e.visuals.gaugeCapabilities,t.hundredPercentStackedBarChart=e.visuals.getColumnChartCapabilities(!0,!0),t.hundredPercentStackedColumnChart=e.visuals.getColumnChartCapabilities(!1,!0),t.image=e.visuals.imageVisualCapabilities,t.lineChart=e.visuals.getLineChartCapabilities(!1,!1),t.stackedAreaChart=e.visuals.getLineChartCapabilities(!0,!0),t.lineStackedColumnComboChart=e.visuals.getComboChartCapabilities(!0),t.lineClusteredColumnComboChart=e.visuals.getComboChartCapabilities(!1),t.map=e.visuals.mapCapabilities,t.filledMap=e.visuals.filledMapCapabilities,t.shapeMap=e.visuals.shapeMapCapabilities,t.treemap=e.visuals.treemapCapabilities,t.pieChart=e.visuals.donutChartCapabilities,t.scatterChart=e.visuals.scatterChartCapabilities,t.table=e.visuals.tableCapabilities,t.matrix=e.visuals.matrixCapabilities,t.slicer=e.visuals.slicerCapabilities,t.textbox=e.visuals.textboxCapabilities,t.waterfallChart=e.visuals.waterfallChartCapabilities,t.cheerMeter=e.visuals.cheerMeterCapabilities,t.bingNews=e.visuals.bingNewsCapabilities,t.heatMap=e.visuals.mapCapabilities,t.sunburst=e.visuals.sunburstCapabilities,t.scriptVisual=e.visuals.scriptVisualCapabilities,t.kpi=e.visuals.KPIStatusWithHistoryCapabilities,t.realTimeLineChart=e.visuals.realTimeLineChartCapabilities})(i=t.capabilities||(t.capabilities={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(i,a){this.options=i;var r=i.eventGroup;r.on("click",(function(){var e=t.getDatumForLastInputEvent();a.handleSelection(e,d3.event.ctrlKey)})),r.on("contextmenu",(function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var i=t.getDatumForLastInputEvent(),r=e.InteractivityUtils.getPositionOfLastInputEvent();a.handleContextMenu(i,r)}}))},t.prototype.renderSelection=function(t){var i=this.options;i.bars.style("fill-opacity",(function(a){return e.ColumnUtil.getFillOpacity(a.selected,a.highlight,!a.highlight&&t,!a.selected&&i.hasHighlights)}))},t.getDatumForLastInputEvent=function(){var e=d3.event.target;return d3.select(e).datum()},t})();e.ColumnChartWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.dots=t.dots,r=t.dotLabels;e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),r&&e.InteractivityUtils.registerStandardInteractivityHandlers(r,i)},t.prototype.renderSelection=function(t){this.dots.style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)}))},t})();e.DataDotChartWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.slices=t.slices,r=this.highlightSlices=t.highlightSlices,n=t.clearCatcher;this.hasHighlights=t.hasHighlights;var o=function(e){i.handleSelection(e.data,d3.event.ctrlKey)},s=function(t){if(!d3.event.ctrlKey){var a=e.InteractivityUtils.getPositionOfLastInputEvent();i.handleContextMenu(t.data,a),d3.event.preventDefault()}};a.on("click",o),a.on("contextmenu",s),r&&(r.on("click",o),r.on("contextmenu",s)),n.on("click",(function(){i.handleClearSelection()}))},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.slices.style("fill-opacity",(function(a){return e.ColumnUtil.getFillOpacity(a.data.selected,!1,t,i&&!a.data.selected)})),this.highlightSlices&&this.highlightSlices.style("fill-opacity",(function(t){return e.ColumnUtil.getFillOpacity(t.data.selected,!0,!1,i)}))},t})();e.DonutChartWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bars=t.bars,r=this.interactors=t.interactors,n=t.clearCatcher;this.hasHighlights=t.hasHighlights,e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),e.InteractivityUtils.registerStandardInteractivityHandlers(r,i),n.on("click",(function(){i.handleClearSelection()}))},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.bars.style("fill-opacity",(function(a){return e.ColumnUtil.getFillOpacity(a.selected,a.highlight,!a.highlight&&t,!a.selected&&i)}))},t})();e.FunnelWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this;this.lines=t.lines;var r=t.interactivityLines,n=this.dots=t.dots,o=this.areas=t.areas,s=this.tooltipOverlay=t.tooltipOverlay,l=function(e){return a.getPointX(e)};r.on("click",(function(e,a){var r=t.getCategoryIndex(e,l(this)),n=_.find(e.data,(function(e){return e&&e.categoryIndex===r}));n?i.handleSelection(n,d3.event.ctrlKey):i.handleSelection({selected:e.selected,identity:e.identity,specificIdentity:t.categoryIdentities[r]},d3.event.ctrlKey)})),r.on("contextmenu",(function(a,r){if(!d3.event.ctrlKey){d3.event.preventDefault();var n=e.InteractivityUtils.getPositionOfLastInputEvent(),o=t.getCategoryIndex(a,l(this)),s=_.find(a.data,(function(e){return e&&e.categoryIndex===o}));s?i.handleContextMenu(s,n):i.handleContextMenu({selected:a.selected,identity:a.identity,specificIdentity:t.categoryIdentities[o]},n)}})),e.InteractivityUtils.registerStandardInteractivityHandlers(n,i),o&&e.InteractivityUtils.registerStandardInteractivityHandlers(o,i),s&&(_.isEmpty(t.categoryIdentities)?s.on("click",(function(){return i.handleClearSelection()})):(s.on("click",(function(){var e=t.getCategoryIndex(void 0,l(this));i.handleSelection({selected:!1,identity:void 0,specificIdentity:t.categoryIdentities[e]},d3.event.ctrlKey)})),s.on("contextmenu",(function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var a=e.InteractivityUtils.getPositionOfLastInputEvent(),r=t.getCategoryIndex(void 0,l(this));i.handleContextMenu({selected:!1,identity:void 0,specificIdentity:t.categoryIdentities[r]},a)}}))))},t.prototype.renderSelection=function(t){this.lines.style("stroke-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)})),this.dots.style("fill-opacity",(function(i){return e.ColumnUtil.getFillOpacity(i.selected,!1,t,!1)})),this.areas&&this.areas.style("fill-opacity",(function(i){return t&&!i.selected?e.LineChart.DimmedAreaFillOpacity:e.LineChart.AreaFillOpacity}))},t.prototype.getPointX=function(e){for(var t,i=d3.event;t=i.sourceEvent;)i=t;var a=e.getBoundingClientRect();return i.clientX-a.left-e.clientLeft},t})();e.LineChartWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=(function(){function i(){this.mapPointerEventsDisabled=!1,this.mapPointerTimeoutSet=!1,this.viewChangedSinceLastClearMouseDown=!1,this.receivedZoomOrPanEvent=!1}return i.prototype.bindEvents=function(i,a){var r=this,n=this.bubbles=i.bubbles,o=this.slices=i.slices,s=this.shapes=i.shapes,l=i.clearCatcher,u=function(){var t=d3.event;if(!e.visuals.EventBubblingUtil.handled(t)){var i=d3.event.target,r=d3.select(i).datum();null!=r&&(n&&n.style("pointer-events","all"),s&&s.style("pointer-events","all"),a.handleSelection(r,d3.event.ctrlKey))}};this.mapPointerEventsDisabled||(n&&n.style("pointer-events","all"),o&&o.style("pointer-events","all"),s&&s.style("pointer-events","all")),n&&(i.bubbleEventGroup.on("click",u),i.bubbleEventGroup.on("mousewheel",(function(){r.mapPointerEventsDisabled||n.style("pointer-events","none"),r.mapPointerEventsDisabled=!0,r.mapPointerTimeoutSet||(r.mapPointerTimeoutSet=!0,setTimeout((function(){n&&n.style("pointer-events","all"),r.mapPointerEventsDisabled=!1,r.mapPointerTimeoutSet=!1}),200))})),t.InteractivityUtils.registerGroupContextMenuHandler(i.bubbleEventGroup,a)),o&&(i.sliceEventGroup.on("click",(function(){o.style("pointer-events","all"),r.mapPointerEventsDisabled=!1;var e=d3.event.target,t=d3.select(e).datum();null!=t&&a.handleSelection(t.data,d3.event.ctrlKey)})),i.sliceEventGroup.on("mousewheel",(function(){r.mapPointerEventsDisabled||o.style("pointer-events","none"),r.mapPointerEventsDisabled=!0,r.mapPointerTimeoutSet||(r.mapPointerTimeoutSet=!0,setTimeout((function(){o&&o.style("pointer-events","all"),r.mapPointerEventsDisabled=!1,r.mapPointerTimeoutSet=!1}),200))})),i.sliceEventGroup.on("contextmenu",(function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var e=t.InteractivityUtils.getPositionOfLastInputEvent(),i=d3.event.target,r=d3.select(i).datum();a.handleContextMenu(r.data,e)}}))),s&&(i.shapeEventGroup.on("click",u),i.shapeEventGroup.on("mousewheel",(function(){r.mapPointerEventsDisabled||s.style("pointer-events","none"),r.mapPointerEventsDisabled=!0,r.mapPointerTimeoutSet||(r.mapPointerTimeoutSet=!0,setTimeout((function(){s&&s.style("pointer-events","all"),r.mapPointerEventsDisabled=!1,r.mapPointerTimeoutSet=!1}),200))})),t.InteractivityUtils.registerGroupContextMenuHandler(i.shapeEventGroup,a)),l.on("mouseup",(function(){r.viewChangedSinceLastClearMouseDown||(a.handleClearSelection(),r.receivedZoomOrPanEvent=!0)})),l.on("mousedown",(function(){r.viewChangedSinceLastClearMouseDown=!1})),l.on("mousewheel",(function(){r.receivedZoomOrPanEvent=!0}))},i.prototype.renderSelection=function(e){this.bubbles&&this.bubbles.style({"fill-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.selected,!1,e,!1)},"stroke-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.selected,!1,e,!1)}}),this.slices&&this.slices.style({"fill-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.data.selected,!1,e,!1)},"stroke-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.data.selected,!1,e,!1)}}),this.shapes&&this.shapes.style({"fill-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.selected,!1,e,!1)},"stroke-opacity":function(i){return t.ColumnUtil.getFillOpacity(i.selected,!1,e,!1)}})},i.prototype.viewChanged=function(){this.viewChangedSinceLastClearMouseDown=!0},i.prototype.resetZoomPan=function(){this.receivedZoomOrPanEvent=!1},i.prototype.hasReceivedZoomOrPanEvent=function(){return this.receivedZoomOrPanEvent},i})();t.MapBehavior=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,
window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.CssConstants.createClassAndSelector,i=a.PerfTimer,r=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bubbles=t.dataPointsSelection,r=t.data,n=t.eventGroup;!this.playOptions||!this.playOptions.traceLineRenderer||t.playOptions&&t.playOptions.traceLineRenderer||this.playOptions.traceLineRenderer.remove(),this.playOptions=t.playOptions,this.shouldEnableFill=(!r.sizeRange||!r.sizeRange.min)&&r.fillPoint,this.colorBorder=r.colorBorder,this.hitTester=new e.ScatterChartHitTester(t.data.dataPoints),this.selectionHandler=i,n?e.InteractivityUtils.registerGroupInteractivityHandlers(n,i):e.InteractivityUtils.registerStandardInteractivityHandlers(a,i)},t.prototype.renderSelection=function(t){var i=this.shouldEnableFill,a=this.colorBorder;if(this.bubbles.style({"fill-opacity":function(a){return e.ScatterChart.getMarkerFillOpacity(null!=a.size,i,t,a.selected)},"stroke-opacity":function(i){return e.ScatterChart.getMarkerStrokeOpacity(null!=i.size,a,t,i.selected)}}),this.playOptions&&this.bubbles){var r=this.bubbles.filter((function(e){return e.selected})).data(),n=this.playOptions.traceLineRenderer;r&&r.length>0&&null!=n?n.render(r,!0):n.remove()}},t.prototype.lassoSelect=function(e,t){var i=this.hitTester.queryRegion(t),a=0;e.ctrlKey?a=1:e.altKey?a=3:e.shiftKey&&(a=2),this.selectionHandler.handleMultipleSelection(i,a)},t})();e.ScatterChartWebBehavior=r;var n=(function(){function a(){}return a.prototype.bindEvents=function(e,t){this.setOptions(e),e.visualInitOptions&&e.visualInitOptions.interactivity.isInteractiveLegend&&(this.makeDataPointsSelectable(e.dataPointsSelection),this.makeRootSelectable(e.root),this.makeDragable(e.root),this.disableDefaultTouchInteractions(e.root),this.selectRoot())},a.prototype.renderSelection=function(e){},a.prototype.setSelectionHandler=function(e){},a.prototype.makeDataPointsSelectable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;a<r;a++){var n=t[a];n.on("click",(function(t,i){e.select(i)}))}},a.prototype.makeRootSelectable=function(e){var t=this;e.on("click",(function(e,i){t.selectRoot()}))},a.prototype.makeDragable=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];for(var a=0,r=t.length;a<r;a++){var n=t[a],o=d3.behavior.drag().on("drag",(function(t){e.drag(0)})).on("dragend",(function(t){e.drag(1)}));n.call(o)}},a.prototype.disableDefaultTouchInteractions=function(e){e.style("touch-action","none")},a.prototype.setOptions=function(e){this.data=e.data,this.mainGraphicsContext=e.plotContext,this.xAxisProperties=e.xAxisProperties,this.yAxisProperties=e.yAxisProperties,this.host=e.host},a.prototype.select=function(e){this.selectDotByIndex(e)},a.prototype.selectRoot=function(){var e=i.start("selectRoot");this.onClick(),e()},a.prototype.drag=function(e){switch(e){case 0:this.onDrag();break;case 1:this.onClick()}},a.prototype.onDrag=function(){var e=this.getMouseCoordinates();this.moveCrosshairToXY(e.x,e.y);var t=this.findClosestDotIndex(e.x,e.y);this.selectDot(t),this.updateLegend(t)},a.prototype.onClick=function(){var e=this.getMouseCoordinates(),t=this.findClosestDotIndex(e.x,e.y);t!==-1&&this.selectDotByIndex(t)},a.prototype.getMouseCoordinates=function(){var e=this.mainGraphicsContext,t=0,i=parseInt(e.attr("height"),10);i=i||0;try{var a=d3.mouse(e.node());t=a[0],i=a[1]}catch(e){}return{x:t,y:i}},a.prototype.selectDotByIndex=function(e){this.selectDot(e),this.moveCrosshairToIndexDot(e),this.updateLegend(e)},a.prototype.selectDot=function(e){var t=this,i=this.mainGraphicsContext;i.selectAll(a.ScatterChartCircleTagName+a.DotClassSelector).classed({selected:!1,notSelected:!0}),i.selectAll(a.ScatterChartCircleTagName+a.DotClassSelector).filter((function(i,a){var r=t.data.dataPoints,n=r[e];return i.x===n.x&&i.y===n.y})).classed({selected:!0,notSelected:!1})},a.prototype.moveCrosshairToIndexDot=function(e){var t=this.data.dataPoints,i=this.mainGraphicsContext,r=this.xAxisProperties.scale(t[e].x),n=this.yAxisProperties.scale(t[e].y);if(null==this.crosshair){var o=+i.attr("width"),s=+i.attr("height");this.crosshair=this.drawCrosshair(i,r,n,o,s),this.crosshairHorizontal=this.crosshair.select(a.Horizontal.selector),this.crosshairVertical=this.crosshair.select(a.Vertical.selector)}else this.moveCrosshairToXY(r,n)},a.prototype.moveCrosshairToXY=function(e,t){this.crosshairHorizontal.attr({y1:t,y2:t}),this.crosshairVertical.attr({x1:e,x2:e})},a.prototype.drawCrosshair=function(e,t,i,r,n){var o=e.append("g");return o.classed(a.CrosshairClassName,!0),o.append("line").classed(a.Horizontal.class,!0).attr({x1:0,x2:r,y1:i,y2:i}),o.append("line").classed(a.Vertical.class,!0).attr({x1:t,x2:t,y1:n,y2:0}),o},a.prototype.findClosestDotIndex=function(e,t){var i=-1,a=Number.MAX_VALUE,r=this.data.dataPoints,n=this.xAxisProperties.scale,o=this.yAxisProperties.scale;for(var s in r){var l=r[s],u=n(l.x),c=o(l.y),d=u-e,p=c-t,h=d*d+p*p;a===Number.MAX_VALUE?(i=s,a=h):a&&a>h&&(i=s,a=h)}return i},a.prototype.updateLegend=function(e){if(null==this.lastDotIndex||this.lastDotIndex!==e){var t=this.createLegendDataPoints(e);this.host.updateLegend(t),this.lastDotIndex=e}},a.prototype.createLegendDataPoints=function(t){var i=e.scatterChartProps.general.formatString,a=[],r=this.data,n=r.dataPoints[t],o=e.valueFormatter.format(null),s=o,l=r.legendData,u=l.dataPoints,c=n.formattedCategory.getValue();return c!==o?(s=c,null!=n&&null!=n.radius&&null!=n.radius.sizeMeasure&&(s+="; "+e.valueFormatter.format(n.radius.sizeMeasure.source.groupName))):null!=n.radius.sizeMeasure?s=e.valueFormatter.format(n.radius.sizeMeasure.source.groupName):u.length>=t&&u[t].label!==o&&(s=u[t].label),null!=r.xCol&&a.push({category:s,color:n.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.xCol.queryName).createSelectionId(),selected:n.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(this.data.axesLabels.x),measure:e.valueFormatter.format(n.x,e.valueFormatter.getFormatString(r.xCol,i)),iconOnlyOnLabel:!0}),null!=r.yCol&&a.push({category:s,color:n.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.yCol.queryName).createSelectionId(),selected:n.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.axesLabels.y),measure:e.valueFormatter.format(n.y,e.valueFormatter.getFormatString(r.yCol,i)),iconOnlyOnLabel:!0}),null!=r.size&&a.push({category:s,color:n.fill,identity:e.SelectionIdBuilder.builder().withMeasure(r.size.queryName).createSelectionId(),selected:n.selected,icon:e.LegendIcon.Box,label:e.valueFormatter.format(r.size.displayName),measure:e.valueFormatter.format(n.radius.sizeMeasure.values[n.radius.index],e.valueFormatter.getFormatString(r.size,i)),iconOnlyOnLabel:!0}),{dataPoints:a}},a.CrosshairClassName="crosshair",a.ScatterChartCircleTagName="circle",a.DotClassName="dot",a.DotClassSelector="."+a.DotClassName,a.Horizontal=t("horizontal"),a.Vertical=t("vertical"),a})();e.ScatterChartMobileBehavior=n})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){this.itemLabels=t.itemLabels,this.dataPoints=t.dataPoints,this.interactivityService=t.interactivityService,this.slicerSettings=t.settings,e.SlicerWebBehavior.bindSlicerEvents(t,this.itemLabels,i,this.slicerSettings,this.interactivityService)},t.prototype.renderSelection=function(t){e.SlicerWebBehavior.setSelectionOnSlicerItems(this.itemLabels,this.itemLabels,t,this.interactivityService,this.slicerSettings)},t})();e.HorizontalSlicerWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=t.itemContainers;this.itemLabels=t.itemLabels,this.itemInputs=t.itemInputs,this.dataPoints=t.dataPoints,this.interactivityService=t.interactivityService,this.settings=t.settings,e.SlicerWebBehavior.bindSlicerEvents(t,a,i,this.settings,this.interactivityService)},t.prototype.renderSelection=function(t){e.SlicerWebBehavior.setSelectionOnSlicerItems(this.itemInputs,this.itemLabels,t,this.interactivityService,this.settings)},t})();e.VerticalSlicerWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.DOMConstants,i=a.KeyUtils,r=(function(){function r(){}return r.prototype.bindEvents=function(e,t){this.behavior=this.createWebBehavior(e),this.behavior.bindEvents(e.behaviorOptions,t)},r.prototype.renderSelection=function(e){this.behavior.renderSelection(e)},r.bindSlicerEvents=function(e,t,i,a,n){r.bindSlicerItemSelectionEvent(t,i,a,n),e.searchInput&&r.bindSlicerSearchEvent(e.searchInput,e.clearSearchTextButton,i,e.slicerValueHandler),r.styleSlicerContainer(e.slicerContainer,n)},r.setSelectionOnSlicerItems=function(e,t,i,a,n){if(i||a.isSelectionModeInverted())r.styleSlicerItems(e,i,a.isSelectionModeInverted());else{e.filter(".selected").classed("selected",!1),e.filter(".partiallySelected").classed("partiallySelected",!1);var o=e.selectAll("input");o&&o.property("checked",!1),t.style("color",n.slicerText.color)}},r.styleSlicerItems=function(e,t,i){e.each((function(e,r){var n=this,o=!1;e.isSelectAllDataPoint?t?(n.classList.add("partiallySelected"),o=!1):(n.classList.remove("partiallySelected"),o=i):o=a.LogicExtensions.XOR(e.selected,i),o?n.classList.add("selected"):n.classList.remove("selected");var s=n.getElementsByTagName("input")[0];s&&(s.checked=o)}))},r.bindSlicerItemSelectionEvent=function(t,i,a,n){t.on("click",(function(t){d3.event.preventDefault(),t.isSelectAllDataPoint?i.toggleSelectionModeInversion():i.handleSelection(t,r.isMultiSelect(d3.event,a,n)),i.persistSelectionFilter(e.slicerProps.filterPropertyIdentifier)}))},r.bindSlicerSearchEvent=function(e,a,n,o){var s=this;e.empty()||(e.on(t.keyDownEventName,(function(){d3.event.ctrlKey&&i.isCtrlShortcutKey(d3.event.keyCode)?d3.event.stopPropagation():i.isArrowKey(d3.event.keyCode)||i.isDeleteKey(d3.event.keyCode)?d3.event.stopPropagation():d3.event.keyCode===t.escKeyCode?(s.clearSearch(n),d3.event.stopPropagation()):d3.event.keyCode===t.enterKeyCode&&(r.startSearch(e,n,o),d3.event.stopPropagation())})).on(t.keyUpEventName,_.debounce((function(){r.startSearch(e,n,o)}),r.searchInputTimeoutDuration)),a&&!a.empty()&&a.on(t.mouseClickEventName,(function(){s.clearSearch(n),d3.event.stopPropagation()})))},r.clearSearch=function(t){t.persistSelfFilter(e.slicerProps.selfFilterPropertyIdentifier,null)},r.startSearch=function(t,i,a){var r=t.node(),n=r&&r.value;if(n=_.trim(n),_.isEmpty(n))return void i.persistSelfFilter(e.slicerProps.selfFilterPropertyIdentifier,null);var o=a.getUpdatedSelfFilter(n);o&&i.persistSelfFilter(e.slicerProps.selfFilterPropertyIdentifier,o)},r.styleSlicerContainer=function(e,t){var i=t.hasSelection()&&void 0===t.isDefaultValueEnabled()||t.isDefaultValueEnabled()===!1;e.classed("hasSelection",i)},r.isMultiSelect=function(e,t,i){return i.isSelectionModeInverted()||!t.selection.singleSelect||e.ctrlKey},r.prototype.createWebBehavior=function(t){var i,a=t.orientation;switch(a){case 1:i=new e.HorizontalSlicerWebBehavior;break;case 0:default:i=new e.VerticalSlicerWebBehavior}return i},r.searchInputTimeoutDuration=500,r})();e.SlicerWebBehavior=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=t.legendItems;this.legendIcons=t.legendIcons;var r=t.clearCatcher;e.InteractivityUtils.registerStandardSelectionHandler(a,i),r.on("click",(function(){i.handleClearSelection()}))},t.prototype.renderSelection=function(e){e?this.legendIcons.style({fill:function(e){return e.selected?e.color:t.dimmedLegendColor}}):this.legendIcons.style({fill:function(e){return e.color}})},t.dimmedLegendColor="#A6A6A6",t})();e.LegendBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.shapes=t.shapes,r=this.highlightShapes=t.highlightShapes,n=t.majorLabels,o=t.minorLabels;this.hasHighlights=t.hasHighlights,e.InteractivityUtils.registerStandardInteractivityHandlers(a,i),e.InteractivityUtils.registerStandardInteractivityHandlers(r,i),n&&e.InteractivityUtils.registerStandardInteractivityHandlers(n,i),o&&e.InteractivityUtils.registerStandardInteractivityHandlers(o,i)},t.prototype.renderSelection=function(t){var i=this.hasHighlights;this.shapes.style("fill",(function(t){return e.Treemap.getFill(t,!1)})).style("fill-opacity",(function(a){return e.Treemap.getFillOpacity(a,t,!a.selected&&i,!1)})),this.highlightShapes.style("fill",(function(t){return e.Treemap.getFill(t,!0)})).style("fill-opacity",(function(a){return e.Treemap.getFillOpacity(a,t,!a.selected&&i,!0)}))},t})();e.TreemapWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){var a=this.bars=t.bars;a.on("click",(function(e){e.isTotal||i.handleSelection(e,d3.event.ctrlKey)})),a.on("contextmenu",(function(t){if(!d3.event.ctrlKey&&(d3.event.preventDefault(),!t.isTotal)){var a=e.InteractivityUtils.getPositionOfLastInputEvent();i.handleContextMenu(t,a)}}))},t.prototype.renderSelection=function(t){this.bars.style("fill-opacity",(function(i){return i.isTotal?e.ColumnUtil.DefaultOpacity:e.ColumnUtil.getFillOpacity(i.selected,i.highlight,t,!1)}))},t})();e.WaterfallChartWebBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){this.labelItems=t.labelItems,e.InteractivityUtils.registerStandardSelectionHandler(this.labelItems,i)},t.prototype.renderSelection=function(e){e?this.labelItems.style({opacity:function(e){return e.selected?t.DefaultLabelOpacity:t.DimmedLabelOpacity}}):this.labelItems.style({opacity:t.DefaultLabelOpacity})},t.DefaultLabelOpacity=1,t.DimmedLabelOpacity=.6,t})();e.LabelsBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.behaviors=e}return e.prototype.bindEvents=function(e,t){for(var i=this.behaviors,a=0,r=i.length;a<r;a++)i[a].bindEvents(e.layerOptions[a],t);this.selectionHandler=t,e.clearCatcher.on("mousedown",(function(){t.handleClearSelection()}))},e.prototype.renderSelection=function(e){for(var t=0,i=this.behaviors;t<i.length;t++){var a=i[t];a.renderSelection(e)}},e.prototype.hoverLassoRegion=function(e,t){for(var i=0,a=this.behaviors;i<a.length;i++){var r=a[i];r.hoverLassoRegion&&r.hoverLassoRegion(e,t)}},e.prototype.lassoSelect=function(e,t){for(var i=0,a=this.behaviors;i<a.length;i++){var r=a[i];r.lassoSelect&&r.lassoSelect(e,t)}},e})();e.CartesianChartBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.bindEvents=function(t,i){this.options=t;var a=t.slices;e.InteractivityUtils.registerStandardInteractivityHandlers(a,i)},t.prototype.renderSelection=function(t){var i=this.options;i.slices.style("fill-opacity",(function(i){return e.Sunburst.getFillOpacity(i,t,i.selected)}))},t})();e.SunburstBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(e){e&&(this.shapeMap=e)}return t.prototype.bindEvents=function(t,i){var a=this;t.clearCatcher.on("click",(function(){i.handleClearSelection(),a.shapeMap.zoomOnClick()})),this.shapes=t.shapes,this.shapes.on("click",(function(e,t){var r=a.shapeMap.getDataPointFromShape(e);r?i.handleSelection(r,d3.event.ctrlKey):i.handleClearSelection(),a.shapeMap.zoomOnClick(e)})),this.shapes.on("contextmenu",(function(){if(!d3.event.ctrlKey){d3.event.preventDefault();var t=d3.event.target,r=d3.select(t).datum();if(r){var n=a.shapeMap.getDataPointFromShape(r);if(n){var o=e.InteractivityUtils.getPositionOfLastInputEvent();i.handleContextMenu(n,o)}}}}))},t.prototype.renderSelection=function(e){var t=this;this.shapes.transition().duration(600).style("opacity",(function(i){var a=t.shapeMap.getDataPointFromShape(i);return a&&a.selected||!e?1:.4}))},t})();e.ShapeMapBehavior=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.emptyDomain=[0,0],(function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right"})(t.AxisOrientation||(t.AxisOrientation={}));var i,r=t.AxisOrientation;!(function(i){function n(e){return e<300?3:e<500?5:8}function o(e){return e<150?3:e<300?5:8}function s(e,t,i,a,r){return isNaN(e)||isNaN(t)?ue:a<=1||t<=1&&e>=-1?a:e===t?r?1:ue:l(i)?a:Math.min(t-e+1,a)}function l(e){for(var t=0,i=e.length;t<i;t++){var a=e[t];if(a&&a.type&&!a.type.integer)return!0}return!1}function u(e,t,i,a,r){return!a||b(t)?c(e,t.domain()):C(i)?h(e,t.domain()):d(e,t,r)}function c(e,t){var i=[];if(e<=0)return i;var a=t.length;if(e>a)return t;for(var r=0,n=Math.ceil(a/e);r<a;r+=n)i.push(t[r]);return i}function d(e,t,i){var a=[];if(0===e)return a;var r=t;if(r.ticks){if(a=r.ticks(e),a.length>e&&e>1&&(a=r.ticks(e-1)),a.length<le&&(a=r.ticks(e+1)),a=p(a),i&&a.length>1){for(var n=a[1]-a[0];n>0&&n<i;){for(var o=1;o<a.length;o++)a.splice(o,1);n=2*n}1===a.length&&a.push(a[0]+i)}return a}return a}function p(e,t){if(void 0===t&&(t=1e-5),!e||e.length<2)return e;var i=t*Math.abs(e[1]-e[0]);return e.map((function(e){return Math.abs(e)<=i?0:e}))}function h(t,i){var a=[];if(0===i[0]&&0===i[1])return[];var r=e.DateTimeSequence.calculate(new Date(i[0]),new Date(i[1]),t).sequence;return a=r.map((function(e){return e.getTime()})),a=N(a,i[0],i[1])}function g(e){return isNaN(e.min)||isNaN(e.max)?(e.min=t.emptyDomain[0],e.max=t.emptyDomain[1]):e.min===e.max?(e.min=e.min<0?1.2*e.min:.8*e.min,e.max=e.max<0?.8*e.max:1.2*e.max):Math.abs(e.min)<1e-4&&e.min/(e.max-e.min)<1e-4&&(e.min=0),e}function f(e,t,i,a){return 0===n(e-i)||0===o(t-a)?{top:0,right:i,bottom:a,left:0}:{top:20,right:30,bottom:40,left:30}}function m(e,t,r,s,l,u,c,d,p,h,g,f){var m=l.x,y=l.y1,v=l.y2,w=m.values,C=y.values,S=0,x=0,P=0,D=0,T=0,V=m.categoryThickness?m.categoryThickness/2:0,L=b(m.scale),M=!_.isEmpty(l.xStack),N=0;void 0!==m.outerPadding?N=m.outerPadding:void 0!==m.xLabelMaxWidth&&(N=Math.max(0,(e.width-m.xLabelMaxWidth*w.length)/2));var I;if(0!==n(e.width)||0!==o(e.height)){var A=void 0;if(A=d||M?pe.DefaultRotationWithScrollbar:pe.DefaultRotation,g)for(var O=0,R=C.length;O<R;O++)c.text=C[O],P=Math.max(P,r(c));if(v&&f)for(var E=v.values,O=0,R=E.length;O<R;O++)c.text=E[O],D=Math.max(D,r(c));I=s(c);var F=Math.floor(u/I),j=m.scale,H=j.domain();if(h&&w.length>0){for(var O=0,R=w.length;O<R;O++){var G=void 0;c.text=w[O];var k=r(c);if(m.willLabelsWordBreak){var z=a.WordBreaker.splitByWidth(c.text,c,r,m.xLabelMaxWidth,F);G=z.length*I,k=m.xLabelMaxWidth}else!m.willLabelsFit&&L?(G=k*A.sine,k*=A.cosine):G=se;if(0===O){if(L)S=m.willLabelsFit?k/2-V-N:k-V-N,S=Math.max(S,0);else if(H.length>1){var U=j(H[0]);S=k/2-U,S=Math.max(S,0)}}else if(O===R-1)if(L)(m.willLabelsFit||m.willLabelsWordBreak)&&(x=k/2-V-N,x=Math.max(x,0));else if(H.length>1){var U=j(H[1]);x=k/2-(e.width-U),x=Math.max(x,0)}T=Math.max(T,G)}S=Math.min(S,oe),x=Math.min(x,oe)}}var B=0,W=0,q=Math.min(Math.ceil(T),u);return p?(W=Math.min(Math.max(S,D),t),B=Math.min(Math.max(x,P),t)):(W=Math.min(Math.max(S,P),t),B=Math.min(Math.max(x,D),t)),M&&(q+=(I+i.stackedAxisPadding)*(l.xStack.length-1)),{xMax:Math.ceil(q),yLeft:Math.ceil(W),yRight:Math.ceil(B),stackHeight:I+i.stackedAxisPadding}}function y(e){return e&&(e.bool||e.numeric||e.text||e.dateTime)}function v(){return e.ValueType.fromDescriptor({text:!0})}function w(e){return!(!e||!(e.text||e.bool||e.misc&&e.misc.barcode||e.geography&&e.geography.postalCode))}function b(e){return"function"==typeof e.rangePoints}function C(e){return!(!e||!e.dateTime)}function S(e,t){return b(e)?D(e,t):e.invert(t)}function x(e){return b(e)?e.rangeExtent():e.range()}function P(e){var t=e.range();if(t.length<2&&i.isOrdinalScale(e)){var a=e.rangeExtent();return a[1]-a[0]}return t[1]-t[0]}function D(e,t){var i=e.range();if(i.length<2)return 0;var a=e.rangeBand(),r=(i[1]-i[0]-a)/2,n=e.range(),o=e.domain();return n[0]>t?o[0]:o[d3.bisect(n,t+r)-1]}function T(e,t){var i=-1,a=Number.MAX_VALUE;for(var r in t){var n=Math.abs(e-t[r].categoryValue);n<a&&(a=n,i=parseInt(r,10))}return i}function V(e,t){var i=-1,a=Number.MAX_VALUE,r=e.domain();if(r.length<2)return 0;var n=(e(1)-e(0))/2;for(var o in r){var s=e(o),l=s+n,u=Math.abs(t-l);u<a&&(a=u,i=parseInt(o,10))}return i}function L(e,t,i){var a=e(t)-e(i);return 0===a?0:a<0?Math.min(a,-1):Math.max(a,1)}function M(e,t,i,a,r){if(i&&!w(t)){var n=void 0,o=void 0;return a&&2===a.length&&(n=a[0],o=a[1]),B(e,n,o,t,r)}return q(e)}function N(e,t,i){var a=e.filter((function(e){return e>=t&&e<=i}));return a.length<2&&(a=[t,i]),a}function I(t,i){return t&&y(t.type)?t.type:i?e.ValueType.fromDescriptor({numeric:!0}):e.ValueType.fromDescriptor({text:!0})}function A(e){var a=e.pixelSpan,r=e.dataDomain,n=e.metaDataColumn,o=e.formatString,s=e.outerPadding||0,l=!!e.isCategoryAxis,c=!!e.isScalar,d=!!e.isVertical,p=!!e.useTickIntervalForDisplayUnits,h=e.getValueFn,g=e.categoryThickness,f=e.axisDisplayUnits,m=e.axisPrecision,y=!!e.is100Pct,v=e.margin,w=i.getCategoryValueType(n,c),b=i.createScale(e),C=b.scale,S=b.bestTickCount,x=C.domain(),P=i.isLogScalePossible(r,w);if(g&&c&&r&&2===r.length){var D=r[1]-r[0],T=x[1]-x[0];D>0&&T>0&&(g=g*D/T)}var V;if(c&&!_.isEmpty(r)&&1===S)V=[r[0]];else{var L=c?U(o,w,y):void 0;V=u(S,C,w,c,L)}e.scaleType&&e.scaleType===t.axisScale.log&&P&&(V=V.filter((function(e){return i.powerOfTen(e)})));var M=j(x,r,w,c,o,S,V,h,p,f,m),N=d3.svg.axis().scale(C).tickSize(6,0).orient(d?"left":"bottom").ticks(S).tickValues(V),I=[];n&&(I=z(N,V,M,w,h));var A,O;return d||(!c&&g?A=Math.max(1,g-2*t.CartesianChart.TickLabelPadding):V.length>1?(A=R(C,V),A-=2*de,O=E(C,V,v,s,A)):A=a-2*de),{scale:C,axis:N,formatter:M,values:I,axisType:w,axisLabel:null,isCategoryAxis:l,xLabelMaxWidth:A,xLabelMaxWidths:O,categoryThickness:g,outerPadding:s,usingDefaultDomain:b.usingDefaultDomain,isLogScaleAllowed:P,dataDomain:r}}function O(e){var t=e.axis,i=null!=e.orient?r[e.orient]:r[r.bottom];return d3.svg.axis().scale(e.scale).tickSize(e.innerTickSize||0,e.outerTickSize||0).orient(i).ticks(t.ticks()).tickValues(t.tickValues()).tickFormat(e.tickFormat)}function R(e,t){return e&&!_.isEmpty(t)?Math.abs(e(t[1])-e(t[0])):1}function E(e,t,i,a,r){var n=_.times(t.length,_.constant(r)),o=i?i.left:0,s=i?i.right:0,l=e(t[0]),u=e(t[t.length-1]),c=e.range(),d=c[0],p=c[1],h=2*(Math.abs(l-d)+o+a),g=2*(Math.abs(u-p)+s+a);return n[0]=Math.min(h,r),n[t.length-1]=Math.min(g,r),n}function F(e){var a=e.pixelSpan,r=e.dataDomain,s=e.metaDataColumn,l=e.outerPadding||0,u=!!e.isScalar,c=!!e.isVertical,d=e.forcedTickCount,p=e.categoryThickness,h=!!e.shouldClamp,f=e.maxTickCount,m=i.getCategoryValueType(s,u),y=c?o(a):n(a);f&&y>f&&(y=f);var v,b=r?r.slice():null,C=y,S=!1;if(null==r||2===r.length&&null==r[0]&&null==r[1]||2!==r.length&&u)S=!0,r=m.dateTime||!w(m)?t.emptyDomain:[],v=w(m)?K(a,r,p?l/p:0):Y(e.scaleType,a,r,m,l,C);else{if(u&&r.length>0){C=void 0!==d?0!==y?d:0:i.getBestNumberOfTicks(r[0],r[r.length-1],[s],y,m.dateTime);var x=g({min:r[0],max:r[r.length-1]});b=[x.min,x.max]}u&&m.numeric&&!m.dateTime?(b&&2===b.length&&0===b[0]&&0===b[1]&&e.zeroScalarDomain&&(b[0]=e.zeroScalarDomain[0],b[1]=e.zeroScalarDomain[1]),v=Y(e.scaleType,a,b,m,l,C,h)):u&&m.dateTime?v=X(a,b,l,null,h):(m.text||m.dateTime||m.numeric||m.bool)&&(v=K(a,b,p?l/p:0),C=0===y?0:Math.min(b.length,(a-2*l)/t.CartesianChart.MinOrdinalRectThickness))}return c&&u&&v.range(v.range().reverse()),t.ColumnUtil.normalizeInfinityInScale(v),{scale:v,bestTickCount:C,usingDefaultDomain:S}}function j(e,i,a,r,n,o,s,l,u,c,d){void 0===u&&(u=!1);var p;if(a.dateTime)if(r){var h=new Date(e[0]),g=new Date(e[1]);1===o&&(h=g=new Date(i[0])),p=t.valueFormatter.create({format:n,value:h,value2:g,tickCount:o})}else p=t.valueFormatter.createDefaultFormatter(n,!0);else if(u&&r&&s.length>1){var f=c?c:s[1]-s[0],m={format:n,value:f,value2:0,allowFormatBeautification:!0};d?m.precision=d:m.precision=H(s[0],s[1],c,n),p=t.valueFormatter.create(m)}else p=t.valueFormatter.createDefaultFormatter(n,!0);return p}function H(i,a,r,n){if(!r){var o=t.valueFormatter.createDisplayUnitSystem();o.update(a-i),r=o.displayUnit&&o.displayUnit.value||1}var s=(i||0)/r,l=(a||0)/r;if(n){var u=e.NumberFormat.getCustomFormatMetadata(n,!1,!1,!0).partsPerScale;s*=u,l*=u}return Math.max(G(s),G(l))}function G(t){if(0===t)return 0;t<0&&(t=-t);var i=Math.floor(e.Double.log10(t)),a=5;if(i>=0){var r=i+1,n=a-r;return n<=0?0:k(t,n)}var o=t/e.Double.pow10(i+1),s=k(o,a),l=-i-1;return l+s}function k(e,t){var i=e.toFixed(t),a=i.indexOf(".");if(a!==-1)for(var r=i.length;r-- >a;)if("0"!==i[r])return r-a;return 0}function z(e,t,i,a,r){var n=[];return r||(r=function(e){return e}),i?(e.tickFormat((function(e){return i.format(r(e,a))})),n=t.map((function(e){return i.format(r(e,a))}))):n=t.map((function(e){return r(e,a)})),n}function U(t,i,a){var r=t&&!e.NumberFormat.isStandardFormat(t);if(r){var n=e.NumberFormat.getCustomFormatMetadata(t,!0).precision;return t.indexOf("%")>-1&&(n+=2),Math.pow(10,-n)}return a?.01:i.integer?1:0}function B(e,t,i,a,r){if(0===e.length)return null;var n=d3.min(e,(function(e){return d3.min(e.data,(function(e){return e&&e.categoryValue}))})),o=d3.max(e,(function(e){return d3.max(e.data,(function(e){return e&&e.categoryValue}))}));return ee([t,i],[n,o],r)}function W(e,t){if(0===e.length)return null;var i=d3.min(e,(function(e){return d3.min(e.data,(function(e){return e&&e.value}))})),a=d3.max(e,(function(e){return d3.max(e.data,(function(e){return e&&e.value}))}));return t?[Math.min(i,0),Math.max(a,0)]:[i,a]}function q(e){if(_.isEmpty(e))return[];for(var t=[],i=e[0],a=0,r=i.data;a<r.length;a++){var n=r[a];n.highlight||t.push(n.categoryIndex)}return t}function K(e,i,a){void 0===a&&(a=0);var r=d3.scale.ordinal().rangeBands([0,e],t.CartesianChart.InnerPaddingRatio,a).domain(i);return r}function Q(e,t){return null!=e&&(!C(t)&&(e[0]>0&&e[1]>0||e[0]<0&&e[1]<0))}function Y(e,i,a,r,n,o,s){return void 0===n&&(n=0),e===t.axisScale.log&&Q(a,r)?J(i,a,n,o):X(i,a,n,o,s)}function J(e,t,i,a){void 0===i&&(i=0);var r=d3.scale.log().range([i,e-i]).domain([t[0],t[1]]).clamp(!0);return a&&r.nice(a),r}function X(e,t,i,a,r){void 0===i&&(i=0);var n=d3.scale.linear().range([i,e-i]).domain([t[0],t[1]]).clamp(r);return a&&n.nice(a),n}function $(e){var t={};return e&&(t.min=null==e.min?null==e.minLocal?d3.min(e.values):e.minLocal:e.min,t.max=null==e.max?null==e.maxLocal?d3.max(e.values):e.maxLocal:e.max),t}function Z(e,t){var i=[void 0,void 0];return t&&2===t.length&&(i=[t[0],t[1]]),e&&2===e.length&&(null!=e[0]&&(i[0]=e[0]),null!=e[1]&&(i[1]=e[1])),null==i[0]&&null==i[1]?t:null!=i[0]&&null!=i[1]&&i[0]>i[1]?t:i}function ee(e,t,i){var a=t?[t[0],t[1]]:[];i&&((null==a[0]||i.min<a[0])&&(a[0]=i.min),(null==a[1]||i.max>a[1])&&(a[1]=i.max));var r=[a[0],a[1]];return e&&2===e.length&&(null!=e[0]&&(a[0]=e[0]),null!=e[1]&&(a[1]=e[1]),a[0]>a[1]&&(a=r)),a}function te(e,i,a,r){void 0===r&&(r=!1);var n=r?"secAxisStyle":"axisStyle";if(!e||!e[n])return i;var o;return o=e[n]===t.axisStyle.showBoth?i+" ("+a+")":e[n]===t.axisStyle.showUnitOnly?a:i}function ie(e,t){return!(!e||!t||e.length<2||t.length<2)&&(e[0]!==t[0]||e[1]!==t[1])}function ae(e){return isNaN(e)?null:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:e}function re(e){var t=Math.abs(e),i=Math.log(t)/Math.LN10;return i=Math.ceil(i-1e-12),t/Math.pow(10,i)===1}function ne(e){var t=e;return t.isStacked===!0}var oe=35,se=10,le=2,ue=3,ce=10,de=3;i.stackedAxisPadding=5,i.getRecommendedNumberOfTicksForXAxis=n,i.getRecommendedNumberOfTicksForYAxis=o,i.getBestNumberOfTicks=s,i.hasNonIntegerData=l,i.getRecommendedTickValues=u,i.getRecommendedTickValuesForAnOrdinalRange=c,i.getRecommendedTickValuesForAQuantitativeRange=d,i.getMargin=f,i.getTickLabelMargins=m,i.columnDataTypeHasValue=y,i.createOrdinalType=v,i.isOrdinal=w,i.isOrdinalScale=b,i.isDateTime=C,i.invertScale=S,i.extent=x,i.getCategoryThickness=P,i.invertOrdinalScale=D,i.findClosestXAxisIndex=T,i.lookupOrdinalIndex=V,i.diffScaled=L,i.createDomain=M,i.ensureValuesInRange=N,i.getCategoryValueType=I,i.createAxis=A,i.createStackedAxis=O,i.createScale=F,i.createFormatter=j,i.calculateAxisPrecision=H,i.getMinTickValueInterval=U,i.createValueDomain=W;var pe;!(function(i){function r(e,t,i,a){var r=e.values;if(0===r.length)return!1;var n=void 0!==e.xLabelMaxWidth?e.xLabelMaxWidth:t/r.length;return!r.some((function(e){return a.text=e,i(a)>n}))}function n(e,r,n,o,s,l,u){var c=e.values,d=void 0!==e.xLabelMaxWidth?e.xLabelMaxWidth:n/c.length,p=r.bottom/i.DefaultRotation.sine,h=s(u),g=Math.max(1,Math.floor(r.bottom/h));if(0===c.length)return!1;var f=c.some((function(e){return u.text=e,!a.WordBreaker.hasBreakers(e)&&o(u)>d}));if(f)return!1;var m=c.filter((function(n,s){var c=r.left+e.outerPadding+e.categoryThickness*(s+.5)-ce,h=c/i.DefaultRotation.cosine,f=Math.min(h,p),m=a.WordBreaker.splitByWidth(n,u,o,d,g,l).join(" ");u.text=n;var y=l(u,f);return t.TextUtil.removeEllipses(m).length>=t.TextUtil.removeEllipses(y).length}));return m.length>=Math.floor(c.length/2)}function o(e,t,a,r,n,o,s,l,u){var c,d,p=s.axis.tickSize();d=u?p?i.DefaultRotationWithScrollbar:i.DefaultRotationWithScrollbarTickSizeZero:i.DefaultRotation,n&&(c=t/d.sine),e.each((function(e,t){var i=d3.select(this),p=i.text();if(r.text=p,n){var h=l.left+s.outerPadding+s.categoryThickness*(t+.5);u||(h-=ce);var g=h/d.cosine;(u||o||g<c)&&(p=a(r,Math.min(g,c)),i.text(p)),i.style("text-anchor","end").attr({dx:"-0.5em",dy:d.dy,transform:d.transform})}else{var f=void 0;f=ne(s)?_.isEmpty(s.xLabelMaxWidths)?s.xLabelMaxWidth:s.xLabelMaxWidths[e]:_.isEmpty(s.xLabelMaxWidths)?s.xLabelMaxWidth:s.xLabelMaxWidths[t],f=Math.ceil(f);var m=a(r,f);m!==p&&i.text(m),i.style("text-anchor","middle").attr({dx:"0em",dy:"1em",transform:"rotate(0)"})}}))}function s(t,i,a){var r=i.xLabelMaxWidth;t.each((function(){var t=d3.select(this);t.style("text-anchor","middle").attr({dx:"0em",dy:"1em",transform:"rotate(0)"}),e.TextMeasurementService.wordBreak(this,r,a)}))}function l(e,t,i){0!==e.size()&&e.each((function(){var e=d3.select(this);i(e[0][0],t)}))}i.willLabelsFit=r,i.willLabelsWordBreak=n,i.DefaultRotation={sine:Math.sin(Math.PI*(35/180)),cosine:Math.cos(Math.PI*(35/180)),tangent:Math.tan(Math.PI*(35/180)),transform:"rotate(-35)",dy:"-0.5em"},i.DefaultRotationWithScrollbar={sine:Math.sin(.5*Math.PI),
cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.8em"},i.DefaultRotationWithScrollbarTickSizeZero={sine:Math.sin(.5*Math.PI),cosine:Math.cos(.5*Math.PI),tangent:Math.tan(.5*Math.PI),transform:"rotate(-90)",dy:"-0.3em"},i.rotate=o,i.wordBreak=s,i.clip=l})(pe=i.LabelLayoutStrategy||(i.LabelLayoutStrategy={})),i.createOrdinalScale=K,i.isLogScalePossible=Q,i.createNumericalScale=Y,i.createLinearScale=X,i.getRangeForColumn=$,i.applyCustomizedDomain=Z,i.combineDomain=ee,i.createAxisLabel=te,i.scaleShouldClamp=ie,i.normalizeNonFiniteNumber=ae,i.powerOfTen=re,i.isStackedAxisProperties=ne})(i=t.AxisHelper||(t.AxisHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t,i,a,r){var n=i*u.PaddingConstRatio+e.lineWeight/2,o=t*u.PaddingConstRatio+e.lineWeight/2,c=i*u.ShapeConstRatio-e.lineWeight,d=t*u.ShapeConstRatio-e.lineWeight,p={x:n,y:o,width:c,height:d,rx:e.roundEdge,ry:e.roundEdge},h=l(c,d,r);s(e,t,i,a,r,h,"rect",p)}function i(e,t,i,a,r){var n=(i/u.OvalRadiusConst).toString(),o=(t/u.OvalRadiusConst).toString(),c=i/(u.OvalRadiusConst+u.OvalRadiusConstPadding)-e.lineWeight,d=t/(u.OvalRadiusConst+u.OvalRadiusConstPadding)-e.lineWeight,p={cx:n,cy:o,rx:c,ry:d},h=l(i,t,r);s(e,t,i,a,r,h,"ellipse",p)}function a(e,t,i,a,r){var n,o,s,l,c,d=i-u.SmallPaddingConstValue-u.SmallPaddingConstValue,p=t-u.SmallPaddingConstValue-u.SmallPaddingConstValue;r<=45?(c=r/90,n=i/2+d*c,o=u.SmallPaddingConstValue,s=i/2-d*c,l=t-u.SmallPaddingConstValue):r<=135?(c=(r-45)/90,n=i-u.SmallPaddingConstValue,o=u.SmallPaddingConstValue+p*c,s=u.SmallPaddingConstValue,l=t-u.SmallPaddingConstValue-p*c):r<=225?(c=(r-135)/90,n=i-u.SmallPaddingConstValue-d*c,o=t-u.SmallPaddingConstValue,s=u.SmallPaddingConstValue+d*c,l=u.SmallPaddingConstValue):r<=315?(c=(r-225)/90,n=u.SmallPaddingConstValue,o=t-u.SmallPaddingConstValue-p*c,s=i-u.SmallPaddingConstValue,l=u.SmallPaddingConstValue+p*c):r<=360&&(c=(r-315)/90,n=u.SmallPaddingConstValue+d*c,o=u.SmallPaddingConstValue,s=i-u.SmallPaddingConstValue-d*c,l=t-u.SmallPaddingConstValue),a.append("svg").attr({width:i,height:t}).append("line").attr({x1:n,y1:o,x2:s,y2:l}).style({"vector-effect":"non-scaling-stroke","stroke-width":e.lineWeight+"px","stroke-opacity":(100-e.lineTransparency)/100,stroke:e.lineColor})}function r(e,t,i,a,r){var n=e.lineWeight,s=t-n,l=i-n,c=[{x:(l*u.ArrowLeftHeadPoint.x).toString(),y:(s*u.ArrowLeftHeadPoint.y).toString()},{x:(l*u.ArrowMiddleHeadPoint.x).toString(),y:(s*u.ArrowMiddleHeadPoint.y).toString()},{x:(l*u.ArrowRightHeadPoint.x).toString(),y:(s*u.ArrowRightHeadPoint.y).toString()},{x:(l*u.ArrowRightMiddleHeadPoint.x).toString(),y:(s*u.ArrowRightMiddleHeadPoint.y).toString()},{x:(l*u.ArrowBottomRightPoint.x).toString(),y:(s*u.ArrowBottomRightPoint.y).toString()},{x:(l*u.ArrowBottomLeftPoint.x).toString(),y:(s*u.ArrowBottomLeftPoint.y).toString()},{x:(l*u.ArrowLeftMiddleHeadPoint.x).toString(),y:(s*u.ArrowLeftMiddleHeadPoint.y).toString()}];o(e,c,a,t,i,r)}function n(e,t,i,a,r){var n=e.lineWeight;n>3&&(n-=3);var s=(i+n)*u.TrianglePaddingConstRatio,l=t-u.SmallPaddingConstValue-n<0?t-u.SmallPaddingConstValue:t-u.SmallPaddingConstValue-n,c=(t+n)*u.TrianglePaddingConstRatio,d=(i-n)*u.TriangleEndPaddingConstRatio<0?i*u.TriangleEndPaddingConstRatio:(i-n)*u.TriangleEndPaddingConstRatio,p=t-u.SmallPaddingConstValue-n<0?t-u.SmallPaddingConstValue:t-n-u.SmallPaddingConstValue,h=(s+d)/2;s<10&&(s=u.SmallPaddingConstValue),c<10&&(c=u.SmallPaddingConstValue);var g=[{x:s,y:l},{x:h,y:c},{x:d,y:p}];o(e,g,a,t,i,r)}function o(e,t,i,a,r,n){var o=d3.svg.line().x((function(e){return e.x})).y((function(e){return e.y})).interpolate("linear"),u={d:o(t)+" Z"},c=l(r,a,n);s(e,a,r,i,n,c,"path",u)}function s(e,t,i,a,r,n,o,s){a.append("div").style({transform:"rotate("+r+"deg) scale("+n+")","transform-origin":"center","-webkit-transform":"rotate("+r+"deg) scale("+n+")","-webkit-transform-origin":"center",width:i+"px",height:t+"px"}).append("svg").attr({width:i,height:t}).append(o).attr(s).style({"vector-effect":"non-scaling-stroke","stroke-width":e.lineWeight+"px",stroke:e.lineColor,"stroke-opacity":(100-e.lineTransparency)/100,fill:e.fillColor,"fill-opacity":e.showFill===!0?(100-e.shapeTransparency)/100:0})}function l(e,t,i){var a=e,r=t,n=Math.atan2(t,e),o=Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),s=i/180*Math.PI;return e>=t?(i<90?s+=n:i<180?s-=n:i<270?s+=n:s-=n,r/Math.abs(Math.sin(s))/o):(i<90?s-=n:i<180?s+=n:i<270?s-=n:s+=n,a/Math.abs(Math.cos(s))/o)}var u;!(function(e){e.PaddingConstRatio=.01,e.TrianglePaddingConstRatio=.15,e.TriangleEndPaddingConstRatio=.85,e.ShapeConstRatio=1-2*e.PaddingConstRatio,e.SmallPaddingConstValue=10,e.OvalRadiusConst=2,e.OvalRadiusConstPadding=.2,e.ArrowLeftHeadPoint={x:.05,y:.42},e.ArrowMiddleHeadPoint={x:.5,y:.016},e.ArrowRightHeadPoint={x:.95,y:.42},e.ArrowRightMiddleHeadPoint={x:.764,y:.42},e.ArrowBottomRightPoint={x:.764,y:.993},e.ArrowBottomLeftPoint={x:.246,y:.993},e.ArrowLeftMiddleHeadPoint={x:.246,y:.42}})(u=e.ShapeFactoryConsts||(e.ShapeFactoryConsts={})),e.createRectangle=t,e.createOval=i,e.createLine=a,e.createUpArrow=r,e.createTriangle=n})(t=e.ShapeFactory||(e.ShapeFactory={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i,a){var r=i?{showAxisTitle:!0}:{};if(!t)return r;var n=t.objects;if(n){var o=n.categoryAxis;o&&(r={show:o.show,position:o.position,axisType:o.axisType,axisScale:o.axisScale,start:o.start,end:o.end,showAxisTitle:null==o.showAxisTitle?i:o.showAxisTitle,axisStyle:o.axisStyle,labelColor:o.labelColor,labelDisplayUnits:o.labelDisplayUnits,labelPrecision:o.labelPrecision,duration:o.duration,concatenateLabels:o[e.cartesianChartProps.categoryAxis.concatenateLabels.propertyName],titleColor:o.titleColor})}return r}function a(e,t,i){var a={};if(!e)return a;var r=e.objects;if(r){var n=r.valueAxis;n&&(a={show:n.show,position:n.position,axisScale:n.axisScale,start:n.start,end:n.end,showAxisTitle:null==n.showAxisTitle?t:n.showAxisTitle,axisStyle:n.axisStyle,labelColor:n.labelColor,labelDisplayUnits:n.labelDisplayUnits,labelPrecision:n.labelPrecision,titleColor:n.titleColor,secShow:n.secShow,secPosition:n.secPosition,secAxisScale:n.secAxisScale,secStart:n.secStart,secEnd:n.secEnd,secShowAxisTitle:n.secShowAxisTitle,secAxisStyle:n.secAxisStyle,secLabelColor:n.secLabelColor,secLabelDisplayUnits:n.secLabelDisplayUnits,secLabelPrecision:n.secLabelPrecision,secTitleColor:n.secTitleColor})}return a}function r(t,i){return!!t&&(!i||!i.axisType||i.axisType===e.axisType.scalar)}function n(e){return null!=e?e<0?0:e:null}function o(t,i,a,r){var n=e.AxisHelper.isDateTime(a);if(r)return n?new Date(i):i;if(a.text)return t.categories[i];if(t&&t.series&&t.series.length>0){var o=t.series[0];if(o){var s=o.data;if(s){t.hasHighlights&&(i=2*i);var l=s[i];if(l)return n&&null!=l.categoryValue?new Date(l.categoryValue):l.categoryValue}}}return i}function s(e){if(_.isEmpty(e))return 0;for(var t=0,i=0,a=e;i<a.length;i++){var r=a[i];if(!_.isEmpty(r.data)){var n=r.data[r.data.length-1].categoryIndex;t=Math.max(n,t)}}return t}t.getCategoryAxisProperties=i,t.getValueAxisProperties=a,t.isScalar=r,t.getPrecision=n,t.lookupXValue=o,t.findMaxCategoryIndex=s})(t=e.CartesianHelper||(e.CartesianHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.data.SQExprShortSerializer,a=(function(){function t(e,t,i){this.colors=e,this.fillProp=t,this.defaultDataPointColor=i,this.defaultColorScale=e.getNewColorScale()}return t.prototype.getColorForSeriesValue=function(t,i,a){return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||this.getColorScaleForSeries(i).getColor(a).value},t.prototype.getColorScaleForSeries=function(e){return this.colors.getColorScaleByKey(i.serializeArray(e||[]))},t.prototype.getColorForMeasure=function(t,i){var a=this.defaultColorScale.getColor(i).value;return this.fillProp&&e.DataViewObjects.getFillColor(t,this.fillProp)||this.defaultDataPointColor||a},t.normalizeSelector=function(e,t){return e&&(t||e.data)?{data:e.data}:e},t})();t.ColorHelper=a})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.PixelConverter,n="rect";!(function(i){function a(e,t,a){if(e){var r=a.start,n=a.end;return i.transformDomain(t,r,n)}return t}function o(i,a,r){if(!i.categories||!i.values||0===i.categories.length||0===i.values.length)return i;if("number"!=typeof a&&"number"!=typeof r)return i;var n=i.categories[0],o=n?n.source.type:null;if(t.AxisHelper.isOrdinal(o))return i;var s=n.values,l=n.objects;if(!s||!l)return i;var u=[],c=[],d=[];if("number"!=typeof a&&(a=s[0]),"number"!=typeof r&&(r=s[s.length-1]),a>r)return i;for(var p=0,h=i.values.length;p<h;p++)c.push([]);for(var g=0,h=s.length;g<h;g++)if(s[g]>=a&&s[g]<=r&&(u.push(s[g]),l&&d.push(l[g]),i.values))for(var f=0;f<i.values.length;f++)c[f].push(i.values[f].values[g]);var m=e.Prototype.inherit(i),y=m.values=e.Prototype.inherit(m.values),v=m.categories=e.Prototype.inherit(i.categories),w=m.categories[0]=e.Prototype.inherit(v[0]);w.values=u,w.objects&&(w.objects=d);for(var g=0,h=i.values.length;g<h;g++){var b=y[g]=e.Prototype.inherit(y[g]);b.values=c[g]}return m}function s(i,a,r,n,o,s,l,u,c,d,p){var h=r.categoryThickness,g=r.isScalar,f=r.outerPaddingRatio,m=t.AxisHelper.createDomain(i.series,i.categoryMetadata?i.categoryMetadata.type:e.ValueType.fromDescriptor({text:!0}),g,[o,s],d),y=t.AxisHelper.createAxis({pixelSpan:a,dataDomain:m,metaDataColumn:i.categoryMetadata,formatString:t.valueFormatter.getFormatString(i.categoryMetadata,t.columnChartProps.general.formatString),outerPadding:h*f,isCategoryAxis:!0,isScalar:g,isVertical:n,categoryThickness:h,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,a){return t.CartesianHelper.lookupXValue(i,e,a,g)},scaleType:l,axisDisplayUnits:u,axisPrecision:c,margin:p});return r.categoryThickness=y.categoryThickness,y}function l(e,t){t&&e.attr("draggable","true").on("dragstart",t)}function u(e,t,a,r){return r&&!t||a&&!e?i.DimmedOpacity:i.DefaultOpacity}function c(e,t){for(var i=0,a=Number.MAX_VALUE,r=0,n=t.length;r<n;r++){var o=Math.abs(e-t[r]);o<a&&(a=o,i=r)}return i}function d(e,a,r,o,s){var l=!s,u=e.selectAll(t.ColumnChart.SeriesClasses.selector).selectAll(n+a),c=u.filter((function(e){return e.categoryIndex===r}));c.transition().duration(0).style("fill-opacity",i.DefaultOpacity);var d=u.filter((function(e){var t=void 0===o;if(t||s)return e.categoryIndex!==r;var i=e.categoryIndex===o,a=e.categoryIndex!==r;return i&&a})),p=l?d.transition():d;p.style("fill-opacity",i.DimmedOpacity)}function p(e,i,a){var r=i.selectAll(t.ColumnChart.SeriesClasses.selector),n=r.data(e.series,(function(e){return e.key}));return n.enter().append("g").classed(t.ColumnChart.SeriesClasses.class,!0),n.style({fill:function(e){return e.color}}),n.exit().remove(),n}function h(e,t,a,r,o,s){var l;l=o?function(e){var t=_.filter(e.data,(function(e){return!!e.value}));return t}:function(e){return e.data};var u=t.selectAll(r.selector),c=u.data(l,(function(e){return e.key}));return c.enter().append(n).attr("class",(function(e){return r.class.concat(e.highlight?" highlight":"")})),c.style("fill-opacity",(function(t){return i.getFillOpacity(t.selected,t.highlight,s,e.hasHighlights)})).style("fill",(function(t){return t.color!==e.series[t.seriesIndex].color?t.color:null})).attr(a.shapeLayout),c.exit().remove(),c}function g(e,i,a,r,n,o){if(void 0===n&&(n=!1),e){for(var s=e.data(),l=[],u=0,c=s.length;u<c;u++)Array.prototype.push.apply(l,s[u].data);return t.dataLabelUtils.drawDefaultLabelsForDataPointChart(l,i,a,r,n,o)}t.dataLabelUtils.cleanDataLabels(i)}function f(e){for(var t=e.domain(),i=0,a=t.length;i<a;++i)t[i]===Number.POSITIVE_INFINITY?t[i]=Number.MAX_VALUE:t[i]===Number.NEGATIVE_INFINITY&&(t[i]=-Number.MAX_VALUE);e.domain(t)}function m(e,i){var a=i.xScale,r=i.yScale,n=r(0),o=a(0);switch(e.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:return o+Math.abs(t.AxisHelper.diffScaled(a,0,e.valueAbsolute))+t.AxisHelper.diffScaled(a,e.position-e.valueAbsolute,0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredBar:return o+t.AxisHelper.diffScaled(a,Math.max(0,e.value),0)+t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:return n+t.AxisHelper.diffScaled(r,e.position,0)-t.dataLabelUtils.defaultColumnLabelMargin;case t.ColumnChartType.clusteredColumn:return n+t.AxisHelper.diffScaled(r,Math.max(0,e.value),0)-t.dataLabelUtils.defaultColumnLabelMargin}}function y(i,a,n,o,s,l,u){for(var c=[],d=i.series,p=t.NewDataLabelUtils.createColumnFormatterCacheManager(),h=a.shapeLayout,g=i.scalarCategoryAxis,f=function(a,f){var m=d[a],y=m.labelSettings?m.labelSettings:i.labelSettings;if(!y.show)return c[a]={labelDataPoints:[],maxNumberOfLabels:0},"continue";var b="100"===y.labelDensity,C=void 0;if(u&&!b&&g){var S=t.NewDataLabelUtils.getNumberOfLabelsToRender(n.viewportWidth,_.parseInt(y.labelDensity),t.ColumnChart.minimumLabelsToRender,t.MinMaxLabelDataPointSorter.estimatedLabelWidth);C=S}else C=m.data.length;var x=t.NewDataLabelUtils.getLabelUnitAndPrecisionForAxis(o,y),P=m.data,D=[],T=function(a,o){if(null==a||null==a.value||i.hasHighlights&&!a.highlight)return null;var u;u=n.is100Pct?t.NewDataLabelUtils.hundredPercentFormat:a.labelFormatString;var c,d=p.getOrCreate(u,y,x.units,x.precision),g=t.NewDataLabelUtils.getLabelFormattedText(d.format(a.value)),f={text:g,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:r.fromPoint(y.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},m=e.TextMeasurementService.measureSvgTextWidth(f),b=e.TextMeasurementService.estimateSvgTextHeight(f,!0),C={left:h.x(a),top:h.y(a),width:h.width(a),height:h.height(a)};c=l?v(y.position):w(y.position);var S;S=s?a.value>=0?3:4:a.value>=0?1:2;var P={isPreferred:!1,text:g,textSize:{width:m,height:b},outsideFill:t.ColumnChart.getLabelFill(y.labelColor,!1,n.isComboChart),insideFill:t.ColumnChart.getLabelFill(y.labelColor,!0,n.isComboChart),parentType:1,parentShape:{rect:C,orientation:S,validPositions:c},identity:a.identity,fontSize:y.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt};return P};if(!_.isEmpty(P))for(var V=0,L=P.length;V<L;V++){var M=T(P[V],V);M&&D.push(M)}c[a]={labelDataPoints:D,maxNumberOfLabels:C}},m=0,y=d.length;m<y;m++)f(m,y);if(u&&i&&i.scalarCategoryAxis){var b=new t.MinMaxLabelDataPointSorter({unsortedLabelDataPointGroups:c,series:d,viewport:{width:n.viewportWidth,height:n.viewportHeight},yAxisProperties:o});return b.getSortedDataLabels()}return c}function v(e){switch(e){case t.labelPosition.insideEnd:return[4];case t.labelPosition.insideCenter:return[1];case t.labelPosition.insideBase:return[2];case t.labelPosition.outsideEnd:return[16];default:return t.ColumnChart.validLabelPositionsAutoClustered}}function w(e){switch(e){case t.labelPosition.insideEnd:return[4];case t.labelPosition.insideBase:return[2];case t.labelPosition.insideCenter:return[1];default:return t.ColumnChart.validLabelPositionsAutoStacked}}i.DimmedOpacity=.4,i.DefaultOpacity=1,i.applyUserMinMax=a,i.transformDomain=o,i.getCategoryAxis=s,i.applyInteractivity=l,i.getFillOpacity=u,i.getClosestColumnIndex=c,i.setSelectedColumnOpacity=d,i.drawSeries=p,i.drawDefaultShapes=h,i.drawDefaultLabels=g,i.normalizeInfinityInScale=f,i.calculatePosition=m,i.createLabelDataPoints=y})(i=t.ColumnUtil||(t.ColumnUtil={}));var o;!(function(e){function t(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}e.clearColumns=t})(o=t.ClusteredUtil||(t.ClusteredUtil={}));var s;!(function(i){function a(e,i,a){return void 0===a&&(a=0),t.AxisHelper.diffScaled(e,a,i)}function r(t,i){var a={min:0,max:10};if(0===t.length)return a;var r=d3.min(t,(function(e){return d3.min(e.data,(function(e){return e.position-e.valueAbsolute}))})),n=d3.max(t,(function(e){return d3.max(e.data,(function(e){return e.position}))}));return i&&(r=e.Double.roundToPrecision(r,s),n=e.Double.roundToPrecision(n,s)),{min:r,max:n}}function n(e,i){for(var a=0,r=0,n=0,o=e.length;n<o;n++){var s=e[n][i];s=t.AxisHelper.normalizeNonFiniteNumber(s),s>0?a+=s:s<0&&(r-=s)}var l=a+r;return{pos:a?a/l/a:1,neg:r?r/l/r:1}}function o(e,t){var i=e.selectAll(t.selector).data([]);i.exit().remove()}var s=1e-4;i.getSize=a,i.calcValueDomain=r,i.getStackedMultiplier=n,i.clearColumns=o})(s=t.StackedUtil||(t.StackedUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.data.HierarchyVisitor;!(function(i){function a(t,i,a){if(!t||!t.categorical||_.isEmpty(t.categorical.categories))return t;var r=t.categorical.categories,s=n(r,i),l=o(r,a),u=e.Prototype.inheritSingle(t),c=e.Prototype.inheritSingle(u.metadata.columns);c.push(l);var d=e.Prototype.inheritSingle(u.metadata);d.columns=c,u.metadata=d;var p=t.categorical,h=e.data.DataViewCategoricalUtils.getCategoriesDataViewObjects(p.categories),g={source:l,values:s},f=t.categorical.categories[0];f.identity&&(g.identity=f.identity),f.identityFields&&(g.identityFields=f.identityFields),h&&(g.objects=h);var m=[g],y=e.Prototype.inheritSingle(p);return y.categories=m,u.categorical=y,u}function n(i,a){for(var r=[],n=0,o=i;n<o.length;n++)for(var s=o[n],l=s.values,u=t.valueFormatter.getFormatString(s.source,a),c=t.valueFormatter.create({format:u,value:l[0],value2:l[l.length-1],displayUnitSystemType:e.DisplayUnitSystemType.Verbose}),d=0,p=s.values.length;d<p;d++){var h=s.values[d],g=c.format(h),f=r[d];f||(f=[],r.splice(d,0,f)),f.push(g)}return _.map(r,(function(e){return e.join(" ")}))}function o(t,i){var a=r.getCategoryLevels(t),n=r.concatenateCategoryLevels(a),o={};o[i]=!0;var s={displayName:n.displayName,roles:o,type:e.ValueType.fromPrimitiveTypeAndCategory(1)},l=_.last(t).source;return void 0!==l.isMeasure&&(s.isMeasure=l.isMeasure),s.queryName=l.queryName,s}i.concatenateCategories=a,i.buildConcatenatedValues=n,i.buildConcatenatedMetadataColumn=o})(i=t.DataViewConcatenateUtil||(t.DataViewConcatenateUtil={}));var r;!(function(e){function i(e){return{displayName:_.map(e,(function(e){return e.displayName})).join(" "),value:_.map(e,(function(e){return e.value})).join(" ")}}function r(e,i,r){for(var n=null!=i,o=null,s=null,l=null,u=[],c=0;c<e.length;c++){var d=e[c],p=d.source;if(p){var h=p.expr?a.getProperty(p.expr):null;null!=h?(h===o?s=p.displayName:(null!==o&&u.push({displayName:o+" "+s,value:l.join(" ")}),o=h,s=p.displayName,l=null,n&&(l=[])),n&&l.push(t.converterHelper.formatFromMetadataColumn(d.values[i],p,r,!1))):null!=o?(u.push({displayName:o+" "+s,value:l?l.join(" "):null}),o=null,s=null,l=null,u.push({displayName:p.displayName,value:n?t.converterHelper.formatFromMetadataColumn(d.values[i],p,r,!1):null})):u.push({displayName:p.displayName,value:n?t.converterHelper.formatFromMetadataColumn(d.values[i],p,r,!1):null})}}return null!=o&&u.push({displayName:o+" "+s,value:n?l.join(" "):null}),u}e.concatenateCategoryLevels=i,e.getCategoryLevels=r})(r=t.CategoryLevelUtils||(t.CategoryLevelUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.data.DataRoleHelper;!(function(i){function r(e,t,i){if(e.categories&&e.categories.length>0){var r=e.categories[0];return r.source&&a.hasRole(r.source,t)&&a.hasRole(r.source,i)}return!1}function n(i,a){if(i.categories&&i.categories.length>0){var r=_.last(i.categories),n=r.values;return r.values.length>0?{categories:n,categoryFormatter:t.valueFormatter.create({format:t.valueFormatter.getFormatString(r.source,a),value:n[0],value2:n[n.length-1],displayUnitSystemType:e.DisplayUnitSystemType.Verbose}),categoryIdentities:r.identity,categoryObjects:r.objects}:{categories:[],categoryFormatter:{format:t.valueFormatter.format}}}return l()}function o(e){return void 0!==e.groupName?e.groupName:e.queryName}function s(e,i,a){var r=e,n=e.displayName;return void 0!==e.groupName&&(r=i.source,n=e.groupName),t.valueFormatter.format(n,t.valueFormatter.getFormatString(r,a))}function l(){return{categories:[null],categoryFormatter:{format:t.valueFormatter.format}}}function u(e,i,a,r){var n=null,o=null;if(e&&a&&a.displayName&&(n=a.displayName),i){var s=[];r&&(s=r.map((function(e){return e?e.displayName:""})).filter((function(e,t,i){return""!==e&&i.indexOf(e)===t})),o=t.valueFormatter.formatListAnd(s))}return{xAxisLabel:n,yAxisLabel:o}}function c(e){var t=p(e);return null!=t&&t.imageUrl===!0}function d(e){var t=p(e);return null!=t&&t.webUrl===!0}function p(e){return e&&e.type&&e.type.misc}function h(e){return!(!e||!e.metadata||_.isEmpty(e.metadata.columns))&&_.any(e.metadata.columns,(function(e){return c(e)===!0}))}function g(e,i,a,r){void 0===r&&(r=!0);var n=t.valueFormatter.getFormatString(i,a,r);return!n&&i&&(n=i.format),t.valueFormatter.format(e,n)}i.categoryIsAlsoSeriesRole=r,i.getPivotedCategories=n,i.getSeriesName=o,i.getFormattedLegendLabel=s,i.createAxesLabels=u,i.isImageUrlColumn=c,i.isWebUrlColumn=d,i.hasImageUrlColumn=h,i.formatFromMetadataColumn=g})(i=t.converterHelper||(t.converterHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.CssConstants.createClassAndSelector,n=t.labelStyle,o=a.PixelConverter;!(function(i){function a(e,t,a){e&&(void 0!==e.show&&(t.show=e.show),void 0!==e.showSeries&&(t.show=e.showSeries),void 0!==e.color&&(t.labelColor=e.color.solid.color),void 0!==e.labelDisplayUnits&&(t.displayUnits=e.labelDisplayUnits),void 0!==e.labelPrecision&&(t.precision=e.labelPrecision>=0?e.labelPrecision:i.defaultLabelPrecision),void 0!==e.fontSize&&(t.fontSize=e.fontSize),void 0!==e.showAll&&(t.showLabelPerSeries=e.showAll),void 0!==e.labelStyle&&(t.labelStyle=e.labelStyle),void 0!==e.labelOrientation&&(t.labelOrientation=a?e.labelOrientation:t.labelOrientation),e.labelPosition&&(t.position=e.labelPosition))}function s(e,t,a){return void 0===e&&(e=!1),{show:e,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:t||i.defaultLabelColor,fontSize:a||i.DefaultFontSizeInPt}}function l(e,t,i){var a=s(!0,e,i);return a.showCategory=!0,a.categoryLabelColor=t,a}function u(){return{show:!1,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultInsideLabelColor,showCategory:!0}}function c(){return{show:!1,labelColor:i.defaultInsideLabelColor,fontSize:i.DefaultFontSizeInPt,displayUnits:0,precision:i.defaultLabelPrecision,showCategory:!0}}function d(e,a,r){return void 0===e&&(e=!1),{show:e,labelOrientation:1,position:t.labelPosition.auto,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:a||i.defaultLabelColor,fontSize:r||i.DefaultFontSizeInPt}}function p(e){var t=s(!1,void 0);return t.position=null,t.labelColor=void 0,t.labelDensity=i.defaultLabelDensity,t.labelOrientation=1,t}function h(){return{show:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,fontSize:i.DefaultFontSizeInPt}}function g(e){return{show:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,fontSize:i.DefaultFontSizeInPt,labelDensity:i.defaultLabelDensity}}function f(){return{show:!1,showCategory:!1,position:0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultInsideLabelColor,fontSize:i.DefaultFontSizeInPt}}function m(){var e=i.getDefaultLabelSettings(!0,i.defaultLabelColor,i.DefaultFontSizeInPt);return e.labelStyle=n.category,e}function y(){return{show:!0,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:null,position:null,fontSize:i.minLabelFontSize}}function v(){return{show:!1,displayUnits:0,precision:i.defaultLabelPrecision,labelColor:i.defaultLabelColor,position:null,showCategory:!0}}function w(t,a){if(t!==i.defaultLabelPrecision)return t;if("g"!==a&&"G"!==a){if(a){var r=e.NumberFormat.getComponents(a).positive,n=e.NumberFormat.getCustomFormatMetadata(r,!0);if(n.hasDots){if(n.optionalPrecision)return;return n.precision}}return z}}function b(i,a,r,n,o,s,l){void 0===o&&(o=!1);var u=new e.DataLabelManager,c=u.hideCollidedLabels(n,i,r),d=o&&!!s,p=C(c,a,!1,d);if(p)return d?(p.text((function(e){return e.labeltext})).transition().duration(s).style(r.style).style("opacity",l?function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,l,!1)}:1).attr({x:function(e){return e.labelX},y:function(e){return e.labelY}}),p.exit().transition().duration(s).style("opacity",0).remove()):(p.attr({x:function(e){return e.labelX},y:function(e){return e.labelY}}).text((function(e){return e.labeltext})).style(r.style),p.exit().remove()),p}function C(e,t,i,a){if(void 0===i&&(i=!1),void 0===a&&(a=!1),0===e.length)return S(t,!0),null;t.select(U.selector).empty()&&t.append("g").classed(U.class,!0);var r=null!=e[0].key,n=null!=e[0].identity,o=r?function(e){return e.key}:n?function(e){return e.identity.getKey()}:void 0,s=i?t.select(U.selector).selectAll(W.selector).data(e,(function(e){return e.data.identity.getKey()})):null!=o?t.select(U.selector).selectAll(W.selector).data(e,o):t.select(U.selector).selectAll(W.selector).data(e),l=s.enter().append("text").classed(W.class,!0);return a&&l.style("opacity",0),s}function S(e,t){void 0===t&&(t=!1);var i=[],a=e.selectAll(W.selector).data(i);if(a.exit().remove(),e.selectAll(U.selector).remove(),t){var r=e.selectAll(q.selector).data(i);r.exit().remove(),e.selectAll(B.selector).remove()}}function x(e,i,a){e.selectAll(W.selector).style("fill-opacity",(function(e){var r=t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a)<1?0:1;return r}))}function P(t){var a={text:t.formatter?t.formatter.format(t.label):e.formattingService.formatValue(t.label,t.format),fontFamily:i.LabelTextProperties.fontFamily,fontSize:o.fromPoint(t.fontSize),fontWeight:i.LabelTextProperties.fontWeight};return e.TextMeasurementService.getTailoredTextOrDefault(a,t.maxWidth?t.maxWidth:i.maxLabelWidth)}function D(e,t,i,a){return{x:function(i){return e.scale(i.categoryIndex)+t/2},y:function(e){return T(i.scale,e,a)}}}function T(t,a,r){var n=t(0)-t(Math.abs(a.value)),o=t(a.position),s=t(r[0]),l=t(a.position+a.value);if(a.value<0){var u={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},c=o+n+e.TextMeasurementService.estimateSvgTextHeight(u);if(s>c)return c}else{var d=o-n-i.labelMargin;if(d>0)return d}return a.isLabelInside=!0,V(o,l,s)}function V(e,t,i){return e=e<0?0:e,e=e>i?i:e,t=t<0?0:t,t=t>i?i:t,Math.abs(t-e)/2+Math.min(e,t)}function _(a,r,n){if(null==a||null===a.value)return!1;var o={text:n.labelText(a),fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},s=t.WaterfallChart.getRectTop(r.scale,a.position,a.value)-i.labelMargin;if(s>0)return!0;var l=e.TextMeasurementService.measureSvgTextWidth(o),u=e.TextMeasurementService.estimateSvgTextHeight(o),c=n.categoryWidth,d=Math.abs(t.AxisHelper.diffScaled(r.scale,Math.max(0,Math.abs(a.value)),0));return!(l>c||u>d)}function L(e){return{labelText:function(t){return P({label:t.labeltext,fontSize:e.fontSize})},labelLayout:{x:function(e){return e.x},y:function(t){var a=t.radius+i.labelMargin;return 0===e.position?t.y-a:t.y+a}},filter:function(e){return null!=e&&null!=e.labeltext},style:{fill:function(e){return e.labelFill},"font-size":o.fromPoint(e.fontSize)}}}function M(e,t,a,r,n,o,s,l){var u=r?i.hundredPercentFormat:null,c=j(),d=!!s&&s.hasSelection();return{labelText:function(e){var t=null!=u?u:e.labelFormatString,a=F(n,e.labelSettings),r=c.getOrCreate(t,e.labelSettings,a);return P({label:r.format(e.value),maxWidth:i.maxLabelWidth})},labelLayout:t,filter:function(t){return i.getColumnChartLabelFilter(t,d,e.hasHighlights,o,l)},style:{fill:function(e){return e.labelFill},"text-anchor":a?"middle":"start"}}}function N(a,r,n){var o,s,l=r.xScale,u=r.yScale,c=r.columnWidth,d={text:a.labeltext,fontFamily:i.LabelTextProperties.fontFamily,fontSize:i.LabelTextProperties.fontSize,fontWeight:i.LabelTextProperties.fontWeight},p=e.TextMeasurementService.measureSvgTextWidth(d),h=e.TextMeasurementService.estimateSvgTextHeight(d),g=!1,f=t.ColumnUtil.calculatePosition(a,r);switch(a.chartType){case t.ColumnChartType.stackedBar:case t.ColumnChartType.hundredPercentStackedBar:(!a.lastSeries||f+p>n||a.chartType===t.ColumnChartType.hundredPercentStackedBar)&&(o=-t.StackedUtil.getSize(l,a.valueAbsolute),s=c,g=!0);break;case t.ColumnChartType.clusteredBar:f+p>n&&(o=Math.abs(t.AxisHelper.diffScaled(l,0,a.value)),s=c,g=!0);break;case t.ColumnChartType.stackedColumn:case t.ColumnChartType.hundredPercentStackedColumn:(!a.lastSeries||f<=0||a.chartType===t.ColumnChartType.hundredPercentStackedColumn)&&(o=c,s=t.StackedUtil.getSize(u,a.valueAbsolute),g=!0);break;case t.ColumnChartType.clusteredColumn:f<=0&&(o=c,s=Math.abs(t.AxisHelper.diffScaled(u,0,a.value)),g=!0);break;default:return!0}return!g||!(p>o||h>s)}function I(e,i,a,r,n){var o=i?t.ColumnUtil.getFillOpacity(e.selected,e.highlight,!e.highlight&&i,!e.selected&&a):t.ColumnUtil.getFillOpacity(e.selected,e.highlight,i,a);return null!=e&&null!=e.value&&N(e,r,n)&&1===o}function A(e,a,r,n,o){return{labelText:function(e){return P({label:e.formattedCategory.getValue(),maxWidth:2*i.maxLabelWidth})},labelLayout:{x:function(t){return e(t.x)},y:function(e){var s=t.ScatterChart.getBubbleRadius(e.radius,o,n)+i.labelMargin;return 0===r.position?a(e.y)-s:a(e.y)+s}},filter:function(e){return null!=e&&null!=e.formattedCategory.getValue()},style:{fill:function(e){return e.labelFill}}}}function O(e,t,a,r,n){var s=j();return{labelText:function(e){var t=F(n,e.labelSettings),i=s.getOrCreate(e.labelFormatString,e.labelSettings,t);return P({label:i.format(e.value)})},labelLayout:{x:function(t){return e(r?t.categoryValue:t.categoryIndex)},y:function(e){return 0===a.position?t(e.value)-i.labelMargin:t(e.value)+i.labelMargin}},filter:function(e){return null!=e&&null!=e.value},style:{fill:function(e){return e.labelFill},"font-size":function(e){return o.fromPoint(e.labelSettings.fontSize)}}}}function R(e){if(e.dataLabelsSettings){var t={objectName:"labels",selector:e.selector,properties:{}};if(e.show&&e.selector?t.properties.showSeries=e.dataLabelsSettings.show:e.show&&(t.properties.show=e.dataLabelsSettings.show),t.properties.color=e.dataLabelsSettings.labelColor||i.defaultLabelColor,e.displayUnits&&(t.properties.labelDisplayUnits=e.dataLabelsSettings.displayUnits),e.precision){var a=e.dataLabelsSettings.precision;t.properties.labelPrecision=a===i.defaultLabelPrecision?null:a}if(e.labelOrientation&&(t.properties.labelOrientation=e.dataLabelsSettings.labelOrientation),e.position&&(t.properties.labelPosition=e.dataLabelsSettings.position,e.positionObject&&(t.validValues={labelPosition:e.positionObject})),e.labelStyle&&(t.properties.labelStyle=e.dataLabelsSettings.labelStyle),e.fontSize&&(t.properties.fontSize=e.dataLabelsSettings.fontSize),e.labelDensity){var r=e.dataLabelsSettings;r&&(t.properties.labelDensity=r.labelDensity)}return e.showAll&&(t.properties.showAll=e.dataLabelsSettings.showLabelPerSeries),e.enumeration.pushInstance(t)}}function E(e,t,a,r,n){
void 0===r&&(r=!1);var o=t?t:h(),s={objectName:"categoryLabels",selector:null,properties:{show:r?o.showCategory:o.show,fontSize:t?t.fontSize:i.DefaultFontSizeInPt}};a&&(s.properties.color=o.categoryLabelColor?o.categoryLabelColor:o.labelColor),n&&(s.properties.fontSize=n),e.pushInstance(s)}function F(e,t){return e&&e.displayUnit&&0===t.displayUnits?e.displayUnit.value:null}function j(){return new K}function H(t,i,a,r){return{displayUnitSystemType:e.DisplayUnitSystemType.DataLabels,format:i,precision:r,value:t.displayUnits,value2:a,allowFormatBeautification:!0}}function G(e,t){return e>t}function k(e,t){return e>t}i.minLabelFontSize=8,i.labelMargin=8,i.maxLabelWidth=50,i.defaultColumnLabelMargin=5,i.defaultColumnHalfLabelHeight=4,i.defaultLabelDensity="50",i.DefaultDy="-0.15em",i.DefaultFontSizeInPt=9,i.StandardFontFamily=t.Font.Family.regular.css,i.LabelTextProperties={fontFamily:t.Font.Family.regularSecondary.css,fontSize:o.fromPoint(i.DefaultFontSizeInPt),fontWeight:"normal"},i.defaultLabelColor="#777777",i.defaultInsideLabelColor="#ffffff",i.hundredPercentFormat="0.00 %;-0.00 %;0.00 %",i.defaultLabelPrecision=void 0;var z=0,U=r("labels"),B=r("lines"),W=r("data-labels"),q=r("line-label");i.updateLabelSettingsFromLabelsObject=a,i.getDefaultLabelSettings=s,i.getDefaultCardLabelSettings=l,i.getDefaultTreemapLabelSettings=u,i.getDefaultSunburstLabelSettings=c,i.getDefaultWaterfallLabelSettings=d,i.getDefaultColumnLabelSettings=p,i.getDefaultPointLabelSettings=h,i.getDefaultLineChartLabelSettings=g,i.getDefaultMapLabelSettings=f,i.getDefaultDonutLabelSettings=m,i.getDefaultGaugeLabelSettings=y,i.getDefaultKpiLabelSettings=v,i.getLabelPrecision=w,i.drawDefaultLabelsForDataPointChart=b,i.cleanDataLabels=S,i.setHighlightedLabelsOpacity=x,i.getLabelFormattedText=P,i.getLabelLayoutXYForWaterfall=D,i.doesDataLabelFitInShape=_,i.getMapLabelLayout=L,i.getColumnChartLabelLayout=M,i.getColumnChartLabelFilter=I,i.getScatterChartLabelLayout=A,i.getLineChartLabelLayout=O,i.enumerateDataLabels=R,i.enumerateCategoryLabels=E,i.createColumnFormatterCacheManager=j,i.getOptionsForLabelFormatter=H,i.isTextWidthOverflows=G,i.isTextHeightOverflows=k;var K=(function(){function e(){this.cache={defaultFormatter:null}}return e.prototype.getOrCreate=function(e,i,a){if(e){var r={formatString:e,displayUnits:i.displayUnits,precision:w(i.precision,e),value2:a},n=JSON.stringify(r);return this.cache[n]||(this.cache[n]=t.valueFormatter.create(H(i,e,a,r.precision))),this.cache[n]}return this.cache.defaultFormatter||(this.cache.defaultFormatter=t.valueFormatter.create(H(i,e,a,i.precision))),this.cache.defaultFormatter},e})()})(i=t.dataLabelUtils||(t.dataLabelUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i,a,r){void 0===r&&(r=0);var n,o,s,l=2.05;if(r){var u=r,c=i.radius*i.outerArcRadiusRatio,d=i.radius/2*i.innerArcRadiusRatio;o=[Math.cos(u)*c,Math.sin(u)*c],s=[Math.cos(u)*d,Math.sin(u)*d]}else o=i.outerArc.centroid(t),s=i.arc.centroid(t);var p=a.x,h=e.NewDataLabelUtils.maxLabelOffset/2;return p+=p<0?-h:h,n=[p,a.y],s[0]*=l,s[1]*=l,[s,o,n]}function a(e){if(e&&e.length>2){var i={width:Math.abs(e[1][0]-e[0][0]),height:Math.abs(e[1][1]-e[0][1])},a={width:Math.abs(e[2][0]-e[1][0]),height:t.LineStrokeWidth};return[i,a]}return null}function r(t){var i=t<0?-e.NewDataLabelUtils.maxLabelOffset:e.NewDataLabelUtils.maxLabelOffset;return t+=i}function n(t,i){return i.width/2-Math.abs(t)-e.NewDataLabelUtils.maxLabelOffset}t.LineStrokeWidth=1,t.DiagonalLineIndex=0,t.HorizontalLineIndex=1,t.getLabelLeaderLineForDonutChart=i,t.getLabelLeaderLinesSizeForDonutChart=a,t.getXPositionForDonutLabel=r,t.getSpaceAvailableForDonutLabels=n})(t=e.DonutLabelUtils||(e.DonutLabelUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){if(e){var t=e,i=t.handled;return!!i}}function i(e){if(e){var t=e;t.handled=!0}}e.handled=t,e.markAsHandled=i})(t=e.EventBubblingUtil||(e.EventBubblingUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){try{for(var t=e.objects[Object.keys(e.objects)[0]].geometries,i=!1,a={},r=0,n=t;r<n.length;r++){var o=n[r];if(i=i||null!=o.id,o.properties)for(var s=Object.keys(o.properties),l=0,u=s;l<u.length;l++){var c=u[l];a[c]=!0}}var d=Object.keys(a).sort();_.pull(d,"id");for(var p=[],h=0,g=t;h<g.length;h++){var o=g[h],f=[];if(i&&f.push(o.id),o.properties)for(var m=0,y=d;m<y.length;m++){var v=y[m];f.push(o.properties[v])}p.push(f)}if(d=(i?["id"]:[]).concat(d),!_.isEmpty(d)&&!_.isEmpty(p))return{names:d,values:p}}catch(e){}}e.getTopoJsonShapeKeys=t})(t=e.GeoJsonHelper||(e.GeoJsonHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.CssConstants.createClassAndSelector,n=a.PixelConverter;!(function(i){function o(e){return 0===e.labelOrientation?e.boundingBox.left+e.boundingBox.width:e.boundingBox.left+e.boundingBox.width/2}function s(e){return e.hasBackground?0===e.labelOrientation?e.boundingBox.top+e.boundingBox.height/2-i.horizontalLabelBackgroundPadding:e.boundingBox.top+e.boundingBox.height-i.verticalLabelBackgroundPadding:0===e.labelOrientation?e.boundingBox.top+e.boundingBox.height/2:e.boundingBox.top+e.boundingBox.height}function l(e){return e.boundingBox.left+e.boundingBox.width/2}function u(e){var t=void 0!==e.text?e.boundingBox.height/2:e.boundingBox.height;return e.hasBackground?e.boundingBox.top+t-i.verticalLabelBackgroundPadding:e.boundingBox.top+t}function c(e,t,a,r,c){void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===c&&(c=!1);var d=e.selectAll(M.selector).data(t,x);d.enter().append("text").classed(M.class,!0);var p={transform:function(e){var t="translate("+o(e)+","+s(e)+")";return 0===e.labelOrientation?t+"rotate(-90)":t},dy:"-0.15em"};a&&(p.dy=void 0),d.interrupt().text((function(e){return e.text})).attr(p).style({fill:function(e){return e.fill},"font-size":function(e){return n.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)},"text-anchor":function(e){return e.textAnchor}}),d.exit().remove();var h=_.filter(r?t:[],(function(e){return!_.isEmpty(e.secondRowText)})),g=e.selectAll(N.selector).data(h,(function(e,t){return e.identity?e.identity.getKeyWithoutHighlight():t}));return g.enter().append("text").classed(N.class,!0),p={transform:function(e){return"translate("+l(e)+","+u(e)+")"},dy:"-0.15em"},a&&(p.dy=void 0),g.interrupt().text((function(e){return e.secondRowText})).attr(p).style({fill:function(e){return e.fill},"font-size":function(e){return n.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)},"text-anchor":function(e){return e.textAnchor}}),g.exit().remove(),c&&(d.append("title").text((function(e){return e.tooltip})),g.append("title").text((function(e){return e.tooltip})),d.style("pointer-events","all"),g.style("pointer-events","all")),d}function d(e,t,a,r,l){void 0===r&&(r=!1),void 0===l&&(l="cubic-in-out");var u=e.selectAll(M.selector).data(t,x),c={transform:function(e){var t="translate("+o(e)+","+s(e)+")";return 0===e.labelOrientation?t+"rotate(-90)":t},dy:"-0.15em"};return r&&(c.dy=void 0),u.enter().append("text").classed(M.class,!0).style("opacity",0).attr(c),u.text((function(e){return e.text})).style({fill:function(e){return e.fill},"font-size":function(e){return n.fromPoint(e.fontSize||i.DefaultLabelFontSizeInPt)}}).transition().ease(l).duration(a).attr(c).style("opacity",1),u.exit().transition().duration(a).style("opacity",0).remove(),u}function p(e,t,a,r){var n=e.selectAll("rect").data(t,x);return n.enter().append("rect"),n.attr({x:function(e){return e.boundingBox.left-i.horizontalLabelBackgroundPadding},y:function(e){return e.boundingBox.top-i.verticalLabelBackgroundPadding},rx:T,ry:T,width:function(e){return e.boundingBox.width+2*i.horizontalLabelBackgroundPadding},height:function(e){return void 0===e.text&&void 0===e.secondRowText?0:e.boundingBox.height+2*i.verticalLabelBackgroundPadding}}).style("fill",a?a:"#000000").style("fill-opacity",null!=r?r:1),n.exit().remove(),n}function h(e,i,a,r){e.select(I.selector).empty()&&e.append("g").classed(I.class,!0);var n=e.select(I.selector).selectAll("polyline").data(i,a);n.enter().append("polyline").classed(A.class,!0),n.attr("points",(function(e){return e.leaderLinePoints})).style({stroke:function(e){return r?r:e.fill},"stroke-width":t.DonutLabelUtils.LineStrokeWidth}),n.exit().remove()}function g(t,i,a){return a?a.format(t):e.formattingService.formatValue(t,i)}function f(e,i){var a,r,n=e.formatter;if(n&&n.displayUnit&&0===i.displayUnits&&(a=n.displayUnit.value,null==i.precision))if(e.formatter.options&&e.formatter.options.precision)r=e.formatter.options.precision+1;else{var o=e.axis.tickValues();if(o&&o.length){var s=o[0],l=o.length>1?o[1]:void 0;r=t.AxisHelper.calculateAxisPrecision(s,l,10*a,e.formatter.options&&e.formatter.options.format)}}return{units:a,precision:r}}function m(e,t){return e&&e.displayUnit&&0===t.displayUnits?e.displayUnit.value:null}function y(t,i){if(t!==V)return t;if("g"!==i&&"G"!==i){if(i){var a=i.split(";")[0],r=e.NumberFormat.getCustomFormatMetadata(a,!0);if(r.hasDots){if(r.optionalPrecision)return;return r.precision}}return L}}function v(){return new O}function w(t,i,a,r){return{displayUnitSystemType:e.DisplayUnitSystemType.DataLabels,format:i,precision:r,value:t.displayUnits,value2:a,allowFormatBeautification:!0}}function b(e){for(var i=[],a={},r=function(e,i,a){return i.some((function(i){return a?t.shapes.Rect.equals(e.parentShape.rect,i.rect):t.shapes.Point.equals(e.parentShape.point,i.point)}))},n=0,o=e;n<o.length;n++){var s=o[n],l=1===s.parentType,u=a[s.text];u?r(s,u,l)||(i.push(s),u.push(s.parentShape)):(i.push(s),a[s.text]=[s.parentShape])}return i}function C(e){switch(e){case 9:return{maximumOffset:t.ScatterChart.dataLabelLayoutMaximumOffset,startingOffset:t.ScatterChart.dataLabelLayoutStartingOffset,offsetIterationDelta:t.ScatterChart.dataLabelLayoutOffsetIterationDelta,allowLeaderLines:!0,attemptToMoveLabelsIntoViewport:!0};default:return{maximumOffset:i.maxLabelOffset,startingOffset:i.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0}}}function S(t,r){var n=i.LabelTextProperties,o={text:t,fontFamily:n.fontFamily,fontSize:a.PixelConverter.fromPoint(r),fontWeight:n.fontWeight};return{width:e.TextMeasurementService.measureSvgTextWidth(o),height:e.TextMeasurementService.estimateSvgTextHeight(o)}}function x(e,t){return e.key?e.key:e.identity?e.identity.getKeyWithoutHighlight():t}function P(e,t,i,a){if(null==t||0===t)return i;var r=t/100,n=Math.ceil(e/a);return 1===r?n:i+Math.floor(r*(n-i))}function D(e,i,a){t.dataLabelUtils.updateLabelSettingsFromLabelsObject(e,i,a),e&&void 0!==e.labelDensity&&(i.labelDensity=e.labelDensity)}i.DefaultLabelFontSizeInPt=9,i.MapPolylineOpacity=.5,i.LabelDensityBufferFactor=3,i.LabelDensityPadding=6,i.startingLabelOffset=8,i.maxLabelOffset=8,i.maxLabelWidth=50,i.hundredPercentFormat="0.00 %;-0.00 %;0.00 %",i.LabelTextProperties={fontFamily:t.Font.Family.regularSecondary.css,fontSize:n.fromPoint(i.DefaultLabelFontSizeInPt),fontWeight:"normal"},i.defaultLabelColor="#777777",i.defaultInsideLabelColor="#ffffff",i.horizontalLabelBackgroundPadding=4,i.verticalLabelBackgroundPadding=2;var T=4,V=void 0,L=0;i.labelGraphicsContextClass=r("labelGraphicsContext"),i.labelBackgroundGraphicsContextClass=r("labelBackgroundGraphicsContext");var M=r("label"),N=r("label-second-line"),I=r("leader-lines"),A=r("line-label");i.drawDefaultLabels=c,i.animateDefaultLabels=d,i.drawLabelBackground=p,i.drawLabelLeaderLines=h,i.getLabelFormattedText=g,i.getLabelUnitAndPrecisionForAxis=f,i.getDisplayUnitValueFromAxisFormatter=m,i.createColumnFormatterCacheManager=v,i.removeDuplicates=b,i.getDataLabelLayoutOptions=C,i.getTextSize=S,i.getNumberOfLabelsToRender=P,i.updateLabelSettingsFromLabelsObjectWithLabelDensity=D;var O=(function(){function e(){this.cache={defaultFormatter:null}}return e.prototype.getOrCreate=function(e,i,a,r){if(null==r&&(r=i.precision),e){var n={formatString:e,displayUnits:i.displayUnits,precision:y(r,e),value2:a},o=JSON.stringify(n);return this.cache[o]||(this.cache[o]=t.valueFormatter.create(w(i,e,a,n.precision))),this.cache[o]}return this.cache.defaultFormatter||(this.cache.defaultFormatter=t.valueFormatter.create(w(i,e,a,r))),this.cache.defaultFormatter},e})()})(i=t.NewDataLabelUtils||(t.NewDataLabelUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){var i=parseFloat(t);if(e){var a=h[e.graphic.toUpperCase()];if(a&&!isNaN(i)){var r=a.statusValues;e.normalizedFiveStateKpiRange&&5===r.length&&(i=2*i);var n=i+Math.floor(r.length/2);return[a.kpiIconClass,r[n]].join(" ").trim()}}}function i(e,t){if(e)return 1===t?[n,o,e].join(" "):[n,e].join(" ")}function a(e,a,r){var n=t(e,a);return i(n,r)}function r(e,a,r){var n=e&&e.kpi;if(n){var o=t(n,a);if(o)return{caption:o,statusGraphic:n.graphic,class:i(o,r)}}}var n="powervisuals-glyph",o="big-kpi",s=["kpi-red","kpi-yellow","kpi-green"],l={kpiIconClass:"circle",statusValues:s},u={kpiIconClass:"",statusValues:["circle-x kpi-red","circle-exclamation kpi-yellow","circle-checkmark kpi-green"]},c={kpiIconClass:"traffic-light",statusValues:s},d={kpiIconClass:"",statusValues:["rhombus kpi-red","triangle kpi-yellow","circle kpi-green"]},p={kpiIconClass:"",statusValues:["circle-empty","circle-one-quarter","circle-half","circle-three-quarters","circle-full"]},h={"THREE CIRCLES COLORED":l,"TRAFFIC LIGHT - SINGLE":l,"THREE FLAGS COLORED":{kpiIconClass:"flag",statusValues:s},"ROAD SIGNS":u,"THREE SYMBOLS CIRCLED COLORED":u,"TRAFFIC LIGHT":c,"THREE TRAFFIC LIGHTS RIMMED COLORED":c,"THREE SYMBOLS UNCIRCLED COLORED":{kpiIconClass:"",statusValues:["x kpi-red","exclamation kpi-yellow","checkmark kpi-green"]},SHAPES:d,"SMILEY FACE":d,THERMOMETER:d,CYLINDER:d,"THREE SIGNS COLORED":d,"THREE STARS COLORED":{kpiIconClass:"star-stacked",statusValues:["star-empty","star-half-full","star-full"]},"FIVE BARS COLORED":{kpiIconClass:"bars-stacked",statusValues:["bars-zero","bars-one","bars-two","bars-three","bars-four"]},"FIVE BOXES COLORED":{kpiIconClass:"boxes-stacked",statusValues:["boxes-zero","boxes-one","boxes-two","boxes-three","boxes-four"]},"FIVE QUARTERS COLORED":p,"GAUGE - ASCENDING":p,"GAUGE - DESCENDING":{kpiIconClass:"",statusValues:["circle-full","circle-three-quarters","circle-half","circle-one-quarter","circle-empty"]},"STANDARD ARROW":{kpiIconClass:"",statusValues:["arrow-down","arrow-right-down","arrow-right","arrow-right-up","arrow-up"]},"VARIANCE ARROW":{kpiIconClass:"",statusValues:["arrow-down kpi-red","arrow-right kpi-yellow","arrow-up kpi-green"]},"STATUS ARROW - ASCENDING":{kpiIconClass:"",statusValues:["arrow-down kpi-red","arrow-right-down kpi-yellow","arrow-right kpi-yellow","arrow-right-up kpi-yellow","arrow-up kpi-green"]},"STATUS ARROW - DESCENDING":{kpiIconClass:"",statusValues:["arrow-up kpi-green","arrow-right-up kpi-yellow","arrow-right kpi-yellow","arrow-right-down kpi-yellow","arrow-down kpi-red"]}};e.getClassForKpi=a,e.getKpiImageMetadata=r})(t=e.KpiUtil||(e.KpiUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){return null==e&&null==t||null!=e&&null!=t&&e.getTime()===t.getTime()}e.isEqual=t})(t=e.DateUtil||(e.DateUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Minimum=0]="Minimum",e[e.Maximum=1]="Maximum",e[e.Neither=2]="Neither"})(t||(t={}));var i=(function(){function e(e){this.unsortedLabelDataPointGroups=e.unsortedLabelDataPointGroups,this.series=e.series,this.yScale=e.yAxisProperties.scale,this.viewport=e.viewport}return e.prototype.getSortedDataLabels=function(){for(var t=this.unsortedLabelDataPointGroups,i=[],a=0,r=t.length;a<r;a++){var n=t[a],o=e.maxNumberToSortFactor*n.maxNumberOfLabels;if(!_.isEmpty(n.labelDataPoints)){var s=n.labelDataPoints,l=[],u=_.filter(this.series[a].data,(function(e){return e&&null!=e.value})),c=e.getMinMaxInRange(0,u.length-1,u),d=this.addFirstLastMaxMin(s,l,c.maxIndex,c.minIndex),p=void 0;if(!(d>=o)){p=this.calculateWeights(s,u,o,c);var h=Math.max(o-d,0);d+=this.addLocalMinMaxes(p,l,c.maxIndex,c.minIndex,h)}if(!(d>=o)){var g=Math.max(o-d,0);this.addNonMinMaxes(p,l,g)}i.push({labelDataPoints:l,maxNumberOfLabels:n.maxNumberOfLabels})}}return i},e.prototype.calculateWeights=function(t,i,a,r){for(var n,o,s=i.length,l=this.yScale,u=this.findMinMaxesBasedOnSmoothedValues(t,i),c=Math.abs(l(r.maxValue)-l(r.minValue)),d=0,p=u.length;d<p;d++){o=u[d];var h=void 0;if(n){var g=Math.abs((l(n.value)-l(o.value))/c),f=Math.abs(n.index-o.index)/(s-1);h=(g+f)/2}if(null!=h&&n){var m=t[n.index];null!=m.weight?m.weight=(m.weight+h)/2:m.weight=h,t[o.index].weight=h}n=o}for(var y=0,v=t;y<v.length;y++){var w=v[y];w.weight<e.minimumWeightToConsiderMinMax&&(w.weight=void 0)}return t},e.prototype.findMinMaxesBasedOnSmoothedValues=function(i,a){for(var r=[],n=this.getWindowSize(a),o=Math.floor(n/2),s=this.calculateSmoothedValues(a,n),l=0,u=i.length;l<u;l++){var c=this.getMinMaxType(l,s);if(c!==t.Neither){var d={index:l,type:c,value:a[l].value};r.push(d)}}for(var p,h,g,f=0,m=r.length;f<m;f++)if(p=r[f-1],h=r[f],g=r[f+1],p&&g){var y=e.getMinMaxInRange(Math.max(p.index,h.index-o),Math.min(g.index,h.index+o),a);if(h.type===t.Maximum){var v=y.maxIndex;h.index=v,h.value=a[v].value}else{var v=y.minIndex;h.index=v,h.value=a[v].value}}return r},e.getMinMaxInRange=function(e,t,i){for(var a,r,n,o,s=e,l=i.length;s<=t&&s<l;s++){var u=i[s].value;null!=u&&((void 0===a||u<a)&&(a=u,n=s),(void 0===r||u>r)&&(r=u,o=s))}return{minIndex:n,minValue:a,maxIndex:o,maxValue:r}},e.prototype.getWindowSize=function(t){var i=t.length/this.viewport.width*e.estimatedLabelWidth,a=2*Math.floor(i/2)+1;return a},e.prototype.calculateSmoothedValues=function(t,i){for(var a=e.getGaussianDistribution(i),r=[],n=0,o=t.length;n<o;n++)if(1===i)r.push(t[n].value);else{var s=this.getSmoothedValue(t,n,i,a);r.push(s)}return r},e.getGaussianDistribution=function(e){for(var t=[],i=Math.floor(e/2),a=1,r=i,n=i/2,o=0;o<i;o++){var s=a*Math.pow(Math.E,-1*((o-r)*(o-r))/(2*n*n));t.push(s)}t.push(1);for(var o=i-1;o>=0;o--)t.push(t[o]);return t},e.prototype.getSmoothedValue=function(e,t,i,a){if(null==e[t].value)return e[t].value;for(var r=Math.floor(i/2),n=t-r,o=t+r,s=0,l=0,u=e.length-1,c=n,d=0;c<=o;c++,d++){var p=Math.max(0,Math.min(c,u)),h=e[p].value;null!=h&&(s+=h*a[d],l++)}return s/l},e.prototype.addFirstLastMaxMin=function(e,t,i,a){var r=0;if(_.isEmpty(e))return r;t.push(e[0]),r++;var n=e.length-1;return 0!==n&&(t.push(e[n]),r++),0!==i&&i!==n&&(t.push(e[i]),r++),0!==a&&a!==n&&(t.push(e[a]),r++),r},e.prototype.addLocalMinMaxes=function(e,t,i,a,r){for(var n=e.length-1,o=_.filter(e,(function(e,t){return 0!==t&&t!==n&&t!==i&&t!==a&&null!=e.weight})),s=_.sortBy(o,(function(e){return-e.weight})),l=0,u=0,c=Math.min(s.length,r);u<c;u++)t.push(s[u]),l++;return l},e.prototype.addNonMinMaxes=function(e,t,i){for(var a,r=[],n=0,o=e.length;n<o;n++)null==e[n].weight?a?a.count++:a={startingIndex:n,count:1}:a&&a.count>0&&(r.push(a),a=null);for(var s=0;r.length>0&&s<i;){for(var l=0,u=0,c=0,d=r.length;c<d;c++){var p=r[c].count;p>l&&(l=p,u=c)}var h=r.splice(u,1)[0];if(1===h.count)t.push(e[h.startingIndex]);else{var g=Math.floor(h.count/2)+h.startingIndex;t.push(e[g]);var f=g-h.startingIndex;f>0&&r.push({startingIndex:h.startingIndex,count:f});var m=h.startingIndex+h.count-g-1;m>0&&r.push({startingIndex:g+1,count:m})}s++}},e.prototype.getMinMaxType=function(e,i){var a=i[e];if(null==i[e])return t.Neither;if(i.length<2)return t.Neither;if(null==i[e-1])return i[e+1]>a?t.Minimum:t.Maximum;if(null==i[e+1])return i[e-1]>a?t.Minimum:t.Maximum;var r=i[e-1],n=i[e+1];return null==r&&null==n?t.Neither:null==r?n>a?t.Minimum:t.Maximum:null==n?r>a?t.Minimum:t.Maximum:r>a&&a<n?t.Minimum:r<a&&a>n?t.Maximum:t.Neither},e.estimatedLabelWidth=40,e.minimumWeightToConsiderMinMax=.015,e.maxNumberToSortFactor=2,e})();e.MinMaxLabelDataPointSorter=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e,t,i,a,r){void 0===t&&(t=!0),void 0===i&&(i=250),void 0===a&&(a=1700),void 0===r&&(r=100),this.callback=e,this.enabled=t,this.distanceFactor=i,this.timeFactor=a,this.sampleTime=r,this.points=[]}return e.prototype.addPoint=function(e,t){for(var i=this.points,a=Date.now();!(_.isEmpty(i)||a-i[0].timestamp<this.sampleTime);)i.shift();i.push({x:e,y:t,timestamp:a})},e.prototype.hasStarted=function(){return this.started},e.prototype.start=function(){var e=this;if(this.enabled&&!(this.points.length<=1)){this.started&&this.stop();var t=d3.ease("cubic-out"),i=_.last(this.points),a=_.first(this.points),r=i.x-a.x,n=i.y-a.y,o=i.timestamp-a.timestamp,s=r/o,l=n/o,u=window.distanceFactor||this.distanceFactor,c=s*u,d=l*u,p=Math.sqrt(Math.pow(s,2)+Math.pow(l,2))*window.timeFactor||this.timeFactor,h=0,g=0;this.started=!0,d3.timer((function(i){if(e.stopRequested)return e.clearState(),!0;var a=t(1*i/p),r=a*c-h,n=a*d-g;h+=r,g+=n,e.callback&&e.callback(r,n);var o=i>p;return o&&e.clearState(),o}))}},e.prototype.stop=function(){this.started&&(this.stopRequested=!0)},e.prototype.clearState=function(){this.started=!1,this.stopRequested=!1},e})();e.Inertia=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(){return{x:d3.event.clientX,y:d3.event.clientY}}function i(e,t){a(e,t),r(e,t)}function a(e,t){e.on("click",(function(e){return u(e,t)}))}function r(e,t){e.on("contextmenu",(function(e){return l(e,t)}))}function n(e,t){o(e,t),s(e,t)}function o(e,t){e.on("click",(function(){var e=d3.event.target,i=d3.select(e).datum();u(i,t)}))}function s(e,t){e.on("contextmenu",(function(){var e=d3.event.target,i=d3.select(e).datum();l(i,t)}))}function l(t,i){if(!d3.event.ctrlKey){d3.event.preventDefault();var a=e.getPositionOfLastInputEvent();i.handleContextMenu(t,a)}}function u(e,t){t.handleSelection(e,d3.event.ctrlKey)}e.getPositionOfLastInputEvent=t,e.registerStandardInteractivityHandlers=i,e.registerStandardSelectionHandler=a,e.registerStandardContextMenuHandler=r,e.registerGroupInteractivityHandlers=n,e.registerGroupSelectionHandler=o,e.registerGroupContextMenuHandler=s})(t=e.InteractivityUtils||(e.InteractivityUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,a,r){var n=new i(t,a,r);return n.getWarningMessages(e)}e.getInvalidValueWarnings=t;var i=(function(){function t(e,t,i){this.supportsNaN=e,this.supportsNegativeInfinity=t,this.supportsPositiveInfinity=i}return t.prototype.getWarningMessages=function(t){this.loadWarningStatus(t);var i=[];return this.hasNaN&&!this.supportsNaN&&i.push(new e.NaNNotSupportedWarning),(this.hasNegativeInfinity&&!this.supportsNegativeInfinity||this.hasPositiveInfinity&&!this.supportsPositiveInfinity)&&i.push(new e.InfinityValuesNotSupportedWarning),this.hasOutOfRange&&i.push(new e.ValuesOutOfRangeWarning),i},t.prototype.loadWarningStatus=function(e){this.hasNaN=!1,this.hasNegativeInfinity=!1,this.hasOutOfRange=!1,this.hasPositiveInfinity=!1;for(var t=0;t<e.length;t++){var i=e[t],a=i&&i.categorical&&i.categorical.values?i.categorical.values:null;if(!a)return;for(var r=a.length,n=0;n<r;n++){var o=a[n];if(o.values)for(var s=o.values.length,l=0;l<s;l++){var u=o.values[l];isNaN(u)?this.hasNaN=!0:u===Number.POSITIVE_INFINITY?this.hasPositiveInfinity=!0:u===Number.NEGATIVE_INFINITY?this.hasNegativeInfinity=!0:(u<-1e300||u>1e300)&&(this.hasOutOfRange=!0)}}}},t})()})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){var i;if(t){for(var a=d3.event,r=void 0;r=a.sourceEvent;)a=r;var n=e.getBoundingClientRect();i=[a.clientX-n.left-e.clientLeft,a.clientY-n.top-e.clientTop]}else{var o=d3.touches(e);o&&o.length>0&&(i=o[0])}return i}e.getCoordinates=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.init=function(e){this.surface=e,this.initDragEvents(e),this.enabled=!0,this.behaviors=[]},t.prototype.enable=function(e){this.enabled=e},t.prototype.initDragEvents=function(e){var t=this;e.on("mousedown.lasso",(function(){t.enabled&&t.startDrag(d3.event)}),!0),e.on("mousemove.lasso",(function(){t.enabled&&t.dragging&&t.drag(d3.event)}),!0),e.on("mouseup.lasso",(function(){t.enabled&&t.dragging&&t.endDrag(d3.event)}),!0)},t.prototype.startDrag=function(t){var i=this;if(this.onRectStart(t)){this.dragging=!0;var a=e.getCoordinates(this.surface.node(),!0);this.dragStart={x:a[0],y:a[1]},this.dragRect=this.surface.append("rect").classed("lasso-select",!0),this.updateDragRect(t,a),t.stopPropagation(),d3.select("body").on("mousemove.lasso",(function(){i.drag(d3.event)})).on("mouseup.lasso",(function(){i.endDrag(d3.event)}))}},t.prototype.endDrag=function(t){var i=e.getCoordinates(this.surface.node(),!0),a={left:Math.min(i[0],this.dragStart.x),top:Math.min(i[1],this.dragStart.y),right:Math.max(i[0],this.dragStart.x),bottom:Math.max(i[1],this.dragStart.y)};this.onRectEnd(t,a),this.dragging=!1,this.dragRect&&(this.dragRect.remove(),this.dragRect=null),d3.select("body").on(".lasso",null)},t.prototype.drag=function(t){var i=e.getCoordinates(this.surface.node(),!0);this.updateDragRect(t,i)},t.prototype.updateDragRect=function(e,t){var i=this.getDragRect(t);this.dragRect.attr({x:i.left,y:i.top,width:i.width,height:i.height}),this.onRectHover(e,{left:i.left,top:i.top,right:i.left+i.width,bottom:i.top+i.height})},t.prototype.onRectHover=function(e,t){for(var i=0,a=this.behaviors;i<a.length;i++){var r=a[i];r.onRectHover&&r.onRectHover(e,t)}},t.prototype.onRectEnd=function(e,t){for(var i=0,a=this.behaviors;i<a.length;i++){var r=a[i];r.onRectEnd&&r.onRectEnd(e,t)}},t.prototype.onRectStart=function(e){for(var t=!0,i=0,a=this.behaviors;i<a.length;i++){var r=a[i];r.onDragStart&&(t=t&&r.onDragStart(e))}return t},t.prototype.getDragRect=function(e){var t=e[0]-this.dragStart.x,i=e[1]-this.dragStart.y;return{left:Math.min(this.dragStart.x,e[0]),top:Math.min(this.dragStart.y,e[1]),width:Math.abs(t),height:Math.abs(i)}},t})();e.LassoManager=t;var i;!(function(t){function i(t,i){var a=t.left-i.margin.left,r=t.top-i.margin.top,n=t.right-i.margin.left,o=t.bottom-i.margin.top;return{left:e.AxisHelper.invertScale(i.axes.x.scale,a),top:e.AxisHelper.invertScale(i.axes.y1.scale,r),right:e.AxisHelper.invertScale(i.axes.x.scale,n),bottom:e.AxisHelper.invertScale(i.axes.y1.scale,o)}}t.getScaledRegion=i})(i=e.CartesianPlotHelper||(e.CartesianPlotHelper={}));var a=(function(){function e(e){this.behavior=e}return e.prototype.update=function(e){this.axesLayout=e},e.prototype.onRectEnd=function(e,t){var a=i.getScaledRegion(t,this.axesLayout);this.selectRegion(e,a)},e.prototype.onRectHover=function(e,t){if(this.behavior.hoverLassoRegion){var a=i.getScaledRegion(t,this.axesLayout);this.behavior.hoverLassoRegion(e,a)}},e.prototype.onDragStart=function(e){return 0===e.button},e.prototype.selectRegion=function(e,t){this.behavior.lassoSelect&&this.behavior.lassoSelect(e,t)},e})();e.LassoSelectionBehavior=a;var r=(function(){function e(e){this.hostServices=e}return e.prototype.update=function(e){this.axesLayout=e},e.prototype.onRectEnd=function(e,t){if(2===e.button)this.unzoomRegion();else{var a=i.getScaledRegion(t,this.axesLayout);this.zoomRegion(a)}},e.prototype.zoomRegion=function(e){this.hostServices.persistProperties({replace:[{objectName:"categoryAxis",properties:{start:e.left,end:e.right},selector:null},{objectName:"valueAxis",properties:{start:e.bottom,end:e.top},selector:null}]})},e.prototype.unzoomRegion=function(){this.hostServices.persistProperties({remove:[{objectName:"categoryAxis",properties:{start:null,end:null},selector:null},{objectName:"valueAxis",properties:{start:null,end:null},selector:null}]})},e})();e.LassoZoomBehavior=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){return new i(e)}e.createListView=t})(t=e.ListViewFactory||(e.ListViewFactory={}));var i=(function(){function t(e){var i=this;this.options=$.extend(!0,{},e),this.scrollbarInner=e.baseContainer.append("div").classed("scrollbar-inner",!0).on("scroll",(function(){return i.renderImpl(i.options.rowHeight)})),this.scrollContainer=this.scrollbarInner.append("div").classed("scrollRegion",!0).on("touchstart",(function(){return i.stopTouchPropagation()})).on("touchmove",(function(){return i.stopTouchPropagation()})),this.visibleGroupContainer=this.scrollContainer.append("div").classed("visibleGroup",!0);var a=$(this.scrollbarInner.node());a.scrollbar({ignoreOverlay:!1,ignoreMobile:!1,onDestroy:function(){return a.off("scroll")}}),$(e.baseContainer.node()).find(".scroll-element").attr("drag-resize-disabled","true"),t.SetDefaultOptions(e)}return t.prototype.getContainerHeight=function(){return $(this.options.baseContainer.node()).outerHeight()},t.SetDefaultOptions=function(e){e.rowHeight=e.rowHeight||t.defaultRowHeight},t.prototype.rowHeight=function(e){return this.options.rowHeight=Math.ceil(e),this},t.prototype.data=function(e,t,i){return void 0===i&&(i=!1),this._data=e,this.getDatumIndex=t,this.setTotalRows(),i&&$(this.scrollbarInner.node()).scrollTop(0),this.render(),this},t.prototype.viewport=function(e){return this.render(),this},t.prototype.empty=function(){this._data=[],this.render()},t.prototype.render=function(){var e=this;this.renderTimeoutId&&window.clearTimeout(this.renderTimeoutId),this.renderTimeoutId=window.setTimeout((function(){e.getRowHeight().then((function(t){e.renderImpl(t)})),e.renderTimeoutId=void 0}),0)},t.prototype.renderImpl=function(e){var t=this.options.scrollEnabled?Math.max(0,this._totalRows*e):this.getContainerHeight();this.scrollContainer.style("height",t+"px").attr("height",t),this.scrollToFrame(!0)},t.prototype.stopTouchPropagation=function(){if(this.options.isReadMode()){if("touchstart"===d3.event.type){var e=d3.event;e.touches&&1===e.touches.length&&d3.event.stopPropagation()}"touchmove"===d3.event.type&&d3.event.stopPropagation()}},t.prototype.scrollToFrame=function(i){var a=this.options,r=this.visibleGroupContainer,n=this._totalRows,o=a.rowHeight||t.defaultRowHeight,s=this.getVisibleRows(),l=this.scrollbarInner.node().scrollTop,u=0===l?0:Math.floor(l/o),c=e.SVGUtil.translateWithPixels(0,u*o);r.style({transform:function(e){return c},"-webkit-transform":c});var d=Math.max(0,Math.min(u,n-s+1)),p=d+s,h=r.selectAll(".row").data(this._data.slice(d,Math.min(p,n)),this.getDatumIndex);
h.enter().append("div").classed("row",!0).call((function(e){return a.enter(e)})),h.order();var g=r.selectAll(".row:not(.transitioning)");g.call((function(e){return a.update(e)})),h.exit().call((function(e){return a.exit(e)})).remove(),i&&s!==n&&p>=n*t.loadMoreDataThreshold&&a.loadMoreData()},t.prototype.setTotalRows=function(){var e=this._data;this._totalRows=e?e.length:0},t.prototype.getVisibleRows=function(){var e=1,t=this.options,i=t.rowHeight,a=this.getContainerHeight();if(!i||i<1)return e;var r=a/i;return this.options.scrollEnabled?Math.min(Math.ceil(r)+1,this._totalRows)||e:Math.min(Math.floor(r),this._totalRows)||e},t.prototype.getRowHeight=function(){var e=$.Deferred(),i=this,a=i.options;if(this.cancelMeasurePass&&this.cancelMeasurePass(),!(this._data&&this._data.length&&a))return i.rowHeight(t.defaultRowHeight),e.resolve(a.rowHeight).promise();this.scrollToFrame(!1);var r=window.requestAnimationFrame((function(){var t=i.visibleGroupContainer.select(".row");if(!t.empty()){var a=t.node(),n=Math.max($(a).outerHeight(!0),$(a).children().first().outerHeight(!0));i.rowHeight(n),e.resolve(n)}i.cancelMeasurePass=void 0,window.cancelAnimationFrame(r)}));return this.cancelMeasurePass=function(){window.cancelAnimationFrame(r),e.reject()},e.promise()},t.loadMoreDataThreshold=.8,t.defaultRowHeight=1,t})()})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft);!(function(e){var t;!(function(t){var i,n=11;!(function(t){function i(e,t,i){return Math.min(Math.max(e,t),i)}function n(e){return 23===e?2147483648:Math.floor(e)===e?256<<e:256*Math.pow(2,e)}function o(e,a,r){void 0===r&&(r=!1);for(var o=[],s={array:new Float64Array(e.length),arrayString:""},l=0;l<e.length;l+=2){var u=i(e[l],t.MinAllowedLatitude,t.MaxAllowedLatitude),c=i(e[l+1],t.MinAllowedLongitude,t.MaxAllowedLongitude),d=(c+180)/360,p=Math.sin(u*Math.PI/180),h=.5-Math.log((1+p)/(1-p))/(4*Math.PI),g=n(a);s.array[l]=i(d*g+.5,0,g-1),s.array[l+1]=i(h*g+.5,0,g-1),r&&(o.push(s.array[l],s.array[l+1]),o.length>=v&&(s.arrayString+=o.join(" ")+" ",o=[]))}return r&&(s.arrayString+=o.join(" ")+" "),s}function s(e){for(var t={latitude:-90,longitude:180},a={latitude:90,longitude:-180},n=0;n<e.length;n+=2)t.latitude=Math.max(e[n],t.latitude),t.longitude=Math.min(e[n+1],t.longitude),a.latitude=Math.min(e[n],a.latitude),a.longitude=Math.max(e[n+1],a.longitude);return t.longitude=i(t.longitude,-180,180),a.longitude=i(a.longitude,-180,180),r.Maps.LocationRect.fromCorners(new r.Maps.Location(t.latitude,t.longitude),new r.Maps.Location(a.latitude,a.longitude))}function l(e){for(var t=[],i=0,a=0,r=0,n=4294967296;i<e.length;){for(var o=0,s=0;;){if(i>=e.length)return null;var l=y.indexOf(e.charAt(i++));if(l===-1)return null;var u=(31&l)*Math.pow(2,s),c=u/n,d=u%n,p=o/n,h=o%n,g=(d|h)>>>0;if(o=(c|p)*n+g,s+=5,l<32)break}var f=Math.floor((Math.sqrt(8*o+5)-1)/2);o-=f*(f+1)/2;var m=Math.floor(o),v=f-m;v=v>>1^-(1&v),m=m>>1^-(1&m),a+=v,r+=m;var w=1e-5*r,b=1e-5*a;t.push(w),t.push(b)}return new Float64Array(t)}function u(e){for(var i=e.locations,a=0;a<i.length;a++){var r=i[a];r.geographic||(r.geographic=t.parseEncodedSpatialValueArray(r.nativeBing));var n=r.geographic;if(n&&!r.absolute){var o=t.latLongToPixelXYArray(n,t.DefaultLevelOfDetail,!0);r.absolute=o.array,r.absoluteString=o.arrayString;var s=t.getLocationBoundaries(n);r.absoluteBounds=t.locationRectToRectXY(s,t.DefaultLevelOfDetail)}}}function c(e,t){return p(e.latitude,e.longitude,t)}function d(t,i){var a=c(t.getNorthwest(),i),r=c(t.getSoutheast(),i);return new e.visuals.Rect(a.x,a.y,r.x-a.x,r.y-a.y)}function p(t,i,a){var r=o(new Float64Array([t,i]),a).array;return new e.visuals.Point(r[0],r[1])}function h(e,t,a){var o=n(a),s=i(e,0,o-1)/o-.5,l=.5-i(t,0,o-1)/o,u=90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,c=360*s;return new r.Maps.Location(u,c)}function g(e,t,i,a){void 0===a&&(a=!1);var n=new r.Maps.Point(t,i),o=e.tryPixelToLocation(n,r.Maps.PixelReference.page);e.setView({center:o,animate:a})}function f(e,t,i,a){void 0===a&&(a=!1);var n=e.tryLocationToPixel(e.getCenter(),r.Maps.PixelReference.page),o=n.x-t,s=n.y-i;g(e,o,s,a)}t.Settings={MaxBingRequest:6,MaxCacheSize:3e3,MaxCacheSizeOverflow:100,BingKey:"AoW85FdF-eTJavFmWhZjaQ970kwG1FuainbyVSlP5HglkbhVVIFOyNwlaQxAIj-S",UseDoubleArrayGeodataResult:!0,UseDoubleArrayDequeueTimeout:0};var m="https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0&s=1";t.DefaultMapControlFactory={ensureMap:function(e,t){return a.ensureMap(m,e,t)}},t.MinAllowedLatitude=-85.05112878,t.MaxAllowedLatitude=85.05112878,t.MinAllowedLongitude=-180,t.MaxAllowedLongitude=180,t.TileSize=256,t.MaxLevelOfDetail=23,t.MinLevelOfDetail=1,t.MaxAutoZoomLevel=5,t.DefaultLevelOfDetail=11,t.WorkerErrorName="___error___",t.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"};var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-";t.clip=i,t.getMapSize=n;var v=15e3;t.latLongToPixelXYArray=o,t.getLocationBoundaries=s,t.parseEncodedSpatialValueArray=l,t.calcGeoData=u,t.locationToPixelXY=c,t.locationRectToRectXY=d,t.latLongToPixelXY=p,t.pixelXYToLocation=h;var w;!(function(e){function t(e){var t='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle fill="#FF5F00" cx="12" cy="12" r="6"/><circle fill="none" stroke="#FF5F00" stroke-width="2" cx="12" cy="12" r="10"/></svg>',i={draggable:!1,htmlContent:t,height:24,width:24};return new r.Maps.Pushpin(e,i)}e.createPushpin=t})(w=t.CurrentLocation||(t.CurrentLocation={})),t.moveMap=g,t.moveMapDelta=f})(i=t.MapUtil||(t.MapUtil={}));var o=(function(){function e(){this._locationRect=new r.Maps.LocationRect(new r.Maps.Location(30,(-30)),60,60)}return e.prototype.reCalc=function(e,a,r){var o=[this._locationRect.getNorthwest(),this._locationRect.getSoutheast()];if(a/=2,r/=2,!this._baseRect){var s=i.locationToPixelXY(this._locationRect.getNorthwest(),n),l=i.locationToPixelXY(this._locationRect.getSoutheast(),n);this._baseRect=new t.Rect(s.x,s.y,l.x-s.x,l.y-s.y)}var u=e.tryLocationToPixel(o);this._currentRect=new t.Rect(u[0].x+a,u[0].y+r,u[1].x-u[0].x,u[1].y-u[0].y)},Object.defineProperty(e.prototype,"scale",{get:function(){return this._baseRect?this._currentRect.width/this._baseRect.width:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform;return a.translate(i.left,i.top),a.scale(i.width/e.width,i.height/e.height),a.translate(-e.left,-e.top),a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outherTransform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform;a.translate(i.left,i.top);var r=Math.sqrt(i.width/e.width);return a.scale(r,r),a},enumerable:!0,configurable:!0}),e.prototype.setViewBox=function(e){var t=e.getBoundingClientRect(),i=this._currentRect;e.setAttribute("viewBox",[-i.left,-i.top,t.width,t.height].join(" "))},Object.defineProperty(e.prototype,"innerTransform",{get:function(){var e=this._baseRect,i=this._currentRect,a=new t.Transform,r=i.width/e.width;return a.scale(r,r),a.translate(-e.left,-e.top),a},enumerable:!0,configurable:!0}),e.prototype.transformToString=function(e){var t=e.matrix;return"matrix("+t.m00+" "+t.m10+" "+t.m01+" "+t.m11+" "+t.m02+" "+t.m12+")"},e})();t.MapPolygonInfo=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.CssConstants.createClassAndSelector;!(function(i){function n(e,t){return 1===e.axis&&!t.y1.isCategoryAxis}function o(e,i,a,r){if(_.isEmpty(i)){var n={selector:{id:"0"},properties:{show:!1,value:"",lineColor:{solid:{color:a}},transparency:50,style:t.lineStyle.dashed,position:t.referenceLinePosition.front,dataLabelShow:!1},objectName:r};return void e.pushInstance(n)}for(var o=0,s=i;o<s.length;o++){var l=s[o],u=l.dataLabelProperties&&l.dataLabelProperties.show,n={selector:l.selector,properties:{show:l.show,displayName:l.displayName,value:l.value,lineColor:l.color,transparency:l.transparency,style:l.style,position:l.position,dataLabelShow:u},objectName:l.type};if(u){var c=l.dataLabelProperties;n.properties[p.dataLabelColor]=c.color,n.properties[p.dataLabelText]=c.text,n.properties[p.dataLabelHorizontalPosition]=c.horizontalPosition,n.properties[p.dataLabelVerticalPosition]=c.verticalPosition,n.properties[p.dataLabelDisplayUnits]=c.displayUnits,n.properties[p.dataLabelDecimalPoints]=c.decimalPoints}e.pushInstance(n)}}function s(e){function a(a){if(a.show&&_.isNumber(a.value)){var r=i.isHorizontal(a,e.axes),s=e.viewport,l=a.value,u=d3.select(this);u.attr("x1",r?0:n(l)),u.attr("y1",r?o(l):0),u.attr("x2",r?s.width:n(l)),u.attr("y2",r?o(l):s.height);var c={};c.stroke=a.color.solid.color;var d=a.transparency;switch(c["stroke-opacity"]=(100-d)/100,a.style){case t.lineStyle.dotted:c["stroke-dasharray"]="1, 5",c["stroke-linecap"]="round";break;case t.lineStyle.solid:c["stroke-dasharray"]=null,c["stroke-linecap"]=null;break;case t.lineStyle.dashed:default:c["stroke-dasharray"]="5, 5",c["stroke-linecap"]=null}u.style(c)}}var n=e.axes.x.scale,o=e.axes.y1.scale,s=e.graphicContext,l=r("reference-line-front"),u=_.filter(e.referenceLines,(function(e){return e.position===t.referenceLinePosition.front&&e.show})),c=s.selectAll(l.selector).data(u);c.enter().append("line").classed(l.class,!0),c.each(a),c.exit().remove();var d=r("reference-line-back"),p=_.filter(e.referenceLines,(function(e){return e.position!==t.referenceLinePosition.front&&e.show})),h=s.selectAll(d.selector).data(p);h.enter().insert("line",":first-child").classed(d.class,!0),h.each(a),h.exit().remove()}function l(i,a,r,n,o){if(!i)return[];var s=[];for(var l in i){var u=i[l],c=e.DataViewObject.getValue(u,p.show,!1),d=e.DataViewObject.getValue(u,p.displayName,void 0),h=e.DataViewObject.getValue(u,p.value,0),g=e.DataViewObject.getValue(u,p.lineColor,{solid:{color:a}}),f=e.DataViewObject.getValue(u,p.transparency,50),m=e.DataViewObject.getValue(u,p.style,t.lineStyle.dashed),y=e.DataViewObject.getValue(u,p.position,t.referenceLinePosition.front),v=e.DataViewObject.getValue(u,p.dataLabelShow,!1),w=e.DataViewObject.getValue(u,p.dataLabelColor,{solid:{color:a}}),b=e.DataViewObject.getValue(u,p.dataLabelText,t.labelText.value),C=e.DataViewObject.getValue(u,p.dataLabelHorizontalPosition,t.referenceLineDataLabelHorizontalPosition.left),S=e.DataViewObject.getValue(u,p.dataLabelVerticalPosition,t.referenceLineDataLabelVerticalPosition.above),x=e.DataViewObject.getValue(u,p.dataLabelDecimalPoints,void 0),P=x<0?void 0:x,D=e.DataViewObject.getValue(u,p.dataLabelDisplayUnits,0),T={id:l,metadata:o};s.push({type:r,selector:T,show:c,displayName:d,value:h,color:g,transparency:f,style:m,position:y,dataLabelProperties:{show:v,color:w,text:b,horizontalPosition:C,verticalPosition:S,decimalPoints:P,displayUnits:D},axis:n})}return s}function u(r){if(_.isEmpty(r.referenceLines))return[];for(var n=[],o=5,s=r.axes,l=r.viewport,u=s.x.scale,c=s.y1.scale,d=0,p=r.referenceLines;d<p.length;d++){var h=p[d];if(h.show&&_.isNumber(h.value)&&h.dataLabelProperties.show){var g=i.isHorizontal(h,s),f=g?s.y1.formatter:s.x.formatter,m=f,y=h.value,v=h.dataLabelProperties;if(null!=f.options){var w=e.Prototype.inherit(f.options);w.precision=v.decimalPoints,w.value=v.displayUnits,m=t.valueFormatter.create(w)}var b="";switch(v.text){case t.labelText.name:b=h.displayName;break;case t.labelText.nameAndValue:if(!_.isNumber(y))continue;var C=r.hostServices.getLocalizedString("Visual_LabelText_Name_Value_Format");b=a.StringExtensions.format(C,h.displayName,t.NewDataLabelUtils.getLabelFormattedText(m.format(y)));break;case t.labelText.value:default:if(!_.isNumber(y))continue;b=t.NewDataLabelUtils.getLabelFormattedText(m.format(y))}var S={text:b,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.dataLabelUtils.LabelTextProperties.fontWeight},x=e.TextMeasurementService.measureSvgTextWidth(S),P=e.TextMeasurementService.estimateSvgTextHeight(S),D=void 0,T=void 0,V=g?0:u(y),L=g?c(y):0,M=g?l.width:u(y),N=g?c(y):l.height,I=[1];g?(D=v.horizontalPosition===t.referenceLineDataLabelHorizontalPosition.left?V+o:M-x/2-o,T=L,I=v.verticalPosition===t.referenceLineDataLabelVerticalPosition.above?[1]:[2]):(D=V,T=v.verticalPosition===t.referenceLineDataLabelVerticalPosition.above?L+P/2+o:N-P/2-o,I=v.horizontalPosition===t.referenceLineDataLabelHorizontalPosition.left?[4]:[8]);var A=e.TextMeasurementService.measureSvgTextWidth(S),O=e.TextMeasurementService.estimateSvgTextHeight(S,!0),R=void 0;R={point:{x:D,y:T},radius:0,validPositions:I},n.push({isPreferred:!0,text:b,textSize:{width:A,height:O},outsideFill:v.color.solid.color,insideFill:null,parentShape:R,parentType:0,fontSize:9,identity:null,secondRowText:null,key:JSON.stringify({type:h.type,id:h.selector.id})})}}return n}function c(t){var i=null;return t&&e.DataViewObject.getValue(t,p.show,!1)&&(i=e.DataViewObject.getValue(t,p.value,null)),i}function d(e,t,i){if(!_.isEmpty(e))for(var a=0,r=e;a<r.length;a++){var n=r[a];if(n.show){var o=n.value;0===n.axis?t.push(o):i.push(o)}}}var p;!(function(e){e.show="show",e.lineColor="lineColor",e.transparency="transparency",e.displayName="displayName",e.value="value",e.style="style",e.position="position",e.dataLabelShow="dataLabelShow",e.dataLabelColor="dataLabelColor",e.dataLabelText="dataLabelText",e.dataLabelDecimalPoints="dataLabelDecimalPoints",e.dataLabelHorizontalPosition="dataLabelHorizontalPosition",e.dataLabelVerticalPosition="dataLabelVerticalPosition",e.dataLabelDisplayUnits="dataLabelDisplayUnits"})(p=i.ReferenceLineProps||(i.ReferenceLineProps={})),i.isHorizontal=n,i.enumerateObjectInstances=o,i.render=s,i.readDataView=l,i.createLabelDataPoint=u,i.extractReferenceLineValue=c,i.gatherDomainExtents=d})(i=t.ReferenceLineHelper||(t.ReferenceLineHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(e){this.dataPointObjectName="dataPoint",this.hostServices=e.hostServices,this.selectedIds=[]}return i.prototype.select=function(e,t){void 0===t&&(t=!1);var i=$.Deferred();return this.hostServices.shouldRetainSelection()?this.sendSelectionToHost([e]):(this.selectInternal(e,t),this.sendSelectionToHost(this.selectedIds)),i.resolve(this.selectedIds),i},i.prototype.showContextMenu=function(e,i){var a=$.Deferred();return i=i||t.InteractivityUtils.getPositionOfLastInputEvent(),this.sendContextMenuToHost(e,i),a.resolve(),a},i.prototype.hasSelection=function(){return this.selectedIds.length>0},i.prototype.clear=function(){var e=$.Deferred();return this.selectedIds=[],this.sendSelectionToHost([]),e.resolve(),e},i.prototype.getSelectionIds=function(){return this.selectedIds},i.prototype.sendSelectionToHost=function(e){var t=this.dataPointObjectName,i={visualObjects:_.chain(e).filter((function(e){return e.hasIdentity()})).map((function(e){return{objectName:t,selectorsByColumn:e.getSelectorsByColumn()}})).value(),selectors:void 0},a=!1;_.isEmpty(e)||(a=e[0].getSelector()&&!e[0].getSelectorsByColumn()),a&&(i.selectors=_.chain(e).filter((function(e){return e.hasIdentity()})).map((function(e){return e.getSelector()})).value()),this.hostServices.onSelect(i)},i.prototype.sendContextMenuToHost=function(e,t){var i=this.getSelectorsByColumn([e]);if(!_.isEmpty(i)){var a={data:i,position:t};this.hostServices.onContextMenu(a)}},i.prototype.getSelectorsByColumn=function(e){return _(e).filter((function(e){return e.hasIdentity})).map((function(e){return e.getSelectorsByColumn()})).compact().value()},i.prototype.selectInternal=function(t,a){i.containsSelection(this.selectedIds,t)?this.selectedIds=a?this.selectedIds.filter((function(i){return!e.data.Selector.equals(i.getSelector(),t.getSelector())})):this.selectedIds.length>1?[t]:[]:a?this.selectedIds.push(t):this.selectedIds=[t]},i.containsSelection=function(t,i){return t.some((function(t){return e.data.Selector.equals(t.getSelector(),i.getSelector())}))},i})();i.SelectionManager=a})(i=t.utility||(t.utility={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){var i=a.Utility,r=(function(){function e(e){this.polygonPoints=this.convertArrayPathToPoints(e)}return e.prototype.absoluteCentroid=function(){return null==this._absoluteCentroid&&(this._absoluteCentroid=this.calculatePolygonCentroid()),this._absoluteCentroid},e.prototype.absoluteBoundingRect=function(){return null==this._absoluteBoundingRect&&(this._absoluteBoundingRect=this.calculateBoundingRect()),this._absoluteBoundingRect},e.prototype.contains=function(e){var t={x:e.left,y:e.top},i={x:e.left+e.width,y:e.top},a={x:e.left,y:e.top+e.height},r={x:e.left+e.width,y:e.top+e.height};return this.inside(t)&&this.inside(i)&&this.inside(a)&&this.inside(r)},e.prototype.conflicts=function(e){if(!this.isConflictWithBoundingBox(e))return!1;var t={x:e.left,y:e.top},i={x:e.left+e.width/2,y:e.top},a={x:e.left+e.width,y:e.top},r={x:e.left,y:e.top+e.height},n={x:e.left+e.width/2,y:e.top+e.height},o={x:e.left+e.width,y:e.top+e.height},s={x:e.left,y:e.top+e.height/2},l={x:e.left+e.width,y:e.top+e.height/2};return this.inside(t)||this.inside(i)||this.inside(a)||this.inside(r)||this.inside(n)||this.inside(o)||this.inside(s)||this.inside(l)},e.prototype.lineIntersectionPoint=function(e,t){for(var i=0;i<this.polygonPoints.length;i++){var a=this.polygonPoints[i],r=i===this.polygonPoints.length-1?this.polygonPoints[0]:this.polygonPoints[i+1],n=this.getLineIntersection(e,t,a,r);if(null!==n)return n}return null},e.calculateAbsolutePolygonArea=function(e){var t,i=1,a=0;for(t=0;t<e.length;t++)a+=e[t].x*e[i].y-e[i].x*e[t].y,i=(i+1)%e.length;return a*=.5},e.prototype.isConflictWithBoundingBox=function(e){return s.isIntersecting(this.absoluteBoundingRect(),e)},e.prototype.calculatePolygonCentroid=function(){var t,i,a,r,n,o;for(t=e.calculateAbsolutePolygonArea(this.polygonPoints),a=r=0,o=1,n=0;n<this.polygonPoints.length;n++)i=this.polygonPoints[n].x*this.polygonPoints[o].y-this.polygonPoints[o].x*this.polygonPoints[n].y,a+=(this.polygonPoints[n].x+this.polygonPoints[o].x)*i,r+=(this.polygonPoints[n].y+this.polygonPoints[o].y)*i,o=(o+1)%this.polygonPoints.length;return a/=6*t,r/=6*t,{x:a,y:r}},e.prototype.calculateBoundingRect=function(){for(var e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,r=0;r<this.polygonPoints.length;r++)this.polygonPoints[r].x<e?e=this.polygonPoints[r].x:this.polygonPoints[r].x>i&&(i=this.polygonPoints[r].x),this.polygonPoints[r].y<t?t=this.polygonPoints[r].y:this.polygonPoints[r].y>a&&(a=this.polygonPoints[r].y);return{left:e,top:t,width:i-e,height:a-t}},e.prototype.inside=function(e){for(var t=e.x,i=e.y,a=!1,r=0,n=this.polygonPoints.length-1;r<this.polygonPoints.length;n=r++){var o=this.polygonPoints[r].x,s=this.polygonPoints[r].y,l=this.polygonPoints[n].x,u=this.polygonPoints[n].y,c=s>i!=u>i&&t<(l-o)*(i-s)/(u-s)+o;c&&(a=!a)}return a},e.prototype.getLineIntersection=function(e,t,i,a){var r=e.x,n=e.y,o=t.x,s=t.y,l=i.x,u=i.y,c=a.x,d=a.y,p=o-r,h=s-n,g=c-l,f=d-u,m=(-h*(r-l)+p*(n-u))/(-g*h+p*f),y=(g*(n-u)-f*(r-l))/(-g*h+p*f);return m>=0&&m<=1&&y>=0&&y<=1?{x:r+y*p,y:n+y*h}:null},e.prototype.convertArrayPathToPoints=function(e){for(var t=[],i=0;i<e.length;i+=2){var a=e[i],r=e[i+1],n={x:a,y:r};t.push(n)}return t},e})();t.Polygon=r;var n;!(function(t){function a(e,t,i){var a=e.x+t>=0?e.x+t:0,r=e.y+i>=0?e.y+i:0;return{x:a,y:r}}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function n(e){return null!==e?{x:e.x,y:e.y}:null}function o(e){return"{x:"+e.x+", y:"+e.y+"}"}function s(e){return e.x+","+e.y}function l(e,t){if(null===e||null===t)return null;var i=t.x-e.x,a=t.y-e.y;return Math.sqrt(i*i+a*a)}function u(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function c(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(2===e.length)return{x:i.parseNumber(e[0]),y:i.parseNumber(e[1])};if("string"==typeof e){var a=e.split(",");return 2!==a.length?void 0===t?null:t:{x:i.parseNumber(a[0]),y:i.parseNumber(a[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{x:i.parseNumber(e.x),y:i.parseNumber(e.y)}}t.offset=a,t.equals=r,t.clone=n,t.toString=o,t.serialize=s,t.getDistance=l,t.equalWithPrecision=u,t.parsePoint=c})(n=t.Point||(t.Point={}));var o;!(function(t){function a(e){return 0===e.width&&0===e.height}function r(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.width===t.width&&e.height===t.height}function n(e){return null!==e?{width:e.width,height:e.height}:null}function o(e,t){var i=n(e);return t&&(i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function s(e,t){var i=n(e);return t&&(i.width=i.width-t.left-t.right,i.width<0&&(i.width=0),i.height=i.height-t.top-t.bottom,i.height<0&&(i.height=0)),i}function l(e,t){return t&&(e.width=Math.max(e.width,t.width),e.height=Math.max(e.height,t.height)),e}function u(e){return{left:0,top:0,width:e.width,height:e.height}}function c(e){return"{width:"+e.width+", height:"+e.height+"}"}function d(e,t){return e===t||void 0!==e&&void 0!==t&&e.width===t.width&&e.height===t.height}function p(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function h(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(2===e.length)return{width:i.parseNumber(e[0]),height:i.parseNumber(e[1])};if("string"==typeof e){var a=e.split(",");return 2!==a.length?void 0===t?null:t:{width:i.parseNumber(a[0]),height:i.parseNumber(a[1])}}return 2!==e.length&&"string"!=typeof e?void 0===t?null:t:{width:i.parseNumber(e.width),height:i.parseNumber(e.height)}}t.isEmpty=a,t.equals=r,t.clone=n,t.inflate=o,t.deflate=s,t.combine=l,t.toRect=u,t.toString=c,t.equal=d,t.equalWithPrecision=p,t.parseSize=h})(o=t.Size||(t.Size={}));var s;!(function(t){function a(e){return{x:e.left,y:e.top}}function r(e){return{width:e.width,height:e.height}}function n(e,t){e.width=t.width,e.height=t.height}function o(e){return e.left+e.width}function s(e){return e.top+e.height}function l(e){return{x:e.left,y:e.top}}function u(e){return{x:e.left+e.width,y:e.top}}function c(e){return{x:e.left,y:e.top+e.height}}function d(e){return{x:e.left+e.width,y:e.top+e.height}}function p(e,t){return void 0!==t&&null!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function h(e){return null!==e?{left:e.left,top:e.top,width:e.width,height:e.height}:null}function g(e){return"{left:"+e.left+", top:"+e.top+", width:"+e.width+", height:"+e.height+"}"}function f(e,t,i){var a=e.left+t>=0?e.left+t:0,r=e.top+i>=0?e.top+i:0;return{left:a,top:r,width:e.width,height:e.height}}function m(e,t){return{left:e.left+t.left,top:e.top+t.top,height:e.height+t.height,width:e.width+t.width}}function y(e,t){return{left:e.left-t.left,top:e.top-t.top,height:e.height-t.height,width:e.width-t.width}}function v(e,t){var i=h(e);return t&&(i.left-=t.left,i.top-=t.top,i.width+=t.left+t.right,i.height+=t.top+t.bottom),i}function w(e,t){var i=h(e);return t&&(i.left+=t.left,i.top+=t.top,i.width-=t.left+t.right,i.height-=t.top+t.bottom),i}function b(e,t){return{left:e.left-t,top:e.top-t,width:e.width+t+t,height:e.height+t+t}}function C(e,t){return{left:e.left+t,top:e.top+t,width:e.width-t-t,height:e.height-t-t}}function S(e,t,i){return{x:Math.min(Math.max(e.left,t),e.left+e.width),y:Math.min(Math.max(e.top,i),e.top+e.height)}}function x(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function P(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.width,i.width)&&e.Double.equalWithPrecision(t.height,i.height)}function D(e){return void 0===e||null===e||0===e.width&&0===e.height}function T(t,i){return null!==t&&null!==i&&(e.Double.lessOrEqualWithPrecision(t.left,i.x)&&e.Double.lessOrEqualWithPrecision(i.x,t.left+t.width)&&e.Double.lessOrEqualWithPrecision(t.top,i.y)&&e.Double.lessOrEqualWithPrecision(i.y,t.top+t.height))}function V(e,t){return!(!e||!t)&&!(t.left>e.left+e.width||t.left+t.width<e.left||t.top>e.top+e.height||t.top+t.height<e.top)}function _(e,t){if(!e)return t;if(!t)return e;var i=Math.max(e.left,t.left),a=Math.max(e.top,t.top),r=Math.min(e.left+e.width,t.left+t.width),n=Math.min(e.top+e.height,t.top+t.height);return i<=r&&a<=n?{left:i,top:a,width:r-i,height:n-a}:{left:0,top:0,width:0,height:0}}function L(e,t){if(!e)return t;if(!t)return e;var i=Math.min(e.left,t.left),a=Math.min(e.top,t.top),r=Math.max(e.left+e.width,t.left+t.width),n=Math.max(e.top+e.height,t.top+t.height);return{left:i,top:a,width:r-i,height:n-a}}function M(e,t){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:i.parseNumber(e[0]),top:i.parseNumber(e[1]),width:i.parseNumber(e[2]),height:i.parseNumber(e[3])};if("string"==typeof e){var a=e.split(",");return 4!==a.length?void 0===t?null:t:{left:i.parseNumber(a[0]),top:i.parseNumber(a[1]),width:i.parseNumber(a[2]),height:i.parseNumber(a[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:i.parseNumber(e.left),top:i.parseNumber(e.top),width:i.parseNumber(e.width),height:i.parseNumber(e.height)}}function N(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}t.getOffset=a,t.getSize=r,t.setSize=n,t.right=o,t.bottom=s,t.topLeft=l,t.topRight=u,t.bottomLeft=c,t.bottomRight=d,t.equals=p,t.clone=h,t.toString=g,t.offset=f,t.add=m,t.subtract=y,t.inflate=v,t.deflate=w,t.inflateBy=b,t.deflateBy=C,t.getClosestPoint=S,t.equal=x,t.equalWithPrecision=P,t.isEmpty=D,t.containsPoint=T,t.isIntersecting=V,t.intersect=_,t.combine=L,t.parseRect=M,t.getCentroid=N})(s=t.Rect||(t.Rect={}));var l;!(function(t){function a(e,t){var i=o(e);return t&&(i.left=e.left+t.left,i.right=e.right+t.right,i.bottom=e.bottom+t.bottom,i.top=e.top+t.top),i}function r(e){return e.left+e.right}function n(e){return e.top+e.bottom}function o(e){return null!==e?{left:e.left,top:e.top,right:e.right,bottom:e.bottom}:null}function s(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.left===t.left&&e.bottom===t.bottom&&e.right===t.right&&e.top===t.top}function l(e){var t=e.right;e.right=e.left,e.left=t}function u(e){var t=e.top;e.top=e.bottom,e.bottom=t}function c(e){return"{top:"+e.top+", left:"+e.left+", right:"+e.right+", bottom:"+e.bottom+"}"}function d(e){return e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px"}function p(e){return 0===e.left&&0===e.top&&0===e.right&&0===e.bottom}function h(e,t){return e===t||void 0!==e&&void 0!==t&&e.left===t.left&&e.top===t.top&&e.right===t.right&&e.bottom===t.bottom}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.left,i.left)&&e.Double.equalWithPrecision(t.top,i.top)&&e.Double.equalWithPrecision(t.right,i.right)&&e.Double.equalWithPrecision(t.bottom,i.bottom)}function f(e,t,a){if(null===e)return void 0===t?null:t;if(void 0===e)return void 0===t?null:t;if(4===e.length)return{left:i.parseNumber(e[0]),top:i.parseNumber(e[1]),right:i.parseNumber(e[2]),bottom:i.parseNumber(e[3])};if("string"==typeof e){var r=e.split(",");return 4!==r.length?void 0===t?null:t:{left:i.parseNumber(r[0]),top:i.parseNumber(r[1]),right:i.parseNumber(r[2]),bottom:i.parseNumber(r[3])}}return 4!==e.length&&"string"!=typeof e?void 0===t?null:t:{left:i.parseNumber(e.left),top:i.parseNumber(e.top),right:i.parseNumber(e.right),bottom:i.parseNumber(e.bottom)}}t.inflate=a,t.getWidth=r,t.getHeight=n,t.clone=o,t.equals=s,t.flipHorizontal=l,t.flipVertical=u,t.toString=c,t.toCssString=d,t.isEmpty=p,t.equal=h,t.equalWithPrecision=g,t.parseThickness=f})(l=t.Thickness||(t.Thickness={}));var u;!(function(t){function i(e){return 0===e.x&&0===e.y}function a(e,t){return void 0!==e&&null!==e&&void 0!==t&&null!==t&&e.x===t.x&&e.y===t.y}function r(e){return null!==e?{x:e.x,y:e.y}:null}function n(e){return"{x:"+e.x+", y:"+e.y+"}"}function o(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function s(e){return e.x*e.x+e.y*e.y}function l(e,t){return{x:e.x*t,y:e.y*t}}function u(e){return i(e)?e:l(e,1/o(e))}function c(e){return{x:e.y,y:-e.x}}function d(e){return{x:-e.y,y:e.x}}function p(e,t){var i=e.x*Math.cos(t)-e.y*Math.sin(t),a=e.x*Math.sin(t)+e.y*Math.cos(t);return{x:i,y:a}}function h(e,t){return e===t||void 0!==e&&void 0!==t&&e.x===t.x&&e.y===t.y}function g(t,i){return t===i||void 0!==t&&void 0!==i&&e.Double.equalWithPrecision(t.x,i.x)&&e.Double.equalWithPrecision(t.y,i.y)}function f(e,t){if(e&&t)return{x:e.x+t.x,y:e.y+t.y}}function m(e,t){if(e&&t)return{x:e.x-t.x,y:e.y-t.y}}function y(e,t){if(e&&t)return e.x*t.x+e.y*t.y}function v(e,t){if(e&&t)return{x:t.x-e.x,y:t.y-e.y}}t.isEmpty=i,t.equals=a,t.clone=r,t.toString=n,t.getLength=o,t.getLengthSqr=s,t.scale=l,t.normalize=u,t.rotate90DegCW=c,t.rotate90DegCCW=d,t.rotate=p,t.equal=h,t.equalWithPrecision=g,t.add=f,t.subtract=m,t.dotProduct=y,t.getDeltaVector=v})(u=t.Vector||(t.Vector={}))})(i=t.shapes||(t.shapes={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.Color,r=a.PixelConverter,n=e.data.SQExprBuilder,o=e.data.SemanticFilter;!(function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=4]="right"})(t.WidgetPosition||(t.WidgetPosition={}));var s,l=t.WidgetPosition;!(function(s){function u(e,t){var i=n.text(t),a=n.contains(e,i);return o.fromSQExpr(a)}function c(t,i,a){if(!t||_.isEmpty(i))return!1;for(var r=0,n=i.length;r<n;r++){var o=i[r];if(e.DataViewScopeIdentity.equals(t,o,a))return i.splice(r,1),!0}return!1}function d(e,t,i,a,r){if(void 0===i&&(i=null),void 0===a&&(a=!1),void 0===r&&(r=null),e&&t){var n="",o="",u="",c="",d="",h=s.getScale(t),g=t.get(0),f=e.offsetParent(),m=s.getScale(f);a&&e.css({transform:"scale("+h+")"});var y=g.getBoundingClientRect();if(null==r&&(r=p(y)),(r&l.bottom)===l.bottom){var v=y.top+y.height;n=v/m,d="top"}else{var w=window.innerHeight-y.top;u=w/m,d="bottom"}if((r&l.left)===l.left){var b=y.left;c=b/m,d="left "+d}else{var C=window.innerWidth-y.left-y.width;o=C/m,d="right "+d}var S={left:c,top:n,right:o,bottom:u,"transform-origin":d};i&&(S.left+=i.left*h,S.top+=i.top*h),e.css(S)}}function p(e){var t=l.bottom|l.left,i=window.innerHeight,a=window.innerWidth;return i-e.top<i/2&&(t&=~l.bottom,t|=l.top),a-e.left<a/2&&(t&=~l.left,t|=l.right),t}function h(e){if(!e)return 1;var t=e.outerWidth();if(0===t)return 1;var i=e.get(0).getBoundingClientRect().width;return i/t}function g(e,t){if(t&&!_.isEmpty(e)){var i=_.first(t.columns);return i&&i.expr?s.getContainsFilter(i.expr,e):void 0}}function f(e,i){var a={remove:[{objectName:"general",selector:null,properties:{filter:!0}}],replace:[{objectName:"data",selector:null,properties:(r={},r[t.slicerProps.data.mode.propertyName]=i,r)}]};e.persistProperties(a),e.onSelect({visualObjects:[]});var r}var m;!(function(e){var t=a.CssConstants.createClassAndSelector;e.ClearSearchTextButton=t("clearSearchTextButton"),e.HeaderContainer=t("headerContainer"),e.Header=t("slicerHeader"),e.Hidden=t("hidden"),e.Icon=t("icon"),e.TitleHeader=t("titleHeader"),e.HeaderText=t("headerText"),e.Body=t("slicerBody"),e.Label=t("slicerLabel"),e.LabelText=t("slicerText"),
e.LabelImage=t("slicerImage"),e.CountText=t("slicerCountText"),e.Clear=t("clear"),e.SearchHeader=t("searchHeader"),e.SearchIconClass=t("searchIcon"),e.SearchInput=t("searchInput"),e.SearchHeaderCollapsed=t("collapsed"),e.SearchHeaderShow=t("show"),e.MultiSelectEnabled=t("isMultiSelectEnabled")})(m=s.Selectors||(s.Selectors={}));var y;!(function(e){e.Clear="Slicer_Clear",e.SelectAll="Slicer_SelectAll",e.Search="SearchBox_Text"})(y=s.DisplayNameKeys||(s.DisplayNameKeys={}));var v;!(function(e){function t(e){return null!=e&&null!=e.slicerSettings}e.areSettingsDefined=t})(v=s.SettingsHelper||(s.SettingsHelper={}));var w;!(function(e){function t(e){if(e){var t=e.categorical;if(t&&!_.isEmpty(t.categories))return t.categories[0].identityFields}}e.getIdentityFields=t})(w=s.DefaultValueHandler||(s.DefaultValueHandler={})),s.getContainsFilter=u,s.tryRemoveValueFromRetainedList=c,s.fixWidgetPosition=d,s.getScale=h,s.getUpdatedSelfFilter=g,s.clearSlicerFilter=f;var b=(function(){function a(){}return a.prototype.addSearch=function(e,t){var i=t.append("div").classed(m.SearchHeader.class,!0).classed(m.SearchHeaderCollapsed.class,!0);return i.append("span").classed("powervisuals-glyph search",!0).classed(m.Icon.class,!0).classed(m.SearchIconClass.class,!0).attr("title",e.getLocalizedString(y.Search)),i.append("input").attr("type","text").classed(m.SearchInput.class,!0).attr("drag-resize-disabled","true"),i},a.prototype.addClearSearchButton=function(e,t){var i=t.append("span").classed("powervisuals-glyph x",!0).classed(m.Icon.class,!0).classed(m.ClearSearchTextButton.class,!0),a=t.select(s.Selectors.SearchInput.selector);return a.attr("placeholder",e.getLocalizedString(y.Search)),i},a.prototype.configureSearchBoxIcon=function(e,t){var i=_.isEmpty(t);e.select(s.Selectors.SearchIconClass.selector).classed(s.Selectors.Hidden.class,!i),e.select(s.Selectors.ClearSearchTextButton.selector).classed(s.Selectors.Hidden.class,i)},a.prototype.getRowHeight=function(t,i){return e.TextMeasurementService.estimateSvgTextHeight(this.getTextProperties(t.slicerText.textSize,i))+this.getRowsOutlineWidth(t.slicerText.outline,t.general.outlineWeight)},a.prototype.setSlicerTextStyle=function(e,i){var a=1.79;e.style({color:i.slicerText.color,"background-color":i.slicerText.background,"border-style":"solid","border-color":i.general.outlineColor,"border-width":t.VisualBorderUtil.getBorderWidth(i.slicerText.outline,i.general.outlineWeight),"font-size":r.fromPoint(i.slicerText.textSize),"line-height":Math.floor(a*i.slicerText.textSize)+"px"});var n=this.calculateSlicerTextHighlightColor(i.slicerText.color);e.on("mouseover",(function(e){d3.select(this).style({color:n})})),e.on("mouseout",(function(e){d3.select(this).style({color:i.slicerText.color})}))},a.prototype.getRowsOutlineWidth=function(e,i){switch(e){case t.outline.none:case t.outline.leftRight:return 0;case t.outline.bottomOnly:case t.outline.topOnly:return i;case t.outline.topBottom:case t.outline.frame:return 2*i;default:return 0}},a.prototype.calculateSlicerTextHighlightColor=function(e){var t=i.parseColorString(e);return 255===t.R&&255===t.G&&255===t.B?"#C8C8C8":i.calculateHighlightColor(t,.8,.2)},a.prototype.getTextProperties=function(e,t){return t.fontSize=r.fromPoint(e),t},a})();s.DOMHelper=b})(s=t.SlicerUtil||(t.SlicerUtil={}));var s;!(function(e){var t;!(function(t){function i(e,t,i,o){if(t)switch(e.objectName){case"items":return n(t,i);case"selection":if(a(o))return r(t,i)}}function a(e){return!(e&&e.metadata&&e.metadata.columns&&_.some(e.metadata.columns,(function(e){return e.discourageAggregationAcrossGroups})))}function r(t,i){var a=i,r=e.SettingsHelper.areSettingsDefined(t)&&t.slicerSettings.selection,n=r&&t.slicerSettings.selection.selectAllCheckboxEnabled?t.slicerSettings.selection.selectAllCheckboxEnabled:a.selection.selectAllCheckboxEnabled,o=t&&t.slicerSettings&&t.slicerSettings.selection&&void 0!==t.slicerSettings.selection.singleSelect?t.slicerSettings.selection.singleSelect:a.selection.singleSelect;return[{selector:null,objectName:"selection",properties:{selectAllCheckboxEnabled:n,singleSelect:o}}]}function n(t,i){var a=i,r=e.SettingsHelper.areSettingsDefined(t)&&t.slicerSettings.slicerText,n=r&&t.slicerSettings.slicerText.color?t.slicerSettings.slicerText.color:a.slicerText.color,o=r&&t.slicerSettings.slicerText.background?t.slicerSettings.slicerText.background:a.slicerText.background;return[{selector:null,objectName:"items",properties:{fontColor:n,background:o,outline:a.slicerText.outline,textSize:a.slicerText.textSize}}]}t.enumerateObjectInstances=i})(t=e.ObjectEnumerator||(e.ObjectEnumerator={}))})(s=t.SlicerUtil||(t.SlicerUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){if(0!==t.length){var i=e.selectAll("title"),a=i.data((function(e,i){return[t[i]]}));a.enter().append("title"),a.exit().remove(),a.text((function(e){return e}))}}e.tooltipUpdate=t})(t=e.tooltipUtils||(e.tooltipUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){return"translate("+e+","+t+")"}function i(e){return"translateX("+e+"px)"}function a(e,t){return"translate("+e+"px,"+t+"px)"}function r(e,t,i,a,r){return"translate("+e+","+t+") rotate("+r+","+i+","+a+")"}function n(e){return"scale("+e+")"}function o(e,t,i){return"translate("+e+","+t+") scale("+i+")"}function s(e,t){return e+" "+t}function l(){var e=Date.now;Date.now=function(){return 1/0},d3.timer.flush(),Date.now=e}function u(e){if(e){var t=e,i=e;i.animation&&(t=i.animation),t&&t.transitionImmediate&&l()}}function c(e){e.getAttribute("d")||e.setAttribute("d","")}function d(e){isNaN(e.x)&&(e.x=0),isNaN(e.y)&&(e.y=0)}function p(e){if(!e||0===e.length)return{x:"0",y:"0"};var t,i=e.split(/[\s,]+/),a="0",r=i[0];if(1===i.length)t=r.substring(10,r.length-1);else{var n=i[1];a=n.substring(0,n.length-1),t=r.substring(10,r.length)}return{x:t,y:a}}function h(e,t,i){var a="rotate("+i+" "+e/2+" "+t/2+")",r="M0 0";return r+="L0 "+t,r+="L"+e+" "+t/2+" Z",{path:r,transform:a}}function g(e){if(null!=e){var t=e.getBoundingClientRect(),i=e.getBBox();if(i.height>0&&i.width>0)return{x:t.width/i.width,y:t.height/i.height}}return{x:1,y:1}}e.AlmostZero=1e-6,e.translate=t,e.translateXWithPixels=i,e.translateWithPixels=a,e.translateAndRotate=r,e.scale=n,e.translateAndScale=o,e.transformOrigin=s,e.flushAllD3Transitions=l,e.flushAllD3TransitionsIfNeeded=u,e.ensureDAttribute=c,e.ensureValidSVGPoint=d,e.parseTranslateTransform=p,e.createArrow=h,e.getTransformScaleRatios=g})(t=e.SVGUtil||(e.SVGUtil={}));var i=(function(){function e(e){this.scaleDetectorElement=e.append("rect").classed("scale-detector",!0).attr({width:1,height:1,"stroke-width":"0px",fill:"none"}).node()}return e.prototype.getScale=function(){var e=this.scaleDetectorElement.getBoundingClientRect(),t=this.scaleDetectorElement.getBBox();return t.height>0&&t.width>0?{x:e.width/t.width,y:e.height/t.height}:{x:1,y:1}},e})();e.SVGScaleDetector=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){return e.toString().replace(new RegExp(" ","g"),"&nbsp")}function i(e){return e.replace(//g,"")}function a(e){if(null!=e)return e.replace(/ /g,"")}e.removeBreakingSpaces=t,e.removeEllipses=i,e.replaceSpaceWithNBSP=a})(t=e.TextUtil||(e.TextUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.data.DataRoleHelper;!(function(t){function i(e){if(e)for(var t in e){var i=e[t];for(var a in i.properties){var r=i.properties[a];if(r.type&&r.type[O])return r.rule.inputRole}}}function r(e){var t=!!(e&&e.query&&e.query.projections&&e.query.projections.Gradient);return t}function n(e){var t;if(e&&!$.isEmptyObject(e)){t=u();for(var i in t){var a=e.hasOwnProperty(i);if(a){var r=e[i];r&&r.solid&&r.solid.color&&(r=r.solid.color),t[i]=r}}}return t}function o(e){if(e&&e.values&&e.values.grouped){var t=e.values.grouped();return a.getMeasureIndexOfRole(t,"Gradient")}return-1}function s(e){if(null==e)return null;var i=t.getGradientMeasureIndex(e),a=i===-1?null:e.values[i];return a}function l(e){var t=o(e);return t>=0}function u(){var e=g(),i={diverging:!1,minColor:e.minColor,midColor:N,maxColor:e.maxColor,minValue:void 0,midValue:void 0,maxValue:void 0,nullStrategy:t.DefaultNullStrategy,nullColor:t.DefaultNullColor};return i}function c(){return y()}function d(t,i,a){var r,n,o=e.data.DataViewObjectDefinitions.ensure(a,A,null),s=h(a);if(s)switch($.isNumeric(i)&&(r=void 0!==i?M.double(+i):void 0),_.contains(["minColor","midColor","maxColor","nullColor"],t)&&(n=b(s,t,i)),t){case"minColor":C(s,n);break;case"midColor":S(s,n);break;case"maxColor":x(s,n);break;case"nullColor":L(s,n);break;case"minValue":P(s,r);break;case"midValue":D(s,r);break;case"maxValue":T(s,r);break;case"nullStrategy":V(s,i);break;case"diverging":s=i?v(s):y(s),o.properties[O]=s;break;case"revertToDefault":s=c(),o.properties[O]=s}}function p(e){return e?f(e):u()}function h(t){var i=e.data.DataViewObjectDefinitions.getValue(t,{objectName:A,propertyName:O},null);return i}function g(){var i=new e.visuals.DataColorPalette,a=i.getColorByIndex(0),r=d3.scale.linear().domain([0,100]).range(["#ffffff",a.value]);return{minColor:r(20),midColor:N,maxColor:a.value,nullColor:t.DefaultNullColor}}function f(e){var i,a,r,n,o,s,l=N,u=t.DefaultNullColor,c=t.DefaultNullStrategy,d=void 0!==e.linearGradient3,p=e.linearGradient2,h=e.linearGradient3;if(p){i=p.max.color.value,a=p.min.color.value;var g=p.max.value;g&&(r=g.value);var f=p.min.value;f&&(o=f.value),s=p.nullColoringStrategy}else if(h){i=h.max.color.value,l=h.mid.color.value,a=h.min.color.value;var g=h.max.value;g&&(r=g.value);var m=h.mid.value;m&&(n=m.value);var f=h.min.value;f&&(o=f.value),s=h.nullColoringStrategy}if(s){c=s.strategy.value;var y=s.color;y&&(u=y.value)}var v={diverging:d,minColor:a,midColor:l,maxColor:i,nullStrategy:c};return null!=o&&(v.minValue=o),null!=n&&(v.midValue=n),null!=r&&(v.maxValue=r),null!=u?v.nullColor=u:v.nullColor=t.DefaultNullColor,v}function m(e){var t=[];return e.minColor=e.minColor||I,t.push(e.minColor),e.diverging&&(e.midColor=e.midColor||I,t.push(e.midColor||I)),e.maxColor=e.maxColor||I,t.push(e.maxColor||I),t.join(",")}function y(t){var i=p(t),a={linearGradient2:{min:{color:M.text(i.minColor)},max:{color:M.text(i.maxColor)},nullColoringStrategy:{strategy:M.text(i.nullStrategy)}}},r=a.linearGradient2;return null!=i.minValue&&(r.min.value=M.double(i.minValue)),null!=i.maxValue&&(r.max.value=M.double(i.maxValue)),i.nullStrategy===e.NullStrategy.specificColor&&i.nullColor&&(r.nullColoringStrategy.color=M.text(i.nullColor)),a}function v(t){var i=p(t),a={linearGradient3:{min:{color:M.text(i.minColor)},mid:{color:M.text(i.midColor)},max:{color:M.text(i.maxColor)},nullColoringStrategy:{strategy:M.text(i.nullStrategy)}}},r=a.linearGradient3;return null!=i.minValue&&(r.min.value=M.double(i.minValue)),null!=i.midValue&&(r.mid.value=M.double(i.midValue)),null!=i.maxValue&&(r.max.value=M.double(i.maxValue)),i.nullStrategy===e.NullStrategy.specificColor&&i.nullColor&&(r.nullColoringStrategy.color=M.text(i.nullColor)),a}function w(e,t){var i;if(e.linearGradient3){var a=v().linearGradient3;switch(t){case"minColor":i=a.min.color;break;case"midColor":i=a.mid.color;break;case"maxColor":i=a.max.color;break;case"nullColor":i=a.nullColoringStrategy.color}}else if(e.linearGradient2){var a=y().linearGradient2;switch(t){case"minColor":i=a.min.color;break;case"maxColor":i=a.max.color;break;case"nullColor":i=a.nullColoringStrategy.color}}return i}function b(e,t,i){var a;return a=i?M.text(i):w(e,t)}function C(e,t){e.linearGradient2?e.linearGradient2.min.color=t:e.linearGradient3&&(e.linearGradient3.min.color=t)}function S(e,t){e.linearGradient3&&(e.linearGradient3.mid.color=t)}function x(e,t){e.linearGradient2?e.linearGradient2.max.color=t:e.linearGradient3&&(e.linearGradient3.max.color=t)}function P(e,t){e.linearGradient2?e.linearGradient2.min.value=t:e.linearGradient3&&(e.linearGradient3.min.value=t)}function D(e,t){e.linearGradient3&&(e.linearGradient3.mid.value=t)}function T(e,t){e.linearGradient2?e.linearGradient2.max.value=t:e.linearGradient3&&(e.linearGradient3.max.value=t)}function V(e,t){e.linearGradient2?e.linearGradient2.nullColoringStrategy.strategy=t:e.linearGradient3&&(e.linearGradient3.nullColoringStrategy.strategy=t)}function L(e,t){e.linearGradient2?e.linearGradient2.nullColoringStrategy.color=t:e.linearGradient3&&(e.linearGradient3.nullColoringStrategy.color=t)}var M=e.data.SQExprBuilder,N="#ffffff";t.DefaultNullColor="#FF7F48",t.DefaultNullStrategy=e.NullStrategy.asZero;var I=N,A="dataPoint",O="fillRule";t.getFillRuleRole=i,t.shouldShowGradient=r,t.getUpdatedGradientSettings=n,t.getGradientMeasureIndex=o,t.getGradientValueColumn=s,t.hasGradientRole=l,t.getDefaultGradientSettings=u,t.getDefaultFillRuleDefinition=c,t.updateFillRule=d,t.getGradientSettings=p,t.getFillRule=h,t.getGradientSettingsFromRule=f,t.getGradientBarColors=m,t.getLinearGradient2FillRuleDefinition=y,t.getLinearGradient3FillRuleDefinition=v})(i=t.GradientUtils||(t.GradientUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(){return"#FFF"}function a(){return 50}function r(){return!1}function n(){return{color:i(),transparency:a(),show:r()}}function o(e,t){var i=t&&t.transparency;null==i&&(i=a());var r={selector:null,properties:{transparency:i,image:t&&t.image},objectName:"plotArea"};e.pushInstance(r)}function s(t,i,a){var r=t&&t.image,n=r&&r.url,o=r&&r.scaling,s=t&&t.transparency,l=i.children(".background-image");if(!n)return void(0!==l.length&&l.remove());switch(0===l.length&&(i.prepend('<div class="background-image"></div>'),l=i.children(".background-image"),l.css("position","absolute")),l.css({width:a.width,height:a.height,"margin-left":a.left,"margin-top":a.top}),l.css({"background-image":"url("+n+")","background-repeat":"no-repeat",opacity:(100-s)/100}),o){case e.imageScalingType.normal:l.css({"background-size":"","background-position":"50% 50%"});break;case e.imageScalingType.fit:l.css({"background-size":"100% 100%","background-position":""});break;case e.imageScalingType.fill:l.css({"background-size":"100%","background-position":"50% 50%"});break;default:l.css({"background-size":"","background-position":"50% 50%"})}}t.getDefaultColor=i,t.getDefaultTransparency=a,t.getDefaultShow=r,t.getDefaultValues=n,t.enumeratePlot=o,t.renderBackgroundImage=s})(t=e.visualBackgroundHelper||(e.visualBackgroundHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.data.Selector,a=(function(){function e(){}return e.prototype.pushInstance=function(e){var t=this.instances;t||(t=this.instances=[]);var i=this.containerIdx;null!=i&&(e.containerIdx=i);for(var a=0,r=t;a<r.length;a++){var n=r[a];if(this.canMerge(n,e))return this.extend(n,e,"properties"),this.extend(n,e,"validValues"),this}return t.push(e),this},e.prototype.pushContainer=function(e){var t=this.containers;t||(t=this.containers=[]);var i=t.push(e);return this.containerIdx=i-1,this},e.prototype.popContainer=function(){return this.containerIdx=void 0,this},e.prototype.complete=function(){if(this.instances){var e={instances:this.instances},t=this.containers;return t&&(e.containers=t),e}},e.prototype.canMerge=function(e,t){return e.objectName===t.objectName&&e.containerIdx===t.containerIdx&&i.equals(e.selector,t.selector)},e.prototype.extend=function(e,t,i){var a=t[i];if(a){var r=e[i];r||(r=e[i]={});for(var n in a)r[n]||(r[n]=a[n])}},e.merge=function(t,i){var a=e.normalize(t),r=e.normalize(i);if(!a||!r)return a||r;for(var n=a.containers?a.containers.length:0,o=0,s=r.instances;o<s.length;o++){var l=s[o];a.instances.push(l),null!=l.containerIdx&&(l.containerIdx+=n)}var u=r.containers;return _.isEmpty(u)||(a.containers?Array.prototype.push.apply(a.containers,u):a.containers=u),a},e.normalize=function(e){return _.isArray(e)?{instances:e}:e},e.getContainerForInstance=function(e,t){return e.containers[t.containerIdx]},e})();t.ObjectEnumerationBuilder=a})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i){switch(t){case e.outline.none:return"0px";case e.outline.bottomOnly:return"0px 0px "+i+"px 0px";case e.outline.topOnly:return i+"px 0px 0px 0px";case e.outline.leftOnly:return"0px 0px 0px "+i+"px";case e.outline.rightOnly:return"0px "+i+"px 0px 0px";case e.outline.topBottom:return i+"px 0px";case e.outline.leftRight:return"0px "+i+"px";case e.outline.frame:return i+"px";default:return"0px"}}t.getBorderWidth=i})(t=e.VisualBorderUtil||(e.VisualBorderUtil={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){return{m00:1,m01:0,m02:e,m10:0,m11:1,m12:t}}function i(e,t){return{m00:e,m01:0,m02:0,m10:0,m11:t,m12:0}}function a(e){var t=e,i=Math.sin(t),a=Math.cos(t);return{m00:a,m01:-i,m02:0,m10:i,m11:a,m12:0}}function r(e){var t=e.m00*e.m11-e.m01*e.m10,i=1/t;return{m00:e.m11*i,m01:-e.m01*i,m02:(e.m01*e.m12-e.m02*e.m11)*i,m10:-e.m10*i,m11:e.m00*i,m12:-(e.m00*e.m12-e.m10*e.m02)*i}}function n(e,t){return{m00:e.m00*t.m00+e.m01*t.m10,m01:e.m00*t.m01+e.m01*t.m11,m02:e.m00*t.m02+e.m01*t.m12+e.m02,m10:e.m10*t.m00+e.m11*t.m10,m11:e.m10*t.m01+e.m11*t.m11,m12:e.m10*t.m02+e.m11*t.m12+e.m12}}var o=(function(){function e(e){this.matrix=e||{m00:1,m01:0,m02:0,m10:0,m11:1,m12:0}}return e.prototype.applyToPoint=function(e){if(!e)return e;var t=this.matrix;return{x:t.m00*e.x+t.m01*e.y+t.m02,y:t.m10*e.x+t.m11*e.y+t.m12}},e.prototype.applyToRect=function(e){if(!e)return e;var t=e.left,i=e.top,a=this.matrix,r=1!==a.m00||1!==a.m11,n=0!==a.m01||0!==a.m10;if(!n&&!r)return{left:t+a.m02,top:i+a.m12,width:e.width,height:e.height};var o,s,l,u,c=e.left+e.width,d=e.top+e.height;if(n){var p=a.m00*t+a.m01*i+a.m02,h=a.m10*t+a.m11*i+a.m12,g=a.m00*t+a.m01*d+a.m02,f=a.m10*t+a.m11*d+a.m12,m=a.m00*c+a.m01*i+a.m02,y=a.m10*c+a.m11*i+a.m12,v=a.m00*c+a.m01*d+a.m02,w=a.m10*c+a.m11*d+a.m12;o=Math.min(p,g,m,v),s=Math.max(p,g,m,v),l=Math.min(h,f,y,w),u=Math.max(h,f,y,w)}else{var p=a.m00*t+a.m02,h=a.m11*i+a.m12,v=a.m00*c+a.m02,w=a.m11*d+a.m12;o=Math.min(p,v),s=Math.max(p,v),l=Math.min(h,w),u=Math.max(h,w)}return{left:o,top:l,width:s-o,height:u-l}},e.prototype.translate=function(e,i){if(0!==e||0!==i){var a=t(e,i);this.matrix=n(this.matrix,a),this._inverse=null}},e.prototype.scale=function(e,t){if(1!==e||1!==t){var a=i(e,t);this.matrix=n(this.matrix,a),this._inverse=null}},e.prototype.rotate=function(e){if(0!==e){var t=a(e);this.matrix=n(this.matrix,t),this._inverse=null}},e.prototype.add=function(e){e&&(this.matrix=n(this.matrix,e.matrix),this._inverse=null)},e.prototype.getInverse=function(){return this._inverse||(this._inverse=new e(r(this.matrix))),this._inverse},e})();e.Transform=o,e.createTranslateMatrix=t,e.createScaleMatrix=i,e.createRotationMatrix=a,e.createInverseMatrix=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.Color,n=e.data.DataRoleHelper;!(function(i){function o(e,t){if(_.isEmpty(t))return void e.pushInstance({selector:null,properties:{show:!1,lineColor:i.defaults.lineColor,transparency:i.defaults.transparency,style:i.defaults.lineStyle,combineSeries:i.defaults.combineSeries},objectName:p});var a=t[0],r={};r.show=a.show,r.displayName=a.displayName,a.combineSeries&&(r.lineColor=a.lineColor),r.transparency=a.transparency,r.style=a.style,r.combineSeries=a.combineSeries,r.useHighlightValues=a.useHighlightValues,e.pushInstance({selector:null,properties:r,objectName:p})}function s(e){return n.hasRoleInDataView(e,"regression.X")}function l(a,r,n,o){if(a&&a.categorical){var s=a.categorical;if(!_.isEmpty(s.categories)&&!_.isEmpty(s.values)){var l=s.categories[0].values,c=s.values.grouped();if(l&&c){var h=e.DataViewObjects.getObject(a.metadata.objects,p,{}),g=e.DataViewObject.getValue(h,d.show,!1),f=e.DataViewObject.getValue(h,d.displayName),m=e.DataViewObject.getValue(h,d.lineColor),y=e.DataViewObject.getValue(h,d.transparency,i.defaults.transparency),v=e.DataViewObject.getValue(h,d.style,i.defaults.lineStyle),w=e.DataViewObject.getValue(h,d.combineSeries,i.defaults.combineSeries),b=e.DataViewObject.getValue(h,d.useHighlightValues,i.defaults.useHighlightValues),C=e.DataViewObjects.getValue(s.values[0].source.objects,t.lineChartProps.dataPoint.fill);C&&(m=C);for(var S=r.metadata.objects,x=e.DataViewObjects.getFillColor(S,{objectName:"dataPoint",propertyName:"defaultColor"}),P=new t.ColorHelper(o,{objectName:"dataPoint",propertyName:"fill"},x),D=[],T=0;T<c.length;T++){for(var V=c[T],L=[],M=0;M<l.length;M++){var N=t.AxisHelper.normalizeNonFiniteNumber(l[M]),I=V.values[0],A=void 0;A=b&&I.highlights?I.highlights:I.values;var O=t.AxisHelper.normalizeNonFiniteNumber(A[M]);null!=N&&null!=O&&L.push({x:N,y:O})}var R=void 0;if(w)R=m||i.defaults.lineColor;else if(r.categorical.values.source){var E=r.categorical.values.grouped(),F=P.getColorForSeriesValue(E[T].objects,r.categorical.values.identityFields,V.name);F=u(F),R={solid:{color:F}}}else{var j=r.categorical.values[T],F=P.getColorForMeasure(j.source.objects,V.name);F=u(F),R={solid:{color:F}}}D.push({points:L,show:g,displayName:f,lineColor:R,transparency:y,style:v,combineSeries:w,useHighlightValues:b,y2Axis:n})}return D}}}}function u(e){var t=r.parseColorString(e);return t=r.darken(t,20),r.rgbString(t)}function c(e,i,a,r){var n=i.select(g.selector);n.empty()&&(n=i.append("svg").classed(g.class,!0)),n.attr({height:r.height,width:r.width});var o=n.selectAll(h.selector).data(e||[]);o.enter().append("path").classed(h.class,!0),o.attr("d",(function(e){var t=a.x.scale,i=e.y2Axis&&a.y2?a.y2.scale:a.y1.scale,r=d3.svg.line().x((function(e){return t(e.x)})).y((function(e){return i(e.y)}));return r(_.filter(e.points,(function(e){return null!=e.x&&null!=e.y})))})),o.each((function(e){var i=d3.select(this),a={};a.stroke=e.lineColor.solid.color,null!=e.transparency&&(a["stroke-opacity"]=(100-e.transparency)/100),e.style===t.lineStyle.dashed?a["stroke-dasharray"]="5, 5":e.style===t.lineStyle.dotted?(a["stroke-dasharray"]="1, 5",a["stroke-linecap"]="round"):e.style===t.lineStyle.solid&&(a["stroke-dasharray"]=null,a["stroke-linecap"]=null),i.style(a)})),o.exit().remove()}var d;!(function(e){e.show="show",e.displayName="displayName",e.lineColor="lineColor",e.transparency="transparency",e.style="style",e.combineSeries="combineSeries",e.useHighlightValues="useHighlightValues"})(d||(d={}));var p="trend";i.defaults={lineColor:{solid:{color:"#000"}},lineStyle:t.lineStyle.dashed,transparency:0,combineSeries:!0,useHighlightValues:!0};var h=a.CssConstants.createClassAndSelector("trend-line"),g=a.CssConstants.createClassAndSelector("trend-line-layer");i.enumerateObjectInstances=o,i.isDataViewForRegression=s,i.readDataView=l,i.darkenTrendLineColor=u,i.render=c})(i=t.TrendLineHelper||(t.TrendLineHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){return e.is(":visible")}e.partiallyVisible=t})(t=e.visibilityHelper||(e.visibilityHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=e.data.Selector;!(function(e){function t(e,t){return e=e||null,t=t||null,e===t||!e==!t&&(!!i.equals(e.selector,t.selector)&&_.isEqual(e.objects,t.objects))}e.equals=t})(t=e.VisualObjectRepetition||(e.VisualObjectRepetition={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.CssConstants.createClassAndSelector,n=e.data.DataRoleHelper;!(function(i){function a(e,t){var a;if(_.isEmpty(t)||(a=t[0]),!a)return void e.pushInstance({selector:{id:"0"},properties:{show:!1,lineColor:i.defaults.lineColor,style:i.defaults.style,confidenceBandStyle:i.defaults.confidenceBandStyle,transparency:i.defaults.transparency},objectName:i.forecastObjectName});var r=(n={},n[c.show]=a.show,n[c.displayName]=a.displayName,n[c.lineColor]=a.lineColor,n[c.style]=a.style,n[c.confidenceBandStyle]=a.confidenceBandStyle,n[c.transparency]=a.transparency,n);e.pushInstance({selector:a.selector,properties:r,objectName:i.forecastObjectName});var n}function o(e){if(!e||!e.categorical||!e.categorical.values)return!1;for(var t=e.categorical.values.grouped(),i=0,a=t;i<a.length;i++){var r=a[i],o=_.any(r.values,(function(e){return n.hasRoleInValueColumn(e,"forecast.ForecastValue")}));if(o)return!0}return!1}function s(a,r,o){if(!(a&&a.categorical&&r&&r.categorical))return[];var s=a.categorical;if(_.isEmpty(s.categories)||_.isEmpty(s.values))return[];var u=t.CartesianChart.getScalarKeys(s.categories[0]),d=u?_.map(u.values,(function(e){return e.min})):s.categories[0].values,p=s.values.grouped();if(_.isEmpty(d)||_.isEmpty(p))return[];var h=n.getMeasureIndexOfRole(p,i.forecastValueRole),g=n.getMeasureIndexOfRole(p,i.forecastConfidenceHighBoundRole),f=n.getMeasureIndexOfRole(p,i.forecastConfidenceLowBoundRole),m=[],y=l(r),v=0;for(var w in y){var b=y[w];for(var C in b){for(var S=b[C],x=e.DataViewObject.getValue(S,c.show,!1),P=e.DataViewObject.getValue(S,c.displayName),D=e.DataViewObject.getValue(S,c.lineColor,i.defaults.lineColor),T=e.DataViewObject.getValue(S,c.confidenceBandStyle,i.defaults.confidenceBandStyle),V=e.DataViewObject.getValue(S,c.transparency,i.defaults.transparency),L=e.DataViewObject.getValue(S,c.style,i.defaults.style),M=new t.ColorHelper(o,{objectName:"dataPoint",propertyName:"fill"},i.defaults.lineColor.solid.color),N=p[v],I=[],A=N.values[h].highlights?N.values[h].highlights:N.values[h].values,O=N.values[g].highlights?N.values[g].highlights:N.values[g].values,R=N.values[f].highlights?N.values[f].highlights:N.values[f].values,E=0;E<d.length;E++){var F=t.AxisHelper.normalizeNonFiniteNumber(d[E]),j=t.AxisHelper.normalizeNonFiniteNumber(A[E]);if(null!=F&&null!=j){var H=t.AxisHelper.normalizeNonFiniteNumber(O[E]),G=t.AxisHelper.normalizeNonFiniteNumber(R[E]);I.push({point:{x:F,y:j},upperBound:{x:F,y:H},lowerBound:{x:F,y:G}})}}var k=void 0;if(D)k=D;else if(r.categorical.values.source){var z=r.categorical.values.grouped(),U=M.getColorForSeriesValue(z[v].objects,r.categorical.values.identityFields,N.name);k={solid:{color:U}}}else{var B=r.categorical.values[v],U=M.getColorForMeasure(B.source.objects,N.name);k={solid:{color:U}}}m.push({selector:{id:C,metadata:w},points:I,show:x,displayName:P,lineColor:k,confidenceBandStyle:T,transparency:V,style:L}),v++}}return m}function l(t){var a=[];if(t&&t.categorical&&t.categorical.values){var r=_.first(t.categorical.values.grouped());if(r)for(var n=0,o=r.values;n<o.length;n++){var s=o[n],l=s.source.queryName,u=e.DataViewObjects.getUserDefinedObjects(s.source.objects,i.forecastObjectName);a[l]=u}}return a}function u(e,i,a,r,n,o){var s=i.select(h.selector);s.empty()&&(s=i.insert("g",":first-child").classed(h.class,!0));var l=s.selectAll(p.selector).data(e||[]);l.enter().insert("path",":first-child").classed(p.class,!0),l.transition().ease("linear").duration(o).attr("d",(function(e){for(var t=d3.svg.line().x((function(e){return a(e.x)})).y((function(e){return r(e.y)})),i=[],n=0,o=e.points.slice().reverse();n<o.length;n++){var s=o[n];i.push({x:s.lowerBound.x,y:s.lowerBound.y})}for(var l=0,u=e.points;l<u.length;l++){var s=u[l];i.push({x:s.upperBound.x,y:s.upperBound.y})}return t(i)})),l.each((function(e){var i=d3.select(this),a={},r=(100-e.transparency)/100;a["fill-opacity"]=r,a["stroke-opacity"]=r,e.confidenceBandStyle===t.confidenceBandStyle.fill?(a.stroke="transparent",a.fill=e.lineColor.solid.color):e.confidenceBandStyle===t.confidenceBandStyle.line?(a.stroke=e.lineColor.solid.color,a.fill="transparent"):e.confidenceBandStyle===t.confidenceBandStyle.none&&(a.stroke="transparent",a.fill="transparent"),i.style(a)})),l.exit().remove();var u=s.selectAll(d.selector).data(e||[]);u.enter().append("path").classed(d.class,!0),u.transition().ease("linear").duration(o).attr("d",(function(e){var t=d3.svg.line().x((function(e){return a(e.point.x)})).y((function(e){return r(e.point.y)}));return t(e.points)})),u.each((function(e){var i=d3.select(this),a={};a.stroke=e.lineColor.solid.color,a.fill="transparent",e.style===t.lineStyle.dashed?a["stroke-dasharray"]="5, 5":e.style===t.lineStyle.dotted?(a["stroke-dasharray"]="1, 5",a["stroke-linecap"]="round"):e.style===t.lineStyle.solid&&(a["stroke-dasharray"]=null,a["stroke-linecap"]=null),i.style(a)})),u.exit().remove()}var c;!(function(e){e.show="show",e.displayName="displayName",e.lineColor="lineColor",e.confidenceBandStyle="confidenceBandStyle",e.transparency="transparency",e.style="style"})(c||(c={})),i.forecastObjectName="forecast",i.forecastValueRole="forecast.ForecastValue",i.forecastConfidenceHighBoundRole="forecast.ConfidenceHighBound",i.forecastConfidenceLowBoundRole="forecast.ConfidenceLowBound",i.defaults={lineColor:{solid:{color:"#000"}},displayName:"",confidenceBandStyle:t.confidenceBandStyle.fill,transparency:80,style:t.lineStyle.solid},i.quarterHierarchyLevelPrefixResorceKey="Visual_Quarter_Abbreviated";var d=r("forecast-line"),p=r("forecast-error-range"),h=r("forecast-line-layer");i.enumerateObjectInstances=a,i.isDataViewForForecast=o,i.readDataView=s,i.render=u})(i=t.ForecastHelper||(t.ForecastHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.PixelConverter,r=1,n=0,o="#00B8AA",s="#666666",l=(function(){function a(){}return a.convert=function(e){var i=e.getStaticObjects(),a=e.getValueMetadataColumn(t.gaugeRoleNames.y),r=this.parseGaugeData(e),n=this.convertDataLabelSettings(i,"labels");return{maxLabel:this.createLabel(r.max,e.getValueMetadataColumn(t.gaugeRoleNames.maxValue),n,a),minLabel:this.createLabel(r.min,e.getValueMetadataColumn(t.gaugeRoleNames.minValue),n,a,r.max),target:{label:this.createLabel(r.target,e.getValueMetadataColumn(t.gaugeRoleNames.targetValue),n,a),ratio:this.getTargetRatio(r)},calloutLabel:this.createLabel(r.value,a,this.convertDataLabelSettings(i,"calloutValue"),a),tooltipInfo:r.tooltipItems,ratio:this.getValueRatio(r),dataPointSettings:this.convertDataPointSettings(i,r)}},a.parseGaugeData=function(e){var i=e.getStaticObjects(),a=e.getValueMetadataColumn(t.gaugeRoleNames.y),o=i?i.axis:null,s=e.hasValues(t.gaugeRoleNames.y),l=e.hasValues(t.gaugeRoleNames.maxValue),u=e.hasValues(t.gaugeRoleNames.minValue),c=0,d={max:null,min:null,target:null,value:null,tooltipItems:[]};if(s){d.value=e.getValue(t.gaugeRoleNames.y,c);var p=t.converterHelper.formatFromMetadataColumn(d.value,a,this.formatStringProp);
d.tooltipItems.push({displayName:e.getValueDisplayName(t.gaugeRoleNames.y),value:p})}if(e.hasValues(t.gaugeRoleNames.targetValue)){var h=e.getValueMetadataColumn(t.gaugeRoleNames.targetValue);d.target=e.getValue(t.gaugeRoleNames.targetValue,c);var p=t.converterHelper.formatFromMetadataColumn(d.target,h,this.formatStringProp);d.tooltipItems.push({displayName:e.getValueDisplayName(t.gaugeRoleNames.targetValue),value:p})}else o&&(d.target=o.target);if(l)d.max=e.getValue(t.gaugeRoleNames.maxValue,c);else if(o&&null!=o.max)d.max=o.max;else if(d.max=r,s&&d.value&&0!==d.value){var g=!1;if(a){var f=t.valueFormatter.getFormatString(a,this.formatStringProp,!0);null!=f&&(g=t.valueFormatter.getFormatMetadata(f).hasPercent)}g||(d.max=d.value<0?n:2*d.value)}return u?d.min=e.getValue(t.gaugeRoleNames.minValue,c):o&&null!=o.min?d.min=o.min:(d.min=n,s&&null!=d.value&&d.value<0&&(d.min=2*d.value)),t.TooltipBuilder.addTooltipMeasures(e,d.tooltipItems,c),d},a.createLabel=function(a,r,n,o,s){var l={fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:i.fromPoint(n.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},u=this.getFormatter(n,r,o,s||a);return l.text=u.format(a),{value:a,requiredSpace:{width:e.TextMeasurementService.measureSvgTextWidth(l),height:e.TextMeasurementService.estimateSvgTextHeight(l)},text:l.text,formatter:u,settings:n}},a.getFormatter=function(i,a,r,n){var o=0===i.displayUnits?n:null;a&&a.objects&&!_.isEmpty(e.DataViewObjects.getValue(a.objects,this.formatStringProp))||(a=r);var s=t.valueFormatter.getFormatString(a,this.formatStringProp),l=t.dataLabelUtils.getLabelPrecision(i.precision,s),u=t.dataLabelUtils.getOptionsForLabelFormatter(i,s,o,l);return u.formatSingleValues=!(i.displayUnits>0),0===i.displayUnits&&(u.value=o),t.valueFormatter.create(u)},a.getValueRatio=function(e){if(!this.isValid(e)||e.value<=e.min)return 0;if(e.value>=e.max)return 1;var t=e.max-e.min,i=(e.value-e.min)/t;return i},a.isValid=function(e){return _.isNumber(e.min)&&_.isNumber(e.max)&&e.min<=e.max},a.getTargetRatio=function(e){if(!this.isValid(e)||!_.isNumber(e.target))return-1;var t=e.max-e.min;return 0!==t?(e.target-e.min)/t:0},a.convertDataLabelSettings=function(e,i){var a=t.dataLabelUtils.getDefaultGaugeLabelSettings();if(e){var r=e[i];t.dataLabelUtils.updateLabelSettingsFromLabelsObject(r,a)}return a},a.convertDataPointSettings=function(i,a){var r=o,n=s;return i&&(r=e.DataViewObjects.getFillColor(i,t.gaugeProps.dataPoint.fill,o),n=e.DataViewObjects.getFillColor(i,t.gaugeProps.dataPoint.target,s)),{fillColor:r,targetColor:n}},a.formatStringProp={objectName:"general",propertyName:"formatString"},a})();t.GaugeConverter=l})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i,n=e.data.DefaultSQExprVisitor,o=e.data.SemanticFilter,s=a.UrlUtils;!(function(i){function a(){return{general:{outlineWeight:1,outlineColor:"#808080"},slicerText:{color:"#666666",outline:t.outline.none,textSize:10},selection:{selectAllCheckboxEnabled:!1,singleSelect:!0},search:{enabled:!1}}}function l(i,a,r,n){if(i&&i.categorical&&!_.isEmpty(i.categorical.categories)){var s=i.categorical.categories[0].identityFields;if(s){var l=i.metadata&&i.metadata.objects&&e.DataViewObjects.getValue(i.metadata.objects,t.slicerProps.filterPropertyIdentifier),c=n.analyzeFilter({dataView:i,defaultValuePropertyId:t.slicerProps.defaultValue,filter:l,fieldSQExprs:s});if(c){var d=c.filter;if(d&&!o.isSameFilter(d,l)){r.handleClearSelection();var p=t.slicerProps.filterPropertyIdentifier,h={};h[p.propertyName]=c.filter;var g={objectName:p.objectName,selector:void 0,properties:h},f={merge:[g]};n.persistProperties(f)}var m=u(c,i.metadata,i.categorical,a,r,n);return m}}}}function u(i,a,r,n,l,u){var p=l&&l.isSelectionModeInverted(),h=i.selectedIdentities,g=!_.isEmpty(h)||p===!0;!p&&i.filter&&(p=i.isNotFilter),l&&(l.setSelectionModeInverted(p),l.setDefaultValueMode(o.isDefaultFilter(i.filter)));for(var f=r.categories[0],m=f&&f.values?f.values.length:0,y=[],v=t.valueFormatter.getFormatString(f.source,t.slicerProps.formatString),w=0,b=f.objects,C=a&&!_.isEmpty(a.columns)&&t.converterHelper.isImageUrlColumn(a.columns[0]),S=[],x=0;x<m;x++){var P=f.identity&&f.identity[x],D=f.values&&f.values[x],T=void 0;if(b){var V=b[x];T=e.DataViewObjects.getValue(V,t.slicerProps.general.count,T)}var L=!!g&&t.SlicerUtil.tryRemoveValueFromRetainedList(P,h),M=t.valueFormatter.format(D,v),N=C===!0&&s.isValidImageUrl(M),I={value:M,tooltip:M,identity:t.SelectionIdBuilder.builder().withCategory(f,x).createSelectionId(),selected:L,count:T,isImage:N};if(L){var A={displayName:M,identity:P};S.push(A)}y.push(I),I.selected&&w++}if(_.isEmpty(S)||u.setIdentityDisplayNames(S),g&&!_.isEmpty(h)){var O=u.getIdentityDisplayNames(h);if(!_.isEmpty(O))for(var R=0,E=O;R<E.length;R++){var F=E[R],M=t.valueFormatter.format(F.displayName,v),j={value:M,tooltip:M,identity:t.SelectionIdBuilder.builder().withCategoryIdentity(f,F.identity).createSelectionId(),selected:!0,count:null!=b?0:void 0};y.push(j),w++}}var H=c(a),G=d(a);G.selection.selectAllCheckboxEnabled&&_.isEmpty(H)&&y.unshift({value:n,tooltip:n,identity:t.SelectionId.createWithMeasure(n),selected:!!p&&0===w,isSelectAllDataPoint:!0,count:void 0});var k={categorySourceName:f.source.displayName,slicerSettings:G,slicerDataPoints:y,hasSelectionOverride:g,defaultValue:i.defaultValue,searchKey:H};return k}function c(i){var a=e.DataViewObjects.getValue(i.objects,t.slicerProps.selfFilterPropertyIdentifier,void 0);if(!a)return"";var r=a.conditions(),n=r[0];if(n){var o=new p;return n.accept(o),o.getValueForField()}}function d(a){var r=i.DefaultSlicerProperties(),n=a.objects,o=a.columns&&_.some(a.columns,(function(e){return e.discourageAggregationAcrossGroups}));if(n){r.slicerText.color=e.DataViewObjects.getFillColor(n,t.slicerProps.items.fontColor,r.slicerText.color),r.general.outlineWeight=e.DataViewObjects.getValue(n,t.slicerProps.general.outlineWeight,r.general.outlineWeight),r.general.outlineColor=e.DataViewObjects.getFillColor(n,t.slicerProps.general.outlineColor,r.general.outlineColor);var s=e.DataViewObjects.getFillColor(n,t.slicerProps.items.background);s&&(r.slicerText.background=s),r.slicerText.outline=e.DataViewObjects.getValue(n,t.slicerProps.items.outline,r.slicerText.outline),r.slicerText.textSize=e.DataViewObjects.getValue(n,t.slicerProps.items.textSize,r.slicerText.textSize),r.selection.selectAllCheckboxEnabled=!o&&e.DataViewObjects.getValue(n,t.slicerProps.selection.selectAllCheckboxEnabled,r.selection.selectAllCheckboxEnabled),r.selection.singleSelect=o||e.DataViewObjects.getValue(n,t.slicerProps.selection.singleSelect,r.selection.singleSelect),r.search.enabled=e.DataViewObjects.getValue(n,t.slicerProps.general.selfFilterEnabled,r.search.enabled)}return r}i.DefaultSlicerProperties=a,i.convert=l;var p=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitConstant=function(e){e.type&&e.type.text&&(this.value=e.value)},t.prototype.visitContains=function(e){e.left.accept(this),e.right.accept(this)},t.prototype.visitColumnRef=function(e){this.fieldExpr=e},t.prototype.visitDefault=function(e){this.value=void 0,this.fieldExpr=void 0},t.prototype.getValueForField=function(){return this.fieldExpr&&this.value},t})(n)})(i=t.DataConversion||(t.DataConversion={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=e.visuals.shapes;!(function(e){e[e.None=0]="None",e[e.VerticalBottomTop=1]="VerticalBottomTop",e[e.VerticalTopBottom=2]="VerticalTopBottom",e[e.HorizontalLeftRight=3]="HorizontalLeftRight",e[e.HorizontalRightLeft=4]="HorizontalRightLeft"})(e.RectOrientation||(e.RectOrientation={}));var i=e.RectOrientation;!(function(e){e[e.Allowed=0]="Allowed",e[e.Disallowed=1]="Disallowed",e[e.Partial=2]="Partial"})(e.OutsidePlacement||(e.OutsidePlacement={}));var a=e.OutsidePlacement,r=(function(){function r(){this.movingStep=3,this.hideOverlapped=!0,this.defaultDataLabelSettings={anchorMargin:r.DefaultAnchorMargin,anchorRectOrientation:i.None,contentPosition:128,outsidePlacement:a.Disallowed,maximumMovingDistance:r.DefaultMaximumMovingDistance,minimumMovingDistance:r.DefaultMinimumMovingDistance,validContentPositions:128,opacity:1}}return Object.defineProperty(r.prototype,"defaultSettings",{get:function(){return this.defaultDataLabelSettings},enumerable:!0,configurable:!0}),r.prototype.hideCollidedLabels=function(e,t,i,a){void 0===a&&(a=!1);var o=new n(e,t,i),s=[],l={x:0,y:0};a&&(l.x=e.width/2,l.y=e.height/2);for(var u=0,c=t.length;u<c;u++)if(i.filter(t[u])){var d=this.getLabelInfo(t[u]);d.anchorPoint={x:i.labelLayout.x(t[u])+l.x,y:i.labelLayout.y(t[u])+l.y};var p=this.calculateContentPosition(d,d.contentPosition,t[u].size,d.anchorMargin);r.isValid(p)&&!this.hasCollisions(o,d,p,e)&&(t[u].labelX=p.left-l.x,t[u].labelY=p.top-l.y,o.add(d,p),s.push(t[u]))}return s},r.prototype.getLabelInfo=function(e){var t=this.defaultDataLabelSettings;return e.anchorMargin=void 0!==e.anchorMargin?e.anchorMargin:t.anchorMargin,e.anchorRectOrientation=void 0!==e.anchorRectOrientation?e.anchorRectOrientation:t.anchorRectOrientation,e.contentPosition=void 0!==e.contentPosition?e.contentPosition:t.contentPosition,e.maximumMovingDistance=void 0!==e.maximumMovingDistance?e.maximumMovingDistance:t.maximumMovingDistance,e.minimumMovingDistance=void 0!==e.minimumMovingDistance?e.minimumMovingDistance:t.minimumMovingDistance,e.outsidePlacement=void 0!==e.outsidePlacement?e.outsidePlacement:t.outsidePlacement,e.validContentPositions=void 0!==e.validContentPositions?e.validContentPositions:t.validContentPositions,e.opacity=void 0!==e.opacity?e.opacity:t.opacity,e.maximumMovingDistance+=e.anchorMargin,e},r.prototype.calculateContentPositionFromPoint=function(e,t,i,a){var r={x:0,y:0};if(e){if(void 0!==e.x&&isFinite(e.x))switch(r.x=e.x,t){case 1:case 8:case 64:r.x-=i.width/2;break;case 4:case 32:case 256:r.x+=i.width/2}if(void 0!==e.y&&isFinite(e.y))switch(r.y=e.y,t){case 8:case 16:case 32:r.y-=i.height/2;break;case 4:case 1:case 2:r.y-=i.height}if(void 0!==a&&isFinite(a))switch(t){case 1:r.x-=a,r.y-=a;break;case 8:r.x-=a;break;case 64:r.x-=a,r.y+=a;break;case 2:r.y-=a;break;case 16:break;case 128:r.y+=a;break;case 4:r.x+=a,r.y-=a;break;case 32:r.x+=a;break;case 256:r.x+=a,r.y+=a}}return{left:r.x,top:r.y,width:i.width,height:i.height}},r.prototype.calculateContentPositionFromRect=function(e,t,i,a,r){switch(i){case 512:return this.handleInsideCenterPosition(t,a,e,r);case 2048:return this.handleInsideEndPosition(t,a,e,r);case 1024:return this.handleInsideBasePosition(t,a,e,r);case 8192:return this.handleOutsideEndPosition(t,a,e,r);case 4096:return this.handleOutsideBasePosition(t,a,e,r)}return{left:0,top:0,width:-1,height:-1}},r.prototype.handleInsideCenterPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:case i.VerticalTopBottom:return o.middleVertical(t,a,r);case i.HorizontalLeftRight:case i.HorizontalRightLeft:default:return o.middleHorizontal(t,a,r)}},r.prototype.handleInsideEndPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return o.topInside(t,a,r);case i.VerticalTopBottom:return o.bottomInside(t,a,r);case i.HorizontalRightLeft:return o.leftInside(t,a,r);case i.HorizontalLeftRight:default:return o.rightInside(t,a,r)}},r.prototype.handleInsideBasePosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return o.bottomInside(t,a,r);case i.VerticalTopBottom:return o.topInside(t,a,r);case i.HorizontalRightLeft:return o.rightInside(t,a,r);case i.HorizontalLeftRight:default:return o.leftInside(t,a,r)}},r.prototype.handleOutsideEndPosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return o.topOutside(t,a,r);case i.VerticalTopBottom:return o.bottomOutside(t,a,r);case i.HorizontalRightLeft:return o.leftOutside(t,a,r);case i.HorizontalLeftRight:default:return o.rightOutside(t,a,r)}},r.prototype.handleOutsideBasePosition=function(e,t,a,r){switch(e){case i.VerticalBottomTop:return o.bottomOutside(t,a,r);case i.VerticalTopBottom:return o.topOutside(t,a,r);case i.HorizontalRightLeft:return o.rightOutside(t,a,r);case i.HorizontalLeftRight:default:return o.leftOutside(t,a,r)}},r.prototype.calculateContentPosition=function(e,t,i,a){return 2048!==t&&512!==t&&1024!==t&&4096!==t&&8192!==t?this.calculateContentPositionFromPoint(e.anchorPoint,t,i,a):this.calculateContentPositionFromRect(e.anchorRect,e.anchorRectOrientation,t,i,a)},r.prototype.hasCollisions=function(i,n,o,s){var l=t.Rect;if(i.hasConflict(o))return!0;var u={left:0,top:o.height/2,width:s.width,height:s.height};if(u=l.inflate(u,{left:r.InflateAmount,top:0,right:r.InflateAmount,bottom:0}),u=l.intersect(u,o),l.isEmpty(u))return!0;var c=e.Double.lessWithPrecision;switch(n.outsidePlacement){case a.Disallowed:return c(u.width,o.width)||c(u.height,o.height/2);case a.Partial:return c(u.width,o.width/2)||c(u.height,o.height/4)}return!1},r.isValid=function(e){return!t.Rect.isEmpty(e)&&e.width>0&&e.height>0},r.DefaultAnchorMargin=0,r.DefaultMaximumMovingDistance=12,r.DefaultMinimumMovingDistance=3,r.InflateAmount=5,r})();e.DataLabelManager=r;var n=(function(){function i(t,a,r){this.grid=[],0!==t.width&&0!==t.height||(this.cellSize=t,this.rowCount=this.colCount=0);var n={fontFamily:e.visuals.dataLabelUtils.LabelTextProperties.fontFamily,fontSize:e.visuals.dataLabelUtils.LabelTextProperties.fontSize,fontWeight:e.visuals.dataLabelUtils.LabelTextProperties.fontWeight};this.cellSize={width:0,height:0};for(var o=0,s=a.length;o<s;o++){var l=a[o];l.labeltext=r.labelText(l);var u=e.Prototype.inherit(n);u.text=l.labeltext,u.fontSize=l.data?l.data.labelFontSize:l.labelFontSize?l.labelFontSize:e.visuals.dataLabelUtils.LabelTextProperties.fontSize,l.size={width:e.TextMeasurementService.measureSvgTextWidth(u),height:e.TextMeasurementService.estimateSvgTextHeight(u)};var c=2*l.size.width,d=2*l.size.height;c>this.cellSize.width&&(this.cellSize.width=c),d>this.cellSize.height&&(this.cellSize.height=d)}0===this.cellSize.width&&(this.cellSize.width=t.width),0===this.cellSize.height&&(this.cellSize.height=t.height),this.colCount=this.getGridRowColCount(this.cellSize.width,t.width,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this.rowCount=this.getGridRowColCount(this.cellSize.height,t.height,i.ARRANGEGRID_MIN_COUNT,i.ARRANGEGRID_MAX_COUNT),this.cellSize.width=t.width/this.colCount,this.cellSize.height=t.height/this.rowCount;for(var p=this.grid,h=0;h<this.colCount;h++){p[h]=[];for(var g=0;g<this.rowCount;g++)p[h][g]=[]}}return i.prototype.add=function(e,t){for(var i=this.getGridIndexRect(t),a=this.grid,r=i.left;r<i.right;r++)for(var n=i.top;n<i.bottom;n++)a[r][n].push({element:e,rect:t})},i.prototype.hasConflict=function(e){for(var i=this.getGridIndexRect(e),a=this.grid,r=t.Rect.isIntersecting,n=i.left;n<i.right;n++)for(var o=i.top;o<i.bottom;o++)for(var s=0;s<a[n][o].length;s++){var l=a[n][o][s];if(r(l.rect,e))return!0}return!1},i.prototype.getGridRowColCount=function(e,t,i,a){return Math.min(Math.max(Math.ceil(t/e),i),a)},i.prototype.getGridIndexRect=function(e){var t=function(e,t,i){return Math.min(Math.max(e,t),i)};return{left:t(Math.floor(e.left/this.cellSize.width),0,this.colCount),top:t(Math.floor(e.top/this.cellSize.height),0,this.rowCount),right:t(Math.ceil((e.left+e.width)/this.cellSize.width),0,this.colCount),bottom:t(Math.ceil((e.top+e.height)/this.cellSize.height),0,this.rowCount)}},i.ARRANGEGRID_MIN_COUNT=1,i.ARRANGEGRID_MAX_COUNT=100,i})();e.DataLabelArrangeGrid=n;var o;!(function(e){function t(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+i,width:e.width,height:e.height}}function i(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height-e.height-i,width:e.width,height:e.height}}function a(e,t,i){return{left:t.left+t.width-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function r(e,t,i){return{left:t.left+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function n(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top-e.height-i,width:e.width,height:e.height}}function o(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height+i,width:e.width,height:e.height}}function s(e,t,i){return{left:t.left+t.width+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function l(e,t,i){return{left:t.left-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function u(e,t,i){return{left:t.left+t.width/2-e.width/2+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function c(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height/2-e.height/2+i,width:e.width,height:e.height}}e.topInside=t,e.bottomInside=i,e.rightInside=a,e.leftInside=r,e.topOutside=n,e.bottomOutside=o,e.rightOutside=s,e.leftOutside=l,e.middleHorizontal=u,e.middleVertical=c})(o||(o={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=e.visuals.NewDataLabelUtils,i=e.visuals.shapes.Rect,a=e.visuals.shapes,r=(function(){function e(t,i){this.viewport=i;for(var a=0,r=0,n=0,o=t;n<o.length;n++)for(var s=o[n],l=0,u=s.labelDataPoints;l<u.length;l++){var c=u[l],d=c.labelSize;d.width>a&&(a=d.width),d.height>r&&(r=d.height)}0===a&&(a=i.width),0===r&&(r=i.height);var p=this.cellSize={width:a*e.cellSizeMultiplier,height:r*e.cellSizeMultiplier};this.columnCount=e.getCellCount(p.width,i.width,1,100),this.rowCount=e.getCellCount(p.height,i.height,1,100);for(var h=[],g=0,f=this.columnCount;g<f;g++){h[g]=[];for(var m=0,y=this.rowCount;m<y;m++)h[g][m]=[]}this.grid=h}return e.prototype.add=function(e){for(var t=this.getContainingGridSubsection(e),i=t.xMin;i<t.xMax;i++)for(var a=t.yMin;a<t.yMax;a++)this.grid[i][a].push(e)},e.prototype.hasConflict=function(e){return!this.isWithinGridViewport(e)||this.hasCollision(e)},e.prototype.tryPositionInViewport=function(e){if(this.isCloseToGridViewport(e))return this.isWithinGridViewport(e)||(e=this.tryMoveInsideViewport(e)),e&&!this.hasCollision(e)?e:void 0},e.prototype.hasCollision=function(e){for(var t=this.getContainingGridSubsection(e),i=this.grid,r=a.Rect.isIntersecting,n=t.xMin;n<t.xMax;n++)for(var o=t.yMin;o<t.yMax;o++)for(var s=0,l=i[n][o];s<l.length;s++){var u=l[s];if(r(u,e))return!0}return!1},e.prototype.isWithinGridViewport=function(e){return e.left>=0&&e.top>=0&&e.left+e.width<=this.viewport.width&&e.top+e.height<=this.viewport.height},e.prototype.isCloseToGridViewport=function(e){return e.left+e.width>=0-e.width&&e.top+e.height>=-e.height&&e.left<=this.viewport.width+e.width&&e.top<=this.viewport.height+e.height},e.prototype.tryMoveInsideViewport=function(e){var t=i.clone(e),a=this.viewport;if(!(e.width>a.width||e.height>a.height))return e.left<0?t.left=0:e.left+e.width>a.width&&(t.left-=e.left+e.width-a.width),e.top<0?t.top=0:e.top+e.height>a.height&&(t.top-=e.top+e.height-a.height),t},e.prototype.getContainingGridSubsection=function(t){return{xMin:e.bound(Math.floor(t.left/this.cellSize.width),0,this.columnCount),xMax:e.bound(Math.ceil((t.left+t.width)/this.cellSize.width),0,this.columnCount),yMin:e.bound(Math.floor(t.top/this.cellSize.height),0,this.rowCount),yMax:e.bound(Math.ceil((t.top+t.height)/this.cellSize.height),0,this.rowCount)}},e.getCellCount=function(t,i,a,r){return e.bound(Math.ceil(i/t),a,r)},e.bound=function(e,t,i){return Math.max(Math.min(e,i),t)},e.cellSizeMultiplier=2,e})();e.LabelArrangeGrid=r;var n=(function(){function e(t){this.startingOffset=t.startingOffset,this.maximumOffset=t.maximumOffset,null!=t.offsetIterationDelta?this.offsetIterationDelta=t.offsetIterationDelta:this.offsetIterationDelta=e.defaultOffsetIterationDelta,null!=t.horizontalPadding?this.horizontalPadding=t.horizontalPadding:this.horizontalPadding=e.defaultHorizontalPadding,null!=t.verticalPadding?this.verticalPadding=t.verticalPadding:this.verticalPadding=e.defaultVerticalPadding,this.allowLeaderLines=!!t.allowLeaderLines,this.attemptToMoveLabelsIntoViewport=!!t.attemptToMoveLabelsIntoViewport}return e.prototype.layout=function(e,i){for(var a=[],n=0,o=e;n<o.length;n++){for(var s=o[n],l=_.map(s.labelDataPoints,(function(e){return{labelDataPoint:e}})),u=s.labelOrientation,c=0,d=l;c<d.length;c++){var p=d[c],h=p.labelDataPoint;p.hasBeenRendered=!1;var g=h.textSize.width,f=h.textSize.height;0===u&&(g=h.textSize.height,f=h.textSize.width),h.hasBackground?p.labelSize={width:g+2*t.horizontalLabelBackgroundPadding,height:f+2*t.verticalLabelBackgroundPadding}:p.labelSize={width:g,height:f}}a.push({labelDataPoints:l,maxNumberOfLabels:s.maxNumberOfLabels,labelOrientation:s.labelOrientation})}for(var m=[],y=new r(a,i),v=0,w=a;v<w.length;v++){for(var b=w[v],C=b.maxNumberOfLabels,l=_.clone(b.labelDataPoints),S=[],u=b.labelOrientation,x=l.length-1,P=C;x>=0&&P>0;x--){var h=l[x].labelDataPoint;h.isPreferred&&(S.unshift(l.splice(x,1)[0]),P--)}if(S.length>0){var D=this.positionDataLabels(S,i,y,C,u);C-=D.length,m=m.concat(D)}if(l.length>0){var T=this.positionDataLabels(l,i,y,C,u);m=m.concat(T)}}return _.filter(m,(function(e){return e.isVisible}))},e.prototype.positionDataLabels=function(e,t,i,a,r){for(var n,o=[],s=this.offsetIterationDelta,l=this.startingOffset,u=0,c=0;l<=this.maximumOffset&&c<a;){n=this.allowLeaderLines&&l>this.startingOffset;for(var d=0,p=e;d<p.length;d++){var h=p[d],g=h.labelDataPoint;if(!h.hasBeenRendered){var f=void 0;if(f=1===g.parentType?this.tryPositionForRectPositions(h,i,l,u,r):this.tryPositionForPointPositions(h,i,l,n,r),f&&(o.push(f),c++),!(c<a))break}}l+=s,u+=s}return o},e.prototype.tryPositionForRectPositions=function(t,i,a,r,n){for(var s=this,l=t.labelDataPoint,u=function(u,c){var d=7&u;if(!d||o.canFitWithinParent(t,s.horizontalPadding,s.verticalPadding)){var p=e.tryPositionRect(i,u,t,a,r,c);if(p){if(d&&!o.isLabelWithinParent(p,l,s.horizontalPadding,s.verticalPadding))return;return i.add(p),t.hasBeenRendered=!0,{boundingBox:p,text:l.text,tooltip:l.tooltip,isVisible:!0,fill:d?l.insideFill:l.outsideFill,identity:l.identity,key:l.key,fontSize:l.fontSize,selected:!1,hasBackground:!!l.hasBackground,labelOrientation:n}}}},c=0,d=l.parentShape.validPositions;c<d.length;c++){var p=d[c],h=u(p,!1);if(h)return h}if(this.attemptToMoveLabelsIntoViewport)for(var g=0,f=l.parentShape.validPositions;g<f.length;g++){var p=f[g],h=u(p,!0);if(h)return h}return null},e.tryPositionRect=function(e,t,i,a,r,n){var s=a;1&t&&(s=r);var l=o.getLabelRect(i,t,s),u=i.labelDataPoint;if(1!==t||0===u.parentShape.orientation){if(!e.hasConflict(l))return l;if(n)return e.tryPositionInViewport(l)}else{if(!e.hasConflict(l))return l;if(l=o.getLabelRect(i,t,-s),!e.hasConflict(l))return l}return null},e.prototype.tryPositionForPointPositions=function(t,i,a,r,n){for(var o=t.labelDataPoint,l=function(l,u,c){var d=e.tryPositionPoint(i,l,t,a,c);if(d)return i.add(d),t.hasBeenRendered=!0,{boundingBox:d,text:o.text,tooltip:o.tooltip,isVisible:!0,fill:256===l?o.insideFill:o.outsideFill,isInsideParent:256===l,identity:o.identity,key:o.key,fontSize:o.fontSize,selected:!1,leaderLinePoints:r?s.getLabelLeaderLineEndingPoint(d,l,u):null,hasBackground:!!o.hasBackground,labelOrientation:n}},u=o.parentShape,c=u.validPositions,d=0,p=c;d<p.length;d++){var h=p[d],g=l(h,u,!1);if(g)return g}if(this.attemptToMoveLabelsIntoViewport&&!_.isEmpty(c)){var g=l(c[0],u,!0);if(g)return g}return null},e.tryPositionPoint=function(e,t,i,a,r){var n=s.getLabelRect(i.labelSize,i.labelDataPoint.parentShape,t,a);return e.hasConflict(n)?r?e.tryPositionInViewport(n):null:n},e.defaultOffsetIterationDelta=2,e.defaultHorizontalPadding=2,e.defaultVerticalPadding=2,e})();e.LabelLayout=n;var o;!(function(e){function t(t,i,a){var r=t.labelDataPoint,n=r.parentShape;if(null!=n)switch(i){case 1:switch(n.orientation){case 1:case 2:return e.middleVertical(t.labelSize,n.rect,a);case 3:case 4:return e.middleHorizontal(t.labelSize,n.rect,a);case 0:}case 2:switch(n.orientation){case 1:return e.bottomInside(t.labelSize,n.rect,a);case 2:return e.topInside(t.labelSize,n.rect,a);case 3:return e.leftInside(t.labelSize,n.rect,a);case 4:return e.rightInside(t.labelSize,n.rect,a);case 0:}case 4:switch(n.orientation){case 1:return e.topInside(t.labelSize,n.rect,a);case 2:return e.bottomInside(t.labelSize,n.rect,a);case 3:return e.rightInside(t.labelSize,n.rect,a);case 4:return e.leftInside(t.labelSize,n.rect,a);case 0:}case 8:switch(n.orientation){case 1:return e.bottomOutside(t.labelSize,n.rect,a);case 2:return e.topOutside(t.labelSize,n.rect,a);case 3:return e.leftOutside(t.labelSize,n.rect,a);case 4:return e.rightOutside(t.labelSize,n.rect,a);case 0:}case 16:switch(n.orientation){case 1:return e.topOutside(t.labelSize,n.rect,a);case 2:return e.bottomOutside(t.labelSize,n.rect,a);case 3:return e.rightOutside(t.labelSize,n.rect,a);case 4:return e.leftOutside(t.labelSize,n.rect,a);case 0:}}return null}function i(e,t,i){var a=e.labelDataPoint;return e.labelSize.width+2*t<a.parentShape.rect.width||e.labelSize.height+2*i<a.parentShape.rect.height}function r(e,t,i,r){var n=t.parentShape.rect,o=a.Rect.inflate(e,{left:i,right:i,top:r,bottom:r});return a.Rect.containsPoint(n,{x:o.left,y:o.top})&&a.Rect.containsPoint(n,{x:o.left+o.width,y:o.top+o.height})}function n(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+i,width:e.width,height:e.height}}function o(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height-i-e.height,width:e.width,height:e.height}}function s(e,t,i){return{left:t.left+t.width-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function l(e,t,i){return{left:t.left+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function u(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top-e.height-i,width:e.width,height:e.height}}function c(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height+i,width:e.width,height:e.height}}function d(e,t,i){return{left:t.left+t.width+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function p(e,t,i){return{left:t.left-e.width-i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function h(e,t,i){return{left:t.left+t.width/2-e.width/2+i,top:t.top+t.height/2-e.height/2,width:e.width,height:e.height}}function g(e,t,i){return{left:t.left+t.width/2-e.width/2,top:t.top+t.height/2-e.height/2+i,width:e.width,height:e.height}}e.getLabelRect=t,e.canFitWithinParent=i,e.isLabelWithinParent=r,e.topInside=n,e.bottomInside=o,e.rightInside=s,e.leftInside=l,e.topOutside=u,e.bottomOutside=c,e.rightOutside=d,e.leftOutside=p,e.middleHorizontal=h,e.middleVertical=g})(o=e.DataLabelRectPositioner||(e.DataLabelRectPositioner={}));var s;!(function(e){function t(t,i,a,r){switch(a){case 1:return e.above(t,i.point,i.radius+r);case 2:return e.below(t,i.point,i.radius+r);case 4:return e.left(t,i.point,i.radius+r);case 8:return e.right(t,i.point,i.radius+r);case 32:return e.belowLeft(t,i.point,i.radius+r);case 16:return e.belowRight(t,i.point,i.radius+r);case 128:return e.aboveLeft(t,i.point,i.radius+r);case 64:return e.aboveRight(t,i.point,i.radius+r);case 256:return e.center(t,i.point)}return null}function i(e,t,i){return{left:t.x-e.width/2,top:t.y-i-e.height,width:e.width,height:e.height}}function a(e,t,i){return{left:t.x-e.width/2,top:t.y+i,width:e.width,height:e.height}}function r(e,t,i){return{left:t.x-i-e.width,top:t.y-e.height/2,width:e.width,height:e.height}}function n(e,t,i){return{left:t.x+i,top:t.y-e.height/2,width:e.width,height:e.height}}function o(t,i,a){return{left:i.x-e.sin45*a-t.width,top:i.y+e.cos45*a,width:t.width,height:t.height}}function s(t,i,a){return{left:i.x+e.sin45*a,top:i.y+e.cos45*a,width:t.width,height:t.height}}function l(t,i,a){return{left:i.x-e.sin45*a-t.width,top:i.y-e.cos45*a-t.height,width:t.width,height:t.height}}function u(t,i,a){return{left:i.x+e.sin45*a,top:i.y-e.cos45*a-t.height,width:t.width,height:t.height}}function c(e,t){return{left:t.x-e.width/2,top:t.y-e.height/2,width:e.width,height:e.height}}function d(e,t,i){var a=e.left,r=e.top;switch(t){case 1:a+=e.width/2,r+=e.height;break;case 2:a+=e.width/2;break;case 4:a+=e.width,r+=2*e.height/3;break;case 8:r+=2*e.height/3;break;case 32:a+=e.width,r+=e.height/2;break;case 16:r+=e.height/2;break;case 128:a+=e.width,r+=e.height;break;case 64:r+=e.height}return[[i.point.x,i.point.y],[a,r]]}e.cos45=Math.cos(45),e.sin45=Math.sin(45),e.getLabelRect=t,e.above=i,e.below=a,e.left=r,e.right=n,e.belowLeft=o,e.belowRight=s,e.aboveLeft=l,e.aboveRight=u,e.center=c,e.getLabelLeaderLineEndingPoint=d})(s=e.DataLabelPointPositioner||(e.DataLabelPointPositioner={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=e.visuals.NewDataLabelUtils,i=e.visuals.labelStyle,r=e.visuals.DonutLabelUtils,n=(function(){function n(i,r){this.startingOffset=i.startingOffset,this.maximumOffset=i.maximumOffset,null!=i.offsetIterationDelta&&(this.offsetIterationDelta=i.offsetIterationDelta),this.donutChartProperties=r,this.center={x:r.viewport.width/2,y:r.viewport.height/2},this.outerRadius=this.donutChartProperties.radius*this.donutChartProperties.outerArcRadiusRatio,this.innerRadius=this.donutChartProperties.radius/2*this.donutChartProperties.innerArcRadiusRatio,this.additionalCharsWidth=e.TextMeasurementService.measureSvgTextWidth({text:" ()",fontFamily:t.LabelTextProperties.fontFamily,fontSize:a.PixelConverter.fromPoint(r.dataLabelsSettings.fontSize),fontWeight:t.LabelTextProperties.fontWeight})}return n.prototype.layout=function(t){for(var i=[],a=0,r=t;a<r.length;a++){var n=r[a];i.push({labelDataPoint:n,hasBeenRendered:!1,labelSize:n.textSize})}for(var o=[],s=[],l=this.donutChartProperties.viewport,u={labelDataPoints:i,maxNumberOfLabels:t.length},c=new e.LabelArrangeGrid([u],l),d=i.length-1;d>=0;d--){var p=i[d].labelDataPoint;if(p.isPreferred){var h=i.splice(d,1);s=h.concat(s)}}if(s.length>0&&(o=this.positionLabels(s,c)),t.length>0){var g=this.positionLabels(i,c);o=o.concat(g)}return _.filter(o,(function(e){return e.isVisible}))},n.prototype.positionLabels=function(e,t){for(var i=[],a=this.offsetIterationDelta,r=this.startingOffset,n=0;r<=this.maximumOffset;){for(var o=0,s=e;o<s.length;o++){var l=s[o];if(!l.hasBeenRendered){var u=this.tryPositionForDonut(l,t,r);u&&i.push(u)}}r+=a,n+=a}return i},n.prototype.tryPositionForDonut=function(e,t,a){var r=e.labelDataPoint,n=r.parentShape;if(!_.isEmpty(n.validPositions)&&0!==n.validPositions[0]){var o=n.validPositions[0],s=this.tryAllPositions(e,t,o,a);if(s&&0===s.score)return this.buildLabel(s,t);if(this.donutChartProperties.dataLabelsSettings.labelStyle===i.both){var l=this.splitDonutDataPoint(e),u=this.tryAllPositions(l,t,o,a);if(u&&(!s||u.score<s.score))return this.buildLabel(u,t)}return s?this.buildLabel(s,t):void 0}},n.prototype.generateCandidate=function(e,t,i,a){var o=e.labelDataPoint,s=this.generateCandidateAngleForPosition(o.donutArcDescriptor,t),l=this.getPointPositionForAngle(s),u=l.point,c=this.score(o,u),d=r.getLabelLeaderLineForDonutChart(o.donutArcDescriptor,this.donutChartProperties,u,s),p=r.getLabelLeaderLinesSizeForDonutChart(d),h=_.clone(o);h.angle=s,h.parentShape=l,h.leaderLinePoints=d,h.linesSize=p;var g=n.tryPositionPoint(i,l.validPositions[0],h,a,this.center,this.donutChartProperties.viewport),f={labelDataPoint:h,hasBeenRendered:e.hasBeenRendered,labelSize:e.labelSize};return{angle:s,point:l,score:c,labelRects:g,donutLabelDataPointLayoutInfo:f}},n.prototype.tryAllPositions=function(e,t,i,a){var r=e.labelDataPoint,o=n.tryPositionPoint(t,i,r,a,this.center,this.donutChartProperties.viewport),s=r.parentShape,l={point:s,angle:r.angle,
score:this.score(r,s.point),labelRects:o,donutLabelDataPointLayoutInfo:e};if(o&&o.textRect&&0===l.score)return l;var u,c=[];o&&o.textRect?(c=this.getLabelPointPositions(r,!0),u=l):c=this.getLabelPointPositions(r,!1);for(var d=0,p=c;d<p.length;d++){var h=p[d],g=this.generateCandidate(e,h,t,a);if(g.labelRects&&g.labelRects.textRect&&(null==u||g.score<u.score)&&(u=g,0===u.score))return u}return u},n.prototype.buildLabel=function(t,a){var n,o=t.labelRects.textRect,s=t.donutLabelDataPointLayoutInfo,l=s.labelDataPoint;null==l.categoryLabel&&null==l.dataLabel||(n=!0),a.add(o),a.add(t.labelRects.horizontalLineRect),a.add(t.labelRects.diagonalLineRect),s.hasBeenRendered=!0;var u=o.left-this.center.x;u<0?u+=o.width/2:u-=o.width/2;var c,d,p,h=8===l.parentShape.validPositions[0]?"start":"end",g={left:u,top:o.top-this.center.y,height:o.height,width:o.width},f=this.donutChartProperties.dataLabelsSettings.labelStyle,m=r.getSpaceAvailableForDonutLabels(l.parentShape.point.x,this.donutChartProperties.viewport),y=e.visuals.dataLabelUtils.getLabelFormattedText,v=l.fontSize,w=f===i.both&&null==l.secondRowText;switch(w&&(l.dataLabel=l.dataLabel?" ("+l.dataLabel+")":null,m/=2),f!==i.both&&f!==i.data||(c=y({label:l.dataLabel,maxWidth:m,fontSize:v})),f!==i.both&&f!==i.category||(d=y({label:l.categoryLabel,maxWidth:m,fontSize:v})),f){case i.both:null==l.secondRowText?p=c?d+c:d:(p=c,l.secondRowText=d);break;case i.data:p=c;break;case i.category:p=d}return l.textSize.width=Math.min(l.textSize.width,w?2*m:m),{boundingBox:g,text:p,tooltip:l.tooltip,isVisible:n,fill:l.outsideFill,identity:l.identity,fontSize:v,selected:!1,textAnchor:h,leaderLinePoints:l.leaderLinePoints,hasBackground:!1,secondRowText:l.secondRowText}},n.tryPositionPoint=function(t,i,a,n,o,s){var l=a.parentShape,u=_.clone(a.textSize);u.width=Math.min(u.width,r.getSpaceAvailableForDonutLabels(l.point.x,s));var c=e.DataLabelPointPositioner.getLabelRect(u,l,i,n),d={point:{x:a.leaderLinePoints[0][0],y:a.leaderLinePoints[0][1]<0?a.leaderLinePoints[1][1]:a.leaderLinePoints[0][1]},radius:0,validPositions:null},p=e.DataLabelPointPositioner.getLabelRect(a.linesSize[r.DiagonalLineIndex],d,i,n),h={point:{x:a.leaderLinePoints[1][0],y:a.leaderLinePoints[1][1]},radius:0,validPositions:null},g=e.DataLabelPointPositioner.getLabelRect(a.linesSize[r.HorizontalLineIndex],h,i,n);if(c&&p&&g){c.left+=o.x,c.top+=o.y;var f=o.x-c.width/2;return p.left+=f,p.top+=o.y,g.left+=f,g.top+=o.y,t.hasConflict(c)||t.hasConflict(p)||t.hasConflict(g)?void 0:{textRect:c,diagonalLineRect:p,horizontalLineRect:g}}},n.prototype.getLabelPointPositions=function(e,t){var i=e.parentShape,a=i.validPositions[0];return t?i.point.y<0?8===a?[64]:[128]:8===a?[16]:[32]:4===a?[128,32]:[16,64]},n.prototype.splitDonutDataPoint=function(e){var t=e.labelDataPoint,i={width:Math.max(t.categoryLabelSize.width,t.dataLabelSize.width),height:2*t.dataLabelSize.height},a=_.clone(t);a.textSize=i,a.secondRowText=t.categoryLabel;var r={labelDataPoint:a,hasBeenRendered:e.hasBeenRendered,labelSize:e.labelSize};return r},n.prototype.generateCandidateAngleForPosition=function(e,t){var i=e.startAngle+(e.endAngle-e.startAngle)/2;switch(t){case 64:case 32:return(e.startAngle+i-Math.PI)/2;case 128:case 16:return(i+e.endAngle-Math.PI)/2}},n.prototype.getPointPositionForAngle=function(e){var t=r.getXPositionForDonutLabel(Math.cos(e)*this.outerRadius),i=Math.sin(e)*this.outerRadius,a=t<0?4:8,n={point:{x:t,y:i},validPositions:[a],radius:0};return n},n.prototype.score=function(e,t){var a,n=r.getSpaceAvailableForDonutLabels(t.x,this.donutChartProperties.viewport);return this.donutChartProperties.dataLabelsSettings.labelStyle===i.both&&null==e.secondRowText?(a=Math.max(e.categoryLabelSize.width,e.dataLabelSize.width+this.additionalCharsWidth),n/=2):a=e.textSize.width,Math.max(a-n,0)},n})();e.DonutLabelLayout=n})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=e.visuals.NewDataLabelUtils,i=5,a=10,r=60,n=5,o=(function(){function o(){}return o.prototype.layout=function(i,a,r,n){var o=_.map(i,(function(e){return{labelDataPoint:e}}));if(n||void 0===this.labels){for(var l={labelDataPoints:o,maxNumberOfLabels:o.length},u=0,c=o;u<c.length;u++){var d=c[u],p=d.labelDataPoint;d.labelSize={width:p.textSize.width+2*t.horizontalLabelBackgroundPadding,height:p.textSize.height+2*t.verticalLabelBackgroundPadding}}for(var h=new e.LabelArrangeGrid([l],a),g=[],f=[],m=0,y=i;m<y.length;m++){var p=y[m],v=p.parentShape.polygon;f.push(v),v.pixelBoundingRect=r.applyToRect(v.absoluteBoundingRect())}for(var w=new s(f,a),b=0,C=i;b<C.length;b++){var p=C[b],S=this.getLabelByPolygonPositions(p,r,h,w);null!=S&&g.push(S)}this.labels=g}else this.updateLabelOffsets(r);return _.filter(this.labels,(function(e){return e.isVisible}))},o.prototype.getLabelPolygon=function(e,t,i,a){var r={width:e.textSize.width,height:e.textSize.height};return this.getLabelBoundingBox(r,t,i,a)},o.prototype.getLabelBoundingBox=function(t,i,a,r){switch(i){case 1:return e.DataLabelPointPositioner.above(t,a,r);case 2:return e.DataLabelPointPositioner.below(t,a,r);case 4:return e.DataLabelPointPositioner.left(t,a,r);case 8:return e.DataLabelPointPositioner.right(t,a,r);case 128:return e.DataLabelPointPositioner.aboveLeft(t,a,r);case 64:return e.DataLabelPointPositioner.aboveRight(t,a,r);case 32:return e.DataLabelPointPositioner.belowLeft(t,a,r);case 16:return e.DataLabelPointPositioner.belowRight(t,a,r);case 256:return e.DataLabelPointPositioner.center(t,a)}return null},o.prototype.getLabelByPolygonPositions=function(e,t,n,o){for(var s=0,l=t.getInverse(),u=0;u<2;u++){1===u&&(s=i);for(var c=0,d=e.parentShape.validPositions;c<d.length;c++){var p=d[c],h=this.tryPositionForPolygonPosition(p,e,t,s,l);if((256!==p||0===u)&&h){var g=t.applyToRect(h),f={text:e.text,secondRowText:e.secondRowText,boundingBox:g,isVisible:!0,fill:e.insideFill,identity:null,selected:!1,hasBackground:!0,textAnchor:"middle",originalPixelOffset:s,isPlacedInsidePolygon:!0,absoluteBoundingBoxCenter:{x:h.left+h.width/2,y:h.top+h.height/2}};return f}}}for(var m=6;m<=r;){for(var y=0,v=e.parentShape.validPositions;y<v.length;y++){var p=v[y];if(256!==p){var w=e.parentShape.polygon,b=t.applyToPoint(w.absoluteCentroid()),C=this.tryPlaceLabelOutsidePolygon(n,p,e,m,b,o,l);if(C){var g=t.applyToRect(C),f={text:e.text,secondRowText:e.secondRowText,boundingBox:g,isVisible:!0,fill:e.insideFill,identity:null,selected:!1,hasBackground:!0,isPlacedInsidePolygon:!1,textAnchor:"middle",originalPixelOffset:m,originalPosition:p,originalAbsoluteCentroid:w.absoluteCentroid(),absoluteBoundingBoxCenter:{x:C.left+C.width/2,y:C.top+C.height/2}},S=this.calculateStemSource(t,l,w,g,p,b);return f.leaderLinePoints=this.setLeaderLinePoints(S,this.calculateStemDestination(g,p)),f.absoluteStemSource=l.applyToPoint(S),n.add(g),f}}}m+=a}return null},o.prototype.setLeaderLinePoints=function(e,t){return[[e.x,e.y],[t.x,t.y]]},o.prototype.calculateStemSource=function(t,i,a,r,o,s){var l=a.lineIntersectionPoint(a.absoluteCentroid(),i.applyToPoint({x:r.left+r.width/2,y:r.top+r.height/2}));if(null==l)return s;var u=t.applyToPoint(l);switch(o){case 1:u.y+=n;break;case 2:u.y-=n;break;case 4:u.x+=n;break;case 8:u.x-=n;break;case 128:u.x+=n/e.DataLabelPointPositioner.cos45,u.y+=n/e.DataLabelPointPositioner.sin45;break;case 64:u.x-=n/e.DataLabelPointPositioner.cos45,u.y+=n/e.DataLabelPointPositioner.sin45;break;case 32:u.x+=n/e.DataLabelPointPositioner.cos45,u.y-=n/e.DataLabelPointPositioner.sin45;break;case 16:u.x-=n/e.DataLabelPointPositioner.cos45,u.y-=n/e.DataLabelPointPositioner.sin45;break;case 256:}return u},o.prototype.calculateStemDestination=function(e,t){var i,a;switch(t){case 1:i=e.left+e.width/2,a=e.top+e.height;break;case 2:i=e.left+e.width/2,a=e.top;break;case 4:i=e.left+e.width,a=e.top+e.height/2;break;case 8:i=e.left,a=e.top+e.height/2;break;case 128:i=e.left+e.width,a=e.top+e.height;break;case 64:i=e.left,a=e.top+e.height;break;case 32:i=e.left+e.width,a=e.top;break;case 16:i=e.left,a=e.top;break;case 256:}return{x:i,y:a}},o.prototype.tryPositionForPolygonPosition=function(e,t,i,a,r){var n=t.parentShape.polygon,o=i.applyToPoint(n.absoluteCentroid()),s=this.getLabelPolygon(t,e,o,a),l=this.getAbsoluteRectangle(r,s);return n.contains(l)?l:null},o.prototype.tryPlaceLabelOutsidePolygon=function(e,t,i,a,r,n,o){var s=a,l=this.getLabelPolygon(i,t,r,s),u=e.hasConflict(l);if(!u){var c=this.getAbsoluteRectangle(o,l);if(!n.hasConflict(c,l))return c}return null},o.prototype.updateLabelOffsets=function(e){for(var t=0,i=this.labels;t<i.length;t++){var a=i[t];if(a.isVisible)if(a.isPlacedInsidePolygon){var r=e.applyToPoint(a.absoluteBoundingBoxCenter),n=a.boundingBox.left+a.boundingBox.width/2-r.x,o=a.boundingBox.top+a.boundingBox.height/2-r.y;a.boundingBox.top-=o,a.boundingBox.left-=n}else{var s=e.applyToPoint(a.absoluteStemSource),l=e.applyToPoint(a.originalAbsoluteCentroid);a.boundingBox=this.getLabelBoundingBox({width:a.boundingBox.width,height:a.boundingBox.height},a.originalPosition,l,a.originalPixelOffset),void 0!==a.leaderLinePoints&&(a.leaderLinePoints=this.setLeaderLinePoints(s,this.calculateStemDestination(a.boundingBox,a.originalPosition)))}}},o.prototype.getAbsoluteRectangle=function(e,t){return e.applyToRect(t)},o})();e.FilledMapLabelLayout=o;var s=(function(){function e(t,i){this.viewport=i;for(var a=0,r=0,n=0,o=t;n<o.length;n++){var s=o[n],l=s.pixelBoundingRect;l.width>a&&(a=l.width),l.height>r&&(r=l.height)}0===a&&(a=i.width),0===r&&(r=i.height);var u=this.cellSize={width:a*e.cellSizeMultiplier,height:r*e.cellSizeMultiplier};this.columnCount=e.getCellCount(u.width,i.width,1,100),this.rowCount=e.getCellCount(u.height,i.height,1,100);for(var c=[],d=0,p=this.columnCount;d<p;d++){c[d]=[];for(var h=0,g=this.rowCount;h<g;h++)c[d][h]=[]}this.grid=c;for(var f=0,m=t;f<m.length;f++){var s=m[f];this.add(s)}}return e.prototype.hasConflict=function(e,t){for(var i=this.getContainingGridSubsection(t),a=this.grid,r=i.xMin;r<i.xMax;r++)for(var n=i.yMin;n<i.yMax;n++)for(var o=0,s=a[r][n];o<s.length;o++){var l=s[o];if(l.conflicts(e))return!0}return!1},e.prototype.add=function(e){for(var t=this.getContainingGridSubsection(e.pixelBoundingRect),i=t.xMin;i<t.xMax;i++)for(var a=t.yMin;a<t.yMax;a++)this.grid[i][a].push(e)},e.prototype.getContainingGridSubsection=function(t){return{xMin:e.bound(Math.floor(t.left/this.cellSize.width),0,this.columnCount),xMax:e.bound(Math.ceil((t.left+t.width)/this.cellSize.width),0,this.columnCount),yMin:e.bound(Math.floor(t.top/this.cellSize.height),0,this.rowCount),yMax:e.bound(Math.ceil((t.top+t.height)/this.cellSize.height),0,this.rowCount)}},e.getCellCount=function(t,i,a,r){return e.bound(Math.ceil(i/t),a,r)},e.bound=function(e,t,i){return Math.max(Math.min(e,i),t)},e.cellSizeMultiplier=2,e})();e.LabelPolygonArrangeGrid=s})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.data.DataViewTransform,a={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},r={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",Restatement_Comma:"{0}, {1}",Restatement_CompoundAnd:"{0} and {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",RichTextbox_Link_DefaultText:"Link",TableTotalLabel:"Total",ListJoin_Separator:", ",Tooltip_HighlightedValueDisplayName:"Highlighted",Funnel_PercentOfFirst:"Percent of first",Funnel_PercentOfPrevious:"Percent of previous",Funnel_PercentOfFirst_Highlight:"Percent of first (highlighted)",Funnel_PercentOfPrevious_Highlight:"Percent of previous (highlighted)",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Longitude_Short2:"long",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",Waterfall_IncreaseLabel:"Increase",Waterfall_DecreaseLabel:"Decrease",Waterfall_TotalLabel:"Total",Slicer_SelectAll:"Select All",Visual_Quarter_Abbreviated:"Qtr {0}"},n=(function(){function n(){}return n.initialize=function(){t.valueFormatter.setLocaleOptions(n.createLocaleOptions()),t.TooltipManager.setLocalizedStrings(n.createTooltipLocaleOptions()),i.setLocalizationOptions(n.createDataViewTransformLocalizationOptions())},n.createLocaleOptions=function(){return{null:r.NullValue,true:r.BooleanTrue,false:r.BooleanFalse,NaN:r.NaNValue,infinity:r.InfinityValue,negativeInfinity:r.NegativeInfinityValue,beautify:function(e){return n.beautify(e)},describe:function(e){return n.describeUnit(e)},restatementComma:r.Restatement_Comma,restatementCompoundAnd:r.Restatement_CompoundAnd,restatementCompoundOr:r.Restatement_CompoundOr}},n.createTooltipLocaleOptions=function(){return{highlightedValueDisplayName:r.Tooltip_HighlightedValueDisplayName}},n.createDataViewTransformLocalizationOptions=function(){return{quarterPrefix:r.Visual_Quarter_Abbreviated}},n.prototype.getLocalizedString=function(e){return r[e]},n.prototype.onDragStart=function(){},n.prototype.canSelect=function(){return!1},n.prototype.onSelecting=function(e){e.action=0},n.prototype.onSelect=function(){},n.prototype.onContextMenu=function(){},n.prototype.loadMoreData=function(){},n.prototype.persistProperties=function(e){},n.prototype.onCustomSort=function(e){},n.prototype.getViewMode=function(){return 0},n.prototype.setWarnings=function(e){},n.prototype.setToolbar=function(e){},n.prototype.shouldRetainSelection=function(){return!1},n.prototype.geocoder=function(){return t.services.createGeocoder()},n.prototype.geolocation=function(){return t.services.createGeolocation()},n.prototype.promiseFactory=function(){return e.createJQueryPromiseFactory()},n.prototype.visualCapabilitiesChanged=function(){},n.prototype.analyzeFilter=function(e){return{isNotFilter:!1,selectedIdentities:[],filter:void 0,defaultValue:void 0}},n.prototype.getIdentityDisplayNames=function(e){},n.prototype.setIdentityDisplayNames=function(e){},n.prototype.tooltips=function(){},n.prototype.locale=function(){return navigator.language},n.beautify=function(e){var t=a[e];return t?r[t]||e:e},n.describeUnit=function(e){var t=e===-1?"Auto":e.toString(),i=r["DisplayUnitSystem_E"+t+"_Title"],a=e<=0?"{0}":r["DisplayUnitSystem_E"+t+"_LabelFormat"];if(i||a)return{title:i,format:a}},n})();t.DefaultVisualHostServices=n,t.defaultVisualHostServices=new n})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){return new u(e)}function r(e){return e.append("rect").classed("clearCatcher",!0).attr({width:"100%",height:"100%"})}function n(t,i,a){return null!=i.objects&&i.objects[a]&&e.DataViewObjects.getValue(i.objects[a],t)}function o(e){for(var t=0,i=e.length;t<i;t++)if(e[t].selected)return!0;return!1}var s=a.ArrayExtensions,l=e.data.SemanticFilter;t.createInteractivityService=i,t.appendClearCatcher=r,t.isCategoryColumnSelected=n,t.dataHasSelection=o;var u=(function(){function t(e){this.renderSelectionInVisual=_.noop,this.renderSelectionInLegend=_.noop,this.renderSelectionInLabels=_.noop,this.selectedIds=[],this.isInvertedSelectionMode=!1,this.dataPointObjectName="dataPoint",this.hostService=e}return t.prototype.bind=function(e,t,i,a){var r=this;a&&a.overrideSelectionFromData&&this.takeSelectionStateFromDataPoints(e),a?(a.isLegend?(this.selectableLegendDataPoints=e,this.renderSelectionInLegend=function(){return t.renderSelection(r.legendHasSelection())}):a.isLabels?(this.selectableLabelsDataPoints=e,this.renderSelectionInLabels=function(){return t.renderSelection(r.labelsHasSelection())}):(this.selectableDataPoints=e,this.renderSelectionInVisual=function(){return t.renderSelection(r.hasSelection())}),null!=a.hasSelectionOverride&&(this.hasSelectionOverride=a.hasSelectionOverride),a.slicerValueHandler&&(this.slicerValueHandler=a.slicerValueHandler)):(this.selectableDataPoints=e,this.renderSelectionInVisual=function(){return t.renderSelection(r.hasSelection())}),this.behavior=t,t.bindEvents(i,this),this.syncSelectionState()},t.prototype.clearSelection=function(){return this.slicerValueHandler&&this.slicerValueHandler.getDefaultValue()&&this.useDefaultValue?void(this.isInvertedSelectionMode=!1):(this.hasSelectionOverride=void 0,s.clear(this.selectedIds),this.isInvertedSelectionMode=!1,this.applyToAllSelectableDataPoints((function(e){return e.selected=!1})),void this.renderAll())},t.prototype.applySelectionStateToData=function(e){for(var i=0,a=e;i<a.length;i++){var r=a[i];r.selected=t.checkDatapointAgainstSelectedIds(r,this.selectedIds)}return this.hasSelection()},t.prototype.hasSelection=function(){return this.selectedIds.length>0},t.prototype.legendHasSelection=function(){return!!this.selectableLegendDataPoints&&o(this.selectableLegendDataPoints)},t.prototype.labelsHasSelection=function(){return!!this.selectableLabelsDataPoints&&o(this.selectableLabelsDataPoints)},t.prototype.isSelectionModeInverted=function(){return this.isInvertedSelectionMode},t.prototype.setSelectionModeInverted=function(e){this.isInvertedSelectionMode=e},t.prototype.handleSelection=function(e,t){if(e){var i;e.specificIdentity?i=e.specificIdentity.getSelectorsByColumn():e.identity&&(i=e.identity.getSelectorsByColumn());var a={visualObjects:[{objectName:this.dataPointObjectName,selectorsByColumn:i}]};_.isEmpty(i)||this.hostService.onSelecting(a),0!==a.action&&null!=a.action||(e.identity?(this.useDefaultValue=!1,this.select(e,t),this.sendSelectionToHost(),this.renderAll()):this.handleClearSelection())}},t.prototype.handleMultipleSelection=function(e,t){this.useDefaultValue=!1,this.selectMultiple(e,t),this.sendSelectionToHost(),this.renderAll()},t.prototype.handleContextMenu=function(e,t){this.sendContextMenuToHost(e,t)},t.prototype.handleClearSelection=function(){this.useDefaultValue=!0,this.clearSelection(),this.sendSelectionToHost()},t.prototype.toggleSelectionModeInversion=function(){return this.useDefaultValue=!1,this.isInvertedSelectionMode=!this.isInvertedSelectionMode,s.clear(this.selectedIds),this.applyToAllSelectableDataPoints((function(e){return e.selected=!1})),this.sendSelectionToHost(),this.isInvertedSelectionMode?this.syncSelectionStateInverted():this.syncSelectionState(),this.renderAll(),this.isInvertedSelectionMode},t.prototype.persistSelectionFilter=function(e){this.hostService.persistProperties(t.createChangeForFilterProperty(e,this.getFilterFromSelectors()))},t.prototype.persistSelfFilter=function(e,i){this.hostService.persistProperties(t.createChangeForFilterProperty(e,i))},t.prototype.setDefaultValueMode=function(e){this.useDefaultValue=e},t.prototype.isDefaultValueEnabled=function(){return this.useDefaultValue},t.prototype.renderAll=function(){this.renderSelectionInVisual(),this.renderSelectionInLegend(),this.renderSelectionInLabels()},t.prototype.selectMultiple=function(e,t){0!==t&&2!==t||(this.selectedIds=[]);for(var i=0,a=e;i<a.length;i++){var r=a[i],n=r.identity;n.highlight||(1===t||0===t?(r.selected=!0,this.selectedIds.push(n)):3===t?(r.selected=!1,this.removeId(n)):2===t&&r.selected&&this.selectedIds.push(n))}if(2===t)for(var o=0,s=this.selectableDataPoints;o<s.length;o++){var r=s[o];_.contains(this.selectedIds,r.identity)||(r.selected=!1)}this.syncSelectionState()},t.prototype.select=function(e,t){if(this.isInvertedSelectionMode)return this.selectInverted(e,t);e.identity&&e.identity.highlight&&(e=_.find(this.selectableDataPoints,(function(t){return!t.identity.highlight&&e.identity.includes(t.identity,!0)})));var i=e.identity;if(i){var a=!e.selected||!t&&this.selectedIds.length>1;t&&(a?(e.selected=!0,this.selectedIds.push(i),i.hasIdentity()?this.removeSelectionIdsWithOnlyMeasures():this.removeSelectionIdsExceptOnlyMeasures()):(e.selected=!1,this.removeId(i))),t&&this.hostService.canSelect(this.createSelectEventArgs(this.selectedIds))||(this.clearSelection(),a&&(e.selected=!0,this.selectedIds.push(i))),this.syncSelectionState()}},t.prototype.selectInverted=function(e,t){var i=e.selected,a=e.identity;e.selected=!i,i?this.removeId(a):(this.selectedIds.push(a),a.hasIdentity()?this.removeSelectionIdsWithOnlyMeasures():this.removeSelectionIdsExceptOnlyMeasures()),this.syncSelectionStateInverted()},t.prototype.removeId=function(e){for(var t=this.selectedIds,i=t.length-1;i>-1;i--){var a=t[i];e.includes(a)&&t.splice(i,1)}},t.prototype.getFilterFromSelectors=function(){var t=[];this.selectedIds.length>0&&(t=_.chain(this.selectedIds).filter((function(e){return e.hasIdentity()})).map((function(e){return e.getSelector()})).value());var i=e.data.Selector.filterFromSelector(t,this.isInvertedSelectionMode);return this.slicerValueHandler&&this.slicerValueHandler.getDefaultValue()&&(this.useDefaultValue===!0?i=l.getDefaultValueFilter(this.slicerValueHandler.getIdentityFields()):_.isEmpty(t)&&(i=l.getAnyValueFilter(this.slicerValueHandler.getIdentityFields()))),i},t.createChangeForFilterProperty=function(e,t){var i={},a={objectName:e.objectName,selector:void 0,properties:i};return null==t?(i[e.propertyName]={},{remove:[a]}):(i[e.propertyName]=t,{merge:[a]})},t.prototype.sendContextMenuToHost=function(e,t){var i=this.hostService;if(i.onContextMenu){var a=[];_.isEmpty(this.selectedIds)?e.specificIdentity?a=[e.specificIdentity]:e.identity&&(a=[e.identity]):a=this.selectedIds;for(var r=[],n=0,o=a;n<o.length;n++){var s=o[n],l=s.getSelectorsByColumn();_.isEmpty(l)||r.push(l)}if(!_.isEmpty(r)){var u={data:r,position:t};i.onContextMenu(u)}}},t.prototype.sendSelectionToHost=function(){var e=this.hostService;if(e.onSelect){var t=this.createSelectEventArgs(this.selectedIds);e.onSelect(t)}},t.prototype.createSelectEventArgs=function(e){var t=!1,i=this.dataPointObjectName;_.isEmpty(e)||(t=e[0].getSelector()&&!e[0].getSelectorsByColumn());var a=_.chain(e).filter((function(e){return e.hasIdentity()})),r={visualObjects:a.map((function(e){return{objectName:i,selectorsByColumn:e.getSelectorsByColumn()}})).value()};return t&&(r.selectors=a.map((function(e){return e.getSelector()})).value()),r},t.prototype.takeSelectionStateFromDataPoints=function(e){var t=this.selectedIds;s.clear(t);for(var i=0,a=e;i<a.length;i++){var r=a[i];r.selected&&t.push(r.identity)}},t.prototype.syncSelectionState=function(){if(this.isInvertedSelectionMode)return this.syncSelectionStateInverted();var e=this.selectedIds,i=this.selectableDataPoints,a=this.selectableLegendDataPoints,r=this.selectableLabelsDataPoints,n=!1;if(i||a){if(i&&t.updateSelectableDataPointsBySelectedIds(i,e)&&(n=!0),a&&t.updateSelectableDataPointsBySelectedIds(a,e)&&(n=!0),r)for(var o,s=0,l=r.length;s<l;s++)o=r[s],e.some((function(e){return e.includes(o.identity)}))?o.selected=!0:o.selected=!1;!n&&e.length>0&&(this.clearSelection(),this.sendSelectionToHost())}},t.prototype.syncSelectionStateInverted=function(){var e=this.selectedIds,t=this.selectableDataPoints;if(t)if(0===e.length)for(var i=0,a=t;i<a.length;i++){var r=a[i];r.selected=!1}else for(var n=0,o=t;n<o.length;n++){var s=o[n];e.some((function(e){return e.includes(s.identity)}))?s.selected=!0:s.selected&&(s.selected=!1)}},t.prototype.applyToAllSelectableDataPoints=function(e){var t=this.selectableDataPoints,i=this.selectableLegendDataPoints,a=this.selectableLabelsDataPoints;if(t)for(var r=0,n=t;r<n.length;r++){var o=n[r];e(o)}if(i)for(var s=0,l=i;s<l.length;s++){var o=l[s];e(o)}if(a)for(var u=0,c=a;u<c.length;u++){var o=c[u];e(o)}},t.updateSelectableDataPointsBySelectedIds=function(e,i){for(var a=!1,r=0,n=e;r<n.length;r++){var o=n[r];o.selected=t.checkDatapointAgainstSelectedIds(o,i),o.selected&&(a=!0)}return a},t.checkDatapointAgainstSelectedIds=function(e,t){return t.some((function(t){return t.includes(e.identity)}))},t.prototype.removeSelectionIdsWithOnlyMeasures=function(){this.selectedIds=_.filter(this.selectedIds,(function(e){return e.hasIdentity()}))},t.prototype.removeSelectionIdsExceptOnlyMeasures=function(){this.selectedIds=_.filter(this.selectedIds,(function(e){return!e.hasIdentity()}))},t})();t.InteractivityService=u})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function i(){return new f}function n(e){return t.CategoryTypeArray.indexOf(e)>-1}function o(e){switch(e.toLowerCase()){case"fr":return"fr-FR";case"de":return"de-DE";default:return e}}function s(e){for(void 0===e&&(e=0),y-=e;y<h.MaxBingRequest&&0!==m.length;)y++,l(m.shift())}function l(e){if(!e.isResolved){var i=b?b.getCoordinates(e.query.key):void 0;i&&(e.deferred.resolve(i),e.isResolved=!0)}if(e.isResolved)return void setTimeout((function(){return s(1)}));var a={type:"GET",dataType:"jsonp",jsonp:"jsonp"},r=e.query.getUrl();r||u(e,new Error("Unsupported query. "+e.query.query)),t.BingAjaxCall(r,a).then((function(t){try{if(e.query instanceof x){var i=t;if(i&&i.d&&Array.isArray(i.d.results)&&i.d.results.length>0){var a=i.d.results[0],r=a.Primitives;if(r&&r.length>0){var n={latitude:e.query.latitude,longitude:e.query.longitude,locations:[]};r.sort((function(e,t){return e.Shape.length<t.Shape.length?1:e.Shape.length>t.Shape.length?-1:0}));for(var o=Math.min(r.length,e.query.maxGeoData),s=0;s<o;s++)for(var l=r[s].Shape,d=l.split(","),p=1;p<d.length;p++)n.locations.push({nativeBing:d[p]});u(e,null,n)}else u(e,new Error("Geocode result is empty."))}else u(e,new Error("Geocode result is empty."))}else if(e.query instanceof S){var h=t.resourceSets[0].resources;if(Array.isArray(h)&&h.length>0){var g=c(h,e.query),f=h[g].point.coordinates,m=h[g].address,y=h[g].name,n={latitude:parseFloat(f[0]),longitude:parseFloat(f[1]),addressLine:m.addressLine,locality:m.locality,neighborhood:m.neighborhood,adminDistrict:m.adminDistrict,adminDistrict2:m.adminDistrict2,formattedAddress:m.formattedAddress,postalCode:m.postalCode,countryRegionIso2:m.countryRegionIso2,countryRegion:m.countryRegion,landmark:m.landmark,name:y};u(e,null,n)}else u(e,null,null)}else{var h=t.resourceSets[0].resources;if(Array.isArray(h)&&h.length>0){var g=c(h,e.query),f=h[g].point.coordinates,n={latitude:parseFloat(f[0]),longitude:parseFloat(f[1])};u(e,null,n)}else u(e,new Error("Geocode result is empty."))}}catch(t){u(e,t)}}),(function(t){u(e,t)}))}function u(e,t,i){void 0===i&&(i=null),e.isResolved||(t?e.deferred.reject(t):(!b||e.query instanceof S||b.registerCoordinates(e.query.key,i),e.deferred.resolve(i)),e.isResolved=!0),P=setTimeout((function(){return s(1)}),h.UseDoubleArrayGeodataResult?h.UseDoubleArrayDequeueTimeout:0)}function c(e,t){var i=t.query.toLowerCase();if(2===i.length&&t.category===p.CountryRegion)for(var a=0;a<e.length;a++){var r=e[a].address&&e[a].address.countryRegionIso2;if(r&&i===r.toLowerCase())return a}for(var n=t.getBingEntity().toLowerCase(),a=0;a<e.length;a++){var o=(e[a].entityType||"").toLowerCase();if(o===n)return a}return 0}function d(e){void 0!==e&&(b=e),m=[],y=0,v=null,clearTimeout(P)}var p=e.MapUtil.CategoryTypes,h=e.MapUtil.Settings;t.createGeocoder=i;var g=(function(){function e(){}return e.prototype.geocode=function(e,t,i){return void 0===t&&(t=""),this.geocodeCore(new C(this.bingGeocodingUrl(),this.bingSpatialDataUrl(),e,t),i)},e.prototype.geocodeBoundary=function(e,t,i,a,r,n){return void 0===i&&(i=""),void 0===a&&(a=2),void 0===r&&(r=3),this.geocodeCore(new x(this.bingGeocodingUrl(),this.bingSpatialDataUrl(),e,t,i,a,r),n)},e.prototype.geocodePoint=function(e,t,i,a){return this.geocodeCore(new S(this.bingGeocodingUrl(),this.bingSpatialDataUrl(),e,t,i),a)},e.prototype.tryGeocodeImmediate=function(e,t){var i=b?b.getCoordinates(new C(this.bingGeocodingUrl(),this.bingSpatialDataUrl(),e,t).key):void 0;return i},e.prototype.tryGeocodeBoundaryImmediate=function(e,t,i,a,r){void 0===r&&(r=3);var n=b?b.getCoordinates(new x(this.bingGeocodingUrl(),this.bingSpatialDataUrl(),e,t,i,a,r).key):void 0;return n},e.prototype.geocodeCore=function(e,t){var i=b?b.getCoordinates(e.key):void 0,a=$.Deferred();if(i)a.resolve(i);else{var r={query:e,deferred:a,isResolved:!1};t&&t.timeout&&t.timeout.finally((function(){r.isResolved||(r.deferred.reject(),r.isResolved=!0)})),m.push(r),s()}return a},e})();t.BingMapsGeocoder=g;var f=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.bingSpatialDataUrl=function(){return"https://platform.bing.com/geo/spatial/v1/public/Geodata"},t.prototype.bingGeocodingUrl=function(){return"https://dev.virtualearth.net/REST/v1/Locations"},t})(g);t.DefaultGeocoder=f,t.safeCharacters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-",t.BingAjaxCall=$.ajax,t.CategoryTypeArray=["Address","City","Continent","Country","County","Longitude","Latitude","Place","PostalCode","StateOrProvince"],t.isCategoryType=n,t.BingEntities={Continent:"Continent",Sovereign:"Sovereign",CountryRegion:"CountryRegion",AdminDivision1:"AdminDivision1",AdminDivision2:"AdminDivision2",PopulatedPlace:"PopulatedPlace",Postcode:"Postcode",Postcode1:"Postcode1",Neighborhood:"Neighborhood",Address:"Address"};var m,y,v,w,b,C=(function(){function e(e,i,a,r){this.bingGeocodingUrl=e,this.bingSpatialDataUrl=i,this.query=null!=a?a:"",this.category=null!=r?r:"",this.key=("G:"+this.bingGeocodingUrl+"; S:"+this.bingSpatialDataUrl+";"+this.query+"/"+this.category).toLowerCase(),b||(b=t.createGeocodingCache(h.MaxCacheSize,h.MaxCacheSizeOverflow))}return e.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return v||(v={},v[p.Continent.toLowerCase()]=t.BingEntities.Continent,v[p.CountryRegion.toLowerCase()]=t.BingEntities.Sovereign,v[p.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,v[p.County.toLowerCase()]=t.BingEntities.AdminDivision2,v[p.City.toLowerCase()]=t.BingEntities.PopulatedPlace,v[p.PostalCode.toLowerCase()]=t.BingEntities.Postcode,v[p.Address.toLowerCase()]=t.BingEntities.Address),v[e]||""},e.prototype.getUrl=function(){var e={key:h.BingKey},i=this.getBingEntity(),r=!1;if(i)if(i===t.BingEntities.Postcode)e.includeEntityTypes="Postcode,Postcode1,Postcode2,Postcode3,Postcode4";else if(this.query.indexOf(",")!==-1||i!==t.BingEntities.AdminDivision1&&i!==t.BingEntities.AdminDivision2)e.includeEntityTypes=i;else{r=!0;try{e.adminDistrict=decodeURIComponent(this.query)}catch(e){return null}}if(!r)try{
e.q=decodeURIComponent(this.query)}catch(e){return null}var n=navigator.userLanguage||navigator.language;return n=o(n),n&&(e.c=n),e.maxRes="20",2===this.query.length&&this.category===p.CountryRegion&&(e.include="ciso2"),a.UrlUtils.setQueryParameters(this.bingGeocodingUrl,e,!0)},e})();t.GeocodeQuery=C;var S=(function(e){function t(t,i,a,r,n){e.call(this,t,i,[a,r].join(),"Point"),this.latitude=a,this.longitude=r,this.entities=n}return r(t,e),t.prototype.getUrl=function(){var e=a.UrlUtils.splitUrlAndQuery(this.bingGeocodingUrl),t=_.endsWith(e.baseUrl,"/")?e.baseUrl:e.baseUrl+"/";t+=[this.latitude,this.longitude].join();var i={key:h.BingKey,include:"ciso2"};return _.isEmpty(this.entities)||(i.includeEntityTypes=this.entities.join()),a.UrlUtils.setQueryParameters(t,i,!0)},t})(C);t.GeocodePointQuery=S;var x=(function(e){function i(t,i,a,r,n,o,s){void 0===s&&(s=3),e.call(this,t,i,[a,r,o,s].join(","),n),this.latitude=a,this.longitude=r,this.levelOfDetail=o,this.maxGeoData=s}return r(i,e),i.prototype.getBingEntity=function(){var e=this.category.toLowerCase();return w||(w={},w[p.CountryRegion.toLowerCase()]=t.BingEntities.CountryRegion,w[p.StateOrProvince.toLowerCase()]=t.BingEntities.AdminDivision1,w[p.County.toLowerCase()]=t.BingEntities.AdminDivision2,w[p.City.toLowerCase()]=t.BingEntities.PopulatedPlace,w[p.PostalCode.toLowerCase()]=t.BingEntities.Postcode1),w[e]||""},i.prototype.getUrl=function(){var e={key:h.BingKey,$format:"json"},t=this.getBingEntity();if(!t)return null;var i=navigator.userLanguage||navigator.language;i=o(i);var r=i.split("-"),n=[this.latitude,this.longitude,this.levelOfDetail,"'"+t+"'",1,0,"'"+i+"'"];return r.length>1&&n.push("'"+r[1]+"'"),e.SpatialFilter="GetBoundary("+n.join(", ")+")",a.UrlUtils.setQueryParameters(this.bingSpatialDataUrl,e,!0)},i})(C);t.GeocodeBoundaryQuery=x;var P;t.resetStaticGeocoderState=d,d()})(t=e.services||(e.services={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(t,i,r){return r||(r=e.localStorageService),new a(t,i,r)}t.createGeocodingCache=i;var a=(function(){function e(e,t,i){this.geocodeCache={},this.geocodeCacheCount=0,this.maxCacheSize=e,this.maxCacheSizeOverflow=t,this.localStorageService=i}return e.prototype.getCoordinates=function(e){var t=this.geocodeCache[e];return t?(++t.hitCount,t.coordinate):(t=this.localStorageService.getData(e),t?(this.registerInMemory(e,t.coordinate),t.coordinate):void 0)},e.prototype.registerCoordinates=function(e,t){this.registerInMemory(e,t),this.registerInStorage(e,t)},e.prototype.registerInMemory=function(e,t){var i=this.geocodeCache,a=this.maxCacheSize,r=a+this.maxCacheSizeOverflow;if(this.geocodeCacheCount>=r){var n=Object.keys(i),o=n.length;if(n.sort((function(e,t){var a=i[e],r=i[t],n=a?a.hitCount:0,o=r?r.hitCount:0;return n<o?1:n>o?-1:0})),o<2*r)for(var s=a;s<o;s++)i[n[s]]=void 0;else{for(var l={},s=0;s<a;++s)l[n[s]]=i[n[s]];i=this.geocodeCache=l}this.geocodeCacheCount=a}i[e]={coordinate:t,hitCount:1},++this.geocodeCacheCount},e.prototype.registerInStorage=function(e,t){this.localStorageService.setData(e,{coordinate:t})},e})()})(i=t.services||(t.services={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(){return new i}e.createGeolocation=t;var i=(function(){function e(){this.webGeolocation=navigator.geolocation}return e.prototype.watchPosition=function(e,t){return this.webGeolocation.watchPosition((function(t){e(t)}),(function(e){null!=t&&t(e)}))},e.prototype.clearWatch=function(e){this.webGeolocation.clearWatch(e)},e.prototype.getCurrentPosition=function(e,t){this.webGeolocation.getCurrentPosition((function(t){e(t)}),(function(e){null!=t&&t(e)}))},e})()})(t=e.services||(e.services={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){if(e)for(var i=0;i<e.length;i++){var a=e[i];a(t)}}var i="unselectable";e.fire=t;var r=(function(){function t(e,t){this._owner=e,this._direction=t,this._timerHandle=void 0,this.createView();var a=this;this._element.addEventListener("mousedown",(function(e){a.onMouseDown(e)})),$(this._element).addClass(i),$(this._svg).addClass(i),$(this._polygon).addClass(i)}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),t.prototype.createView=function(){var e="http://www.w3.org/2000/svg";this._polygon=document.createElementNS(e,"polygon"),this._polygon.setAttributeNS(null,"points","3,3 6,3 13,8 6,13 3,13 10,8"),this._polygon.setAttributeNS(null,"fill",t.ARROW_COLOR),this._svg=document.createElementNS(e,"svg");var i=this._svg.style;i.position="absolute",i.left="0px",i.top="0px",this._svg.appendChild(this._polygon),this._element=document.createElement("div"),this._element.className=n.arrowClassName,this._element.appendChild(this._svg),this._owner.element.appendChild(this._element)},t.prototype.onMouseDown=function(e){var t=this;if(clearTimeout(this._timerHandle),!this._mouseUpWrapper){e.cancelBubble=!0;var i=this;this._mouseUpWrapper=function(e){i.onMouseUp(e)},n.addDocumentMouseUpEvent(this._mouseUpWrapper)}this._owner._scrollSmallIncrement(this._direction),this._owner.refresh(),this._timerHandle=setTimeout((function(){t.onMouseDown(e)}),100),e.preventDefault&&e.preventDefault()},t.prototype.onMouseUp=function(e){clearTimeout(this._timerHandle),n.removeDocumentMouseUpEvent(this._mouseUpWrapper),this._mouseUpWrapper=void 0},t.prototype.arrange=function(t,i,a){var r=Math.min(t,i),n=r/16,o=(t-r)/2,s=(i-r)/2;this._polygon.setAttributeNS(null,"transform","translate("+o+", "+s+") scale("+n+") rotate("+a+",8,8)"),this._svg.setAttributeNS(null,"width",t+"px"),this._svg.setAttributeNS(null,"height",i+"px"),e.HTMLElementUtils.setElementWidth(this._element,t),e.HTMLElementUtils.setElementHeight(this._element,i)},t.MIN_WIDTH=26,t.ARROW_COLOR="#404040",t})();e.ScrollbarButton=r;var n=(function(){function a(e,t){this.MIN_BAR_SIZE=10,this.min=0,this.max=10,this.viewMin=0,this.viewSize=2,this.smallIncrement=1,this._onscroll=[],this._screenToOffsetScale=1,this.createView(e,t);var a=this;this._element.addEventListener("mousedown",(function(e){a.onBackgroundMouseDown(e)})),this._middleBar.addEventListener("mousedown",(function(e){a.onMiddleBarMouseDown(e)})),this._timerHandle=void 0,this._visible=!0,this.element.winControl=this,$(this._touchPanel).addClass(i)}return a.prototype.scrollBy=function(e){this.scrollTo(this.viewMin+e)},a.prototype.scrollUp=function(){this.scrollBy(-this.smallIncrement)},a.prototype.scrollDown=function(){this.scrollBy(this.smallIncrement)},a.prototype.scrollPageUp=function(){this.scrollBy(-this.viewSize)},a.prototype.scrollPageDown=function(){this.scrollBy(this.viewSize)},Object.defineProperty(a.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._element.style.width=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._element.style.height=e,this.invalidateArrange()},enumerable:!0,configurable:!0}),a.prototype.refresh=function(){},Object.defineProperty(a.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxButton",{get:function(){return this._maxButton},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"middleBar",{get:function(){return this._middleBar},enumerable:!0,configurable:!0}),a.prototype._scrollSmallIncrement=function(e){this.scrollBy(this.smallIncrement*e)},Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInMouseCapture",{get:function(){return void 0!==this._timerHandle},enumerable:!0,configurable:!0}),a.prototype.show=function(e){this._visible=e,this.element.style.visibility=e?"visible":"hidden",this.invalidateArrange()},a.prototype._getMouseOffset=function(e){return void 0!==e.offsetX?{x:e.offsetX,y:e.offsetY}:void 0!==e.layerX?{x:e.layerX,y:e.layerY}:{x:e.screenX,y:e.screenY}},a.prototype._getOffsetXDelta=function(e){return(e.screenX-this._screenPrevMousePos.x)/this._screenToOffsetScale},a.prototype._getOffsetYDelta=function(e){return(e.screenY-this._screenPrevMousePos.y)/this._screenToOffsetScale},a.prototype._getOffsetXTouchDelta=function(e){return this._getMouseOffset(e).x-this._offsetTouchPrevPos.x},a.prototype._getOffsetYTouchDelta=function(e){return this._getMouseOffset(e).y-this._offsetTouchPrevPos.y},a.prototype.initTouch=function(e,t){var i=this;this._touchPanel=e,this._allowMouseDrag=void 0===t||t,"ontouchmove"in e?(e.addEventListener("touchstart",(function(e){return i.onTouchStart(e)})),e.addEventListener("touchmove",(function(e){return i.onTouchMove(e)})),e.addEventListener("touchend",(function(e){return i.onTouchEnd(e)}))):(e.addEventListener("mousedown",(function(e){return i.onTouchMouseDown(e)})),e.addEventListener("mousemove",(function(e){return i.onTouchMouseMove(e)})),e.addEventListener("mouseup",(function(e){return i.onTouchMouseUp(e)})))},a.prototype.onTouchStart=function(e){1===e.touches.length&&this.onTouchMouseDown(e.touches[0])},a.prototype.onTouchMove=function(e){1===e.touches.length&&(e.preventDefault&&e.preventDefault(),this.onTouchMouseMove(e.touches[0]))},a.prototype.onTouchEnd=function(e){this.onTouchMouseUp(1===e.touches.length?e.touches[0]:e,!0)},a.prototype.onTouchMouseDown=function(e){(this._allowMouseDrag||e.pointerType!==MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&("setCapture"in this._touchPanel&&this._touchPanel.setCapture(!0),this._offsetTouchPrevPos=this._offsetTouchStartPos=null,this._touchStarted=!0)},a.prototype._getOffsetTouchDelta=function(e){return null},a.prototype.onTouchMouseMove=function(e){if(this._touchStarted){this._offsetTouchStartPos||(this._offsetTouchPrevPos=this._offsetTouchStartPos=this._getMouseOffset(e));var t=this._getOffsetTouchDelta(e);0!==t&&(this.scrollBy(-t/this._getRunningSize(!1)*this.viewSize),this._offsetTouchPrevPos=this._getMouseOffset(e)),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0}},a.prototype.onTouchMouseUp=function(e,t){if(this._touchStarted&&this._offsetTouchStartPos){var i=this._getMouseOffset(e);!t&&(Math.abs(this._offsetTouchStartPos.x-i.x)>3||Math.abs(this._offsetTouchStartPos.y-i.y)>3)&&(e.preventDefault&&e.preventDefault(),e.cancelBubble=!0)}"releaseCapture"in this._touchPanel&&this._touchPanel.releaseCapture(),this._touchStarted=!1},a.prototype.createView=function(e,t){this._element=document.createElement("div"),this._element.className=a.className,this._element.setAttribute("drag-resize-disabled","true"),0===t&&e.appendChild(this._element),this._minButton=new r(this,(-1)),this._maxButton=new r(this,1),this._middleBar=document.createElement("div"),this._middleBar.className=a.barClassName,this._element.appendChild(this._middleBar)},a.prototype.scrollTo=function(e){var i=Math.min(this.max-this.viewSize,Math.max(this.min,e));i!==this.viewMin&&(this.viewMin=i,t(this._onscroll,null))},a.prototype._scrollByPage=function(e){},a.prototype._getRunningSize=function(e){return null},a.prototype._getOffsetDelta=function(e){return null},a.prototype.scroll=function(e){var t=this._getOffsetDelta(e)/this._getRunningSize(!0)*(this.max-this.min);if(t<0){if(this._getScreenMousePos(e)>=this._screenMaxMousePos)return}else if(t>0&&this._getScreenMousePos(e)<=this._screenMinMousePos)return;this.scrollBy(t)},Object.defineProperty(a.prototype,"actualWidth",{get:function(){return void 0===this._actualWidth&&this.arrange(),this._actualWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actualHeight",{get:function(){return void 0===!this._actualHeight&&this.arrange(),this._actualHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actualButtonWidth",{get:function(){return void 0===!this._actualButtonWidth&&this.arrange(),this._actualButtonWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actualButtonHeight",{get:function(){return void 0===!this._actualButtonHeight&&this.arrange(),this._actualButtonHeight},enumerable:!0,configurable:!0}),a.prototype.arrange=function(){this._actualWidth||(this._actualWidth=this._element.offsetWidth,this._actualHeight=this._element.offsetHeight,this._actualButtonWidth=this._calculateButtonWidth(),this._actualButtonHeight=this._calculateButtonHeight(),this._minButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMinButtonAngle()),this._maxButton.arrange(this._actualButtonWidth,this._actualButtonHeight,this._getMaxButtonAngle()),this._setMaxButtonPosition())},a.prototype._calculateButtonWidth=function(){return null},a.prototype._calculateButtonHeight=function(){return null},a.prototype._getMinButtonAngle=function(){return null},a.prototype._getMaxButtonAngle=function(){return null},a.prototype._setMaxButtonPosition=function(){},a.prototype.invalidateArrange=function(){this._actualWidth=void 0,this._actualHeight=void 0,this._actualButtonWidth=void 0,this._actualButtonHeight=void 0},a.prototype.onHoldBackgroundMouseDown=function(e){var t=this,i=this._timerHandle?a.ScrollbarBackgroundMousedownHoldDelay:a.ScrollbarBackgroundFirstTimeMousedownHoldDelay;this._timerHandle=setTimeout((function(){t.onBackgroundMouseDown(e)}),i)},a.prototype.onBackgroundMouseDown=function(e){var t=this;clearTimeout(this._timerHandle),this._backgroundMouseUpWrapper||(e.cancelBubble=!0,this._backgroundMouseUpWrapper=function(e){t.onBackgroundMouseUp(e)},a.addDocumentMouseUpEvent(this._backgroundMouseUpWrapper)),this._scrollByPage(e),this.refresh(),this.onHoldBackgroundMouseDown(e),e.preventDefault&&e.preventDefault()},a.prototype.onBackgroundMouseUp=function(e){clearTimeout(this._timerHandle),this._timerHandle=void 0,a.removeDocumentMouseUpEvent(this._backgroundMouseUpWrapper),this._backgroundMouseUpWrapper=void 0},a.prototype.getPinchZoomY=function(){return document.documentElement.clientHeight/window.innerHeight},a.prototype.onMiddleBarMouseDown=function(t){t.cancelBubble=!0,this._screenPrevMousePos={x:t.screenX,y:t.screenY},this._screenMinMousePos=this._getScreenMousePos(t)-(this._getScreenContextualLeft(this._middleBar)-this._getScreenContextualRight(this._minButton.element)),this._screenMaxMousePos=this._getScreenMousePos(t)+(this._getScreenContextualLeft(this._maxButton.element)-this._getScreenContextualRight(this._middleBar)),this._screenToOffsetScale=e.HTMLElementUtils.getAccumulatedScale(this.element)*this.getPinchZoomY();var i=this;this._middleBarMouseMoveWrapper=function(e){i.onMiddleBarMouseMove(e)},a.addDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseUpWrapper=function(e){i.onMiddleBarMouseUp(e)},a.addDocumentMouseUpEvent(this._middleBarMouseUpWrapper),t.preventDefault&&t.preventDefault()},a.prototype.onMiddleBarMouseMove=function(e){this._screenPrevMousePos&&(this.scroll(e),this.refresh(),this._screenPrevMousePos={x:e.screenX,y:e.screenY})},a.prototype.onMiddleBarMouseUp=function(e){this._screenPrevMousePos=void 0,a.removeDocumentMouseMoveEvent(this._middleBarMouseMoveWrapper),this._middleBarMouseMoveWrapper=void 0,a.removeDocumentMouseUpEvent(this._middleBarMouseUpWrapper),this._middleBarMouseUpWrapper=void 0,e.preventDefault&&e.preventDefault()},a.prototype._getScreenContextualLeft=function(e){return null},a.prototype._getScreenContextualRight=function(e){return null},a.prototype.onMouseWheel=function(e){e&&this.mouseWheel(e)},a.prototype.mouseWheel=function(e){this.visible&&(e<0?e=Math.min(-a.MouseWheelRange,e):e>0&&(e=Math.max(a.MouseWheelRange,e)),this.scrollBy(-e/a.MouseWheelRange*this.smallIncrement))},a.prototype._getScreenMousePos=function(e){return null},a.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},a.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},a.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},a.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},a.DefaultScrollbarWidth="15px",a.ScrollbarBackgroundFirstTimeMousedownHoldDelay=500,a.ScrollbarBackgroundMousedownHoldDelay=50,a.MouseWheelRange=120,a.className="scroll-bar-div",a.barClassName="scroll-bar-part-bar",a.arrowClassName="scroll-bar-part-arrow",a})();e.Scrollbar=n;var o=(function(t){function i(e,i){t.call(this,e,i),this.height=n.DefaultScrollbarWidth}return a(i,t),i.prototype._calculateButtonWidth=function(){return Math.min(this.actualWidth/2,Math.max(this.actualHeight,r.MIN_WIDTH))},i.prototype._calculateButtonHeight=function(){return this.actualHeight},i.prototype._getMinButtonAngle=function(){return-180},i.prototype._getMaxButtonAngle=function(){return 0},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementLeft(this.maxButton.element,this.actualWidth-this.actualButtonWidth)},i.prototype.refresh=function(){this.arrange();var t=this.actualWidth-2*this.actualButtonWidth-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),t<0&&(t=0,i=0),i=Math.min(i,t);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,i),e.HTMLElementUtils.setElementHeight(this.middleBar,this.actualHeight),e.HTMLElementUtils.setElementLeft(this.middleBar,this.actualButtonWidth+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.height=this.height:e.HTMLElementUtils.setElementHeight(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetLeft,i=t+this.middleBar.offsetWidth,a=void 0===e.offsetX?e.layerX:e.offsetX;a>i?this.scrollPageDown():a<t&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualWidth;if(e){var i=this.actualButtonWidth+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetXDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetXTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().left},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().right},i.prototype._getScreenMousePos=function(e){return e.screenX},i})(n);e.HorizontalScrollbar=o;var s=(function(t){function i(e,i){t.call(this,e,i),this.width=n.DefaultScrollbarWidth}return a(i,t),i.prototype._calculateButtonWidth=function(){return this.actualWidth},i.prototype._calculateButtonHeight=function(){return Math.min(this.actualHeight/2,Math.max(this.actualWidth,r.MIN_WIDTH))},i.prototype._getMinButtonAngle=function(){return-90},i.prototype._getMaxButtonAngle=function(){return 90},i.prototype._setMaxButtonPosition=function(){e.HTMLElementUtils.setElementTop(this.maxButton.element,this.actualHeight-this.actualButtonHeight)},i.prototype.refresh=function(){this.arrange();var t=this.actualHeight-2*this.actualButtonHeight-2,i=this.viewSize/(this.max-this.min)*t;i<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-i,i=this.MIN_BAR_SIZE),t<0&&(t=0,i=0);var a=this.viewMin/(this.max-this.min)*t;e.HTMLElementUtils.setElementWidth(this.middleBar,this.actualWidth),e.HTMLElementUtils.setElementHeight(this.middleBar,i),e.HTMLElementUtils.setElementTop(this.middleBar,this.actualButtonHeight+1+a)},i.prototype.show=function(i){i!==this.visible&&(t.prototype.show.call(this,i),i?this.element.style.width=this.width:e.HTMLElementUtils.setElementWidth(this.element,0))},i.prototype._scrollByPage=function(e){var t=this.middleBar.offsetTop,i=t+this.middleBar.offsetHeight,a=void 0===e.offsetY?e.layerY:e.offsetY;a>i?this.scrollPageDown():a<t&&this.scrollPageUp()},i.prototype._getRunningSize=function(e){var t=this.actualHeight;if(e){var i=this.actualButtonHeight+1;t-=2*i;var a=t*(this.viewSize/(this.max-this.min));a<this.MIN_BAR_SIZE&&(t-=this.MIN_BAR_SIZE-a)}return t},i.prototype._getOffsetDelta=function(e){return this._getOffsetYDelta(e)},i.prototype._getOffsetTouchDelta=function(e){return this._getOffsetYTouchDelta(e)},i.prototype._getScreenContextualLeft=function(e){return e.getBoundingClientRect().top},i.prototype._getScreenContextualRight=function(e){return e.getBoundingClientRect().bottom},i.prototype._getScreenMousePos=function(e){return e.screenY},i})(n);e.VerticalScrollbar=s})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){var r=e.visuals.SlicerUtil,n="drag-resize-disabled",o=6,s=12,l=(function(){function e(e){this.settings=e,this.init(),this.applyStyles(),this.setValue(this.settings.selectedValue)}return e.prototype.update=function(t){$.extend(this.settings,t),e.populateOptions(this.select,this.settings.options),null!=this.settings.selectedValue&&this.setValue(this.settings.selectedValue),this.select.selectmenu("refresh"),this.applyStyles(),this.applyState()},e.prototype.setValue=function(e){this.select.val(e)},e.prototype.init=function(){var i=this;this.select=a.DomFactory.select(),this.select.attr(n,"true").appendTo(this.settings.container),e.populateOptions(this.select,this.settings.options),this.select.selectmenu({open:function(){r.fixWidgetPosition(i.menuWidget,i.widget,{left:-s,top:o},!0,t.WidgetPosition.left|t.WidgetPosition.bottom)},width:"auto"}),this.settings.onChange&&this.select.on("selectmenuchange",(function(e,t){var a=t.item.value;i.settings.onChange(a)})),this.applyState(),this.widget=this.select.selectmenu("widget"),this.menuWidget=this.select.selectmenu("menuWidget").parent(),this.menuWidget.addClass(this.settings.className)},e.prototype.applyState=function(){this.settings.disabled?this.select.selectmenu("disable"):this.select.selectmenu("enable")},e.prototype.applyStyles=function(){this.settings.css&&this.widget.css(this.settings.css)},e.populateOptions=function(e,t){e.find("option").remove();for(var i=0,a=t;i<a.length;i++){var r=a[i];$("<option />").attr("value",r.value).text(r.text).appendTo(e)}},e})();i.SelectMenu=l})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){var n=e.visuals.SlicerUtil.DisplayNameKeys,o=e.visuals.controls.SelectMenu,s=a.PixelConverter,l="slicer-header",u="slicer-header-title",c="slicer-header-clear",d="slicer-header-text",p="slicer-header-selectmenu",h=(function(){function i(e,t){this.localize=t,this.settings=e,this.data=i.DefaultData(),this.render()}return i.DefaultData=function(){return{borderStyle:"solid",borderBottomWidth:1,show:!0,outline:t.outline.none,fontColor:"#000000",textSize:9,outlineColor:"#808080",outlineWeight:1,searchEnabled:!1,background:null,menu:{fontColor:"#666666"}}},i.InFocusModeData=function(){var e=i.DefaultData();return e.borderStyle="none",e.background="#EAEAEA",e.textSize=s.toPoint(13),e.fontColor="#212121",e},i.prototype.enumerateObjectInstances=function(e){if(this.data)return"header"===e.objectName?[{selector:null,objectName:"header",properties:{show:this.data.show,fontColor:this.data.fontColor,background:this.data.background,outline:this.data.outline,textSize:this.data.textSize,outlineColor:this.data.outlineColor,outlineWeight:this.data.outlineWeight}}]:"general"===e.objectName?[{selector:null,objectName:"general",properties:{outlineColor:this.data.outlineColor,outlineWeight:this.data.outlineWeight}}]:void 0},i.prototype.update=function(e,t){$.extend(this.settings,t),this.data=this.settings.enableInFocusRenderers&&this.settings.isInFocus?i.InFocusModeData():i.converter(e),this.updateTitle(),this.updateSelectMenu()},i.converter=function(a){var r=i.DefaultData(),n=a.getStaticObjects();return n&&(r.show=e.DataViewObjects.getValue(n,t.slicerProps.header.show,r.show),r.fontColor=e.DataViewObjects.getFillColor(n,t.slicerProps.header.fontColor,r.fontColor),r.menu.fontColor=e.DataViewObjects.getFillColor(n,t.slicerProps.header.fontColor,r.menu.fontColor),r.background=e.DataViewObjects.getFillColor(n,t.slicerProps.header.background,r.background),r.outlineColor=e.DataViewObjects.getFillColor(n,t.slicerProps.general.outlineColor,r.outlineColor),r.outlineWeight=e.DataViewObjects.getValue(n,t.slicerProps.general.outlineWeight,r.outlineWeight),r.outline=e.DataViewObjects.getValue(n,t.slicerProps.header.outline,r.outline),r.textSize=e.DataViewObjects.getValue(n,t.slicerProps.header.textSize,r.textSize),r.searchEnabled=e.DataViewObjects.getValue(n,t.slicerProps.general.selfFilterEnabled,r.searchEnabled)),r},i.prototype.render=function(){this.header=r.DomFactory.div().addClass(l).appendTo(this.settings.host),this.addTitle(),this.addSelectMenu()},i.prototype.addSelectMenu=function(){var e=this;this.selectMenuContainer=r.DomFactory.div().addClass(p).appendTo(this.title);var t={onChange:function(t){e.settings.onChange&&e.settings.onChange(t)},container:this.selectMenuContainer,options:this.getSelectMenuOptions(),selectedValue:this.settings.selectedValue,className:l,disabled:2===this.settings.visibilityState};this.selectMenu=new o(t),this.settings.hoverContainer.hover((function(){0!==e.settings.visibilityState&&e.selectMenuContainer.show()}),(function(){e.selectMenuContainer.hide()}))},i.prototype.addTitle=function(){var e=this;this.title=r.DomFactory.div().addClass(u).appendTo(this.header),this.clearButton=r.DomFactory.span().addClass(c).attr("title",this.localize(n.Clear)).appendTo(this.title),this.clearButton.click((function(){e.settings.onClear&&e.settings.onClear()})),this.settings.hoverContainer.hover((function(){e.clearButton.show()}),(function(){e.clearButton.hide()})),this.textElement=$("<h2 />").addClass(d).appendTo(this.title)},i.prototype.updateTitle=function(){if(this.data.show){var e=!1;if(this.data.searchEnabled){var a=i.DefaultData();e=this.data.outline===a.outline&&this.data.outlineWeight===a.outlineWeight&&this.data.outlineColor===a.outlineColor}this.title.show(),this.title.css({"border-style":e?"none":this.data.borderStyle,"border-color":this.data.outlineColor,"border-width":t.VisualBorderUtil.getBorderWidth(this.data.outline,this.data.outlineWeight),"background-color":_.isEmpty(this.data.background)?"":this.data.background}),this.textElement.css({"font-size":s.fromPoint(this.data.textSize),color:this.data.fontColor}),this.textElement.text(this.settings.text).attr("title",this.settings.text)}else this.title.hide()},i.prototype.updateSelectMenu=function(){0===this.settings.visibilityState?this.selectMenuContainer.hide():this.selectMenu.update({options:this.getSelectMenuOptions(),selectedValue:this.settings.selectedValue,disabled:2===this.settings.visibilityState})},i.prototype.getSelectMenuOptions=function(){for(var e=[],t=this.settings.slicerModeOptions,i=0,a=t;i<a.length;i++){var r=a[i],n=r.displayName({get:this.localize});e.push({text:n,value:r.value})}return e},i})();i.SlicerHeader=h})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var i="unselectable",r=(function(){function e(e,t){this._element=e,this._handler=t,this._elementMouseDownWrapper=null,this._elementMouseMoveWrapper=null,this._elementMouseOutWrapper=null,this._documentMouseMoveWrapper=null,this._documentMouseUpWrapper=null,this._startMousePosition=null,this._originalCursor=null}return e.addDocumentMouseUpEvent=function(e){document.addEventListener("mouseup",e)},e.removeDocumentMouseUpEvent=function(e){document.removeEventListener("mouseup",e)},e.addDocumentMouseMoveEvent=function(e){document.addEventListener("mousemove",e)},e.removeDocumentMouseMoveEvent=function(e){document.removeEventListener("mousemove",e)},e.getMouseCoordinates=function(e){return{x:e.pageX,y:e.pageY}},e.getMouseCoordinateDelta=function(e,t){return{x:t.x-e.x,y:t.y-e.y}},e.prototype.initialize=function(){var e=this;this._elementMouseDownWrapper=function(t){return e.onElementMouseDown(t)},this._element.addEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseMoveWrapper=function(t){return e.onElementMouseMove(t)},this._element.addEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseOutWrapper=function(t){return e.onElementMouseOut(t)},this._element.addEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseDoubleClickOutWrapper=function(t){return e.onElementMouseDoubleClick(t)},this._element.addEventListener("dblclick",this._elementMouseDoubleClickOutWrapper)},e.prototype.uninitialize=function(){this._element.removeEventListener("mousedown",this._elementMouseDownWrapper),this._elementMouseDownWrapper=null,this._element.removeEventListener("mousemove",this._elementMouseMoveWrapper),this._elementMouseMoveWrapper=null,this._element.removeEventListener("mouseout",this._elementMouseOutWrapper),this._elementMouseOutWrapper=null,this._element.removeEventListener("dblclick",this._elementMouseDoubleClickOutWrapper),this._elementMouseDoubleClickOutWrapper=null},Object.defineProperty(e.prototype,"cell",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),e.prototype._hotSpot=function(e){return!1},e.prototype.onElementMouseDown=function(t){var i=this,a=e.getMouseCoordinates(t);this._hotSpot(a)&&("setCapture"in this._element&&this._element.setCapture(),t.cancelBubble=!0,this._startMousePosition=a,this._documentMouseMoveWrapper=function(e){return i.onDocumentMouseMove(e)},e.addDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseUpWrapper=function(e){return i.onDocumentMouseUp(e)},e.addDocumentMouseUpEvent(this._documentMouseUpWrapper),document.documentElement&&(this._originalCursor=document.documentElement.style.cursor,document.documentElement.style.cursor=e.resizeCursor),this._handler.onStartResize(this.cell,this._startMousePosition.x,this._startMousePosition.y))},e.prototype.onElementMouseMove=function(t){this._startMousePosition||(this._hotSpot(e.getMouseCoordinates(t))?null===this._originalCursor&&(this._originalCursor=this._element.style.cursor,this._element.style.cursor=e.resizeCursor):null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null))},e.prototype.onElementMouseOut=function(e){this._startMousePosition||null!==this._originalCursor&&(this._element.style.cursor=this._originalCursor,this._originalCursor=null)},e.prototype.onElementMouseDoubleClick=function(t){this._hotSpot(e.getMouseCoordinates(t))&&this._handler.onReset(this.cell)},e.prototype.onDocumentMouseMove=function(t){if(this._startMousePosition){var i=e.getMouseCoordinateDelta(this._startMousePosition,e.getMouseCoordinates(t));this._handler.onResize(this.cell,i.x,i.y),t.preventDefault()}},e.prototype.onDocumentMouseUp=function(t){this._startMousePosition=null,"releaseCapture"in this._element&&this._element.releaseCapture(),
e.removeDocumentMouseMoveEvent(this._documentMouseMoveWrapper),this._documentMouseMoveWrapper=null,e.removeDocumentMouseUpEvent(this._documentMouseUpWrapper),this._documentMouseUpWrapper=null,document.documentElement&&(document.documentElement.style.cursor=this._originalCursor),t.preventDefault&&t.preventDefault(),this._handler.onEndResize(this.cell)},e.resizeHandleSize=4,e.resizeCursor="e-resize",e})();t.TablixResizer=r;var n=(function(e){function t(t,i,a){e.call(this,i,a),this._cell=t}return a(t,e),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),t.prototype._hotSpot=function(e){return e.x>=this.element.getBoundingClientRect().right-r.resizeHandleSize},t})(r);t.TablixDomResizer=n;var o=(function(){function i(e,i){this._tableCell=null,this._contentElement=t.TablixUtils.createDiv(),this._contentHost=t.TablixUtils.createDiv(),this.layoutKind=i,this._contentElement.appendChild(this._contentHost),this._resizer=null}return i.prototype.initialize=function(e){this._owner=e},Object.defineProperty(i.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),i.prototype.registerTableCell=function(e){this._tableCell=e,e.appendChild(this._contentElement)},Object.defineProperty(i.prototype,"tableCell",{get:function(){return this._tableCell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentElement",{get:function(){return this._contentElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!0,configurable:!0}),i.prototype.registerClickHandler=function(e){this._contentElement.onclick=e},i.prototype.unregisterClickHandler=function(){this._contentElement.onclick=null},i.prototype.onContainerWidthChanged=function(t){e.HTMLElementUtils.setElementWidth(this._contentElement,t)},i.prototype.onContinerHeightChanged=function(t){e.HTMLElementUtils.setElementHeight(this._contentElement,t)},i.prototype.onColumnSpanChanged=function(e){this._tableCell.colSpan=e},i.prototype.onRowSpanChanged=function(e){this._tableCell.rowSpan=e},i.prototype.onTextAlignChanged=function(e){this._tableCell.style.textAlign=e},i.prototype.onClear=function(){this._contentHost.className="",this._tableCell.className=""},i.prototype.onHorizontalScroll=function(t,i){e.HTMLElementUtils.setElementLeft(this._contentHost,i),e.HTMLElementUtils.setElementWidth(this._contentHost,t)},i.prototype.onVerticalScroll=function(t,i){e.HTMLElementUtils.setElementTop(this._contentHost,i),e.HTMLElementUtils.setElementHeight(this._contentHost,t)},i.prototype.onInitializeScrolling=function(){e.HTMLElementUtils.setElementLeft(this._contentHost,0),e.HTMLElementUtils.setElementTop(this._contentHost,0),e.HTMLElementUtils.setElementWidth(this._contentHost,-1),e.HTMLElementUtils.setElementHeight(this._contentHost,-1)},i.prototype.enableHorizontalResize=function(e,t){e!==(null!==this._resizer)&&(e?(this._resizer=new n(this._owner,this._tableCell,t),this._resizer.initialize()):(this._resizer.uninitialize(),this._resizer=null))},i.prototype.disableDragResize=function(){this._tableCell.setAttribute(i._dragResizeDisabledAttributeName,"true")},i._dragResizeDisabledAttributeName="drag-resize-disabled",i})();t.TablixCellPresenter=o;var s=(function(){function e(e){this._tableRow=null,this._fitProportionally=e}return e.prototype.initialize=function(e){this._row=e},e.prototype.createCellPresenter=function(e){return new o(this._fitProportionally,e)},e.prototype.registerRow=function(e){this._tableRow=e},e.prototype.onAppendCell=function(e){var t=e._presenter;if(null===t.tableCell){var i=this._tableRow.insertCell(-1);t.registerTableCell(i)}else this._tableRow.appendChild(t.tableCell)},e.prototype.onInsertCellBefore=function(e,t){var i=e._presenter;if(null===i.tableCell){var a=this._tableRow.insertCell(Math.max(0,t._presenter.tableCell.cellIndex-1));i.registerTableCell(a)}else this._tableRow.insertBefore(e._presenter.tableCell,t._presenter.tableCell)},e.prototype.onRemoveCell=function(e){this._tableRow.removeChild(e._presenter.tableCell)},e.prototype.getHeight=function(){return this.getCellHeight(this._row.getTablixCell())},e.prototype.getCellHeight=function(e){return-1},e.prototype.getCellContentHeight=function(e){return-1},Object.defineProperty(e.prototype,"tableRow",{get:function(){return this._tableRow},enumerable:!0,configurable:!0}),e})();t.TablixRowPresenter=s;var l=(function(e){function t(t,i){e.call(this,i),this._gridPresenter=t}return a(t,e),t.prototype.getCellHeight=function(e){return e.containerHeight},t.prototype.getCellContentHeight=function(e){return e.contentHeight},t})(s);t.DashboardRowPresenter=l;var u=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.getCellHeight=function(e){return e.containerHeight},t.prototype.getCellContentHeight=function(e){return e.contentHeight},t})(s);t.CanvasRowPresenter=u;var c=(function(){function e(){}return e.prototype.initialize=function(e){this._column=e},e.prototype.getWidth=function(){var e=this.getPersistedWidth();return null==e&&(e=this.getCellWidth(this._column.getTablixCell())),e},e.prototype.getPersistedWidth=function(){return-1},e.prototype.getCellWidth=function(e){return-1},e})();t.TablixColumnPresenter=c;var d=(function(e){function t(t){e.call(this),this._gridPresenter=t}return a(t,e),t.prototype.getPersistedWidth=function(){return this._gridPresenter.sizeComputationManager.cellWidth},t.prototype.getCellWidth=function(e){return this._gridPresenter.sizeComputationManager.cellWidth},t})(c);t.DashboardColumnPresenter=d;var p=(function(e){function t(t,i){e.call(this),this._gridPresenter=t,this._columnIndex=i}return a(t,e),t.prototype.getPersistedWidth=function(){return this._gridPresenter.getPersistedColumnWidth(this._column)},t.prototype.getCellWidth=function(e){var t=e;return t._presenter?e.contentWidth:0},t})(c);t.CanvasColumnPresenter=p;var h=(function(){function a(e){this._table=t.TablixUtils.createTable(),this._table.className=i,this._footerTable=t.TablixUtils.createTable(),this._footerTable.className=i,this._columnWidthManager=e}return a.prototype.initialize=function(e,t,i,a){this._owner=e,t.appendChild(this._table),i.appendChild(this._footerTable)},a.prototype.getWidth=function(){return-1},a.prototype.getHeight=function(){return-1},a.prototype.getScreenToCssRatioX=function(){return 1},a.prototype.getScreenToCssRatioY=function(){return 1},a.prototype.createRowPresenter=function(){return null},a.prototype.createColumnPresenter=function(e){return null},a.prototype.onAppendRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._table.insertRow(-1);t.registerRow(i)}else this._table.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onInsertRowBefore=function(e,t){var i=e.presenter;if(null===i.tableRow){var a=this._table.insertRow(Math.max(0,t.presenter.tableRow.rowIndex-1));i.registerRow(a)}else this._table.tBodies[0].insertBefore(e.presenter.tableRow,t.presenter.tableRow)},a.prototype.onRemoveRow=function(e){this._table.tBodies[0].removeChild(e.presenter.tableRow)},a.prototype.onAddFooterRow=function(e){var t=e.presenter;if(null===t.tableRow){var i=this._footerTable.insertRow(-1);t.registerRow(i)}else this._footerTable.tBodies[0].appendChild(e.presenter.tableRow)},a.prototype.onClear=function(){e.HTMLElementUtils.clearChildren(this._table),e.HTMLElementUtils.clearChildren(this._footerTable)},a.prototype.onFillColumnsProportionallyChanged=function(e){e?(this._table.style.width="100%",this._footerTable.style.width="100%"):(this._table.style.width="auto",this._footerTable.style.width="auto")},a.prototype.invokeColumnResizeEndCallback=function(t,i){this._columnWidthManager&&this._columnWidthManager.onColumnWidthChanged(e.TablixColumnWidthManager.getColumnQueryName(t),i)},a.prototype.getPersistedColumnWidth=function(t){if(this._columnWidthManager)return this._columnWidthManager.getPersistedColumnWidth(e.TablixColumnWidthManager.getColumnQueryName(t))},a})();t.TablixGridPresenter=h;var g=(function(e){function t(t){e.call(this),this._sizeComputationManager=t}return a(t,e),t.prototype.createRowPresenter=function(){return new l(this,this._owner.fillColumnsProportionally)},t.prototype.createColumnPresenter=function(e){return new d(this)},Object.defineProperty(t.prototype,"sizeComputationManager",{get:function(){return this._sizeComputationManager},enumerable:!0,configurable:!0}),t.prototype.getWidth=function(){return this._sizeComputationManager.gridWidth},t.prototype.getHeight=function(){return this._sizeComputationManager.gridHeight},t})(h);t.DashboardTablixGridPresenter=g;var f=(function(t){function i(e){t.call(this,e)}return a(i,t),i.prototype.createRowPresenter=function(){return new u(this._owner.fillColumnsProportionally)},i.prototype.createColumnPresenter=function(e){return new p(this,e)},i.prototype.getWidth=function(){return e.HTMLElementUtils.getElementWidth(this._table)},i.prototype.getHeight=function(){return e.HTMLElementUtils.getElementHeight(this._table)},i})(h);t.CanvasTablixGridPresenter=f})(t=e.internal||(e.internal={}))})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(t){var i=(function(){function e(e){this._binder=e,this._adjustmentFactor=1}return e.prototype._getOwner=function(){return null},Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adjustmentFactor",{get:function(){return this._adjustmentFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsToRealizeCount",{get:function(){return this._itemsToRealizeCount},set:function(e){this._itemsToRealizeCount=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsEstimatedContextualWidth",{get:function(){return this._itemsEstimatedContextualWidth},set:function(e){this._itemsEstimatedContextualWidth=e},enumerable:!0,configurable:!0}),e.prototype.onStartRenderingIteration=function(){var e=this._getOwner();e.measureEnabled&&!e.done&&this._getEstimatedItemsToRealizeCount(),this._realizedLeavesCount=0},e.prototype.onEndRenderingIteration=function(e,t){t||this._getOwner().allItemsRealized||(this._adjustmentFactor*=this._getSizeAdjustment(e))},e.prototype.onEndRenderingSession=function(){this._adjustmentFactor=1},e.prototype.onCornerCellRealized=function(e,t){},e.prototype.onHeaderRealized=function(e,t,i){i&&this._realizedLeavesCount++},Object.defineProperty(e.prototype,"needsToRealize",{get:function(){return this._realizedLeavesCount<this._itemsToRealizeCount},enumerable:!0,configurable:!0}),e.prototype._getEstimatedItemsToRealizeCount=function(){},e.prototype._getSizeAdjustment=function(e){return 1},e})();t.TablixDimensionRealizationManager=i;var r=(function(e){function t(){e.apply(this,arguments)}return a(t,e),Object.defineProperty(t.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),t.prototype._getOwner=function(){return this._owner},t.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateRowsToRealizeCount()},t.prototype.estimateRowsToRealizeCount=function(){return this._owner.dimension.model?void(this._owner.alignToEnd?this.itemsToRealizeCount=this._owner.dimension.getItemsCount()-this._owner.dimension.getIntegerScrollOffset()+1:this.itemsToRealizeCount=Math.ceil(this._owner.contextualWidthToFill/(this._owner.owner.getEstimatedRowHeight()*this.adjustmentFactor)+this._owner.dimension.getFractionScrollOffset())-this._owner.otherLayoutManager.dimension.getDepth()+1):void(this.itemsToRealizeCount=0)},t.prototype.getEstimatedRowHierarchyWidth=function(){if(!this._owner.dimension.model||0===this._owner.dimension.getItemsCount())return 0;var e=new o;this.updateRowHiearchyEstimatedWidth(this._owner.dimension.model,this._owner.dimension._hierarchyNavigator.getIndex(this._owner.dimension.getFirstVisibleItem(0)),e);for(var t=e.items,i=t.length,a=0,r=0;r<i;r++){var n=t[r];a+=0!==n.maxNonLeafWidth?n.maxNonLeafWidth:n.maxLeafWidth}return a},t.prototype.updateRowHiearchyEstimatedWidth=function(e,t,i){if(!(t<0))for(var a=this._owner.owner.owner.hierarchyNavigator,r=this.binder,n=a.getCount(e),o=t;o<n;o++){if(i.leafCount===this.itemsToRealizeCount)return;var l=a.getAt(e,o),u=r.getHeaderLabel(l),c=this._owner.getEstimatedHeaderWidth(u,t),d=a.isLeaf(l),p=a.getLevel(l),h=i.items[p];h||(h=new s,i.items[p]=h),d?(h.maxLeafWidth=Math.max(h.maxLeafWidth,c),i.leafCount=i.leafCount+1):(h.maxNonLeafWidth=Math.max(h.maxNonLeafWidth,c),this.updateRowHiearchyEstimatedWidth(a.getChildren(l),this._owner.dimension.getFirstVisibleChildIndex(l),i))}},t.prototype._getSizeAdjustment=function(e){return e/((this._owner.getRealizedItemsCount()-this._owner.dimension.getFractionScrollOffset())*this._owner.owner.getEstimatedRowHeight())},t})(i);t.RowRealizationManager=r;var n=(function(i){function r(){i.apply(this,arguments)}return a(r,i),Object.defineProperty(r.prototype,"owner",{set:function(e){this._owner=e},enumerable:!0,configurable:!0}),r.prototype._getOwner=function(){return this._owner},r.prototype._getEstimatedItemsToRealizeCount=function(){this.estimateColumnsToRealizeCount(this.getEstimatedRowHierarchyWidth())},Object.defineProperty(r.prototype,"rowRealizationManager",{get:function(){return this._owner.otherLayoutManager.realizationManager},enumerable:!0,configurable:!0}),r.prototype.getEstimatedRowHierarchyWidth=function(){return this._owner.otherLayoutManager.done?this._owner.getOtherHierarchyContextualHeight():this.rowRealizationManager.getEstimatedRowHierarchyWidth()*this.adjustmentFactor},r.prototype.estimateColumnsToRealizeCount=function(i){var a=this._owner.contextualWidthToFill-i;if(!this._owner.dimension.model||e.Double.lessOrEqualWithPrecision(a,0,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=0);var r=this.binder,n=this._owner.owner.owner.hierarchyNavigator,o=this._owner.dimension.getIntegerScrollOffset(),s=this._owner.dimension.getItemsCount(),l=s-o,u=this._owner.otherLayoutManager.dimension.getIntegerScrollOffset(),c=this._owner.otherLayoutManager.dimension.getItemsCount();if(this.itemsEstimatedContextualWidth=0,this._owner.alignToEnd)return void(this.itemsToRealizeCount=l);for(var d=o;d<s;d++){if(e.Double.greaterOrEqualWithPrecision(this.itemsEstimatedContextualWidth,a,t.DimensionLayoutManager._pixelPrecision))return void(this.itemsToRealizeCount=d-o);var p=0,h=void 0;h=d===o?this._owner.getVisibleSizeRatio():1;var g=n.getLeafAt(this._owner.dimension.model,d),f=r.getHeaderLabel(g);p=Math.max(p,this._owner.getEstimatedHeaderWidth(f,d));for(var m=u;m<c;m++){var y=n.getIntersection(n.getLeafAt(this._owner.otherLayoutManager.dimension.model,m),g);f=r.getCellContent(y),p=Math.max(p,this._owner.getEstimatedBodyCellWidth(f))}this.itemsEstimatedContextualWidth+=p*h*this.adjustmentFactor}this.itemsToRealizeCount=l},r.prototype._getSizeAdjustment=function(e){return e/(this.getEstimatedRowHierarchyWidth()+this.itemsEstimatedContextualWidth)},r})(i);t.ColumnRealizationManager=n;var o=(function(){function e(){this.items=[],this.leafCount=0}return e})();t.RowWidths=o;var s=(function(){function e(){this.maxLeafWidth=0,this.maxNonLeafWidth=0}return e})();t.RowWidth=s})(i=t.internal||(t.internal={}))})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function t(t,i,a){this._scrollable=!1,this._presenter=t,this.extension=i,this._presenter.initialize(this),this._row=a,this.item=null,this.type=null,this._horizontalOffset=0,this._verticalOffset=0,this._colSpan=1,this._rowSpan=1,this._containerWidth=-1,this._containerHeight=-1,this.contentHeight=this.contentWidth=0,this.position=new e.TablixUtils.CellPosition}return t.prototype.unfixRowHeight=function(){this._row.unfixSize()},Object.defineProperty(t.prototype,"colSpan",{get:function(){return this._colSpan},set:function(e){this._colSpan!==e&&(this._presenter.onColumnSpanChanged(e),this._colSpan=e,this._presenter.onContainerWidthChanged(-1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return this._rowSpan},set:function(e){this._rowSpan!==e&&(this._presenter.onRowSpanChanged(e),this._rowSpan=e,this._row.unfixSize())},enumerable:!0,configurable:!0}),t.prototype.getCellSpanningHeight=function(){return this._row.getCellSpanningHeight(this)},Object.defineProperty(t.prototype,"textAlign",{get:function(){return this._textAlign},set:function(e){e!==this._textAlign&&(this._presenter.onTextAlignChanged(e),this._textAlign=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalOffset",{get:function(){return this._horizontalOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalOffset",{get:function(){return this._verticalOffset},enumerable:!0,configurable:!0}),t.prototype.isScrollable=function(){return this._scrollable},t.prototype.clear=function(){this.isScrollable()&&this.initializeScrolling(),this._presenter.onClear(),this.setContainerWidth(-1),this.setContainerHeight(-1),this.contentHeight=this.contentWidth=0},t.prototype.initializeScrolling=function(){this._presenter.onInitializeScrolling(),this._horizontalOffset=0,0!==this._verticalOffset&&(this._verticalOffset=0,this.unfixRowHeight()),1===this.colSpan&&this.setContainerWidth(-1),1===this.rowSpan&&this.setContainerHeight(-1)},t.prototype.prepare=function(e){this.isScrollable()&&this.initializeScrolling(),this._scrollable=e},t.prototype.scrollVertically=function(e,t){var i=Math.ceil(-e*t);this._verticalOffset=i,this.isScrollable()?(this._presenter.onVerticalScroll(e,i),this.setContainerHeight(e+i)):this.setContainerHeight(this._row.getCellSpanningHeight(this)+i)},t.prototype.scrollHorizontally=function(e,t){this.isScrollable()&&(this._presenter.onHorizontalScroll(e,t),this.setContainerWidth(e+t))},t.prototype.setContainerWidth=function(e){e!==this._containerWidth&&(this._containerWidth=e,this._presenter.onContainerWidthChanged(e))},Object.defineProperty(t.prototype,"containerWidth",{get:function(){return this._containerWidth},enumerable:!0,configurable:!0}),t.prototype.setContainerHeight=function(e){e<0&&(e=-1),e!==this._containerHeight&&(this._containerHeight=e,this._presenter.onContinerHeightChanged(e))},Object.defineProperty(t.prototype,"containerHeight",{get:function(){return this._containerHeight},enumerable:!0,configurable:!0}),t.prototype.applyStyle=function(e){e&&(e.applyStyle(this),this.contentHeight+=e.getExtraBottom()+e.getExtraTop(),this.contentWidth+=e.getExtraLeft()+e.getExtraRight())},t.prototype.enableHorizontalResize=function(e,t){this._presenter.enableHorizontalResize(e,t)},t.prototype.isColumnResizing=function(){return this._column&&this._column.isResizing()},t})();e.TablixCell=t;var i=(function(){function e(e,t){this._presenter=e,this._presenter.initialize(this),this._containerWidth=-1,this._width=-1,this._sizeFixed=!1,this._aligningWidth=-1,this._fixedToAligningWidth=!1,this._items=[],this._itemType=null,this._footerCell=null,this._columnIndex=t,this.isColumnResizing=!1}return e.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedColumnHeaders=[],this._realizedCornerCells=[],this._realizedBodyCells=[]},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),e.prototype.getType=function(){return this._realizedCornerCells.length>0?0:2},e.prototype.getColumnHeadersOrCorners=function(){return this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders},e.prototype.columnHeadersOrCornersEqual=function(e,t,i){if(this._items.length!==t.length)return!1;for(var a=this._items.length,r=0;r<a;r++)if(!this.columnHeaderOrCornerEquals(this._itemType,this._items[r],e,t[r].item,i))return!1;return!0},Object.defineProperty(e.prototype,"itemType",{get:function(){return this._itemType},enumerable:!0,configurable:!0}),e.prototype.getLeafItem=function(){return 0===this._items.length?null:this._items[this._items.length-1]},e.prototype.columnHeaderOrCornerEquals=function(e,t,i,a,r){if(e!==i)return!1;if(0===e){if(!r.cornerCellItemEquals(t,a))return!1}else if(!r.headerItemEquals(t,a))return!1;return!0},e.prototype.OnLeafRealized=function(e){var t=this.getType(),i=this.getColumnHeadersOrCorners();if(this.columnHeadersOrCornersEqual(t,i,e))this.clearSpanningCellsWidth(this._realizedColumnHeaders);else{var a=i.length;this._items=[];for(var r=0;r<a;r++)this._items.push(i[r].item);this._itemType=t,this.clearSize()}},e.prototype.clearSpanningCellsWidth=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.colSpan>1&&i.setContainerWidth(-1)}},e.prototype.addCornerCell=function(e){e._column=this,this._realizedCornerCells.push(e),e.setContainerWidth(this._containerWidth)},e.prototype.addRowHeader=function(e){e._column=this,this._realizedRowHeaders.push(e),e.setContainerWidth(this._containerWidth)},e.prototype.addColumnHeader=function(e,t){e._column=this,this._realizedColumnHeaders.push(e),t&&e.setContainerWidth(this._containerWidth)},e.prototype.addBodyCell=function(e){e._column=this,this._realizedBodyCells.push(e),e.setContainerWidth(this._containerWidth)},Object.defineProperty(e.prototype,"footer",{get:function(){return this._footerCell},set:function(e){this._footerCell=e,e._column=this,e.setContainerWidth(this._containerWidth)},enumerable:!0,configurable:!0}),e.prototype.isResizing=function(){return this.isColumnResizing},e.prototype.onResize=function(e){this.isColumnResizing=!0,e!==this.getContentContextualWidth()&&(this._containerWidth=e,this.setContainerWidth(this._containerWidth),this._sizeFixed=!0,this._fixedToAligningWidth=!1,this._aligningWidth=-1)},e.prototype.onResizeEnd=function(e){this.isColumnResizing=!1;var t=this.owner._presenter;t&&t.invokeColumnResizeEndCallback(this,e)},e.prototype.fixSize=function(){var e=this._aligningWidth!==-1,t=e!==this._fixedToAligningWidth;(!this._sizeFixed||t||e)&&(this._aligningWidth===-1?this.setContainerWidth(this._containerWidth):this.setContainerWidth(this._aligningWidth),this._sizeFixed=!0,this._fixedToAligningWidth=this._aligningWidth!==-1)},e.prototype.clearSize=function(){this._containerWidth=-1,this.setContainerWidth(this._containerWidth),this._sizeFixed=!1},e.prototype.getContentContextualWidth=function(){return this._containerWidth},e.prototype.getCellIContentContextualWidth=function(e){return this._presenter.getCellWidth(e)},e.prototype.getCellSpanningWidthWithScrolling=function(e,t){var i=this.getContextualWidth()+this.getScrollingOffset();if(e.colSpan>1)for(var a=this.getIndex(t),r=t.realizedColumns,n=1;n<e.colSpan;n++)i+=r[n+a].getContextualWidth();return i},e.prototype.getScrollingOffset=function(){var e=0;return this._realizedColumnHeaders.length>0&&(e=_.last(this._realizedColumnHeaders).horizontalOffset),e},e.prototype.getContextualWidth=function(){return this._width!==-1&&this._containerWidth!==-1||(this._width=this._presenter.getWidth()),this._width},e.prototype.calculateSize=function(){if(this._sizeFixed)return this._containerWidth;var e=0,t=this._presenter.getPersistedWidth();if(null!=t){e=t;for(var i=0,a=this._realizedColumnHeaders.length;i<a-1;i++){var r=this._realizedColumnHeaders[i];1===r.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(r)))}return this._containerWidth=e}for(var n=0,o=this._realizedColumnHeaders;n<o.length;n++){var r=o[n];1===r.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(r)))}for(var s=0,l=this._realizedRowHeaders;s<l.length;s++){var r=l[s];1===r.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(r)))}for(var u=0,c=this._realizedCornerCells;u<c.length;u++){var r=c[u];e=Math.max(e,this._presenter.getCellWidth(r))}for(var d=0,p=this._realizedBodyCells;d<p.length;d++){var r=p[d];e=Math.max(e,this._presenter.getCellWidth(r))}return null!==this._footerCell&&1===this._footerCell.colSpan&&(e=Math.max(e,this._presenter.getCellWidth(this._footerCell))),this._containerWidth=e},e.prototype.setAligningContextualWidth=function(e){this._aligningWidth=e},e.prototype.getAligningContextualWidth=function(){return this._aligningWidth},e.prototype.setContainerWidth=function(e){for(var t=0,i=this._realizedColumnHeaders;t<i.length;t++){var a=i[t];1===a.colSpan&&a.setContainerWidth(e)}for(var r=0,n=this._realizedRowHeaders;r<n.length;r++){var a=n[r];1===a.colSpan&&a.setContainerWidth(e)}for(var o=0,s=this._realizedCornerCells;o<s.length;o++){var a=s[o];a.setContainerWidth(e)}for(var l=0,u=this._realizedBodyCells;l<u.length;l++){var a=u[l];a.setContainerWidth(e)}null!==this._footerCell&&1===this._footerCell.colSpan&&this._footerCell.setContainerWidth(e),this._width=e},e.prototype.getTablixCell=function(){var e=this._realizedColumnHeaders.length>0?this._realizedColumnHeaders:this._realizedCornerCells;return e[e.length-1]},e.prototype.getIndex=function(e){return e.realizedColumns.indexOf(this)},e.prototype.getHeaders=function(){return this._realizedColumnHeaders},e.prototype.getOtherDimensionHeaders=function(){return this._realizedRowHeaders},e.prototype.getCellContextualSpan=function(e){return e.colSpan},e.prototype.getOtherDimensionOwner=function(e){return e._row},e})();e.TablixColumn=i;var a=(function(){function e(e){this._containerHeight=-1,this._presenter=e,this._presenter.initialize(this),this._allocatedCells=[],this._heightFixed=!1,this._containerHeight=-1,this._height=-1}return e.prototype.initialize=function(e){this._owner=e,this._realizedRowHeaders=[],this._realizedBodyCells=[],this._realizedCornerCells=[],this._realizedColumnHeaders=[],this._realizedCellsCount=0},Object.defineProperty(e.prototype,"presenter",{get:function(){return this._presenter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),e.prototype.releaseUnusedCells=function(e){this.releaseCells(e,this._realizedCellsCount)},e.prototype.releaseAllCells=function(e){this.releaseCells(e,0)},e.prototype.releaseCells=function(e,t){for(var i=this._allocatedCells,a=i.length,r=t;r<a;r++){var n=i[r];e._unbindCell(n),n.clear()}},e.prototype.moveScrollableCellsToEnd=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;i<t+e;i++){var a=this._allocatedCells[i];this._presenter.onRemoveCell(a),this._presenter.onAppendCell(a),this._allocatedCells.push(a)}this._allocatedCells.splice(t,e)},e.prototype.moveScrollableCellsToStart=function(e){for(var t=Math.max(this._realizedRowHeaders.length,this._realizedCornerCells.length),i=t;i<t+e;i++){var a=this._allocatedCells.pop();this._presenter.onRemoveCell(a),this._presenter.onInsertCellBefore(a,this._allocatedCells[t]),this._allocatedCells.splice(t,0,a)}},e.prototype.getOrCreateCornerCell=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.addCornerCell(t),this._realizedCornerCells.push(t),t.setContainerHeight(this._containerHeight),t},e.prototype.getOrCreateRowHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addRowHeader(a),this._realizedRowHeaders.push(a),i&&a.setContainerHeight(this._containerHeight),a},e.prototype.getOrCreateColumnHeader=function(e,t,i){var a=this.getOrCreateCell();return a.prepare(t),e.addColumnHeader(a,i),this._realizedColumnHeaders.push(a),a.setContainerHeight(this._containerHeight),a},e.prototype.getOrCreateBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.addBodyCell(i),this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},e.prototype.getOrCreateFooterRowHeader=function(e){var t=this.getOrCreateCell();return t.prepare(!1),e.footer=t,this._realizedRowHeaders.push(t),t.setContainerHeight(this._containerHeight),t},e.prototype.getOrCreateFooterBodyCell=function(e,t){var i=this.getOrCreateCell();return i.prepare(t),e.footer=i,this._realizedBodyCells.push(i),i.setContainerHeight(this._containerHeight),i},e.prototype.getRowHeaderLeafIndex=function(){for(var e=-1,t=this._allocatedCells.length,i=0;i<t&&1===this._allocatedCells[i].type;i++)e++;return e},e.prototype.getAllocatedCellAt=function(e){return this._allocatedCells[e]},e.prototype.moveCellsBy=function(e){if(0!==this._allocatedCells.length)if(e>0)for(var t=this._allocatedCells[0],i=0;i<e;i++){var a=this.createCell(this);this._presenter.onInsertCellBefore(a,t),this._allocatedCells.unshift(a),t=a}else{e=-e;for(var i=0;i<e;i++)this._presenter.onRemoveCell(this._allocatedCells[i]);this._allocatedCells.splice(0,e)}},e.prototype.getRealizedCellCount=function(){return this._realizedCellsCount},e.prototype.getRealizedHeadersCount=function(){return this._realizedRowHeaders.length},e.prototype.getRealizedHeaderAt=function(e){return this._realizedRowHeaders[e]},e.prototype.getTablixCell=function(){var e;return e=this._realizedRowHeaders.length>0?this._realizedRowHeaders:this._realizedCornerCells.length>0?this._realizedCornerCells:this._realizedColumnHeaders,e[e.length-1]},e.prototype.getOrCreateEmptySpaceCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e&&(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)),e},e.prototype.createCell=function(e){var i=this._presenter.createCellPresenter(this._owner.owner.layoutManager.getLayoutKind());return new t(i,i,this)},e.prototype.getOrCreateCell=function(){var e=this._allocatedCells[this._realizedCellsCount];return void 0===e?(e=this.createCell(this),this._allocatedCells[this._realizedCellsCount]=e,this._presenter.onAppendCell(e)):(e.colSpan=1,e.rowSpan=1),this._realizedCellsCount=this._realizedCellsCount+1,e},e.prototype.isResizing=function(){return!1},e.prototype.onResize=function(e){e!==this.getContentContextualWidth()&&(this._containerHeight=e,this.setContentHeight(),this._heightFixed=!0,this.setAligningContextualWidth(-1))},e.prototype.onResizeEnd=function(e){},e.prototype.fixSize=function(){this.sizeFixed()||(this.setContentHeight(),this._heightFixed=!0)},e.prototype.unfixSize=function(){this._heightFixed=!1,this._height=-1},e.prototype.getContentContextualWidth=function(){return this._containerHeight},e.prototype.getCellIContentContextualWidth=function(e){return this.presenter.getCellContentHeight(e)},e.prototype.getCellSpanningHeight=function(e){var t=this.getContextualWidth();if(e.rowSpan>1)for(var i=this.getIndex(this.owner),a=this.owner.realizedRows,r=1;r<e.rowSpan;r++)t+=a[r+i].getContextualWidth();return t},e.prototype.getContextualWidth=function(){return this._height!==-1&&this._containerHeight!==-1||(this._height=this._presenter.getHeight()),this._height},e.prototype.sizeFixed=function(){return this._heightFixed},e.prototype.calculateSize=function(){if(this._heightFixed)return this._containerHeight;for(var e=0,t=this._realizedRowHeaders.length,i=0;i<t;i++){var a=this._realizedRowHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedCornerCells.length;for(var i=0;i<t;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedCornerCells[i]));t=this._realizedColumnHeaders.length;for(var i=0;i<t;i++){var a=this._realizedColumnHeaders[i];1===a.rowSpan&&(e=Math.max(e,this._presenter.getCellContentHeight(a)))}t=this._realizedBodyCells.length;for(var i=0;i<t;i++)e=Math.max(e,this._presenter.getCellContentHeight(this._realizedBodyCells[i]));return this._containerHeight=e},e.prototype.setAligningContextualWidth=function(e){},e.prototype.getAligningContextualWidth=function(){return-1},e.prototype.setContentHeight=function(){
for(var e=this._realizedRowHeaders.length,t=e-1;t>=0;t--){var i=this._realizedRowHeaders[t];i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i))}e=this._realizedCornerCells.length;for(var t=0;t<e;t++)this._realizedCornerCells[t].setContainerHeight(this._containerHeight);e=this._realizedColumnHeaders.length;for(var t=0;t<e;t++){var i=this._realizedColumnHeaders[t];i.setContainerHeight(this._containerHeight),i.rowSpan>1&&i.setContainerHeight(this.getCellSpanningHeight(i))}e=this._realizedBodyCells.length;for(var t=0;t<e;t++)this._realizedBodyCells[t].setContainerHeight(this._containerHeight);this._height=-1},e.prototype.getIndex=function(e){return e.realizedRows.indexOf(this)},e.prototype.getHeaders=function(){return this._realizedRowHeaders},e.prototype.getOtherDimensionHeaders=function(){return this._realizedColumnHeaders},e.prototype.getCellContextualSpan=function(e){return e.rowSpan},e.prototype.getOtherDimensionOwner=function(e){return e._column},e})();e.TablixRow=a;var r=(function(){function e(e){this._presenter=e,this._footerRow=null}return e.prototype.initialize=function(e,t,i){this._owner=e,this._presenter.initialize(this,t,i,e),this.fillColumnsProportionally=!1,this._realizedRows=[],this._realizedColumns=[],this._emptySpaceHeaderCell=null,this._emptyFooterSpaceCell=null},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColumnsProportionally",{get:function(){return this._fillColumnsProportionally},set:function(e){this._fillColumnsProportionally!==e&&(this._fillColumnsProportionally=e,this._presenter.onFillColumnsProportionallyChanged(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedColumns",{get:function(){return this._realizedColumns},set:function(e){this._realizedColumns=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"realizedRows",{get:function(){return this._realizedRows},set:function(e){this._realizedRows=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerRow",{get:function(){return this._footerRow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceHeaderCell",{get:function(){return this._emptySpaceHeaderCell},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptySpaceFooterCell",{get:function(){return this._emptyFooterSpaceCell},enumerable:!0,configurable:!0}),e.prototype.ShowEmptySpaceCells=function(e,t){0!==this._realizedRows.length&&(0===this._realizedRows.length||this._emptySpaceHeaderCell||(this._emptySpaceHeaderCell=this._realizedRows[0].getOrCreateEmptySpaceCell(),this._emptySpaceHeaderCell.rowSpan=e,this._emptySpaceHeaderCell.colSpan=1,this._emptySpaceHeaderCell.setContainerWidth(t)),this._footerRow&&null===this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell=this._footerRow.getOrCreateEmptySpaceCell(),this._emptyFooterSpaceCell.rowSpan=1,this._emptyFooterSpaceCell.colSpan=1,this._emptyFooterSpaceCell.setContainerWidth(t)))},e.prototype.HideEmptySpaceCells=function(){this._emptySpaceHeaderCell&&(this._emptySpaceHeaderCell.clear(),this._emptySpaceHeaderCell=null),this._emptyFooterSpaceCell&&(this._emptyFooterSpaceCell.clear(),this._emptyFooterSpaceCell=null)},e.prototype.onStartRenderingSession=function(e){e&&(this.clearRows(),this.clearColumns())},e.prototype.onStartRenderingIteration=function(){this.initializeRows(),this.initializeColumns()},e.prototype.onEndRenderingIteration=function(){var e=this._rows;if(void 0!==e)for(var t=e.length,i=0;i<t;i++)e[i].releaseUnusedCells(this._owner);this._footerRow&&this._footerRow.releaseUnusedCells(this._owner)},e.prototype.getOrCreateRow=function(e){var t=this._rows[e];return void 0===t&&(t=new a(this._presenter.createRowPresenter()),t.initialize(this),this._presenter.onAppendRow(t),this._rows[e]=t),void 0===this._realizedRows[e]&&(this._realizedRows[e]=t),t},e.prototype.getOrCreateFootersRow=function(){return null===this._footerRow&&(this._footerRow=new a(this._presenter.createRowPresenter()),this._footerRow.initialize(this),this._presenter.onAddFooterRow(this._footerRow)),this._footerRow},e.prototype.moveRowsToEnd=function(e,t){for(var i=0;i<t;i++){var a=this._rows[i+e];a.unfixSize(),this._presenter.onRemoveRow(a),this._presenter.onAppendRow(a),this._rows.push(a)}this._rows.splice(e,t)},e.prototype.moveRowsToStart=function(e,t){for(var i=this._rows[e],a=0;a<t;a++){var r=this._rows.pop();r.unfixSize(),this._presenter.onRemoveRow(r),this._presenter.onInsertRowBefore(r,i),this._rows.splice(e+a,0,r)}},e.prototype.moveColumnsToEnd=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToEnd(t);for(var r=0;r<t;r++){var n=this._columns[r+e];this._columns.push(n)}this._columns.splice(e,t)},e.prototype.moveColumnsToStart=function(e,t){for(var i=this._rows[0]._realizedCornerCells.length,a=Math.max(this._columns[i]._realizedColumnHeaders.length-1,0),r=a;r<this._rows.length;r++)this._rows[r].moveScrollableCellsToStart(t);for(var r=0;r<t;r++){var n=this._columns.pop();this._columns.splice(e+r,0,n)}},e.prototype.getOrCreateColumn=function(e){var t=this._columns[e];return void 0===t&&(t=new i(this._presenter.createColumnPresenter(e),e),t.initialize(this),this._columns[e]=t),void 0===this._realizedColumns[e]&&(this._realizedColumns[e]=t),t},e.prototype.initializeColumns=function(){this._columns||(this._columns=[]);for(var e=this._columns.length,t=0;t<e;t++)this._columns[t].initialize(this);this._realizedColumns=[]},e.prototype.clearColumns=function(){this._columns=null,this._realizedColumns=null},e.prototype.initializeRows=function(){var e=this._owner.rowDimension.hasFooter()&&null!==this._footerRow;this._realizedRows=[],this._rows||(this._rows=[]);for(var t=this._rows,i=t.length,a=0;a<i;a++)t[a].initialize(this);e&&(this._footerRow||this.getOrCreateFootersRow(),this._footerRow.initialize(this))},e.prototype.clearRows=function(){var e=this._rows;if(e){for(var t=e.length,i=0;i<t;i++)e[i].releaseAllCells(this._owner);this._footerRow&&this._footerRow.releaseAllCells(this._owner),this._presenter.onClear(),this._footerRow=null,this._rows=null,this._realizedRows=null}},e.prototype.getWidth=function(){return this._presenter.getWidth()},e.prototype.getHeight=function(){return this._presenter.getHeight()},e})();e.TablixGrid=r})(t=e.internal||(e.internal={}))})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(i){var n=a.PixelConverter,o=(function(){function e(){}return Object.defineProperty(e.prototype,"visibleWidth",{get:function(){return this._viewport?this._viewport.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleHeight",{get:function(){return this._viewport?this._viewport.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridWidth",{get:function(){return this.visibleWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridHeight",{get:function(){return this.visibleHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this._cellWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._cellWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._cellHeight},enumerable:!0,configurable:!0}),e.prototype.updateColumnCount=function(e){this._columnCount=e},e.prototype.updateRowHeight=function(e){this._cellHeight=e},e.prototype.updateScalingFactor=function(e){this._scalingFactor=e,this._cellWidth=this.computeColumnWidth(this._columnCount)},e.prototype.updateViewport=function(e){this._viewport=e,this._cellWidth=this.computeColumnWidth(this._columnCount),this._cellHeight=this.computeColumnHeight()},e.prototype.computeColumnWidth=function(t){var i=this._scalingFactor;i||(i=1);var a=i*e.TablixMinimumColumnWidth,r=Math.floor(this._viewport.width/a);return this.fitToColumnCount(r,t)},e.prototype.computeColumnHeight=function(){if(!this.hasImageContent)return this._cellHeight;var e=this._viewport.width;return e<=250?20:e<=510?51:e<=770?52:void 0},e.prototype.fitToColumnCount=function(e,t){var i=Math.min(e,t);return Math.floor(this._viewport.width/i)},e.TablixMinimumColumnWidth=75,e})();i.SizeComputationManager=o;var s=(function(){function t(e,t,i){this._owner=e,this._grid=t,this._lastScrollOffset=null,this._isScrolling=!1,this._fixedSizeEnabled=!0,this._done=!1,this._realizationManager=i}return Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"realizationManager",{get:function(){return this._realizationManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedSizeEnabled",{get:function(){return this._fixedSizeEnabled},set:function(e){this._fixedSizeEnabled=e},enumerable:!0,configurable:!0}),t.prototype.onCornerCellRealized=function(e,t,i){this._realizationManager.onCornerCellRealized(e,t)},t.prototype.onHeaderRealized=function(e,t,i){this._realizationManager.onHeaderRealized(e,t,i)},Object.defineProperty(t.prototype,"needsToRealize",{get:function(){return this._realizationManager.needsToRealize},enumerable:!0,configurable:!0}),t.prototype.getVisibleSizeRatio=function(){return 1-this.dimension.getFractionScrollOffset()},Object.defineProperty(t.prototype,"alignToEnd",{get:function(){return this._alignToEnd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return this._done},enumerable:!0,configurable:!0}),t.prototype._requiresMeasure=function(){return!0},t.prototype.startScrollingSession=function(){this._isScrolling=!0},t.prototype.endScrollingSession=function(){this._isScrolling=!1},t.prototype.isScrolling=function(){return this._isScrolling},t.prototype.isResizing=function(){return!1},t.prototype.getOtherHierarchyContextualHeight=function(){var e=this.dimension.otherDimension,t=e.getDepth(),i=0,a=this._getRealizedItems();if(a.length>0)for(var r=0;r<t;r++)i+=a[r].getContextualWidth();return i},t.prototype._isAutoSized=function(){return!1},t.prototype.onStartRenderingSession=function(){this._measureEnabled=this._requiresMeasure(),this._gridOffset=this.dimension.otherDimension.getDepth()},t.prototype.onEndRenderingSession=function(){this._realizationManager.onEndRenderingSession(),this._alignToEnd=!1,this._done=!1,this._measureEnabled=!0,this._sendDimensionsToControl()},t.prototype._sendDimensionsToControl=function(){},Object.defineProperty(t.prototype,"measureEnabled",{get:function(){return this._measureEnabled},enumerable:!0,configurable:!0}),t.prototype.getFooterContextualWidth=function(){return 0},t.prototype.onStartRenderingIteration=function(e,t){this._measureEnabled&&!this._done&&(this._contextualWidthToFill=(t-this.otherScrollbarContextualWidth)*this.getGridScale()-this.getFooterContextualWidth()),this._realizationManager.onStartRenderingIteration(),e?this._lastScrollOffset=null:null!==this._lastScrollOffset&&this.swapElements()},Object.defineProperty(t.prototype,"allItemsRealized",{get:function(){return this.getRealizedItemsCount()-this._gridOffset===this.dimension.getItemsCount()||0===this.dimension.getItemsCount()},enumerable:!0,configurable:!0}),t.prototype.onEndRenderingIteration=function(){if(!this._done){if(!this._measureEnabled)return this._lastScrollOffset=this.dimension.scrollOffset,void(this._done=!0);var i,a=this.getGridContextualWidth(),r=e.Double.greaterOrEqualWithPrecision(a,this._contextualWidthToFill,t._pixelPrecision),n=this.allItemsRealized;i=r?this.scrollForwardToAlignEnd(a):this.scrollBackwardToFill(a),this._realizationManager.onEndRenderingIteration(a,r);var o=this.dimension.scrollbar.visible;this.updateScrollbar(a),this._done=(r||n)&&this.dimension.scrollbar.visible===o&&e.Double.equalWithPrecision(i,this.dimension.scrollOffset,t._scrollOffsetPrecision),this.dimension.scrollOffset=i,this._lastScrollOffset=this.dimension.scrollOffset}},t.prototype.getScrollDeltaWithinPage=function(){if(null!==this._lastScrollOffset){var e=this.dimension.getIntegerScrollOffset()-Math.floor(this._lastScrollOffset);if(Math.abs(e)<this.getRealizedItemsCount()-this.dimension.otherDimension.getDepth())return e}return null},t.prototype.swapElements=function(){var e=this.getScrollDeltaWithinPage();if(null!==e){var t=this.dimension.otherDimension.getDepth();Math.abs(e)<this.getRealizedItemsCount()-t&&(e>0?this._moveElementsToBottom(t,e):e<0&&this._moveElementsToTop(t,-e))}},t.prototype._getRealizedItems=function(){return null},t.prototype.getRealizedItemsCount=function(){var e=this._getRealizedItems();return e.length},t.prototype._moveElementsToBottom=function(e,t){},t.prototype._moveElementsToTop=function(e,t){},t.prototype.isScrollingWithinPage=function(){return null!==this.getScrollDeltaWithinPage()},t.prototype.getGridContextualWidth=function(){return 0},t.prototype.updateScrollbar=function(e){var t=this.dimension.scrollbar;t.viewMin=this.dimension.scrollOffset,t.min=0,t.max=this.dimension.getItemsCount(),t.viewSize=this.getViewSize(e),this.dimension.scrollbar.show(this.canScroll(e))},t.prototype.getViewSize=function(i){var a=this.getRealizedItemsCount();if(0===a)return 0;for(var r=this._gridOffset,n=0,o=0,s=this._contextualWidthToFill,l=s-this.getOtherHierarchyContextualHeight(),u=this.getMeaurementError(i),c=r;c<a;c++){var d=void 0;d=c===r?this.getVisibleSizeRatio():1;var p=this.getItemContextualWidthWithScrolling(c)*u;if(o+=p,n+=d,e.Double.greaterWithPrecision(o,l,t._pixelPrecision)){n-=(o-l)/p*d;break}}return n},t.prototype.isScrollableHeader=function(e,t,i){if(0!==i||0===this.dimension.getFractionScrollOffset())return!1;var a=this.dimension._hierarchyNavigator;if(a.isLeaf(e))return!0;var r=e,n=t;do{if(n=a.getChildren(r),r=this.dimension.getFirstVisibleItem(a.getLevel(r)+1),void 0===r)break;if(!a.isLastItem(r,n))return!1}while(!a.isLeaf(r));return!0},t.prototype.reachedEnd=function(){return this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},t.prototype.scrollBackwardToFill=function(i){var a=this.dimension.scrollOffset;if(this.reachedEnd()){var r=this._contextualWidthToFill-i;if(this.dimension.getItemsCount()>0){var n=i/(this.getRealizedItemsCount()-this.dimension.getFractionScrollOffset());a=this.dimension.getValidScrollOffset(Math.floor(this.dimension.scrollOffset-r/n))}this._alignToEnd=!e.Double.equalWithPrecision(a,this.dimension.scrollOffset,t._scrollOffsetPrecision)}return a},t.prototype.getItemContextualWidth=function(e){var t=this._getRealizedItems();return e>=t.length?null:t[e].getContextualWidth()},t.prototype.getItemContextualWidthWithScrolling=function(e){return this.getSizeWithScrolling(this.getItemContextualWidth(e),e)},t.prototype.getSizeWithScrolling=function(e,t){var i;return i=this._gridOffset===t?this.getVisibleSizeRatio():1,e*i},t.prototype.getGridContextualWidthFromItems=function(){for(var e=this.getRealizedItemsCount(),t=0,i=0;i<e;i++)t+=this.getItemContextualWidthWithScrolling(i);return t},t.prototype.getMeaurementError=function(e){return e/this.getGridContextualWidthFromItems()},t.prototype.scrollForwardToAlignEnd=function(i){var a=this.dimension.scrollOffset;if(this._alignToEnd){var r=e.Double.equalWithPrecision(i,this._contextualWidthToFill,t._pixelPrecision);if(!r)for(var n=this.getRealizedItemsCount(),o=this._gridOffset,s=i-this._contextualWidthToFill,l=this.getMeaurementError(i),u=o;u<n;u++){var c=this.getItemContextualWidth(u)*l;if(!e.Double.lessWithPrecision(c,s,t._pixelPrecision)){var d=o===u?1-this.dimension.getFractionScrollOffset():1;a=this.dimension.getValidScrollOffset(this.dimension.scrollOffset+(u-o)+s*d/c);break}s-=c}this._alignToEnd=!r}return a},Object.defineProperty(t.prototype,"dimension",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherLayoutManager",{get:function(){return this.dimension.otherDimension.layoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextualWidthToFill",{get:function(){return this._contextualWidthToFill},enumerable:!0,configurable:!0}),t.prototype.getGridScale=function(){return 0},Object.defineProperty(t.prototype,"otherScrollbarContextualWidth",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.getActualContextualWidth=function(e){return this._isAutoSized()&&!this.canScroll(e)?e:this._contextualWidthToFill},t.prototype.canScroll=function(e){return!1},t.prototype.calculateSizes=function(){this.fixedSizeEnabled&&(this.calculateContextualWidths(),this.calculateSpans())},t.prototype._calculateSize=function(e){return null},t.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),t=e.length,i=0;i<t;i++){var a=e[i];this.measureEnabled&&a.setAligningContextualWidth(-1),this._calculateSize(a)}},t.prototype.calculateSpans=function(){this.measureEnabled&&(this.updateNonScrollableItemsSpans(),this.updateScrollableItemsSpans())},t.prototype.updateNonScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=e.length,i=this.dimension.getDepth(),a=i;a<t;a++){var r=e[a];this.updateSpans(r,r.getHeaders(),!1)}},t.prototype.updateScrollableItemsSpans=function(){for(var e=this.otherLayoutManager._getRealizedItems(),t=Math.min(this.dimension.getDepth(),e.length),i=0;i<t;i++){var a=e[i];this.updateSpans(a,a.getOtherDimensionHeaders(),!0)}},t.prototype.fixSizes=function(){if(this.fixedSizeEnabled)for(var e=this._getRealizedItems(),t=e.length,i=t-1;i>=0;i--)e[i].fixSize()},t.prototype.updateSpans=function(e,t,i){for(var a=this._getRealizedItems(),r=t.length,n=0;n<r;n++){var o=t[n],s=e.getOtherDimensionOwner(o),l=s.getCellContextualSpan(o);if(l>1)for(var u=0,c=s.getIndex(this._grid),d=0;d<l;d++){var p=a[d+c],h=p.getContentContextualWidth();i&&0===n&&0===d&&(h=Math.floor((1-this.dimension.getFractionScrollOffset())*h)),u+=h,d===l-1&&this.updateLastChildSize(o,p,u)}}},t.prototype.updateLastChildSize=function(e,t,i){var a=t.getCellIContentContextualWidth(e)-i;a>0&&t.setAligningContextualWidth(Math.max(t.getAligningContextualWidth(),a+t.getContentContextualWidth()))},t._pixelPrecision=1.0001,t._scrollOffsetPrecision=.01,t})();i.DimensionLayoutManager=s;var l=(function(){function e(e,t,i){this.column=e,this.item=e.getLeafItem(),this.itemType=e.itemType,this.startColumnWidth=t,this.resizingDelta=0,this.animationFrame=null,this.scale=i}return e.prototype.getNewSize=function(){return this.startColumnWidth+this.resizingDelta},e})();i.ResizeState=l;var u=(function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this,this.fillProportionally=!1,this._resizeState=null}return r(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.columnDimension},enumerable:!0,configurable:!0}),i.prototype.isResizing=function(){return null!==this._resizeState},Object.defineProperty(i.prototype,"fillProportionally",{get:function(){return this._grid.fillColumnsProportionally},set:function(e){this._grid.fillColumnsProportionally=e},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioX()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementWidth(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype._getRealizedItems=function(){return this._grid.realizedColumns||(this._grid.realizedColumns=[]),this._grid.realizedColumns},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveColumnsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveColumnsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()||this.isScrolling()||this.isResizing()},i.prototype.getGridContextualWidth=function(){return this._grid.getWidth()},i.prototype.getFirstVisibleColumn=function(){return this._grid.realizedColumns[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeWidth},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleColumn();if(void 0!==i){t=i.getContextualWidth();var a=Math.ceil(-t*e);this.scroll(i,t,a)}}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedColumnHeaders,t,i),this.scrollBodyCells(this._grid.realizedRows,t,i),null!==e.footer&&e.footer.scrollHorizontally(t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;r<a;r++)e[r].scrollHorizontally(t,i)},i.prototype.scrollBodyCells=function(e,t,i){for(var a,r,n=e.length,o=0;o<n;o++)a=e[o]._realizedBodyCells,void 0!==a&&(r=a[0],void 0!==r&&r.scrollHorizontally(t,i))},i.prototype.onStartResize=function(e,i,a){this._resizeState=new l(e._column,e._column.getContentContextualWidth(),t.HTMLElementUtils.getAccumulatedScale(this.owner.owner.container))},i.prototype.onResize=function(e,t,a){var r=this;this.isResizing()&&(this._resizeState.resizingDelta=Math.round(Math.max(t/this._resizeState.scale,i.minColumnWidth-this._resizeState.startColumnWidth)),null===this._resizeState.animationFrame&&(this._resizeState.animationFrame=requestAnimationFrame((function(){return r.performResizing()}))))},i.prototype.onEndResize=function(e){this.isResizing()&&null!==this._resizeState.animationFrame&&this.performResizing(),this.endResizing(),this._resizeState=null},i.prototype.onReset=function(e){this._resizeState=new l(e._column,(-1),1),e._column.clearSize(),this.endResizing(),this.owner.owner.refresh(!1),this._resizeState=null},i.prototype.updateItemToResizeState=function(e){if(null!==this._resizeState)for(var t=e.length,i=this.owner.owner.hierarchyNavigator,a=this.otherLayoutManager.dimension.getDepth(),r=a;r<t;r++){var n=e[r];if(n.columnHeaderOrCornerEquals(this._resizeState.itemType,this._resizeState.item,n.itemType,n.getLeafItem(),i)&&n!==this._resizeState.column){this._resizeState.column=n,n.onResize(this._resizeState.getNewSize());break}}},i.prototype.performResizing=function(){if(null!==this._resizeState){this._resizeState.animationFrame=null;var e=this._resizeState.getNewSize();this._resizeState.column.onResize(e),this.owner.owner.refresh(!1)}},i.prototype.endResizing=function(){if(null!==this._resizeState){var e=this._resizeState.getNewSize();this._resizeState.column.onResizeEnd(e)}},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateColumnDimensions(i/a,(t-i)/a,this.getViewSize(e))},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i.prototype.getEstimatedBodyCellWidth=function(e){return-1},i.minColumnWidth=10,i})(s);i.ColumnLayoutManager=u;var c=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.ignoreColumn(t)?0:this.owner.getCellWidth(void 0)},t.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getCellWidth(void 0)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){var t=e.getIndex(this._grid),i=0;return this.ignoreColumn(t)||(i=this.owner.getContentWidth(void 0)),e.onResize(i),e.onResizeEnd(i),i},t.prototype.ignoreColumn=function(e){return 0===e&&!this.owner.binder.hasRowGroups()},t})(u);i.DashboardColumnLayoutManager=c;var d=(function(i){function a(){i.apply(this,arguments)}return r(a,i),a.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},a.prototype.getEstimatedBodyCellWidth=function(e){return this.owner.getEstimatedTextWidth(e)},a.prototype.calculateContextualWidths=function(){for(var e=this._getRealizedItems(),i=[],a=0,r=e.length;a<r;a++){var n=e[a];this.measureEnabled&&n.setAligningContextualWidth(-1);var o=t.TablixColumnWidthManager.getColumnQueryName(n);null!=o&&i.push({queryName:o,width:this._calculateSize(n),isFixed:!1})}this.owner.columnWidthsToPersist=i},a.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,s._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,s._pixelPrecision)},a.prototype._calculateSize=function(e){return e.calculateSize()},a})(u);i.CanvasColumnLayoutManager=d;var p=(function(e){function i(t,i,a){e.call(this,t,i,a),a.owner=this}return r(i,e),Object.defineProperty(i.prototype,"dimension",{get:function(){return this.owner.owner.rowDimension},enumerable:!0,configurable:!0}),i.prototype.getGridScale=function(){return this._grid._presenter.getScreenToCssRatioY()},Object.defineProperty(i.prototype,"otherScrollbarContextualWidth",{get:function(){return this.dimension.otherDimension.scrollbar.visible?t.HTMLElementUtils.getElementHeight(this.dimension.otherDimension.scrollbar.element):0},enumerable:!0,configurable:!0}),i.prototype.startScrollingSession=function(){e.prototype.startScrollingSession.call(this)},i.prototype._getRealizedItems=function(){return this._grid.realizedRows||(this._grid.realizedRows=[]),this._grid.realizedRows},i.prototype._moveElementsToBottom=function(e,t){this._grid.moveRowsToEnd(e,t)},i.prototype._moveElementsToTop=function(e,t){this._grid.moveRowsToStart(e,t)},i.prototype._requiresMeasure=function(){return!this.isScrolling()&&!this.otherLayoutManager.isScrolling()&&!this.otherLayoutManager.isResizing()||this.isScrolling()&&this.dimension.getIntegerScrollOffset()+(this.getRealizedItemsCount()-this._gridOffset)>=this.dimension.getItemsCount()},i.prototype.getGridContextualWidth=function(){return this._grid.getHeight()},i.prototype.getFirstVisibleRow=function(){return this._grid.realizedRows[this._gridOffset]},i.prototype._isAutoSized=function(){return this.owner.owner.autoSizeHeight},i.prototype.applyScrolling=function(){var e=this.dimension.getFractionScrollOffset(),t=0;if(0!==e){var i=this.getFirstVisibleRow();i&&(t=i.getContextualWidth(),this.scroll(i,t,e))}},i.prototype.scroll=function(e,t,i){this.scrollCells(e._realizedRowHeaders,t,i),this.scrollCells(e._realizedBodyCells,t,i)},i.prototype.scrollCells=function(e,t,i){for(var a=e.length,r=0;r<a;r++)e[r].scrollVertically(t,i)},i.prototype.getFooterContextualWidth=function(){return this.owner.owner.rowDimension.hasFooter()&&this.owner.grid.footerRow?this.owner.grid.footerRow.getContextualWidth():0},i.prototype.calculateContextualWidths=function(){if(e.prototype.calculateContextualWidths.call(this),this.fixedSizeEnabled){var t=this._grid.footerRow;t&&this._calculateSize(t)}},i.prototype.fixSizes=function(){e.prototype.fixSizes.call(this),this.fixedSizeEnabled&&this._grid.footerRow&&this._grid.footerRow.fixSize()},i.prototype._sendDimensionsToControl=function(){var e=this.getGridContextualWidth(),t=this.getActualContextualWidth(e),i=this.getOtherHierarchyContextualHeight(),a=this.getGridScale();this.owner.owner.updateRowDimensions(i/a,(t-i)/a,e/a,this.getViewSize(e),this._grid.footerRow?this._grid.footerRow.getContextualWidth()/a:0)},i.prototype.getEstimatedHeaderWidth=function(e,t){return-1},i})(s);i.RowLayoutManager=p;var h=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.getEstimatedHeaderWidth=function(e,t){return this.getHeaderWidth(t)},t.prototype.canScroll=function(e){return!1},t.prototype._calculateSize=function(e){return e.calculateSize()},t.prototype.getHeaderWidth=function(e){return 0!==e||this.owner.binder.hasRowGroups()?this.owner.getEstimatedTextWidth(void 0):0},t})(p);i.DashboardRowLayoutManager=h;var g=(function(t){function i(){t.apply(this,arguments)}return r(i,t),i.prototype.getEstimatedHeaderWidth=function(e,t){return this.owner.getEstimatedTextWidth(e)},i.prototype.canScroll=function(t){return!e.Double.equalWithPrecision(this.dimension.scrollOffset,0,s._scrollOffsetPrecision)||this.getRealizedItemsCount()-this._gridOffset<this.dimension.getItemsCount()&&this._contextualWidthToFill>0||e.Double.greaterWithPrecision(t,this._contextualWidthToFill,s._pixelPrecision)},i.prototype._calculateSize=function(e){return e.calculateSize()},i})(p);i.CanvasRowLayoutManager=g;var f=(function(){function e(e,t,i,a){this._allowHeaderResize=!0,this._binder=e,this._grid=t,this._columnLayoutManager=i,this._rowLayoutManager=a,this._columnWidthsToPersist=[]}return e.prototype.initialize=function(e){this._owner=e,this._container=e.container,this._gridHost=e.contentHost,this._footersHost=e.footerHost,this._grid.initialize(e,this._gridHost,this._footersHost)},Object.defineProperty(e.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binder",{get:function(){return this._binder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnWidthsToPersist",{get:function(){return this._columnWidthsToPersist},set:function(e){this._columnWidthsToPersist=e},enumerable:!0,configurable:!0}),e.prototype.getTablixClassName=function(){return null},e.prototype.getLayoutKind=function(){return null},e.prototype.getOrCreateColumnHeader=function(e,t,i,a){var r=this.owner.hierarchyNavigator,n=this._grid.getOrCreateRow(i),o=this._grid.getOrCreateColumn(a+this._columnLayoutManager._gridOffset),s=r.isLeaf(e),l=n.getOrCreateColumnHeader(o,this._columnLayoutManager.isScrollableHeader(e,t,a),s),u=r.getLevel(e);l.position.row.index=l.position.row.indexInSiblings=u,l.position.row.isFirst=0===u,l.position.row.isLast=s;var c=r.getIndex(e);return l.position.column.index=l.position.row.indexInSiblings=c,l.position.column.isFirst=r.areAllParentsFirst(e,t),l.position.column.isLast=r.areAllParentsLast(e,t),this.enableCellHorizontalResize(s,l),l},e.prototype.getOrCreateRowHeader=function(e,t,i,a){var r=this.owner.hierarchyNavigator,n=this._grid.getOrCreateRow(i+this._rowLayoutManager._gridOffset),o=this._grid.getOrCreateColumn(a),s=r.isLeaf(e),l=this._rowLayoutManager.isScrollableHeader(e,t,i);0===n.getRealizedCellCount()&&this.alignRowHeaderCells(e,n);var u=n.getOrCreateRowHeader(o,l,r.isLeaf(e)),c=r.getIndex(e);u.position.row.index=u.position.row.indexInSiblings=c,u.position.row.isFirst=r.areAllParentsFirst(e,t),u.position.row.isLast=r.areAllParentsLast(e,t);var d=r.getLevel(e);return u.position.column.index=u.position.column.indexInSiblings=d,u.position.column.isFirst=0===d,u.position.column.isLast=s,u.enableHorizontalResize(!1,this._columnLayoutManager),u},e.prototype.getOrCreateCornerCell=function(e,t,i){var a=this._grid.getOrCreateRow(i),r=this._grid.getOrCreateColumn(t),n=this._columnLayoutManager.dimension.getDepth(),o=i===n-1,s=a.getOrCreateCornerCell(r),l=i;s.position.row.index=s.position.row.indexInSiblings=l,s.position.row.isFirst=0===l,s.position.row.isLast=o;var u=t;return s.position.column.index=s.position.column.indexInSiblings=u,s.position.column.isFirst=0===u,s.position.column.isLast=u===this._rowLayoutManager.dimension.getDepth()-1,this.enableCellHorizontalResize(o,s),s},e.prototype.getOrCreateBodyCell=function(e,t,i,a,r){var n,o=this._grid.getOrCreateRow(a+this._rowLayoutManager._gridOffset),s=this._grid.getOrCreateColumn(r+this._columnLayoutManager._gridOffset);
n=0===o._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset()||this._rowLayoutManager.isScrollableHeader(t,i,a);var l=o.getOrCreateBodyCell(s,n);return l.position=e.position,l.enableHorizontalResize(!1,this._columnLayoutManager),l},e.prototype.getOrCreateFooterBodyCell=function(e,t){var i,a=this._grid.getOrCreateFootersRow(),r=this._grid.getOrCreateColumn(t+this._columnLayoutManager._gridOffset);i=0===a._realizedBodyCells.length&&0!==this._owner.columnDimension.getFractionScrollOffset();var n=a.getOrCreateFooterBodyCell(r,i);return n.position=e.position,n.enableHorizontalResize(!1,this._columnLayoutManager),n},e.prototype.getOrCreateFooterRowHeader=function(e,t){var i=this._grid.getOrCreateFootersRow(),a=this._grid.getOrCreateColumn(0),r=i.getOrCreateFooterRowHeader(a);return r.position=void 0,r.enableHorizontalResize(!1,this._columnLayoutManager),r},e.prototype.getVisibleWidth=function(){return-1},e.prototype.getVisibleHeight=function(){return-1},e.prototype.updateColumnCount=function(e,t){},e.prototype.updateViewport=function(e){},e.prototype.getEstimatedRowHeight=function(){return-1},e.prototype.getCellWidth=function(e){return-1},e.prototype.getContentWidth=function(e){return-1},e.prototype.adjustContentSize=function(e){},e.prototype.alignRowHeaderCells=function(e,t){var i=t.getRowHeaderLeafIndex();if(i!==-1){var a=this._owner.rowDimension,r=a.getFirstVisibleChildLeaf(e);this.owner.hierarchyNavigator.headerItemEquals(r,t.getAllocatedCellAt(i).item)&&t.moveCellsBy(this.owner.hierarchyNavigator.getLevel(r)-this.owner.hierarchyNavigator.getLevel(e)-i)}},Object.defineProperty(e.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowLayoutManager",{get:function(){return this._rowLayoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnLayoutManager",{get:function(){return this._columnLayoutManager},enumerable:!0,configurable:!0}),e.prototype.showEmptySpaceHeader=function(){return!1},e.prototype.onStartRenderingSession=function(e,t,i){if(this.showEmptySpaceHeader()){var a=this._grid.emptySpaceHeaderCell;a&&this._binder.unbindEmptySpaceHeaderCell(a),a=this._grid.emptySpaceFooterCell,a&&this._binder.unbindEmptySpaceFooterCell(a),this._grid.HideEmptySpaceCells()}this._scrollingDimension=e,this._scrollingDimension&&this._scrollingDimension.layoutManager.startScrollingSession(),this._rowLayoutManager.onStartRenderingSession(),this._columnLayoutManager.onStartRenderingSession(),this._grid.onStartRenderingSession(i);var r=this._columnLayoutManager.measureEnabled||this._rowLayoutManager.measureEnabled;r&&this.measureSampleText(t)},e.prototype.onEndRenderingSession=function(){if(this._rowLayoutManager.onEndRenderingSession(),this._columnLayoutManager.onEndRenderingSession(),this._scrollingDimension&&this._scrollingDimension.layoutManager.endScrollingSession(),this._scrollingDimension=null,this.showEmptySpaceHeader()){var e=this._columnLayoutManager.contextualWidthToFill-this._columnLayoutManager.getGridContextualWidth();if(e>0){this._grid.ShowEmptySpaceCells(this._owner.columnDimension.getDepth(),e);var t=this._grid.emptySpaceHeaderCell;t&&this._binder.bindEmptySpaceHeaderCell(t),t=this._grid.emptySpaceFooterCell,t&&this._binder.bindEmptySpaceFooterCell(t)}}},e.prototype.onStartRenderingIteration=function(e){this._rowLayoutManager.onStartRenderingIteration(e,this.getVisibleHeight()),this._columnLayoutManager.onStartRenderingIteration(e,this.getVisibleWidth()),this._grid.onStartRenderingIteration()},e.prototype.onEndRenderingIteration=function(){return this._grid.onEndRenderingIteration(),this._columnLayoutManager.calculateSizes(),this._rowLayoutManager.calculateSizes(),this._columnLayoutManager.fixSizes(),this._rowLayoutManager.fixSizes(),this._columnLayoutManager.updateItemToResizeState(this._grid.realizedColumns),this._columnLayoutManager.applyScrolling(),this._rowLayoutManager.applyScrolling(),this._columnLayoutManager.onEndRenderingIteration(),this._rowLayoutManager.onEndRenderingIteration(),this._columnLayoutManager.done&&this._rowLayoutManager.done},e.prototype.onCornerCellRealized=function(e,t){var i=this.owner.hierarchyNavigator.isColumnHierarchyLeaf(e),a=this.owner.hierarchyNavigator.isRowHierarchyLeaf(e);i&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onCornerCellRealized(e,t,i),this._rowLayoutManager.onCornerCellRealized(e,t,a)},e.prototype.onRowHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e),r=t;r.colSpan>1&&r.setContainerWidth(-1),this._rowLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onRowHeaderFooterRealized=function(e,t){},e.prototype.onColumnHeaderRealized=function(e,t){var i=this._owner.hierarchyNavigator,a=i.isLeaf(e);a&&t._column.OnLeafRealized(this._owner.hierarchyNavigator),this._columnLayoutManager.onHeaderRealized(e,t,a)},e.prototype.onBodyCellRealized=function(e,t){},e.prototype.onBodyCellFooterRealized=function(e,t){},e.prototype.setAllowHeaderResize=function(e){this._allowHeaderResize=e},e.prototype.enableCellHorizontalResize=function(e,t){var i=e&&this._allowHeaderResize;t.enableHorizontalResize(i,this._columnLayoutManager)},e.prototype.getEstimatedTextWidth=function(e){return-1},e.prototype.measureSampleText=function(e){},e})();i.TablixLayoutManager=f;var m=(function(a){function s(e,t,i,r,n){var o=new c(null,i,n),s=new h(null,i,r);a.call(this,e,i,o,s),o.owner=this,s.owner=this,this._sizeComputationManager=t}return r(s,a),s.createLayoutManager=function(e){var t=new o;return new s(e,t,new i.TablixGrid(new i.DashboardTablixGridPresenter(t)),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},s.prototype.getTablixClassName=function(){return"tablixDashboard"},s.prototype.getLayoutKind=function(){return 1},s.prototype.showEmptySpaceHeader=function(){return!1},s.prototype.measureSampleText=function(i){var a=e.TextMeasurementService.getSvgMeasurementProperties(i);this._characterHeight=e.TextMeasurementService.estimateSvgTextHeight(a),this._sizeComputationManager.updateRowHeight(this._characterHeight);var r=n.toPoint(parseFloat(a.fontSize)),o=r/t.TablixDefaultTextSize;this._sizeComputationManager.updateScalingFactor(e.Double.toIncrement(o,.05))},s.prototype.getVisibleWidth=function(){return this._sizeComputationManager.visibleWidth},s.prototype.getVisibleHeight=function(){return this._sizeComputationManager.visibleHeight},s.prototype.getCellWidth=function(e){return this._sizeComputationManager.cellWidth},s.prototype.getContentWidth=function(e){return this._sizeComputationManager.contentWidth},s.prototype.getEstimatedTextWidth=function(e){return this._sizeComputationManager.contentWidth},s.prototype.adjustContentSize=function(e){this._sizeComputationManager.hasImageContent=e},s.prototype.updateColumnCount=function(e,t){var i=e?e.getDepth():0,a=t?t.getItemsCount():0,r=i+a;this.binder.hasRowGroups()||r--,this._sizeComputationManager.updateColumnCount(r)},s.prototype.updateViewport=function(e){this._sizeComputationManager.updateViewport(e)},s.prototype.getEstimatedRowHeight=function(){return this._characterHeight},s})(f);i.DashboardTablixLayoutManager=m;var y=(function(e){function a(t,i,a,r){var n=new d(null,i,r),o=new g(null,i,a);e.call(this,t,i,n,o),n.owner=this,o.owner=this}return r(a,e),a.createLayoutManager=function(e,r){return new a(e,new i.TablixGrid(new t.internal.CanvasTablixGridPresenter(r)),new i.RowRealizationManager(e),new i.ColumnRealizationManager(e))},a.prototype.getTablixClassName=function(){return"tablixCanvas"},a.prototype.getLayoutKind=function(){return 0},a.prototype.measureSampleText=function(e){var i=t.internal.TablixUtils.createDiv();i.style.cssFloat="left",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.lineHeight="normal",e.appendChild(i);var a=document.createTextNode("a");i.appendChild(a),this.characterWidth=t.HTMLElementUtils.getElementWidth(i),this.characterHeight=t.HTMLElementUtils.getElementHeight(i),i.removeChild(a),e.removeChild(i)},a.prototype.showEmptySpaceHeader=function(){return!this._columnLayoutManager.fillProportionally},a.prototype.getVisibleWidth=function(){return this._columnLayoutManager.measureEnabled?this._owner.autoSizeWidth&&this._owner.maxWidth?this._owner.maxWidth:t.HTMLElementUtils.getElementWidth(this._container):-1},a.prototype.getVisibleHeight=function(){return this._rowLayoutManager.measureEnabled?this._owner.autoSizeHeight&&this._owner.maxHeight?this._owner.maxHeight:t.HTMLElementUtils.getElementHeight(this._container):-1},a.prototype.getCellWidth=function(e){return e.containerWidth},a.prototype.getContentWidth=function(e){return e.contentWidth},a.prototype.getEstimatedTextWidth=function(e){return e?e.length*this.characterWidth:0},a.prototype.updateColumnCount=function(e,t){},a.prototype.updateViewport=function(e){},a.prototype.getEstimatedRowHeight=function(){return this.characterHeight},a})(f);i.CanvasTablixLayoutManager=y})(i=t.internal||(t.internal={}))})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){if(e)for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function i(e,t){e.style.top=t+"px"}function a(e,t){e.style.left=t+"px"}function r(t,i){e.isAutoSize(i)?t.style.height="":t.style.height=i+"px"}function n(t,i){e.isAutoSize(i)?t.style.width="":t.style.width=i+"px"}function o(e){return e.offsetWidth}function s(e){return e.offsetHeight}function l(e){return e===-1}function u(t){for(var i=1;t;)i*=e.getScale(t),t=t.parentElement;return i}function c(e){e=$(e);var t=e.css("-webkit-transform")||e.css("-moz-transform")||e.css("-ms-transform")||e.css("-o-transform")||e.css("transform");return t&&(t.match(/\d*\.\d*/)&&Number(t.match(/\d*\.\d*/)[0])||t.match(/\d+/)&&Number(t.match(/\d+/)[0]))||1}e.clearChildren=t,e.setElementTop=i,e.setElementLeft=a,e.setElementHeight=r,e.setElementWidth=n,e.getElementWidth=o,e.getElementHeight=s,e.isAutoSize=l,e.getAccumulatedScale=u,e.getScale=c})(t=e.HTMLElementUtils||(e.HTMLElementUtils={}))})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}));var i;!(function(e){var t;!(function(t){var i;!(function(i){var n;!(function(n){var o,s=r.DomFactory,l=e.data.DataViewObjectDefinitions,u=e.data.DataViewRoleWildcard,c=e.data.DataViewMatrixUtils;!(function(t){function r(e){return e&&e.metadata?e.metadata.objects:null}function n(e,a,r){var n,o=[];switch(r){case i.TablixType.Table:n=d(a),o=[u.fromRoles(["Values"])];break;case i.TablixType.Matrix:case i.TablixType.PivotTable:n=p(a),o=[u.fromRoles(["Rows","Columns"])];break;default:return}if(n){for(var s=0,l=n;s<l.length;s++){var c=l[s],h={selector:{data:o,metadata:c.queryName},objects:(g={},g[t.ObjectValues]={formattingProperties:[t.PropValuesBackColor.propertyName]},g)};e.push(h)}var g}}function o(e,a,n,o,l,u){var c=r(n),d=!0;switch(d=o===i.TablixType.Table?L(n)&&V(c):E(n)&&I(c)||N(n)&&M(c),e.objectName){case t.ObjectGeneral:h(a,c,o,n);break;case t.ObjectGrid:g(a,c,o);break;case t.ObjectColumnHeaders:f(a,c,o,u);break;case t.ObjectRowHeaders:m(a,c,o);break;case t.ObjectValues:y(a,c,o);break;case t.ObjectTotal:d&&(o===i.TablixType.Table?v(a,c):w(a,c));break;case t.ObjectSubTotals:(d||o===i.TablixType.PivotTable)&&b(a,c,o,n);break;case t.ObjectColumnFormatting:l&&C(a,s(n,o),o)}}function s(e,t){switch(t){case i.TablixType.Table:return d(e);case i.TablixType.Matrix:case i.TablixType.PivotTable:return p(e);default:return}}function d(e){if(e&&e.table&&!_.isEmpty(e.table.columns))return e.table.columns}function p(e){if(e&&e.matrix&&!_.isEmpty(e.matrix.valueSources))return e.matrix.valueSources}function h(e,a,r,n){var o={selector:null,objectName:t.ObjectGeneral,properties:{}},s=o.properties;switch(r){case i.TablixType.Table:s[t.PropGeneralAutoSizeColumns.propertyName]=t.PropGeneralAutoSizeColumns.getValue(a),s[t.PropGeneralTextSize.propertyName]=t.PropGeneralTextSize.getValue(a),L(n)&&(s[t.PropGeneralTableTotals.propertyName]=V(a));break;case i.TablixType.Matrix:s[t.PropGeneralAutoSizeColumns.propertyName]=t.PropGeneralAutoSizeColumns.getValue(a),s[t.PropGeneralTextSize.propertyName]=t.PropGeneralTextSize.getValue(a),N(n)&&(s[t.PropGeneralMatrixRowSubtotals.propertyName]=M(a)),E(n)&&(s[t.PropGeneralMatrixColumnSubtotals.propertyName]=I(a))}e.pushInstance(o)}function g(e,a,r){var n={selector:null,objectName:t.ObjectGeneral,properties:{}},o=n.properties,s=t.PropGridVertical.getValue(a);o[t.PropGridVertical.propertyName]=s,s&&(o[t.PropGridVerticalColor.propertyName]=t.PropGridVerticalColor.getValue(a),o[t.PropGridVerticalWeight.propertyName]=t.PropGridVerticalWeight.getValue(a));var l=(r===i.TablixType.Table?t.PropGridHorizontalTable:t.PropGridHorizontalMatrix).getValue(a);o[(r===i.TablixType.Table?t.PropGridHorizontalTable:t.PropGridHorizontalMatrix).propertyName]=l,l&&(o[t.PropGridHorizontalColor.propertyName]=t.PropGridHorizontalColor.getValue(a),o[t.PropGridHorizontalWeight.propertyName]=t.PropGridHorizontalWeight.getValue(a)),o[t.PropGridRowPadding.propertyName]=t.PropGridRowPadding.getValue(a),o[t.PropGridOutlineColor.propertyName]=t.PropGridOutlineColor.getValue(a),o[t.PropGridOutlineWeight.propertyName]=t.PropGridOutlineWeight.getValue(a),r===i.TablixType.PivotTable&&(o[t.PropGridPivotTableTextSize.propertyName]=t.PropGridPivotTableTextSize.getValue(a)),o[t.PropGridImageHeight.propertyName]=t.PropGridImageHeight.getValue(a),e.pushInstance(n)}function f(e,a,r,n){var o={selector:null,objectName:t.ObjectColumnHeaders,properties:{fontColor:t.PropColumnsFontColor.getValue(a),backColor:t.PropColumnsBackColor.getValue(a),outline:t.PropColumnsOutline.getValue(a)}},s=o.properties;r===i.TablixType.PivotTable&&(s[t.PropColumnPivotTableAutoSizeColumns.propertyName]=t.PropColumnPivotTableAutoSizeColumns.getValue(a)),r===i.TablixType.Table&&n&&(o.properties[t.PropColumnsWordWrap.propertyName]=t.PropColumnsWordWrap.getValue(a)),e.pushInstance(o)}function m(e,a,r){var n={selector:null,objectName:t.ObjectRowHeaders,properties:{fontColor:t.PropRowsFontColor.getValue(a),backColor:t.PropRowsBackColor.getValue(a),outline:t.PropRowsOutline.getValue(a)}};r===i.TablixType.PivotTable&&(n.properties[t.PropRowsSteppedLayout.propertyName]=t.PropRowsSteppedLayout.getValue(a)),e.pushInstance(n)}function y(e,a,r){var n={selector:null,objectName:t.ObjectValues,properties:{fontColorPrimary:t.PropValuesFontColorPrimary.getValue(a),backColorPrimary:t.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(a),backColorSecondary:t.PropValuesBackColorSecondary.getValue(a),outline:t.PropValuesOutline.getValue(a)}};r===i.TablixType.Table&&(n.properties[t.PropValuesUrlIconProp.propertyName]=t.PropValuesUrlIconProp.getValue(a)),e.pushInstance(n)}function v(e,i){e.pushInstance({selector:null,objectName:t.ObjectTotal,properties:{fontColor:t.PropTotalFontColor.getValue(i),backColor:t.PropTotalBackColor.getValue(i),outline:t.PropTotalOutline.getValue(i)}})}function w(e,i){e.pushInstance({selector:null,objectName:t.ObjectTotal,properties:{fontColor:t.PropGrandTotalFontColor.getValue(i),backColor:t.PropGrandTotalBackColor.getValue(i),applyToHeaders:t.PropGrandTotalApplyToHeaders.getValue(i)}})}function b(e,a,r,n){var o={selector:null,objectName:t.ObjectSubTotals,properties:{fontColor:t.PropSubTotalsFontColor.getValue(a),backColor:t.PropSubTotalsBackColor.getValue(a)}},s=o.properties;r===i.TablixType.PivotTable&&(N(n)&&(s[t.PropSubTotalsPivotTableRowSubtotals.propertyName]=A(a)),E(n)&&(s[t.PropSubTotalsPivotTableColumnSubtotals.propertyName]=O(a))),e.pushInstance(o)}function C(e,a,r){for(var n=0,o=a;n<o.length;n++){var s=o[n];e.pushContainer({displayName:s.displayName});var l=s&&s.objects,u={selector:{metadata:s.queryName},objectName:t.ObjectColumnFormatting,properties:{fontColor:t.PropColumnFormattingFontColor.getValue(l),backColor:t.PropColumnFormattingBackColor.getValue(l),styleHeader:t.PropColumnFormattingStyleHeader.getValue(l),styleValues:t.PropColumnFormattingStyleValues.getValue(l)}};r!==i.TablixType.Matrix&&r!==i.TablixType.PivotTable||(u.properties[t.PropColumnFormattingStyleSubtotals.propertyName]=t.PropColumnFormattingStyleSubtotals.getValue(l)),u.properties[t.PropColumnFormattingStyleTotal.propertyName]=t.PropColumnFormattingStyleTotal.getValue(l),e.pushInstance(u),e.popContainer()}}function S(e,i){var a=r(e),n={general:{autoSizeColumnWidth:t.PropGeneralAutoSizeColumns.getValue(a),textSize:t.PropGeneralTextSize.getValue(a),totals:V(a)}};n.grid={gridVertical:t.PropGridVertical.getValue(a),gridVerticalColor:t.PropGridVerticalColor.getValue(a),gridVerticalWeight:t.PropGridVerticalWeight.getValue(a),gridHorizontal:t.PropGridHorizontalTable.getValue(a),gridHorizontalColor:t.PropGridHorizontalColor.getValue(a),gridHorizontalWeight:t.PropGridHorizontalWeight.getValue(a),outlineColor:t.PropGridOutlineColor.getValue(a),outlineWeight:t.PropGridOutlineWeight.getValue(a),rowPadding:t.PropGridRowPadding.getValue(a),imageHeight:t.PropGridImageHeight.getValue(a)},n.columnHeaders={fontColor:t.PropColumnsFontColor.getValue(a),backColor:t.PropColumnsBackColor.getValue(a),outline:t.PropColumnsOutline.getValue(a),wordWrap:!!i&&t.PropColumnsWordWrap.getValue(a)},n.values={fontColorPrimary:t.PropValuesFontColorPrimary.getValue(a),backColorPrimary:t.PropValuesBackColorPrimary.getValue(a),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(a),backColorSecondary:t.PropValuesBackColorSecondary.getValue(a),outline:t.PropValuesOutline.getValue(a),urlIcon:t.PropValuesUrlIconProp.getValue(a)},n.total={fontColor:t.PropTotalFontColor.getValue(a),backColor:t.PropTotalBackColor.getValue(a),outline:t.PropTotalOutline.getValue(a)},n.columnFormatting={};var o=d(e);if(o)for(var s=0,l=o;s<l.length;s++){var u=l[s],c=u&&u.objects;n.columnFormatting[u.queryName]={fontColor:t.PropColumnFormattingFontColor.getValue(c),backColor:t.PropColumnFormattingBackColor.getValue(c),styleHeader:t.PropColumnFormattingStyleHeader.getValue(c),styleValues:t.PropColumnFormattingStyleValues.getValue(c),styleTotal:t.PropColumnFormattingStyleTotal.getValue(c)}}return n}function x(e){var i=r(e),a={general:{autoSizeColumnWidth:t.PropGeneralAutoSizeColumns.getValue(i),textSize:t.PropGeneralTextSize.getValue(i),rowSubtotals:M(i),columnSubtotals:I(i)}};a.grid={gridVertical:t.PropGridVertical.getValue(i),gridVerticalColor:t.PropGridVerticalColor.getValue(i),gridVerticalWeight:t.PropGridVerticalWeight.getValue(i),gridHorizontal:t.PropGridHorizontalMatrix.getValue(i),gridHorizontalColor:t.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:t.PropGridHorizontalWeight.getValue(i),outlineColor:t.PropGridOutlineColor.getValue(i),outlineWeight:t.PropGridOutlineWeight.getValue(i),rowPadding:t.PropGridRowPadding.getValue(i),imageHeight:t.PropGridImageHeight.getValue(i)},a.columnHeaders={fontColor:t.PropColumnsFontColor.getValue(i),backColor:t.PropColumnsBackColor.getValue(i),outline:t.PropColumnsOutline.getValue(i)},a.rowHeaders={fontColor:t.PropRowsFontColor.getValue(i),backColor:t.PropRowsBackColor.getValue(i),outline:t.PropRowsOutline.getValue(i)},a.values={fontColorPrimary:t.PropValuesFontColorPrimary.getValue(i),backColorPrimary:t.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(i),backColorSecondary:t.PropValuesBackColorSecondary.getValue(i),outline:t.PropValuesOutline.getValue(i)},a.grandTotal={fontColor:t.PropGrandTotalFontColor.getValue(i),backColor:t.PropGrandTotalBackColor.getValue(i),applyToHeaders:t.PropGrandTotalApplyToHeaders.getValue(i)},a.subtotals={fontColor:t.PropSubTotalsFontColor.getValue(i),backColor:t.PropSubTotalsBackColor.getValue(i)},a.columnFormatting={};var n=p(e);if(n)for(var o=0,s=n;o<s.length;o++){var l=s[o],u=l&&l.objects;a.columnFormatting[l.queryName]={fontColor:t.PropColumnFormattingFontColor.getValue(u),backColor:t.PropColumnFormattingBackColor.getValue(u),styleHeader:t.PropColumnFormattingStyleHeader.getValue(u),styleValues:t.PropColumnFormattingStyleValues.getValue(u),styleTotal:t.PropColumnFormattingStyleTotal.getValue(u),styleSubTotals:t.PropColumnFormattingStyleSubtotals.getValue(u)}}return a}function P(e){var i=r(e),a={general:{autoSizeColumnWidth:t.PropColumnPivotTableAutoSizeColumns.getValue(i),textSize:t.PropGridPivotTableTextSize.getValue(i),rowSubtotals:A(i),columnSubtotals:O(i)},grid:{gridVertical:t.PropGridVertical.getValue(i),gridVerticalColor:t.PropGridVerticalColor.getValue(i),gridVerticalWeight:t.PropGridVerticalWeight.getValue(i),gridHorizontal:t.PropGridHorizontalMatrix.getValue(i),gridHorizontalColor:t.PropGridHorizontalColor.getValue(i),gridHorizontalWeight:t.PropGridHorizontalWeight.getValue(i),outlineColor:t.PropGridOutlineColor.getValue(i),outlineWeight:t.PropGridOutlineWeight.getValue(i),rowPadding:t.PropGridRowPadding.getValue(i),imageHeight:t.PropGridImageHeight.getValue(i)},columnHeaders:{fontColor:t.PropColumnsFontColor.getValue(i),backColor:t.PropColumnsBackColor.getValue(i),outline:t.PropColumnsOutline.getValue(i)},rowHeaders:{fontColor:t.PropRowsFontColor.getValue(i),backColor:t.PropRowsBackColor.getValue(i),outline:t.PropRowsOutline.getValue(i)},values:{fontColorPrimary:t.PropValuesFontColorPrimary.getValue(i),backColorPrimary:t.PropValuesBackColorPrimary.getValue(i),fontColorSecondary:t.PropValuesFontColorSecondary.getValue(i),backColorSecondary:t.PropValuesBackColorSecondary.getValue(i),outline:t.PropValuesOutline.getValue(i)},grandTotal:{fontColor:t.PropGrandTotalFontColor.getValue(i),backColor:t.PropGrandTotalBackColor.getValue(i),applyToHeaders:t.PropGrandTotalApplyToHeaders.getValue(i)},subtotals:{fontColor:t.PropSubTotalsFontColor.getValue(i),backColor:t.PropSubTotalsBackColor.getValue(i)}};a.columnFormatting={};var n=p(e);if(n)for(var o=0,s=n;o<s.length;o++){var l=s[o],u=l&&l.objects;a.columnFormatting[l.queryName]={fontColor:t.PropColumnFormattingFontColor.getValue(u),backColor:t.PropColumnFormattingBackColor.getValue(u),styleHeader:t.PropColumnFormattingStyleHeader.getValue(u),styleValues:t.PropColumnFormattingStyleValues.getValue(u),styleTotal:t.PropColumnFormattingStyleTotal.getValue(u),styleSubTotals:t.PropColumnFormattingStyleSubtotals.getValue(u)}}return a}function D(e){return{general:[{selector:null,properties:{textSize:l.encodePropertyValue(12,{numeric:!0}),totals:l.encodePropertyValue(!1,{bool:!0})}}]}}function T(e){return a.PixelConverter.fromPoint(e)}function V(e){return t.PropGeneralTableTotals.getValue(e)}function L(e){if(e&&e.table&&!_.isEmpty(e.table.columns)){var t=e.table.columns;if(_.some(t,(function(e){return e.discourageAggregationAcrossGroups})))return!1}return!0}function M(e){return t.PropGeneralMatrixRowSubtotals.getValue(e)}function N(e){return!(!e||c.getRowGroupingLevelsCount(e.matrix)<1)&&!F(e.matrix.rows.levels)}function I(e){return t.PropGeneralMatrixColumnSubtotals.getValue(e)}function A(e){return t.PropSubTotalsPivotTableRowSubtotals.getValue(e)}function O(e){return t.PropSubTotalsPivotTableColumnSubtotals.getValue(e)}function R(e){return t.PropRowsSteppedLayout.getValue(e)}function E(e){if(!e||c.getColumnGroupingLevelsCount(e.matrix)<1)return!1;var t=e.matrix.columns.levels;return e.matrix.valueSources.length>1&&(t=_.initial(t)),!F(t)}function F(e){var t=_.last(e);return t&&_.some(t.sources,(function(e){return e.discourageAggregationAcrossGroups}))}t.ObjectGeneral="general",t.ObjectGrid="grid",t.ObjectColumnHeaders="columnHeaders",t.ObjectRowHeaders="rowHeaders",t.ObjectValues="values",t.ObjectTotal="total",t.ObjectSubTotals="subTotals",t.ObjectColumnFormatting="columnFormatting";var j=(function(){function e(e,t,i,a){this.objectName=e,this.propertyName=t,this.defaultValue=i,this.getterFuntion=a}return e.prototype.getPropertyID=function(){return{objectName:this.objectName,propertyName:this.propertyName}},e.prototype.getValue=function(e){return this.getterFuntion(e,this.getPropertyID(),this.defaultValue)},e})();t.TablixProperty=j,t.PropColumnFormatString=new j(t.ObjectGeneral,"formatString",(void 0),e.DataViewObjects.getValue),t.PropGeneralAutoSizeColumns=new j(t.ObjectGeneral,"autoSizeColumnWidth",(!0),e.DataViewObjects.getValue),t.PropGeneralTextSize=new j(t.ObjectGeneral,"textSize",8,e.DataViewObjects.getValue),t.PropGeneralTableTotals=new j(t.ObjectGeneral,"totals",(!0),e.DataViewObjects.getValue),t.PropGeneralMatrixRowSubtotals=new j(t.ObjectGeneral,"rowSubtotals",(!0),e.DataViewObjects.getValue),t.PropGeneralMatrixColumnSubtotals=new j(t.ObjectGeneral,"columnSubtotals",(!0),e.DataViewObjects.getValue),t.PropGridVertical=new j(t.ObjectGrid,"gridVertical",(!1),e.DataViewObjects.getValue),t.PropGridVerticalColor=new j(t.ObjectGrid,"gridVerticalColor","#E8E8E8",e.DataViewObjects.getFillColor),t.PropGridVerticalWeight=new j(t.ObjectGrid,"gridVerticalWeight",1,e.DataViewObjects.getValue),t.PropGridHorizontalTable=new j(t.ObjectGrid,"gridHorizontal",(!0),e.DataViewObjects.getValue),t.PropGridHorizontalMatrix=new j(t.ObjectGrid,"gridHorizontal",(!1),e.DataViewObjects.getValue),t.PropGridHorizontalColor=new j(t.ObjectGrid,"gridHorizontalColor","#E8E8E8",e.DataViewObjects.getFillColor),t.PropGridHorizontalWeight=new j(t.ObjectGrid,"gridHorizontalWeight",1,e.DataViewObjects.getValue),t.PropGridRowPadding=new j(t.ObjectGrid,"rowPadding",0,e.DataViewObjects.getValue),t.PropGridOutlineColor=new j(t.ObjectGrid,"outlineColor","#CCC",e.DataViewObjects.getFillColor),t.PropGridOutlineWeight=new j(t.ObjectGrid,"outlineWeight",1,e.DataViewObjects.getValue),t.PropGridImageHeight=new j(t.ObjectGrid,"imageHeight",75,e.DataViewObjects.getValue),t.PropGridPivotTableTextSize=new j(t.ObjectGrid,"textSize",8,e.DataViewObjects.getValue),t.PropColumnsFontColor=new j(t.ObjectColumnHeaders,"fontColor","#666",e.DataViewObjects.getFillColor),t.PropColumnsBackColor=new j(t.ObjectColumnHeaders,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropColumnsOutline=new j(t.ObjectColumnHeaders,"outline","BottomOnly",e.DataViewObjects.getValue),t.PropColumnPivotTableAutoSizeColumns=new j(t.ObjectColumnHeaders,"autoSizeColumnWidth",(!0),e.DataViewObjects.getValue),t.PropColumnsWordWrap=new j(t.ObjectColumnHeaders,"wordWrap",(!1),e.DataViewObjects.getValue),t.PropRowsFontColor=new j(t.ObjectRowHeaders,"fontColor","#666",e.DataViewObjects.getFillColor),t.PropRowsBackColor=new j(t.ObjectRowHeaders,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropRowsOutline=new j(t.ObjectRowHeaders,"outline","RightOnly",e.DataViewObjects.getValue),t.PropRowsSteppedLayout=new j(t.ObjectRowHeaders,"stepped",(!0),e.DataViewObjects.getValue),t.PropValuesBackColor=new j(t.ObjectValues,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropValuesFontColorPrimary=new j(t.ObjectValues,"fontColorPrimary","#333",e.DataViewObjects.getFillColor),t.PropValuesBackColorPrimary=new j(t.ObjectValues,"backColorPrimary",(void 0),e.DataViewObjects.getFillColor),t.PropValuesFontColorSecondary=new j(t.ObjectValues,"fontColorSecondary","#333",e.DataViewObjects.getFillColor),t.PropValuesBackColorSecondary=new j(t.ObjectValues,"backColorSecondary",(void 0),e.DataViewObjects.getFillColor),t.PropValuesOutline=new j(t.ObjectValues,"outline","None",e.DataViewObjects.getValue),t.PropValuesUrlIconProp=new j(t.ObjectValues,"urlIcon",(!1),e.DataViewObjects.getValue),t.PropTotalFontColor=new j(t.ObjectTotal,"fontColor","#333",e.DataViewObjects.getFillColor),t.PropTotalBackColor=new j(t.ObjectTotal,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropTotalOutline=new j(t.ObjectTotal,"outline","TopOnly",e.DataViewObjects.getValue),t.PropSubTotalsFontColor=new j(t.ObjectSubTotals,"fontColor",(void 0),e.DataViewObjects.getFillColor),t.PropSubTotalsBackColor=new j(t.ObjectSubTotals,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropSubTotalsPivotTableRowSubtotals=new j(t.ObjectSubTotals,"rowSubtotals",(!0),e.DataViewObjects.getValue),t.PropSubTotalsPivotTableColumnSubtotals=new j(t.ObjectSubTotals,"columnSubtotals",(!0),e.DataViewObjects.getValue),t.PropGrandTotalFontColor=new j(t.ObjectTotal,"fontColor",(void 0),e.DataViewObjects.getFillColor),t.PropGrandTotalBackColor=new j(t.ObjectTotal,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropGrandTotalApplyToHeaders=new j(t.ObjectTotal,"applyToHeaders",(!1),e.DataViewObjects.getValue),t.PropColumnFormattingFontColor=new j(t.ObjectColumnFormatting,"fontColor",(void 0),e.DataViewObjects.getFillColor),t.PropColumnFormattingBackColor=new j(t.ObjectColumnFormatting,"backColor",(void 0),e.DataViewObjects.getFillColor),t.PropColumnFormattingStyleHeader=new j(t.ObjectColumnFormatting,"styleHeader",(!1),e.DataViewObjects.getValue),t.PropColumnFormattingStyleValues=new j(t.ObjectColumnFormatting,"styleValues",(!0),e.DataViewObjects.getValue),t.PropColumnFormattingStyleSubtotals=new j(t.ObjectColumnFormatting,"styleSubtotals",(!0),e.DataViewObjects.getValue),t.PropColumnFormattingStyleTotal=new j(t.ObjectColumnFormatting,"styleTotal",(!1),e.DataViewObjects.getValue),t.getMetadadataObjects=r,t.enumerateObjectRepetition=n,t.enumerateObjectInstances=o,t.enumerateGeneralOptions=h,t.enumerateGridOptions=g,t.enumerateColumnHeadersOptions=f,t.enumerateRowHeadersOptions=m,t.enumerateValuesOptions=y,t.enumerateTotalOptions=v,t.enumerateGrandTotalOptions=w,t.enumerateSubTotalsOptions=b,t.enumerateColumnFormattingOptions=C,t.getTableObjects=S,t.getMatrixObjects=x,t.getPivotTableObjects=P,t.generateTablixDefaultObjects=D,t.getTextSizeInPx=T,t.shouldShowTableTotals=V,t.shouldShowRowSubtotals=M,t.shouldShowColumnSubtotals=I,t.shouldShowPivotTableRowSubtotals=A,t.shouldShowPivotTableColumnSubtotals=O,t.steppedLayout=R,t.shouldShowColumnSubtotalsOption=E,t.isDiscourageAggregationAcrossGroups=F})(o=n.TablixObjects||(n.TablixObjects={}));var d;!(function(e){function r(){return document.createElement("table")}function l(){var t=document.createElement("div");return t.className=e.CssClassTablixDiv,t}function u(t){t.extension.contentElement.className=e.CssClassTablixDiv+" "+e.CssClassContentElement,t.extension.contentHost.className=e.CssClassTablixDiv+" "+e.CssClassContentHost}function c(e,t){e.extension.contentHost.className+=" "+t}function d(e){e.extension.contentHost.className="",e.extension.contentHost.style.cssText=""}function p(e){e.extension.contentHost.textContent="",e.extension.contentHost.removeAttribute("title"),e.contentHeight=e.contentWidth=0,i.HTMLElementUtils.clearChildren(e.extension.contentHost)}function h(t,i,a){e.setCellText(t,i),e.setCellTooltip(t,a||i)}function g(e,i){i.textContent=t.TextUtil.replaceSpaceWithNBSP(e)}function f(e,t){t.title=e}function m(e,t){var i=l();return e.appendChild(i),t&&(i.textContent=t),i}function y(e){var t=e.target,i=e.offsetX;return i>=0&&i<t.offsetWidth-n.TablixResizer.resizeHandleSize}function v(t,i,a){var r=null;0===i.childElementCount?(r=document.createElement("a"),i.appendChild(r)):r=i.children[0],r.href=t,r.target="_blank",r.rel="noopener noreferrer",r.title=t,a===!0?(r.className=e.CssClassValueURLIcon,$(i).addClass(e.CssClassValueURLIconContainer)):r.innerText=t}function w(t,i,a){var r=e.createDiv(),n=document.createElement("img");r.style.height=a+"px",r.style.width="100%",r.style.textAlign="center",n.src=t,n.style.maxHeight="100%",n.style.maxWidth="100%",r.appendChild(n),i.appendChild(r),i.title=t}function b(e,i){var a=t.KpiUtil.getClassForKpi(e,i)||"";return s.div().addClass(a).css({display:"inline-block","vertical-align":"bottom",margin:"0"})}function C(e,i){return!(!e||void 0===i)&&!!t.KpiUtil.getClassForKpi(e,i)}function S(e,t){var i=[{queryName:e,sortDirection:t}];return{sortDescriptors:i}}function x(e){return 2===e?1:2}function P(t,i){var a=e.createDiv();t?(a.appendChild(D(t,!0)),a.appendChild(D(x(t),!1))):a.appendChild(D(2,!1));var r=e.createDiv();return a.appendChild(r),i.appendChild(a),r}function D(e,t){var i=document.createElement("i");return i.className=L+" "+(t?"sorted":"future")+" "+(1===e?"powervisuals-glyph caret-up":"powervisuals-glyph caret-down"),
i}function T(e){for(var t=0,i=e.extension.contentElement.childElementCount;t<i;t++){var a=e.extension.contentElement.children.item(t);if(a.classList.contains(L))return!0}return!1}function V(e){T(e)&&$(e.extension.contentElement).find("."+L).remove()}e.TotalLabel="TableTotalLabel",e.CssClassTablixDiv="tablixDiv",e.CssClassContentElement="tablixCellContentElement",e.CssClassContentHost="tablixCellContentHost",e.CssClassWrappingContainer="tablixWrappingContainer",e.CssClassTablixHeader="tablixHeader",e.CssClassTablixColumnHeaderLeaf="tablixColumnHeaderLeaf",e.CssClassTablixValueNumeric="tablixValueNumeric",e.CssClassTablixValueTotal="tablixValueTotal",e.CssClassValueURLIcon="powervisuals-glyph url-icon tablixUrlIconGlyph",e.CssClassValueURLIconContainer="tablixValueUrlIcon",e.CssClassMatrixRowHeaderLeaf="matrixRowHeaderLeaf",e.CssClassMatrixRowHeaderSubTotal="matrixRowHeaderSubTotal",e.CssClassTableFooter="tableFooterCell",e.CssClassTableBodyCell="tableBodyCell",e.CssClassTableBodyCellBottom="tableBodyCellBottom",e.StringNonBreakingSpace="&nbsp;",e.UnitOfMeasurement="px";var L="tablixSortIconContainer";e.CellPaddingLeft=10,e.CellPaddingRight=5,e.CellPaddingLeftMatrixTotal=5,e.SortIconPadding=5,e.ImageDefaultAspectRatio=1,e.FontFamilyCell=t.Font.Family.regular.css,e.FontFamilyHeader=t.Font.Family.regular.css,e.FontFamilyTotal=t.Font.Family.bold.css,e.FontColorCells="#333",e.FontColorHeaders="#666",e.WordWrappingMaxLines=Number.POSITIVE_INFINITY,(function(e){e[e.Outline=0]="Outline",e[e.Gridline=1]="Gridline"})(e.EdgeType||(e.EdgeType={}));var M=e.EdgeType,N=(function(){function t(e,t){this.applyParams(!0,e,t)}return t.prototype.applyParams=function(e,t,i,a){e?(this.weight=null==t?0:t,this.color=null==i?"black":i,this.type=null==a?M.Gridline:a):(this.weight=0,this.color="black",this.type=M.Gridline)},t.prototype.getCSS=function(){var t=[];return _.isNumber(this.weight)&&(t.push(this.weight+e.UnitOfMeasurement),this.color&&t.push(this.color),t.push("solid")),t.join(" ")},t.prototype.getPriority=function(e){return this===e.top||this===e.bottom?this.type===M.Outline?2:0:this===e.right||this===e.left?this.type===M.Outline?3:1:-1},t.prototype.getShadowCss=function(t){var i="inset ";if(this===t.left)i+=this.weight+e.UnitOfMeasurement+" 0";else if(this===t.right)i+="-"+this.weight+e.UnitOfMeasurement+" 0";else if(this===t.top)i+="0 "+this.weight+e.UnitOfMeasurement;else{if(this!==t.bottom)return"";i+="0 -"+this.weight+e.UnitOfMeasurement}return i+" 0 0 "+this.color},t})();e.EdgeSettings=N;var I=(function(){function t(){this.borders={},this.paddings={top:0,left:e.CellPaddingLeft,bottom:0,right:e.CellPaddingRight},this.fontFamily="",this.fontColor="",this.backColor=""}return t.prototype.applyStyle=function(t){var i=this,a=t.extension.contentHost,r=a.style;r.fontFamily=this.fontFamily,r.color=this.fontColor,r.backgroundColor=this.backColor;var n=[this.borders.top,this.borders.right,this.borders.bottom,this.borders.left];n=_.sortBy(n,(function(e){return e?e.getPriority(i.borders):-1})).reverse(),r.boxShadow=_.map(n,(function(e){if(e)return e.getShadowCss(i.borders)})).join(", "),r.border="none",r.paddingTop=(null==this.paddings.top?0:this.paddings.top)+(null==this.borders.top?0:this.borders.top.weight)+e.UnitOfMeasurement,r.paddingRight=(null==this.paddings.right?e.CellPaddingRight:this.paddings.right)+(null==this.borders.right?0:this.borders.right.weight)+e.UnitOfMeasurement,r.paddingBottom=(null==this.paddings.bottom?0:this.paddings.bottom)+(null==this.borders.bottom?0:this.borders.bottom.weight)+e.UnitOfMeasurement,r.paddingLeft=(null==this.paddings.left?e.CellPaddingLeft:this.paddings.left)+(null==this.borders.left?0:this.borders.left.weight)+e.UnitOfMeasurement},t.prototype.getExtraTop=function(){var e=0;return this.paddings.top&&(e+=this.paddings.top),this.borders.top&&(e+=this.borders.top.weight),e},t.prototype.getExtraBottom=function(){var e=0;return this.paddings.bottom&&(e+=this.paddings.bottom),this.borders.bottom&&(e+=this.borders.bottom.weight),e},t.prototype.getExtraRight=function(){var e=0;return this.paddings.right&&(e+=this.paddings.right),this.borders.right&&(e+=this.borders.right.weight),e},t.prototype.getExtraLeft=function(){var e=0;return this.paddings.left&&(e+=this.paddings.left),this.borders.left&&(e+=this.borders.left.weight),e},t})();e.CellStyle=I;var A=(function(){function e(){}return e})();e.DimensionPosition=A;var O=(function(){function e(){this.row=new A,this.column=new A}return e.prototype.isMatch=function(e){return this.column.index===e.column.index&&this.row.index===e.row.index},e})();e.CellPosition=O;var R=(function(){function i(t,i,a,r,n,o,s,l){this.dataPoint=t,this.isRowSubTotal=i,this.isColumnSubTotal=a,this.isRowGrandTotal=r,this.isColumnGrandTotal=n,this.columnMetadata=o,this.formatter=s,this.nullsAreBlank=l,this.position=new e.CellPosition}return Object.defineProperty(i.prototype,"isTotal",{get:function(){return this.isSubtotal||this.isGrandTotal},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isSubtotal",{get:function(){return this.isColumnSubTotal||this.isRowSubTotal},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isGrandTotal",{get:function(){return this.isColumnGrandTotal||this.isRowGrandTotal},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textContent",{get:function(){return this.formatter?this.formatter(this.dataPoint,this.columnMetadata,o.PropColumnFormatString.getPropertyID(),this.nullsAreBlank):null!=this.dataPoint?this.dataPoint:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"kpiContent",{get:function(){if(this.columnMetadata&&C(this.columnMetadata.kpi,this.textContent))return b(this.columnMetadata.kpi,this.textContent)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isNumeric",{get:function(){if(this.columnMetadata)return this.columnMetadata.type.numeric&&!this.columnMetadata.kpi},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isUrl",{get:function(){if(this.columnMetadata)return t.converterHelper.isWebUrlColumn(this.columnMetadata)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isImage",{get:function(){if(this.columnMetadata)return t.converterHelper.isImageUrlColumn(this.columnMetadata)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isValidUrl",{get:function(){return a.UrlUtils.isValidImageUrl(this.textContent)},enumerable:!0,configurable:!0}),i.prototype.isMatch=function(e){return this.position.isMatch(e.position)&&this.backColor===e.backColor},i})();e.TablixVisualCell=R,e.createTable=r,e.createDiv=l,e.resetCellCssClass=u,e.addCellCssClass=c,e.clearCellStyle=d,e.clearCellTextAndTooltip=p,e.setCellTextAndTooltip=h,e.setCellText=g,e.setCellTooltip=f,e.appendDiv=m,e.isValidSortClick=y,e.appendATagToBodyCell=v,e.appendImgTagToBodyCell=w,e.createKpiDom=b,e.isValidStatusGraphic=C,e.getCustomSortEventArgs=S,e.reverseSort=x,e.addSortIconToColumnHeader=P,e.removeSortIcons=V})(d=n.TablixUtils||(n.TablixUtils={}))})(n=i.internal||(i.internal={}))})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){e.TablixDefaultTextSize=a.TextSizeDefaults.TextSizeMin;var t=(function(){function t(i,a,r,n,o){var s=this;this.scrollBarElementWidth=9,this.options=o;var l=o.interactive;this.isTouchEnabled=l&&o.enableTouchSupport,this.mainDiv=e.internal.TablixUtils.createDiv(),this.mainDiv.classList.add(t.TablixTableAreaClassName),this.footerDiv=e.internal.TablixUtils.createDiv(),this.footerDiv.classList.add(t.TablixFooterClassName),this.gridDimensions={},this.containerElement=e.internal.TablixUtils.createDiv(),this.className=a.getTablixClassName(),this.autoSizeWidth=!1,this.autoSizeHeight=!1,this.fontFamily=e.internal.TablixUtils.FontFamilyCell,this.fontColor=e.internal.TablixUtils.FontColorCells,this.fontSize=o.fontSize,n.className=t.TablixContainerClassName,n.appendChild(this.containerElement),this.containerElement.addEventListener("wheel",(function(e){s.onWheel(e)})),this.containerElement.appendChild(this.mainDiv),this.containerElement.appendChild(this.footerDiv),this.isTouchEnabled&&(this.InitializeTouchSupport(),this.bindTouchEvents()),this.controlLayoutManager=a,this.controlLayoutManager.initialize(this),this.hierarchyTablixNavigator=i,this.binder=r,this.columnDim=new e.TablixColumnDimension(this),this.rowDim=new e.TablixRowDimension(this),this.columnDim._otherDimension=this.rowDimension,this.rowDim._otherDimension=this.columnDimension,this.InitializeScrollbars(),l||(this.scrollbarWidth=0),this.updateHorizontalPosition(),this.updateVerticalPosition(),this.updateFooterVisibility(),this.lastRenderingArgs={}}return t.prototype.InitializeTouchSupport=function(){this.isTouchEventsBound=!1,this.touchManager=new e.TouchUtils.TouchManager,this.touchInterpreter=new e.TouchUtils.TouchEventInterpreter(this.touchManager),this.footerTouchInterpreter=new e.TouchUtils.TouchEventInterpreter(this.touchManager),this.columnTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this.rowTouchDelegate=new e.RowTouchDelegate(new e.TouchUtils.Rectangle),this.bodyTouchDelegate=new e.BodyTouchDelegate(new e.TouchUtils.Rectangle),this.footerTouchDelegate=new e.ColumnTouchDelegate(new e.TouchUtils.Rectangle),this.columnTouchDelegate.setHandler(this,this.onTouchEvent),this.rowTouchDelegate.setHandler(this,this.onTouchEvent),this.bodyTouchDelegate.setHandler(this,this.onTouchEvent),this.footerTouchDelegate.setHandler(this,this.onTouchEvent),this.touchManager.addTouchRegion(this.columnTouchDelegate.dimension,this.columnTouchDelegate,this.columnTouchDelegate),this.touchManager.addTouchRegion(this.rowTouchDelegate.dimension,this.rowTouchDelegate,this.rowTouchDelegate),this.touchManager.addTouchRegion(this.bodyTouchDelegate.dimension,this.bodyTouchDelegate,this.bodyTouchDelegate),this.touchManager.addTouchRegion(this.footerTouchDelegate.dimension,this.footerTouchDelegate,this.footerTouchDelegate)},t.prototype.unBindTouchEvents=function(){this.isTouchEventsBound&&(this.touchInterpreter.clearAllTouchEvents(),this.footerTouchInterpreter.clearAllTouchEvents(),this.isTouchEventsBound=!1)},t.prototype.bindTouchEvents=function(){this.isTouchEventsBound||(this.touchInterpreter.initTouch(this.mainDiv,null),this.footerTouchInterpreter.initTouch(this.footerDiv,this.mainDiv),this.isTouchEventsBound=!0)},t.prototype.InitializeScrollbars=function(){this.rowDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var e=this.rowDim.scrollbar.element.style;e.position="absolute",e.top="0"+t.UnitOfMeasurement,e.right="0"+t.UnitOfMeasurement,this.rowDim.scrollbar.width=this.scrollBarElementWidth+t.UnitOfMeasurement,this.rowDim.scrollbar.show(!0),this.columnDim._initializeScrollbar(this.containerElement,null,this.options.layoutKind);var i=this.columnDim.scrollbar.element.style;i.position="absolute",i.left="0"+t.UnitOfMeasurement,i.bottom="0"+t.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+t.UnitOfMeasurement,this.columnDim.scrollbar.show(!1)},t.prototype.toggleTouchBindings=function(e){this.isTouchEnabled&&(e?this.bindTouchEvents():this.unBindTouchEvents())},Object.defineProperty(t.prototype,"container",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentHost",{get:function(){return this.mainDiv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"footerHost",{get:function(){return this.footerDiv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{set:function(e){this.containerElement.className=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hierarchyNavigator",{get:function(){return this.hierarchyTablixNavigator},enumerable:!0,configurable:!0}),t.prototype.getBinder=function(){return this.binder},Object.defineProperty(t.prototype,"autoSizeWidth",{get:function(){return this._autoSizeWidth},set:function(e){this._autoSizeWidth=e,e||(this.containerElement.style.minWidth=this.containerElement.style.maxWidth="none")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoSizeHeight",{get:function(){return this._autoSizeHeight},set:function(e){e||(this.containerElement.style.minHeight=this.containerElement.style.maxHeight="none")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.maximumWidth},set:function(e){this.maximumWidth=e,this.containerElement.style.maxWidth=this.maximumWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewport",{get:function(){return this.viewPort},set:function(e){this.viewPort=e,this.containerElement.style.width=this.viewPort.width+t.UnitOfMeasurement,this.containerElement.style.height=this.viewPort.height+t.UnitOfMeasurement,this.rowDim.scrollbar.invalidateArrange(),this.columnDim.scrollbar.invalidateArrange(),this.controlLayoutManager.updateViewport(this.viewPort)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return this.maximumHeight},set:function(e){this.maximumHeight=e,this.containerElement.style.maxHeight=this.maximumHeight+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){return this.minimumWidth},set:function(e){this.minimumWidth=e,this.containerElement.style.minWidth=this.minimumWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){return this.minimumHeight},set:function(e){this.minimumHeight=e,this.containerElement.style.minHeight=this.minimumHeight+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.textFontSize},set:function(e){this.textFontSize=e?e:t.DefaultFontSize,this.containerElement.style.fontSize=this.textFontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.textFontFamily},set:function(e){this.textFontFamily=e,this.containerElement.style.fontFamily=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontColor",{get:function(){return this.textFontColor},set:function(e){this.textFontColor=e,this.containerElement.style.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scrollbarWidth",{set:function(e){this.scrollBarElementWidth=e,this.rowDim.scrollbar.width=this.scrollBarElementWidth+t.UnitOfMeasurement,this.columnDim.scrollbar.height=this.scrollBarElementWidth+t.UnitOfMeasurement},enumerable:!0,configurable:!0}),t.prototype.getIsTouchEventsBound=function(){return!!this.isTouchEventsBound},t.prototype.updateModels=function(e,t,i){this.rowDim.model=t,this.rowDim.modelDepth=this.hierarchyNavigator.getRowHierarchyDepth(),this.columnDim.model=i,this.columnDim.modelDepth=this.hierarchyNavigator.getColumnHierarchyDepth(),e&&(this.rowDim.scrollOffset=0,this.columnDim.scrollOffset=0),this.layoutManager.updateColumnCount(this.rowDim,this.columnDim)},t.prototype.updateColumnDimensions=function(e,t,i){var a=this.gridDimensions;a.columnCount=i,a.rowHierarchyWidth=e,a.columnHierarchyWidth=t},t.prototype.updateRowDimensions=function(e,t,i,a,r){var n=this.gridDimensions;n.rowCount=a,n.rowHierarchyHeight=t,n.rowHierarchyContentHeight=i,n.columnHierarchyHeight=e,n.footerHeight=r},t.prototype.updateTouchDimensions=function(){var e=this.gridDimensions;this.columnTouchDelegate.resize(e.rowHierarchyWidth,0,e.columnHierarchyWidth,e.columnHierarchyHeight),this.columnTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth),this.rowTouchDelegate.resize(0,e.columnHierarchyHeight,e.rowHierarchyWidth,e.rowHierarchyHeight),this.rowTouchDelegate.setScrollDensity(e.rowCount/e.rowHierarchyHeight),this.bodyTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight,e.columnHierarchyWidth,e.rowHierarchyHeight),this.bodyTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth,e.rowCount/e.rowHierarchyHeight),this.footerTouchDelegate.resize(e.rowHierarchyWidth,e.columnHierarchyHeight+e.rowHierarchyHeight,e.columnHierarchyWidth,e.footerHeight),this.footerTouchDelegate.setScrollDensity(e.columnCount/e.columnHierarchyWidth)},t.prototype.onWheel=function(e){this.determineDimensionToScroll(e,(function(e,t){e.scrollbar.onMouseWheel(-1*t)})),0===this.options.layoutKind&&e.preventDefault()},t.prototype.determineDimensionToScroll=function(e,t){this.rowDim.scrollbar.visible?(e.deltaY&&t(this.rowDim,e.deltaY),e.deltaX&&this.columnDim.scrollbar.visible&&t(this.columnDim,e.deltaX)):this.columnDim.scrollbar.visible&&(e.deltaX?t(this.columnDim,e.deltaX):e.deltaY&&t(this.columnDim,e.deltaY))},Object.defineProperty(t.prototype,"layoutManager",{get:function(){return this.controlLayoutManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnDimension",{get:function(){return this.columnDim},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowDimension",{get:function(){return this.rowDim},enumerable:!0,configurable:!0}),t.prototype.refresh=function(e){this.render(e,null)},t.prototype._onScrollAsync=function(e){var t=this;requestAnimationFrame((function(){t.performPendingScroll(e)}))},t.prototype.performPendingScroll=function(e){this.render(!1,e)},t.prototype.updateHorizontalPosition=function(){this.rowDim.scrollbar.visible?(this.columnDim.scrollbar.element.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement,this.footerDiv.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement,this.mainDiv.style.right=this.scrollBarElementWidth+t.UnitOfMeasurement):(this.columnDim.scrollbar.element.style.right="0"+t.UnitOfMeasurement,this.mainDiv.style.right="0"+t.UnitOfMeasurement,this.footerDiv.style.right="0"+t.UnitOfMeasurement)},t.prototype.updateFooterVisibility=function(){(this.rowDim.hasFooter()?"block"!==this.footerDiv.style.display:"none"!==this.footerDiv.style.display)&&(this.rowDim.hasFooter()?this.footerDiv.style.display="block":this.footerDiv.style.display="none")},t.prototype.updateVerticalPosition=function(){var e=this.rowDim.scrollbar.visible,i=1===this.controlLayoutManager.getLayoutKind(),a=e||i;if(a){var r=this.footerDiv.offsetHeight,n=0,o=0,s=this.columnDim.scrollbar.visible;s&&(r+=this.scrollBarElementWidth,n+=this.scrollBarElementWidth,o=this.scrollBarElementWidth),this.mainDiv.style.bottom=r+t.UnitOfMeasurement,this.rowDim.scrollbar.element.style.bottom=o+t.UnitOfMeasurement,this.footerDiv.style.bottom=n+t.UnitOfMeasurement,this.footerDiv.style.removeProperty("top")}else this.footerDiv.style.top=this.gridDimensions.rowHierarchyContentHeight+t.UnitOfMeasurement,this.footerDiv.style.removeProperty("bottom"),this.mainDiv.style.removeProperty("bottom")},t.prototype.alreadyRendered=function(e){return e===this.lastRenderingArgs.scrollingDimension&&this.rowDimension.scrollOffset===this.lastRenderingArgs.rowScrollOffset&&this.columnDimension.scrollOffset===this.lastRenderingArgs.columnScrollOffset},t.prototype.render=function(e,i){if(this.columnDim.makeScrollOffsetValid(),this.rowDim.makeScrollOffsetValid(),e||null===i)this.lastRenderingArgs={};else if(this.alreadyRendered(i))return;var a=!1;this.renderIterationCount=0,this.controlLayoutManager.onStartRenderingSession(i,this.mainDiv,e);var r=this.binder;r.onStartRenderingSession();for(var n=this.gridDimensions.footerHeight,o=this.gridDimensions.rowHierarchyHeight,s=this.gridDimensions.rowHierarchyContentHeight;!a&&this.renderIterationCount<t.MaxRenderIterationCount;){var l=this.columnDim.scrollbar.visible,u=this.rowDim.scrollbar.visible;this.columnDim._onStartRenderingIteration(),this.rowDim._onStartRenderingIteration(),this.controlLayoutManager.onStartRenderingIteration(e),this.renderCorner(),this.columnDim._render(),this.rowDim._render(),a=this.controlLayoutManager.onEndRenderingIteration(),this.columnDim._onEndRenderingIteration(),this.rowDim._onEndRenderingIteration(),l!==this.columnDim.scrollbar.visible&&this.updateVerticalPosition(),u!==this.rowDim.scrollbar.visible&&this.updateHorizontalPosition(),this.renderIterationCount++}this.controlLayoutManager.onEndRenderingSession(),r.onEndRenderingSession(),this.isTouchEnabled&&this.updateTouchDimensions(),this.lastRenderingArgs.rowScrollOffset=this.rowDimension.scrollOffset,this.lastRenderingArgs.columnScrollOffset=this.columnDimension.scrollOffset,this.updateContainerDimensions();var c=this.lastRenderingArgs;c.rowScrollOffset=this.rowDimension.scrollOffset,c.columnScrollOffset=this.columnDimension.scrollOffset,c.scrollingDimension=i,n===this.gridDimensions.footerHeight&&o===this.gridDimensions.rowHierarchyHeight&&s===this.gridDimensions.rowHierarchyContentHeight||this.updateVerticalPosition(),this.options.interactive&&(this.columnDim.scrollbar.refresh(),this.rowDim.scrollbar.refresh())},t.prototype.updateContainerDimensions=function(){var e=this.gridDimensions;if(this._autoSizeWidth){var i=this.rowDim.scrollbar.visible?this.scrollBarElementWidth:0;this.containerElement.style.width=e.rowHierarchyWidth+e.columnHierarchyWidth+i+t.UnitOfMeasurement}if(this._autoSizeHeight){var a=this.columnDim.scrollbar.visible?this.scrollBarElementWidth:0;this.containerElement.style.height=e.columnHierarchyHeight+e.rowHierarchyHeight+e.footerHeight+a+t.UnitOfMeasurement}},t.prototype.cornerCellMatch=function(e,t){var i=t.item;return 0===t.type&&i&&this.hierarchyTablixNavigator.cornerCellItemEquals(e,i)},t.prototype.renderCorner=function(){for(var e=this.columnDim.getDepth(),t=this.rowDim.getDepth(),i=0;i<e;i++)for(var a=0;a<t;a++){var r=this.hierarchyTablixNavigator.getCorner(a,i),n=this.controlLayoutManager.getOrCreateCornerCell(r,a,i),o=this.cornerCellMatch(r,n);o||(this._unbindCell(n),n.type=0,n.item=r,this.binder.bindCornerCell(r,n)),this.controlLayoutManager.onCornerCellRealized(r,n)}},t.prototype._unbindCell=function(e){switch(e.type){case 3:this.binder.unbindBodyCell(e.item,e);break;case 2:this.binder.unbindColumnHeader(e.item,e);break;case 1:this.binder.unbindRowHeader(e.item,e);break;case 0:this.binder.unbindCornerCell(e.item,e)}e.item=null,e.type=null},t.prototype.onTouchEvent=function(e){var t,i,a;e&&e.length>0&&"columnDim"in e[0]&&"rowDim"in e[0]&&(a=e[0],t=a.columnDim.scrollbar.visible?e[1]:0,i=a.rowDim.scrollbar.visible?e[2]:0,a.columnDim.scrollbar.viewMin=Math.max(0,a.columnDim.scrollbar.viewMin+t),a.columnDim.scrollOffset=Math.max(0,a.columnDim.scrollOffset+t),a.rowDim.scrollbar.viewMin=Math.max(0,a.rowDim.scrollbar.viewMin+i),a.rowDim.scrollOffset=Math.max(0,a.rowDim.scrollOffset+i),0===t?a._onScrollAsync(a.rowDim):0===i?a._onScrollAsync(a.columnDim):a._onScrollAsync(null))},t.UnitOfMeasurement="px",t.TablixContainerClassName="tablixContainer",t.TablixTableAreaClassName="tablixTableArea",t.TablixFooterClassName="tableFooterArea",t.DefaultFontSize=a.PixelConverter.fromPoint(e.TablixDefaultTextSize),t.MaxRenderIterationCount=10,t})();e.TablixControl=t})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this._scrollStep=.1,this._owner=e,this._hierarchyNavigator=e.hierarchyNavigator,this._binder=e.getBinder(),this._tablixLayoutManager=e.layoutManager,this.scrollOffset=0}return e.prototype._onStartRenderingIteration=function(){this.updateScrollPosition()},e.prototype._onEndRenderingIteration=function(){},e.prototype.getValidScrollOffset=function(e){return Math.min(Math.max(e,0),Math.max(this.getItemsCount()-this._scrollStep,0))},e.prototype.makeScrollOffsetValid=function(){this.scrollOffset=this.getValidScrollOffset(this.scrollOffset)},e.prototype.getIntegerScrollOffset=function(){return Math.floor(this.scrollOffset)},e.prototype.getFractionScrollOffset=function(){return this.scrollOffset-this.getIntegerScrollOffset()},Object.defineProperty(e.prototype,"scrollbar",{get:function(){return this._scrollbar},enumerable:!0,configurable:!0}),e.prototype.getFirstVisibleItem=function(e){return this._scrollItems[e]},e.prototype.getFirstVisibleChild=function(e){return this._hierarchyNavigator.getAt(this._hierarchyNavigator.getChildren(e),this.getFirstVisibleChildIndex(e))},e.prototype.getFirstVisibleChildIndex=function(e){var t,i=this.getFirstVisibleItem(this._hierarchyNavigator.getLevel(e)+1);return t=void 0===i||void 0!==i&&this._hierarchyNavigator.getParent(i)!==e?0:this._hierarchyNavigator.getIndex(i)},e.prototype._initializeScrollbar=function(e,t,i){var a=this;this._scrollbar=this._createScrollbar(e,i),this._scrollbar._onscroll.push((function(e){return a.onScroll()})),t&&(this.scrollbar.initTouch(t,!0),t.style.setProperty("-ms-touch-action","pinch-zoom"))},e.prototype.getItemsCount=function(){return this.model?this._hierarchyNavigator.getLeafCount(this.model):0},e.prototype.getDepth=function(){return this.modelDepth},e.prototype.onScroll=function(){this.scrollOffset=this._scrollbar.viewMin,this._owner._onScrollAsync(this)},Object.defineProperty(e.prototype,"otherDimension",{get:function(){return this._otherDimension},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layoutManager",{get:function(){return this._layoutManager},enumerable:!0,configurable:!0}),e.prototype._createScrollbar=function(e,t){return null},e.prototype.updateScrollPosition=function(){if(this._scrollItems=[],this.model){var e=this.getIntegerScrollOffset(),t=this._hierarchyNavigator.getLeafAt(this.model,e);if(t){this._firstVisibleScrollIndex=e;do this._scrollItems[this._hierarchyNavigator.getLevel(t)]=t,t=this._hierarchyNavigator.getParent(t);while(null!==t)}}},e})();e.TablixDimension=t;var i=(function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.rowLayoutManager,this._footer=null}return a(i,t),i.prototype.setFooter=function(e){this._footer=e,this._owner.updateFooterVisibility()},i.prototype.hasFooter=function(){return null!==this._footer},i.prototype._render=function(){var e=this.getFirstVisibleItem(0);this.hasFooter()&&(this.addFooterRowHeader(this._footer),this.addFooterBodyCells(this._footer)),void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t,i){return new e.VerticalScrollbar(t,i)},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),n=a;n<r;n++){if(!this._layoutManager.needsToRealize)return;var o=this._hierarchyNavigator.getAt(e,n),s=this.addNode(o,e,t,i);t+=s.rowSpan}},i.prototype.getFirstVisibleChildLeaf=function(e){for(var t=e;!this._hierarchyNavigator.isLeaf(t);)t=this.getFirstVisibleChild(t);return t},i.prototype.bindRowHeader=function(e,t){this._binder.bindRowHeader(e,t)},i.prototype.addNode=function(e,t,i,a){var r,n=this._tablixLayoutManager.getOrCreateRowHeader(e,t,i,this._hierarchyNavigator.getLevel(e)),o=this.rowHeaderMatch(e,n);return o||(this._owner._unbindCell(n),n.type=1,n.item=e,n.unfixRowHeight()),this._hierarchyNavigator.isLeaf(e)?(n.colSpan=a-this._hierarchyNavigator.getLevel(e),n.rowSpan=1,o||this.bindRowHeader(e,n),this._tablixLayoutManager.onRowHeaderRealized(e,n),this.addBodyCells(e,t,i)):(r=this._layoutManager.getRealizedItemsCount(),this.addNodes(this._hierarchyNavigator.getChildren(e),i,a,this.getFirstVisibleChildIndex(e)),n.colSpan=1,n.rowSpan=this._layoutManager.getRealizedItemsCount()-r+1,o||this.bindRowHeader(e,n),this._tablixLayoutManager.onRowHeaderRealized(e,n)),n},i.prototype.rowHeaderMatch=function(e,t){var i=t.item;return 1===t.type&&i&&this._hierarchyNavigator.headerItemEquals(e,i)},i.prototype.addBodyCells=function(e,t,i){for(var a=this._otherDimension.getIntegerScrollOffset(),r=this._otherDimension._layoutManager.getRealizedItemsCount()-this.getDepth(),n=this._hierarchyNavigator,o=this._otherDimension.model,s=this._tablixLayoutManager,l=0;l<r;l++){var u=n.getIntersection(e,n.getLeafAt(o,a+l)),c=s.getOrCreateBodyCell(u,e,t,i,l);this.bindBodyCell(u,c),s.onBodyCellRealized(u,c)}},i.prototype.bindBodyCell=function(e,t){var i=this.bodyCelMatch(e,t);i||(this._owner._unbindCell(t),t.type=3,t.item=e,t.unfixRowHeight(),this._binder.bindBodyCell(e,t))},i.prototype.addFooterRowHeader=function(e){var t=this._tablixLayoutManager.getOrCreateFooterRowHeader(e,this.model);t.colSpan=this.getDepth();var i=this.rowHeaderMatch(e,t);i||(this._owner._unbindCell(t),t.type=1,t.item=e,t.unfixRowHeight(),this.bindRowHeader(e,t),this._tablixLayoutManager.onRowHeaderFooterRealized(e,t))},i.prototype.addFooterBodyCells=function(e){for(var t=this._otherDimension.getIntegerScrollOffset(),i=this._otherDimension.layoutManager.getRealizedItemsCount()-this.getDepth(),a=this._tablixLayoutManager,r=0;r<i;r++){var n=this._hierarchyNavigator.getLeafAt(this._otherDimension.model,t+r),o=this._hierarchyNavigator.getIntersection(e,n),s=a.getOrCreateFooterBodyCell(o,r);this.bindBodyCell(o,s),a.onBodyCellFooterRealized(o,s)}},i.prototype.bodyCelMatch=function(e,t){var i=t.item;return 3===t.type&&i&&this._hierarchyNavigator.bodyCellItemEquals(e,i)},i})(t);e.TablixRowDimension=i;var r=(function(t){function i(e){t.call(this,e),this._layoutManager=this._tablixLayoutManager.columnLayoutManager}return a(i,t),i.prototype._render=function(){var e=this.getFirstVisibleItem(0);void 0!==e&&this.addNodes(this.model,0,this.getDepth(),this._hierarchyNavigator.getIndex(e))},i.prototype._createScrollbar=function(t,i){var a=new e.HorizontalScrollbar(t,i);return a.smallIncrement=.2,a},i.prototype.addNodes=function(e,t,i,a){for(var r=this._hierarchyNavigator.getCount(e),n=a;n<r;n++){if(!this._layoutManager.needsToRealize)return;var o=this.addNode(this._hierarchyNavigator.getAt(e,n),e,t,i);t+=o.colSpan}},i.prototype.addNode=function(e,t,i,a){var r=this._tablixLayoutManager.getOrCreateColumnHeader(e,t,this._hierarchyNavigator.getLevel(e),i),n=this.columnHeaderMatch(e,r);if(n||(this._owner._unbindCell(r),r.type=2,r.item=e,r.unfixRowHeight()),this._hierarchyNavigator.isLeaf(e))r.rowSpan=a-this._hierarchyNavigator.getLevel(e);else{var o=this._layoutManager.getRealizedItemsCount();this.addNodes(this._hierarchyNavigator.getChildren(e),i,a,this.getFirstVisibleChildIndex(e));var s=this._hierarchyNavigator.getChildrenLevelDifference(e);s===1/0?r.rowSpan=1:r.rowSpan=s,r.colSpan=this._layoutManager.getRealizedItemsCount()-o+1}return n||this._binder.bindColumnHeader(e,r),this._tablixLayoutManager.onColumnHeaderRealized(e,r),r},i.prototype.columnHeaderMatch=function(e,t){var i=t.item;return!this._owner.wordWrapColumnHeaders&&2===t.type&&i&&this._hierarchyNavigator.headerItemEquals(e,i)},i})(t);e.TablixColumnDimension=r})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function t(e){this.dim=e,this.averageSize=1,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this.averageSize=e},t.prototype.resize=function(e,t,i,a){this.dim.x=e,this.dim.y=t,
this.dim.width=i,this.dim.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){return new e.TouchUtils.TouchEvent(t*this.averageSize,0,n,-a*this.averageSize,0)},t.prototype.touchEvent=function(t){var i=[];i[0]=this.tablixControl,i[1]=t.dx,i[2]=t.dy,this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t})();e.ColumnTouchDelegate=t;var i=(function(){function t(e){this.dim=e,this.averageSize=30,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e){this.averageSize=e},t.prototype.resize=function(e,t,i,a){this.dim.x=e,this.dim.y=t,this.dim.width=i,this.dim.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){var o=new e.TouchUtils.TouchEvent(0,i*this.averageSize,n,0,-r*this.averageSize);return o},t.prototype.touchEvent=function(t){var i=[];i[0]=this.tablixControl,i[1]=t.dx,i[2]=t.dy,this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t})();e.RowTouchDelegate=i;var a=(function(){function t(e){this.dim=e,this.averageSizeX=t.DefaultAverageSizeX,this.averageSizeY=t.DefaultAverageSizeY,this.handlers=null,this.tablixControl=null}return Object.defineProperty(t.prototype,"dimension",{get:function(){return this.dim},enumerable:!0,configurable:!0}),t.prototype.setScrollDensity=function(e,t){this.averageSizeX=e,this.averageSizeY=t},t.prototype.resize=function(e,t,i,a){var r=this.dim;r.x=e,r.y=t,r.width=i,r.height=a},t.prototype.getPixelToItem=function(t,i,a,r,n){return new e.TouchUtils.TouchEvent(t*this.averageSizeX,i*this.averageSizeY,n,-a*this.averageSizeX,-r*this.averageSizeY)},t.prototype.touchEvent=function(t){var i=[this.tablixControl,t.dx,t.dy];this.handlers&&e.fire([this.handlers],i)},t.prototype.setHandler=function(e,t){this.handlers=t,this.tablixControl=e},t.DefaultAverageSizeX=30,t.DefaultAverageSizeY=30,t})();e.BodyTouchDelegate=a})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var i=(function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.offset=function(e,t){this.x+=e,this.y+=t},e})();t.Point=i;var r=(function(e){function t(t,i,a,r){e.call(this,t,i),this.width=a||0,this.height=r||0}return a(t,e),Object.defineProperty(t.prototype,"point",{get:function(){return new i(this.x,this.y)},enumerable:!0,configurable:!0}),t.prototype.contains=function(e){return t.contains(this,e)},t.contains=function(e,i){return!(!i||t.isEmpty(e))&&(e.x<=i.x&&i.x<e.x+e.width&&e.y<=i.y&&i.y<e.y+e.height)},t.isEmpty=function(e){return!(void 0!==e&&e.width>=0&&e.height>=0)},t})(i);t.Rectangle=r,(function(e){e[e.NoClick=0]="NoClick",e[e.LeftClick=1]="LeftClick",e[e.RightClick=2]="RightClick",e[e.CenterClick=3]="CenterClick"})(t.MouseButton||(t.MouseButton={}));var n=t.MouseButton,o=(function(){function e(e,t,i,a,r){this._x=e,this._y=t,this.isMouseButtonDown=i,this._dx=a||0,this._dy=r||0}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dx",{get:function(){return this._dx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dy",{get:function(){return this._dy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMouseDown",{get:function(){return this.isMouseButtonDown},enumerable:!0,configurable:!0}),e})();t.TouchEvent=o;var s=(function(){function e(){this.touchList=[],this.swipeDirection=2,this.matchingDirectionCount=0,this.lockThreshold=!0,this.scrollThreshold=!0,this.lastTouchEvent=new o(0,0,(!1))}return Object.defineProperty(e.prototype,"lastEvent",{get:function(){return this.lastTouchEvent},enumerable:!0,configurable:!0}),e.prototype.addTouchRegion=function(e,t,i){var a={lastPoint:new o(0,0,(!1)),handler:t,region:e,converter:i};this.touchList=this.touchList.concat([a])},e.prototype.upAllTouches=function(){var e,t;t=this.touchList.length;for(var i=0;i<t;i++)this.touchList[i].lastPoint.isMouseDown&&(e=this.touchList[i].converter.getPixelToItem(this.touchList[i].lastPoint.x,this.touchList[i].lastPoint.y,0,0,!1),this.touchList[i].handler.touchEvent(e)),this.touchList[i].lastPoint=new o(this.touchList[i].lastPoint.x,this.touchList[i].lastPoint.y,(!1));this.lastTouchEvent=new o(0,0,(!1))},e.prototype.touchEvent=function(e){var t,i,a=0,r=0,n=0,s=0,l=0,u=null;t=this._getActive(),!this.lastTouchEvent.isMouseDown&&e.isMouseDown&&(t=this._findRegions(e)),n=this.lastTouchEvent.x-e.x,s=this.lastTouchEvent.y-e.y,this.lastTouchEvent=new o(e.x,e.y,e.isMouseDown,n,s),i=t.length;for(var c=0;c<i;c++)a=e.x-t[c].region.point.x,r=e.y-t[c].region.point.y,t[c].lastPoint.isMouseDown&&e.isMouseDown?(n=a-t[c].lastPoint.x,s=r-t[c].lastPoint.y,l=Math.abs(180/Math.PI*Math.atan(s/n)),this.scrollThreshold&&(this.lockThreshold&&this.matchingDirectionCount>5?1===this.swipeDirection?s=0:0===this.swipeDirection&&(n=0):l<20?(s=0,1===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=1)):(l=Math.abs(180/Math.PI*Math.atan(n/s)),l<20?(n=0,0===this.swipeDirection?this.matchingDirectionCount++:(this.matchingDirectionCount=1,this.swipeDirection=0)):2===this.swipeDirection?this.matchingDirectionCount++:(this.swipeDirection=2,this.matchingDirectionCount=1)))):(n=0,s=0,this.swipeDirection=2,this.matchingDirectionCount=0),t[c].lastPoint=new o(a,r,e.isMouseDown,n,s),u=t[c].converter.getPixelToItem(a,r,n,s,e.isMouseDown),t[c].handler.touchEvent(u)},e.prototype._findRegions=function(e){var t,a=[];t=this.touchList.length;for(var r=0;r<t;r++)this.touchList[r].region.contains(new i(e.x,e.y))&&(a=a.concat([this.touchList[r]]));return a},e.prototype._getActive=function(){var e,t=[];e=this.touchList.length;for(var i=0;i<e;i++)this.touchList[i].lastPoint.isMouseDown&&(t=t.concat([this.touchList[i]]));return t},e})();t.TouchManager=s;var l=80,u=600,c=(function(){function t(e){this.manager=e,this.touchPanel=null,this.scale=1,this.documentCallbacksWrapper=null,this.panelCallbacksWrapper=null,this.sliding=!1}return t.prototype.initTouch=function(e,t){e.style.setProperty("-ms-touch-action","pinch-zoom"),this.touchReferencePoint=t,this.touchPanel=e,this.startTouchPanelEvents()},t.prototype.startTouchPanelEvents=function(){var e=this;"ontouchmove"in this.touchPanel&&(this.panelCallbacksWrapper={startCallback:function(t){return e.onTouchStart(t)},endCallback:function(t){return e.onTouchEnd(t)}},this.touchPanel.addEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.addEventListener("touchend",this.panelCallbacksWrapper.endCallback))},t.prototype.clearTouchPanelEvents=function(){null!==this.panelCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(this.touchPanel.removeEventListener("touchstart",this.panelCallbacksWrapper.startCallback),this.touchPanel.removeEventListener("touchend",this.panelCallbacksWrapper.endCallback)),this.panelCallbacksWrapper=null)},t.prototype.getXYByClient=function(e,t,a){var r=a.left,n=a.top;void 0!==window.scrollX&&(r+=window.scrollX,n+=window.scrollY);var o=new i(0,0);return o.offset(e-r,t-n),o},t.prototype.onTouchStart=function(e){if(1===e.touches.length){e.cancelBubble=!0;var t=e.touches[0];this.touchStartTime=(new Date).getTime(),this.touchStartPageY=t.pageY,this.onTouchMouseDown(t)}},t.prototype.onTouchMove=function(e){if(1===e.touches.length){e.preventDefault&&e.preventDefault();var t=e.touches[0];this.touchLastPageY=t.pageY,this.touchLastPageX=t.pageX,this.sliding||this.onTouchMouseMove(t)}},t.prototype.onTouchEnd=function(e){this.clearTouchDocumentEvents();var t=this.getSwipeInfo();this.didUserSwipe(t)?this.startSlideAffect(t):this.sliding||this.upAllTouches()},t.prototype.onTouchMouseDown=function(t){this.scale=e.HTMLElementUtils.getAccumulatedScale(this.touchPanel),document.getSelection().removeAllRanges(),this.rect=(this.touchReferencePoint?this.touchReferencePoint:this.touchPanel).getBoundingClientRect(),this.startTouchDocumentEvents()},t.prototype.startTouchDocumentEvents=function(){var e=this;"ontouchmove"in this.touchPanel&&(this.documentCallbacksWrapper={moveCallback:function(t){return e.onTouchMove(t)},endCallback:function(t){return e.onTouchEnd(t)}},document.addEventListener("touchend",this.documentCallbacksWrapper.endCallback),document.addEventListener("touchmove",this.documentCallbacksWrapper.moveCallback)),"setCapture"in this.touchPanel&&this.touchPanel.setCapture()},t.prototype.onTouchMouseMove=function(e){var t,i,a=this.rect,r=null!==a&&e.which!==n.NoClick;r&&!this.sliding&&(i=this.getXYByClient(e.pageX,e.pageY,a),t=new o(i.x/this.scale,i.y/this.scale,r),this.manager.touchEvent(t),e.preventDefault?e.preventDefault():"returnValue"in e&&(e.returnValue=!1))},t.prototype.onTouchMouseUp=function(e,t){this.upAllTouches(),this.clearTouchDocumentEvents()},t.prototype.getSwipeInfo=function(){var e=(new Date).getTime(),t=e-this.touchStartTime,i=this.touchLastPageY-this.touchStartPageY,a=i<0?-1:1;return{direction:a,distance:i,endTime:e,time:t}},t.prototype.didUserSwipe=function(e){return e.time<u&&e.distance*e.direction>l},t.prototype.startSlideAffect=function(e){var t=this;if(!this.sliding){this.sliding=!0;var i=this.getXYByClient(this.touchLastPageX,this.touchLastPageY,this.rect);this.slide(i,300,e),requestAnimationFrame((function(){t.didUserChangeDirection(e)||t.slide(i,200,e),t.clearSlide()}))}},t.prototype.didUserChangeDirection=function(e){if(this.touchStartTime<=e.endTime)return!1;var t=this.touchLastPageY-this.touchStartPageY,i=t<0?-1:1;return i!==e.direction},t.prototype.slide=function(e,t,i){var a=this.touchStartTime>i.endTime?this.touchLastPageY-this.touchStartPageY:0;e.y+=t*i.direction+a;var r=new o(e.x/this.scale,e.y/this.scale,(!0));this.manager.touchEvent(r)},t.prototype.clearSlide=function(){this.sliding=!1,this.upAllTouches()},t.prototype.upAllTouches=function(){null===this.documentCallbacksWrapper&&(this.rect=null,this.manager.upAllTouches())},t.prototype.clearTouchDocumentEvents=function(){"releaseCapture"in this.touchPanel&&this.touchPanel.releaseCapture(),null!==this.documentCallbacksWrapper&&("ontouchmove"in this.touchPanel&&(document.removeEventListener("touchmove",this.documentCallbacksWrapper.moveCallback),document.removeEventListener("touchend",this.documentCallbacksWrapper.endCallback)),this.documentCallbacksWrapper=null)},t.prototype.clearAllTouchEvents=function(){this.clearTouchDocumentEvents(),this.clearTouchPanelEvents()},t})();t.TouchEventInterpreter=c})(t=e.TouchUtils||(e.TouchUtils={}))})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){!(function(e){e[e.Matrix=0]="Matrix",e[e.Table=1]="Table",e[e.PivotTable=2]="PivotTable"})(e.TablixType||(e.TablixType={}));e.TablixType})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){var i=t.internal.TablixObjects.PropGeneralAutoSizeColumns,a=t.internal.TablixObjects.getMetadadataObjects,r=(function(){function t(e,t,i,a){this.columnWidthObjects={},this.isMatrix=t,this.updateDataView(e,a),this.hostPersistCallBack=i,this.visualObjectInstancesToPersist={merge:[],remove:[]}}return t.prototype.updateDataView=function(e,t){this.previousDataView=this.currentDataView,this.previousDataView?this.previousAutoColumnSizePropertyValue=i.getValue(a(this.previousDataView)):this.previousAutoColumnSizePropertyValue=void 0,this.currentDataView=e,this.currentDataView?this.currentAutoColumnSizePropertyValue=i.getValue(a(this.currentDataView)):this.currentAutoColumnSizePropertyValue=void 0,this.matrixLeafNodes=t,this.updateColumnsMetadata(),this.updateTablixColumnWidths()},t.prototype.updateColumnsMetadata=function(){this.columnWidthObjects={},this.isMatrix?this.updateMatrixColumnsMetadata():this.updateTableColumnsMetadata()},t.prototype.updateTableColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.table)for(var e=this.currentDataView.table.columns,t=0,i=e.length;t<i;t++){var a=e[t].queryName;a&&(this.columnWidthObjects[a]={queryName:a,width:void 0,isFixed:!1})}},t.prototype.updateMatrixColumnsMetadata=function(){if(this.currentDataView&&this.currentDataView.matrix&&this.currentDataView.matrix.rows)for(var e=0,t=this.currentDataView.matrix.rows.levels.length;e<t;e++){var i=this.currentDataView.matrix.rows.levels[e];if(1===i.sources.length){var a=i.sources[0].queryName;a&&(this.columnWidthObjects[a]={queryName:a,width:void 0,isFixed:!1})}}if(this.matrixLeafNodes)for(var e=0,t=this.matrixLeafNodes.length;e<t;e++){var a=this.matrixLeafNodes[e].queryName;a&&(this.columnWidthObjects[a]={queryName:a,width:void 0,isFixed:!1})}},t.prototype.updateTablixColumnWidths=function(){var e=this.currentDataView&&this.currentDataView.metadata&&this.currentDataView.metadata.columns;if(e){if(this.shouldClearAllColumnWidths())return void this.autoSizeAllColumns();this.deserializeColumnsWidth(e)}},t.prototype.autoSizeAllColumns=function(){for(var e in this.columnWidthObjects)this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(e,void 0));this.callHostToPersist()},t.prototype.deserializeColumnsWidth=function(i){for(var a in this.columnWidthObjects)this.columnWidthObjects[a].isFixed=!this.currentAutoColumnSizePropertyValue,this.columnWidthObjects[a].width=void 0;for(var r=0,n=i.length;r<n;r++){var o=i[r],s=o.queryName,l=e.DataViewObjects.getValue(o.objects,t.columnWidthProp);this.columnWidthObjects.hasOwnProperty(s)&&null!=l&&(this.columnWidthObjects[s].width=l,this.columnWidthObjects[s].isFixed=!0)}},t.prototype.shouldPersistAllColumnWidths=function(){return!!this.previousDataView&&(!this.currentAutoColumnSizePropertyValue&&this.previousAutoColumnSizePropertyValue)},t.prototype.shouldClearAllColumnWidths=function(){return null!=this.previousDataView&&this.previousAutoColumnSizePropertyValue===!1&&null!=this.currentDataView&&this.currentAutoColumnSizePropertyValue===!0},t.getColumnQueryName=function(e){var t=e.getTablixCell();switch(t.type){case 0:if(null==t.item||null==t.item.metadata)return;return t.item.metadata.queryName;case 2:return t.item.queryName;default:return}},t.prototype.getColumnWidthObjects=function(){return this.columnWidthObjects},t.prototype.getFixedColumnWidthObjects=function(){var e={};for(var t in this.columnWidthObjects){var i=this.columnWidthObjects[t];i.isFixed&&(e[t]=i)}return e},t.prototype.getPersistedColumnWidth=function(e){var t=this.columnWidthObjects[e];return t&&t.width},t.prototype.callHostToPersist=function(){this.hostPersistCallBack&&this.hostPersistCallBack(this.visualObjectInstancesToPersist),this.visualObjectInstancesToPersist={merge:[],remove:[]}},t.prototype.onColumnWidthChanged=function(e,t){if(null!=e&&null!=this.columnWidthObjects[e]){var i=this.columnWidthObjects[e];t===-1?(i.width=void 0,i.isFixed=!this.currentAutoColumnSizePropertyValue,this.visualObjectInstancesToPersist.remove.push(this.generateColumnWidthObjectToPersist(i.queryName,void 0)),this.callHostToPersist()):(i.width=t,i.isFixed=!0,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(e,t)),this.callHostToPersist())}},t.prototype.onColumnsRendered=function(e){for(var t={},i=0,a=e.length;i<a;i++){var r=e[i].queryName,n=e[i].width;null==t[r]?t[r]={queryName:r,width:n,isFixed:!1}:n>t[r].width&&(t[r].width=n)}var o=!1;for(var r in this.columnWidthObjects)if(t[r]){var s=this.columnWidthObjects[r];s.isFixed&&null==s.width&&(s.width=t[r].width,this.visualObjectInstancesToPersist.merge.push(this.generateColumnWidthObjectToPersist(r,s.width)),o=!0)}return o&&this.callHostToPersist(),o},t.prototype.generateColumnWidthObjectToPersist=function(e,t){return{selector:{metadata:e},objectName:"general",properties:{columnWidth:t}}},t.columnWidthProp={objectName:"general",propertyName:"columnWidth"},t})();t.TablixColumnWidthManager=r})(i=t.controls||(t.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e){var t=e.tooltips();return t?new a(t):new r}e.createTooltipService=t;var i=1e3,a=(function(){function t(e,t){void 0===t&&(t=i),this.visualHostTooltipService=e,this.handleTouchDelay=t}return t.prototype.addTooltip=function(t,i,a,r){var n=this;if(this.visualHostTooltipService.enabled()){var o=this.visualHostTooltipService.container();t.on("mouseover.tooltip",(function(){if(n.canDisplayTooltip(d3.event)){var e=n.makeTooltipEventArgs(o,!0,!1);if(e){var t=i(e);if(null!=t){var r=a(e),s=r&&r.getSelectorsByColumn();n.visualHostTooltipService.show({coordinates:e.coordinates,isTouchEvent:!1,dataItems:t,identities:s?[s]:[]})}}}})),t.on("mouseout.tooltip",(function(){n.visualHostTooltipService.hide({isTouchEvent:!1,immediately:!1})})),t.on("mousemove.tooltip",(function(){if(n.canDisplayTooltip(d3.event)){var e=n.makeTooltipEventArgs(o,!0,!1);if(e){var t;if(!r||(t=i(e),null!=t)){var s=a(e),l=s&&s.getSelectorsByColumn();n.visualHostTooltipService.move({coordinates:e.coordinates,isTouchEvent:!1,dataItems:t,identities:l?[l]:[]})}}}}));var s=e.TouchUtils.touchStartEventName(),l=e.TouchUtils.touchEndEventName(),u=e.TouchUtils.usePointerEvents();t.on(s+".tooltip",(function(){n.visualHostTooltipService.hide({isTouchEvent:!0,immediately:!0});var e=n.makeTooltipEventArgs(o,u,!0);if(e){var t=i(e),r=a(e),s=r&&r.getSelectorsByColumn();n.visualHostTooltipService.show({coordinates:e.coordinates,isTouchEvent:!0,dataItems:t,identities:s?[s]:[]})}})),t.on(l+".tooltip",(function(){n.visualHostTooltipService.hide({isTouchEvent:!0,immediately:!1}),n.handleTouchTimeoutId&&clearTimeout(n.handleTouchTimeoutId),n.handleTouchTimeoutId=setTimeout((function(){n.handleTouchTimeoutId=void 0}),n.handleTouchDelay)}))}},t.prototype.hide=function(){this.visualHostTooltipService.hide({immediately:!0,isTouchEvent:!1})},t.prototype.makeTooltipEventArgs=function(e,t,i){var a=d3.event.target,r=d3.select(a).datum(),n=this.getCoordinates(e,t),o=this.getCoordinates(a,t),s={data:r,coordinates:n,elementCoordinates:o,context:a,isTouchEvent:i};return s},t.prototype.canDisplayTooltip=function(e){var t=!0,i=e;if(void 0!==i.buttons){var a=0!==i.buttons;t=!a}return t=t&&null==this.handleTouchTimeoutId},t.prototype.getCoordinates=function(e,t){var i;if(t){for(var a=d3.event,r=void 0;r=a.sourceEvent;)a=r;var n=e.getBoundingClientRect();i=[a.clientX-n.left-e.clientLeft,a.clientY-n.top-e.clientTop]}else{var o=d3.touches(e);o&&o.length>0&&(i=o[0])}return i},t})();e.TooltipService=a;var r=(function(){function t(){}return t.prototype.addTooltip=function(t,i,a,r){e.TooltipManager.addTooltip(t,i,r)},t.prototype.hide=function(){e.TooltipManager.ToolTipInstance.hide()},t})();e.LegacyTooltipService=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=(function(){function i(e){this.mainText=a.CssConstants.createClassAndSelector("mainText"),this.name=e,this.visualConfiguration={maxFontSize:60}}return i.prototype.getMetaDataColumn=function(e){if(e&&e.metadata&&e.metadata.columns)for(var t=0,i=e.metadata.columns.length;t<i;t++){var a=e.metadata.columns[t];if(a.isMeasure){this.metaDataColumn=a;break}}},i.prototype.getAdjustedFontHeight=function(e,t,i){var a={fontFamily:null,fontSize:null,text:t},r=this.getAdjustedFontHeightCore(a,e,i,0);return r},i.prototype.getAdjustedFontHeightCore=function(t,i,r,n){if(n>10)return r;t.fontSize=a.PixelConverter.toString(r);var o=e.TextMeasurementService.measureSvgTextWidth(t);return o<i?r:this.getAdjustedFontHeightCore(t,i,.9*r,n+1)},i.prototype.clear=function(){this.svg.select(this.mainText.selector).text("")},i.prototype.doValueTransition=function(e,i,a,r,n,o,s){if(o||e!==i||null==i){e||(e=0);var l=this.svg,u=this.currentViewport,c=u.height,d=u.width,p=[i],h=this.getSeedFontHeight(d,c),g=this.getTranslateX(d),f=this.getTranslateY(h),m=this.metaDataColumn;s||(s=t.valueFormatter.create({format:this.getFormatString(m),value:i,displayUnitSystemType:a,formatSingleValues:!0,allowFormatBeautification:!0,columnType:m?m.type:void 0}));var y=s.format(e),v=s.format(i);l.attr("class",this.name);var w=l.selectAll("text").data(p);w.enter().append("text").attr("class",this.mainText.class);var b=this.getAdjustedFontHeight(d,v,h);f=this.getTranslateY(b+(c-b)/2);var C=w.text(y).attr({"text-anchor":this.getTextAnchor(),"font-size":b,transform:t.SVGUtil.translate(g,f)}).style({fill:this.style.titleText.color.value}).call(t.tooltipUtils.tooltipUpdate,[y]);if(null==i)C.text(v).call(t.tooltipUtils.tooltipUpdate,[v]);else if(m&&t.AxisHelper.isDateTime(m.type))C.text(v).call(t.tooltipUtils.tooltipUpdate,[v]);else{var S=e;C.transition().duration(n).tween("text",(function(e){var t=d3.interpolate(S,e);return function(e){var i=t(e);this.textContent=s.format(i)}}))}t.SVGUtil.flushAllD3TransitionsIfNeeded(r)}},i.prototype.setTextColor=function(e){this.style.titleText.color.value=e},i.prototype.getSeedFontHeight=function(e,t){var i=Math.floor(.75*Math.min(e,t)),a=this.visualConfiguration.maxFontSize;return a?Math.min(a,i):i},i.prototype.getTranslateX=function(e){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return 0;case"right":return e}return e/2},i.prototype.getTranslateY=function(e){return e},i.prototype.getTextAnchor=function(){if(this.visualConfiguration)switch(this.visualConfiguration.align){case"left":return"start";case"right":return"end"}return"middle"},i.prototype.getFormatString=function(e){return t.valueFormatter.getFormatString(e,i.formatStringProp)},i.formatStringProp={objectName:"general",propertyName:"formatString"},i})();t.AnimatedText=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(t){function i(e,i){t.call(this,"animatedNumber"),e&&(this.svg=e),i&&(this.animator=i)}return a(i,t),i.prototype.init=function(e){this.options=e;var t=e.element;this.svg||(this.svg=d3.select(t.get(0)).append("svg")),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportDependantProperties()},i.prototype.updateViewportDependantProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},i.prototype.update=function(e){this.currentViewport=e.viewport;var t=this.dataViews=e.dataViews;if(t&&t[0]){var i=t[0];this.updateViewportDependantProperties(),this.getMetaDataColumn(i);var a=i&&i.single?i.single.value:0;this.updateInternal(a,e.suppressAnimations,!0,this.formatter)}},i.prototype.setFormatter=function(e){this.formatter=e},i.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},i.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},i.prototype.canResizeTo=function(e){return!0},i.prototype.updateInternal=function(t,i,a,r){void 0===a&&(a=!1);var n=this.value,o=e.AnimatorCommon.GetAnimationDuration(this.animator,i);this.doValueTransition(n,t,null,this.options.animation,o,a,r),this.value=t},i})(e.AnimatedText);e.AnimatedNumber=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=(function(){function i(e){}return Object.defineProperty(i.prototype,"shapeType",{get:function(){return this.data.shapeType},set:function(e){this.data.shapeType=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineColor",{get:function(){return this.data?this.data.lineColor:i.DefaultStrokeColor},set:function(e){this.data.lineColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineTransparency",{get:function(){return this.data?this.data.lineTransparency:i.DefaultLineTransValue},set:function(e){this.data.lineTransparency=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineWeight",{get:function(){return this.data?this.data.lineWeight:i.DefaultWeightValue},set:function(e){this.data.lineWeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"roundEdge",{get:function(){return this.data?this.data.roundEdge:i.DefaultRoundEdgeValue},set:function(e){this.data.roundEdge=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showFill",{get:function(){return this.data?this.data.showFill:i.DefaultFillShowValue},set:function(e){this.data.showFill=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillColor",{get:function(){return this.data?this.data.fillColor:i.DefaultFillColor},set:function(e){this.data.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shapeTransparency",{get:function(){return this.data?this.data.shapeTransparency:i.DefaultFillTransValue},set:function(e){this.data.shapeTransparency=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.data?this.data.angle:i.DefaultAngle},set:function(e){this.data.angle=this.scaleTo360Deg(e)},enumerable:!0,configurable:!0}),i.prototype.init=function(e){this.element=e.element,this.selection=d3.select(this.element.context),this.currentViewport=e.viewport},i.prototype.update=function(e){this.currentViewport=e.viewport;var t=e.dataViews;if(!_.isEmpty(t)){var i=e.dataViews[0];if(i.metadata&&i.metadata.objects){var a=e.dataViews[0].metadata.objects;this.data=this.getDataFromDataView(a),this.render()}}},i.prototype.getDataFromDataView=function(a){return a?{shapeType:e.DataViewObjects.getValue(a,t.basicShapeProps.general.shapeType,i.DefaultShape),lineColor:this.getValueFromColor(e.DataViewObjects.getValue(a,t.basicShapeProps.line.lineColor,i.DefaultStrokeColor)),lineTransparency:e.DataViewObjects.getValue(a,t.basicShapeProps.line.transparency,i.DefaultLineTransValue),lineWeight:e.DataViewObjects.getValue(a,t.basicShapeProps.line.weight,i.DefaultWeightValue),roundEdge:e.DataViewObjects.getValue(a,t.basicShapeProps.line.roundEdge,i.DefaultRoundEdgeValue),shapeTransparency:e.DataViewObjects.getValue(a,t.basicShapeProps.fill.transparency,i.DefaultFillTransValue),fillColor:this.getValueFromColor(e.DataViewObjects.getValue(a,t.basicShapeProps.fill.fillColor,i.DefaultFillColor)),showFill:e.DataViewObjects.getValue(a,t.basicShapeProps.fill.show,i.DefaultFillShowValue),angle:this.scaleTo360Deg(e.DataViewObjects.getValue(a,t.basicShapeProps.rotation.angle,i.DefaultAngle))}:null},i.prototype.scaleTo360Deg=function(e){return 0!==e&&Math.abs(e)%360===0?e:(e%=360,e=(e+360)%360)},i.prototype.getValueFromColor=function(e){return e.solid?e.solid.color:e},i.prototype.enumerateObjectInstances=function(e){var i=[];if(!this.data)return i;switch(e.objectName){case"line":var a={selector:null,properties:{lineColor:this.lineColor,transparency:this.lineTransparency,weight:this.lineWeight},objectName:e.objectName};return this.shapeType===t.basicShapeType.rectangle&&(a.properties.roundEdge=this.roundEdge),i.push(a),i;case"fill":return this.shapeType!==t.basicShapeType.line&&i.push({selector:null,properties:{show:this.showFill,fillColor:this.fillColor,transparency:this.shapeTransparency},objectName:e.objectName}),i;case"rotation":return i.push({selector:null,properties:{angle:this.angle},objectName:e.objectName}),i}return null},i.prototype.render=function(){switch(this.selection.html(""),this.shapeType){case t.basicShapeType.rectangle:t.ShapeFactory.createRectangle(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.oval:t.ShapeFactory.createOval(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.line:t.ShapeFactory.createLine(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.arrow:t.ShapeFactory.createUpArrow(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle);break;case t.basicShapeType.triangle:t.ShapeFactory.createTriangle(this.data,this.currentViewport.height,this.currentViewport.width,this.selection,this.angle)}},i.DefaultShape=t.basicShapeType.rectangle,i.DefaultStrokeColor="#00B8AA",i.DefaultFillColor="#E6E6E6",i.DefaultFillShowValue=!0,i.DefaultFillTransValue=0,i.DefaultWeightValue=3,i.DefaultLineTransValue=0,i.DefaultRoundEdgeValue=0,i.DefaultAngle=0,i})();t.BasicShapeVisual=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){var i,r=a.CssConstants.createClassAndSelector;!(function(e){e[e.None=0]="None",e[e.DraggingThumb=1]="DraggingThumb",e[e.BackgroundClicked=2]="BackgroundClicked",e[e.InitialPagingDelay=3]="InitialPagingDelay",e[e.Paging=4]="Paging"})(i||(i={}));var n=(function(){function t(e){this.scrollingMode=i.None,this.brush=d3.svg.brush(),this.brushWidth=e}return t.prototype.init=function(e){this.element=e},t.prototype.remove=function(){this.element.selectAll(t.Brush.selector).remove(),this.brush.on(t.events.brushStart,null).on(t.events.brush,null).on(t.events.brushEnd,null),this.brushGraphicsContext=void 0,null!=this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)},t.prototype.getExtent=function(){var e=this.brush.extent();return{start:e[0],end:e[1]}},t.prototype.setExtent=function(e){var a;null==e.start||null==e.end?(a=this.getExtentLength(),null==e.start?e.start=e.end-a:e.end=e.start+a):a=e.end-e.start;var r=this.getExtent().start;e=t.clampExtent(e,this.scrollBarLength,a),this.scrollingMode!==i.None&&(this.offset=e.start-r,this.previousBrushExtent=e),this.brush.extent([e.start,e.end])},t.prototype.getExtentLength=function(){var e=this.getExtent();return e.end-e.start},t.prototype.setExtentLength=function(e){var t=this.getExtent();t.end=t.start+e,this.setExtent(t)},t.prototype.setScale=function(e){this.isHorizontal?this.brush.x(e):this.brush.y(e)},t.prototype.setOrientation=function(e){this.isHorizontal=e},t.prototype.render=function(a,r,n){var o=this;this.brushGraphicsContext||(this.brushGraphicsContext=this.element.append("g").classed(t.Brush.class,!0)),this.onRefreshVisualCallback=n,this.brush.on(t.events.brushStart,(function(){o.previousBrushExtent=o.getExtent()})).on(t.events.brush,(function(){var e=o.getExtent();o.scrollingMode===i.None&&(e.start<0&&0===e.end?e.start=0:e.start===o.scrollBarLength&&e.end>o.scrollBarLength&&(e.end=o.scrollBarLength),o.scrollingMode=t.isBackgroundClickExtent(e)?i.BackgroundClicked:i.DraggingThumb,o.startBrushExtent=e),null!=o.offset&&(e.start+=o.offset,e.end+=o.offset);var a=o.getExtentLength();
switch(e=t.clampExtent(e,o.scrollBarLength,a),o.pointerPosition=o.getPointerPosition(),o.scrollingMode){case i.DraggingThumb:o.refreshVisual();break;case i.BackgroundClicked:if(t.CenterOnBackgroundClick){var r=a/2;e.start=o.pointerPosition-r,e.end=o.pointerPosition+r,o.refreshVisual()}else{var n=e.start>o.previousBrushExtent.start;e=t.stepExtent(o.previousBrushExtent,n),o.refreshVisual(),o.scrollingMode=i.InitialPagingDelay,o.setStepTimeout(n,e)}break;case i.InitialPagingDelay:case i.Paging:e=o.previousBrushExtent}o.setExtent(e),o.refreshExtent(),o.previousBrushExtent=e})).on(t.events.brushEnd,(function(){o.setExtent(o.previousBrushExtent),o.refreshExtent(),o.previousBrushExtent=null,o.startBrushExtent=null,o.pointerPosition=null,o.scrollingMode=i.None,o.offset=null,null!=o.timeoutId&&(window.clearTimeout(o.timeoutId),o.timeoutId=null)}));var s=this.brushGraphicsContext.attr({transform:e.SVGUtil.translate(a,r),"drag-resize-disabled":"true"}).call(this.brush);s.selectAll(".resize").remove(),this.isHorizontal?s.selectAll("rect").attr("height",this.brushWidth):s.selectAll("rect").attr("width",this.brushWidth)},t.prototype.shouldContinueStepping=function(e,t){var i=this.pointerPosition>=t.start&&this.pointerPosition<=t.end;return 0!==t.start&&t.end!==e&&!i},t.prototype.getPointerPosition=function(){var e=this.getExtent();return t.isBackgroundClickExtent(this.startBrushExtent)?e.start<this.startBrushExtent.start?e.start:e.end:(e.end-e.start)/2},t.prototype.refreshExtent=function(){var e=this.getExtent(),t=this.getExtentLength();this.isHorizontal?(this.brushGraphicsContext.select(".extent").attr("width",t),this.brushGraphicsContext.select(".extent").attr("x",e.start)):(this.brushGraphicsContext.select(".extent").attr("height",t),this.brushGraphicsContext.select(".extent").attr("y",e.start))},t.prototype.refreshVisual=function(){this.onRefreshVisualCallback&&window.requestAnimationFrame(this.onRefreshVisualCallback)},t.prototype.refreshExtentAndVisual=function(){this.refreshExtent(),this.refreshVisual()},t.prototype.setStepTimeout=function(e,a){var r=this;if(this.shouldContinueStepping(this.scrollBarLength,a)){var n=this.scrollingMode===i.InitialPagingDelay?t.InitialPagingDelayMS:t.PagingDelayMS;this.timeoutId=_.delay((function(){r.onPagingTimeoutExpired(e)}),n)}},t.isBackgroundClickExtent=function(e){return e.start===e.end},t.stepExtent=function(e,t){var i=e.end-e.start;return e.start=t?e.start+i:e.start-i,e.end=t?e.end+i:e.end-i,e},t.prototype.onPagingTimeoutExpired=function(e){this.scrollingMode!==i.Paging&&(this.scrollingMode=i.Paging);var a=this.getExtent(),r=t.stepExtent(a,e);this.setExtent(r),this.refreshExtentAndVisual(),this.previousBrushExtent=a,this.setStepTimeout(e,r)},t.clampExtent=function(e,t,i){return e.start<0&&(e.start=0,e.end=i),e.end>t&&(e.end=t,e.start=t-i),e},t.InitialPagingDelayMS=500,t.PagingDelayMS=50,t.CenterOnBackgroundClick=!1,t.events={brushStart:"brushstart",brush:"brush",brushEnd:"brushend"},t.Brush=r("brush"),t})();t.SvgScrollbar=n})(t=e.controls||(e.controls={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){return e.length>1}function r(e,t,i){return 0===e&&!!t&&!!t.showAxisTitle||1===e&&!i&&!!t&&!!t.secShowAxisTitle}function n(e,t){var i={domain:void 0,merged:!1,tickCount:void 0};if(e.length<2)return i;var a,r,n,o,s=e[0].calculateAxesProperties(t)[1],u=e[1].calculateAxesProperties(t)[1],c=s.scale.domain(),d=u.scale.domain();if(s.values&&s.values.length>0&&u.values&&u.values.length>0&&(i.tickCount=Math.max(s.values.length,u.values.length)),a=Math.min(c[0],d[0]),r=Math.max(c[1],d[1]),t.forceMerge)return{domain:[a,r],merged:!0,tickCount:i.tickCount};if(c[0]>d[1]||c[1]<d[0])return i;o=Math.max(c[0],d[0]),n=Math.min(c[1],d[1]);var p=r-a;if(0===p)return i;var h=Math.abs((n-o)/p);return h<l?i:{domain:[a,r],merged:!0,tickCount:i.tickCount}}var o=a.EnumExtensions,s=a.CssConstants.createClassAndSelector,l=.1,u=(function(){function i(e){this.axes=e}return i.prototype.getScrollableRegion=function(){return this.axisGraphicsContextScrollable},i.prototype.getLabelsRegion=function(){return this.labelRegion},i.prototype.getLabelBackground=function(){return this.labelBackgroundRegion},i.prototype.getXAxis=function(){return this.xAxisGraphicsContext},i.prototype.getY1Axis=function(){return this.y1AxisGraphicsContext},i.prototype.getY2Axis=function(){return this.y2AxisGraphicsContext},i.prototype.update=function(e,t){this.categoryAxisProperties=e,this.valueAxisProperties=t},i.prototype.init=function(e){var a=this.axisGraphicsContext=e.append("g").classed(i.AxisGraphicsContext.class,!0);this.svgScrollable=e.append("svg").classed("svgScrollable",!0).style("overflow","hidden");var r=this.axisGraphicsContextScrollable=this.svgScrollable.append("g").classed(i.AxisGraphicsContext.class,!0);this.labelBackgroundRegion=this.svgScrollable.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass.class,!0),this.labelRegion=this.svgScrollable.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass.class,!0);var n=this.axes.showLinesOnX,o=this.axes.showLinesOnY,s=o,l=!s;l?(this.y1AxisGraphicsContext=r.append("g").attr("class","y axis"),this.y2AxisGraphicsContext=r.append("g").attr("class","y axis")):(this.y1AxisGraphicsContext=a.append("g").attr("class","y axis"),this.y2AxisGraphicsContext=a.append("g").attr("class","y axis")),s?this.xAxisGraphicsContext=r.append("g").attr("class","x axis"):this.xAxisGraphicsContext=a.append("g").attr("class","x axis"),this.xAxisGraphicsContext.classed("showLinesOnAxis",n),this.y1AxisGraphicsContext.classed("showLinesOnAxis",o),this.y2AxisGraphicsContext.classed("showLinesOnAxis",o),this.xAxisGraphicsContext.classed("hideLinesOnAxis",!n),this.y1AxisGraphicsContext.classed("hideLinesOnAxis",!o),this.y2AxisGraphicsContext.classed("hideLinesOnAxis",!o)},i.updateAnimatedTickTooltips=function(e,t){e.each("end",(function(){d3.select(this).selectAll("text").append("title").text((function(e,i){return t[i]}))}))},i.updateTickTooltips=function(e,t){e.selectAll("text").append("title").text((function(e,i){return t[i]}))},i.prototype.renderXAxis=function(r){var n=r.graphicsElement,o=r.layout,s=r.fontSize,l=r.axisProps,u=r.duration,c=r.easing,d=r.labelColor,p=r.isStacked,h=o.margin,g=o.tickLabelMargins,f=o.marginLimits,m=f.bottom;if(l.axis.orient("bottom"),!l.willLabelsFit&&t.AxisHelper.isOrdinalScale(l.scale)&&l.axis.tickPadding(i.TickPaddingRotatedX),u&&!p?n.transition().duration(u).ease(c).call(l.axis).call(i.updateAnimatedTickTooltips,l.values):n.call(l.axis),n.call(i.darkenZeroLine,!t.AxisHelper.isOrdinalScale(l.axis.scale())).call(i.setAxisLabelColor,d),p){var y=l;i.removeUnwantedLines(n,y),_.isEmpty(l.xLabelMaxWidths)?n.selectAll("g.tick").selectAll("line").remove():(i.centerHierarchyTicks(n,y),i.styleHierarchyTicks(n,y))}var v=_.clone(t.CartesianChart.AxisTextProperties);v.fontSize=a.PixelConverter.toString(s.x);var w=n.selectAll("text");l.willLabelsWordBreak?w.call(t.AxisHelper.LabelLayoutStrategy.wordBreak,l,m):w.call(t.AxisHelper.LabelLayoutStrategy.rotate,m,e.TextMeasurementService.getTailoredTextOrDefault,v,!l.willLabelsFit&&t.AxisHelper.isOrdinalScale(l.scale),m===g.xMax,l,h,this.axes.isXScrollBarVisible||this.axes.isYScrollBarVisible||!l.willLabelsFit&&!!p),u||p||i.updateTickTooltips(n,l.values),w.style("font-size",a.PixelConverter.toString(s.x))},i.prototype.renderAxes=function(r,n,o,s){void 0===s&&(s="cubic-in-out");var l,u,d,p,h,g,f=r.marginLimits,m=r.plotArea,y=r.viewport,v=r.margin,w=r.axes,b=r.tickLabelMargins,C=f.left;if(r.shouldRenderAxis.x){w.x.isCategoryAxis?(l=this.categoryAxisProperties&&this.categoryAxisProperties.labelColor?this.categoryAxisProperties.labelColor:null,p=this.categoryAxisProperties&&this.categoryAxisProperties.titleColor?this.categoryAxisProperties.titleColor:l):(l=this.valueAxisProperties&&this.valueAxisProperties.labelColor?this.valueAxisProperties.labelColor:null,p=this.valueAxisProperties&&this.valueAxisProperties.titleColor?this.valueAxisProperties.titleColor:l);var S=this.xAxisGraphicsContext;if(_.isEmpty(w.xStack)){S.selectAll(".stack").remove();var x={graphicsElement:S,axisProps:w.x,layout:r,labelColor:l,duration:n,easing:s,fontSize:o,isStacked:!1};this.renderXAxis(x)}else{this.axisGraphicsContextScrollable.selectAll(".x.axis > .tick").remove();var P=S.selectAll(".stack").data(w.xStack);P.enter().append("g").classed({showLinesOnAxis:!0,stack:!0}),P.exit().remove();var D=w.xStack.length,T=c.getLeafHeight(b.xMax,b.stackHeight,D),V=this;P.each((function(e,i){var a=0;i>0&&(a=T+(i-1)*b.stackHeight);var u=d3.select(this);u.attr("transform",t.SVGUtil.translate(0,a));var c={graphicsElement:u,axisProps:e,layout:r,labelColor:l,duration:n,easing:s,fontSize:o,isStacked:!0};V.renderXAxis(c)}))}}else this.xAxisGraphicsContext.selectAll("*").remove();if(r.shouldRenderAxis.y){w.y1.isCategoryAxis?(u=this.categoryAxisProperties&&this.categoryAxisProperties.labelColor?this.categoryAxisProperties.labelColor:null,h=this.categoryAxisProperties&&this.categoryAxisProperties.titleColor?this.categoryAxisProperties.titleColor:u):(u=this.valueAxisProperties&&this.valueAxisProperties.labelColor?this.valueAxisProperties.labelColor:null,h=this.valueAxisProperties&&this.valueAxisProperties.titleColor?this.valueAxisProperties.titleColor:u);var L=this.axes.shouldShowY1OnRight(),M=L?r.tickPadding.right:r.tickPadding.left;w.y1.axis.tickSize(-m.width).tickPadding(M).orient(this.axes.getYAxisOrientation().toLowerCase());var N=this.y1AxisGraphicsContext;if(n?N.transition().duration(n).ease(s).call(w.y1.axis).call(i.updateAnimatedTickTooltips,w.y1.values):N.call(w.y1.axis),N.call(i.darkenZeroLine,!t.AxisHelper.isOrdinalScale(w.y1.axis.scale())).call(i.setAxisLabelColor,u),b.yLeft>=C&&N.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.clip,C-M,e.TextMeasurementService.svgEllipsis),n||i.updateTickTooltips(N,w.y1.values),N.style("font-size",a.PixelConverter.toString(o.y)),!w.y2||this.valueAxisProperties&&null!=this.valueAxisProperties.secShow&&!this.valueAxisProperties.secShow)this.y2AxisGraphicsContext.selectAll("*").remove();else{d=this.valueAxisProperties&&this.valueAxisProperties.secLabelColor?this.valueAxisProperties.secLabelColor:u,g=this.valueAxisProperties&&this.valueAxisProperties.secTitleColor?this.valueAxisProperties.secTitleColor:d;var I=L?r.tickPadding.left:r.tickPadding.right;w.y2.axis.tickSize(i.Y2TickSize).tickPadding(I).orient(L?t.yAxisPosition.left.toLowerCase():t.yAxisPosition.right.toLowerCase());var A=this.y2AxisGraphicsContext;n?A.transition().duration(n).ease(s).call(w.y2.axis).call(i.updateAnimatedTickTooltips,w.y2.values):A.call(w.y2.axis),A.call(i.darkenZeroLine,!t.AxisHelper.isOrdinalScale(w.y2.axis.scale())).call(i.setAxisLabelColor,d),b.yRight>=C&&A.selectAll("text").call(t.AxisHelper.LabelLayoutStrategy.clip,C-I,e.TextMeasurementService.svgEllipsis),n||i.updateTickTooltips(A,w.y2.values),A.style("font-size",a.PixelConverter.toString(o.y2))}}else this.y1AxisGraphicsContext.selectAll("*").remove(),this.y2AxisGraphicsContext.selectAll("*").remove();var O=r.axisLabels,R=null!=O.x||null!=O.y||null!=O.y2;if(R){var E=!this.axes.shouldRenderAxisTitle(w.x,!0,!1),F=!this.axes.shouldRenderAxisTitle(w.y1,!0,!1),j=!this.axes.shouldRenderAxisTitle(w.y2,!1,!0),H={axisLabels:O,viewport:y,margin:v,hideXAxisTitle:E,hideYAxisTitle:F,hideY2AxisTitle:j,xLabelColor:p,yLabelColor:h,y2LabelColor:g,axisTitleFontSize:{x:o.x,y:o.y,y2:o.y2}};this.renderAxesLabels(H)}else this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();this.translateAxes(y,v)},i.prototype.renderAxesLabels=function(i){this.axisGraphicsContext.selectAll(".xAxisLabel").remove(),this.axisGraphicsContext.selectAll(".yAxisLabel").remove();var r=i.margin,n=i.viewport.width-(r.left+r.right),o=i.viewport.height,s=_.clone(t.CartesianChart.AxisTextProperties),l=this.axes.shouldShowY1OnRight();if(!i.hideXAxisTitle){s.fontSize=a.PixelConverter.toString(i.axisTitleFontSize.x),s.text=i.axisLabels.x;var u=e.TextMeasurementService.estimateSvgTextHeight(s),c=this.axisGraphicsContext.append("text").style("text-anchor","middle").style("font-size",s.fontSize).text(i.axisLabels.x).call((function(e){e.each((function(){var e=d3.select(this);e.attr({class:"xAxisLabel",transform:t.SVGUtil.translate(n/2,o-u)})}))}));c.style("fill",i.xLabelColor?i.xLabelColor.solid.color:null),c.call(t.AxisHelper.LabelLayoutStrategy.clip,n,e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.x])}if(!i.hideYAxisTitle){s.fontSize=a.PixelConverter.toString(i.axisTitleFontSize.y),s.text=i.axisLabels.y;var d=e.TextMeasurementService.estimateSvgTextHeight(s),p=this.axisGraphicsContext.append("text").style("text-anchor","middle").style("font-size",s.fontSize).text(i.axisLabels.y).call((function(e){e.each((function(){var e=d3.select(this);e.attr({class:"yAxisLabel",transform:"rotate(-90)",y:l?n+r.right-d:-r.left,x:-((o-r.top-r.bottom)/2),dy:"1em"})}))}));p.style("fill",i.yLabelColor?i.yLabelColor.solid.color:null),p.call(t.AxisHelper.LabelLayoutStrategy.clip,o-(r.bottom+r.top),e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.y])}if(!i.hideY2AxisTitle&&i.axisLabels.y2){s.fontSize=a.PixelConverter.toString(i.axisTitleFontSize.y2),s.text=i.axisLabels.y2;var h=e.TextMeasurementService.estimateSvgTextHeight(s),g=this.axisGraphicsContext.append("text").style("text-anchor","middle").text(i.axisLabels.y2).call((function(e){e.each((function(){var e=d3.select(this);e.attr({class:"yAxisLabel",transform:"rotate(-90)",y:l?-r.left:n+r.right-h,x:-((o-r.top-r.bottom)/2),dy:"1em"})}))}));g.style("fill",i.y2LabelColor?i.y2LabelColor.solid.color:null),g.call(t.AxisHelper.LabelLayoutStrategy.clip,o-(r.bottom+r.top),e.TextMeasurementService.svgEllipsis).call(t.tooltipUtils.tooltipUpdate,[i.axisLabels.y2])}},i.prototype.translateAxes=function(e,i){var a=e.width-(i.left+i.right),r=e.height-(i.top+i.bottom),n=this.axes.shouldShowY1OnRight();this.xAxisGraphicsContext.attr("transform",t.SVGUtil.translate(0,r)),this.y1AxisGraphicsContext.attr("transform",t.SVGUtil.translate(n?a:0,0)),this.y2AxisGraphicsContext.attr("transform",t.SVGUtil.translate(n?0:a,0)),this.svgScrollable.attr({x:0,width:e.width,height:e.height}),this.axisGraphicsContext.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.labelRegion.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.labelBackgroundRegion.attr("transform",t.SVGUtil.translate(i.left,i.top)),this.axes.isXScrollBarVisible?(this.svgScrollable.attr({x:i.left}),this.axisGraphicsContextScrollable.attr("transform",t.SVGUtil.translate(0,i.top)),this.labelRegion.attr("transform",t.SVGUtil.translate(0,i.top)),this.labelBackgroundRegion.attr("transform",t.SVGUtil.translate(0,i.top)),this.svgScrollable.attr("width",a)):this.axes.isYScrollBarVisible&&this.svgScrollable.attr("height",r+i.top)},i.darkenZeroLine=function(e,t){if(e.selectAll("g.tick line").classed("zero-line",!1),t){var i=e.selectAll("g.tick").filter((function(e){return 0===e})).node();i&&d3.select(i).select("line").classed("zero-line",!0)}},i.setAxisLabelColor=function(e,t){e.selectAll("g.tick text").style("fill",t?t.solid.color:null)},i.removeUnwantedLines=function(e,t){e.selectAll("g.tick").filter((function(e){return t.adjustedValues[e]===c.hierarchyPlaceholder})).selectAll("line").remove()},i.centerHierarchyTicks=function(e,i){e.selectAll("g.tick").filter((function(e){return i.adjustedValues[e]!==c.hierarchyPlaceholder})).each((function(e){var a=d3.select(this),r=a.attr("transform"),n=t.SVGUtil.parseTranslateTransform(r);if(n&&+n.x>0){var o=+n.x+i.xLabelMaxWidths[e]/2-i.categoryThickness/2+t.CartesianChart.TickLabelPadding;a.attr("transform",t.SVGUtil.translate(o,+n.y))}}))},i.styleHierarchyTicks=function(e,t){var i=e.selectAll("g.tick").filter((function(e){return t.adjustedValues[e]!==c.hierarchyPlaceholder})).selectAll("line").data((function(e){return t.lineStyleInfo[e]}));i.enter().append("line"),i.attr("x1",(function(e){return e.x1})).attr("y1",(function(e){return e.y1})).attr("x2",(function(e){return e.x2})).attr("y2",(function(e){return e.y2})).attr("stroke",(function(e){return e.stroke})).attr("stroke-width",(function(e){return e.strokeWidth})),i.exit().remove()},i.AxisPadding={left:10,right:10,top:0,bottom:13},i.AxisGraphicsContext=s("axisGraphicsContext"),i.TickPaddingRotatedX=5,i.Y2TickSize=-6,i})();t.SvgCartesianAxes=u;var c=(function(){function s(e,i,a){this.scrollbarWidth=i,this.isScrollable=e,this.maxMarginFactor=s.MaxMarginFactor,this.yAxisOrientation=t.yAxisPosition.left,this.trimOrdinalDataOnOverflow=a}return s.prototype.shouldShowY1OnRight=function(){return this.yAxisOrientation===t.yAxisPosition.right},s.prototype.isYAxisCategorical=function(){return this.layout&&this.layout.axes.y1.isCategoryAxis},s.prototype.hasCategoryAxis=function(){var e=this.layout&&this.layout.axes;return!!e&&(this.isYAxisCategorical()?e.y1&&null!=e.y1.axis:e.x&&null!=e.x.axis)},s.prototype.isCategoryAxisDateTime=function(){var e=this.layout&&this.layout.axes;if(!e)return!1;var t=this.isYAxisCategorical()?e.y1:e.x;return t.axisType.dateTime},s.getLeafHeight=function(e,i,a){return e-i*(a-1)+t.AxisHelper.stackedAxisPadding+1},s.prototype.hasY2Axis=function(){return this.layout&&null!=this.layout.axes.y2},s.prototype.getYAxisOrientation=function(){return this.yAxisOrientation},s.prototype.setAxisLinesVisibility=function(e){this.showLinesOnX=o.hasFlag(e,3)||o.hasFlag(e,1),this.showLinesOnY=o.hasFlag(e,3)||o.hasFlag(e,2)},s.prototype.setMaxMarginFactor=function(e){this.maxMarginFactor=e},s.prototype.update=function(e,i,a,r){this.categories=e,this.categoryAxisProperties=i,this.valueAxisProperties=a,this.isHierarchicalCategoryAxis=r===t.CartesianAxisRenderMode.Hierarchical;var n=this.isYAxisCategorical()?this.categoryAxisProperties.position:this.valueAxisProperties.position;this.yAxisOrientation=n?n.toString():t.yAxisPosition.left},s.prototype.addWarnings=function(e){var i=this.layout&&this.layout.axes;(i&&i.x&&i.x.hasDisallowedZeroInDomain||i.y1&&i.y1.hasDisallowedZeroInDomain||i.y2&&i.y2.hasDisallowedZeroInDomain)&&e.unshift(new t.ZeroValueWarning)},s.prototype.calculateAxes=function(o,l,u,c,d,p,h,g,f,m,y,v){var w,b={viewport:l,margin:u,forcedXDomain:[this.categoryAxisProperties?this.categoryAxisProperties.start:null,this.categoryAxisProperties?this.categoryAxisProperties.end:null],forceMerge:this.valueAxisProperties&&this.valueAxisProperties.secShow===!1,showCategoryAxisLabel:!1,showValueAxisLabel:!1,trimOrdinalDataOnOverflow:this.trimOrdinalDataOnOverflow,categoryAxisScaleType:this.categoryAxisProperties&&null!=this.categoryAxisProperties.axisScale?this.categoryAxisProperties.axisScale:t.DEFAULT_AXIS_SCALE_TYPE,valueAxisScaleType:this.valueAxisProperties&&null!=this.valueAxisProperties.axisScale?this.valueAxisProperties.axisScale:t.DEFAULT_AXIS_SCALE_TYPE,categoryAxisDisplayUnits:this.categoryAxisProperties&&null!=this.categoryAxisProperties.labelDisplayUnits?this.categoryAxisProperties.labelDisplayUnits:0,valueAxisDisplayUnits:this.valueAxisProperties&&null!=this.valueAxisProperties.labelDisplayUnits?this.valueAxisProperties.labelDisplayUnits:0,categoryAxisPrecision:this.categoryAxisProperties?t.CartesianHelper.getPrecision(this.categoryAxisProperties.labelPrecision):null,valueAxisPrecision:this.valueAxisProperties?t.CartesianHelper.getPrecision(this.valueAxisProperties.labelPrecision):null,playAxisControlLayout:c,ensureXDomain:m,ensureYDomain:y},C=this.valueAxisProperties&&this.valueAxisProperties.secShow===!0,S=!1;i(o)&&!C&&(w=n(o,b),S=w.merged,S?b.forcedYDomain=w.domain:b.forcedTickCount=w.tickCount),this.valueAxisProperties&&(b.forcedYDomain=t.AxisHelper.applyCustomizedDomain([this.valueAxisProperties.start,this.valueAxisProperties.end],b.forcedYDomain));for(var x,P=0,D=o.length;P<D;P++){var T=o[P];1!==P||S||(b.forcedYDomain=this.valueAxisProperties?[this.valueAxisProperties.secStart,this.valueAxisProperties.secEnd]:null,b.valueAxisScaleType=this.valueAxisProperties&&null!=this.valueAxisProperties.secAxisScale?this.valueAxisProperties.secAxisScale:t.DEFAULT_AXIS_SCALE_TYPE,b.valueAxisDisplayUnits=this.valueAxisProperties&&null!=this.valueAxisProperties.secLabelDisplayUnits?this.valueAxisProperties.secLabelDisplayUnits:0,b.valueAxisPrecision=this.valueAxisProperties?t.CartesianHelper.getPrecision(this.valueAxisProperties.secLabelPrecision):null),b.showCategoryAxisLabel=!!this.categoryAxisProperties&&!!this.categoryAxisProperties.showAxisTitle,b.showValueAxisLabel=r(P,this.valueAxisProperties,S);var V=T.calculateAxesProperties(b);if(0===P)x={x:V[0],y1:V[1]};else if(V&&!x.y2)if(x.x.usingDefaultDomain||_.isEmpty(x.x.dataDomain)){b.showValueAxisLabel=!!this.valueAxisProperties&&!!this.valueAxisProperties.showAxisTitle;var L=T.calculateAxesProperties(b);x.x=L[0],x.y1=L[1]}else T.overrideXScale(x.x),S||V[1].usingDefaultDomain||(x.y2=V[1]);var M=_.clone(t.CartesianChart.AxisTextProperties);if(M.fontSize=a.PixelConverter.toString(p.x),g&&g.x)x.x.willLabelsFit=g.x.willLabelsFit,x.x.willLabelsWordBreak=g.x.willLabelsWordBreak;else{var N=l.width-(u.left+u.right);x.x.willLabelsFit=t.AxisHelper.LabelLayoutStrategy.willLabelsFit(x.x,N,e.TextMeasurementService.measureSvgTextWidth,M),x.x.willLabelsWordBreak=!x.x.willLabelsFit&&!h&&t.AxisHelper.LabelLayoutStrategy.willLabelsWordBreak(x.x,u,N,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,e.TextMeasurementService.getTailoredTextOrDefault,M)}this.isHierarchicalCategoryAxis&&v&&(x.xStack=s.createStackedAxis(this.categories,x.x,v.stackHeight,v.xMax))}return!f.x&&x.x&&(x.x.axisLabel=null),!f.y&&x.y1&&(x.y1.axisLabel=null),!f.y2&&x.y2&&(x.y2.axisLabel=null),this.addUnitTypeToAxisLabels(x),x},s.createStackedAxis=function(i,a,r,n){if(!_.isEmpty(i)){for(var o=i.length,l=s.getLeafHeight(n,r,o),u=[],c=t.AxisHelper.getCategoryThickness(a.scale),d=[],p=function(n){var p=n===o-1,h=o-n-1,g=i[n];p||d.push.apply(d,g.source.identityExprs);for(var f=[],m=[],y=[],v=0,w=void 0,b=g.values.length,C=0;C<b;C++){var S=p?g.identity[C]:s.getSpecificIdentityFromCompositeIdentity(g,C,d),x=g.values[C];if(!p&&w&&e.DataViewScopeIdentity.equals(w,S))f[C]=s.hierarchyPlaceholder,v++;else{if(v>0&&!p){var P=C-v;m[P]=s.getMaxCategoryWidth(v,c),y[P]=s.getHierarchyLineStyleInfo({levelIndex:h,stackHeight:r,leafHeight:l,categorySpanCount:v,categoryWidth:c})}v=1,f[C]=x}w=S}if(v>0&&!p){var P=b-v;m[P]=s.getMaxCategoryWidth(v,c),y[P]=s.getHierarchyLineStyleInfo({levelIndex:h,stackHeight:r,leafHeight:l,categorySpanCount:v,categoryWidth:c})}var D=e.Prototype.inherit(a);D.isStacked=!0,D.adjustedValues=f,D.axis=t.AxisHelper.createStackedAxis({axis:D.axis,scale:D.scale,tickFormat:function(e){return f[e]!==s.hierarchyPlaceholder?f[e]:""}}),D.categoryThickness=c,D.levelIndex=h,D.lineStyleInfo=y,D.values=f,D.xLabelMaxWidths=m,p?D.levelSize=l:(D.levelSize=r,D.willLabelsFit=!0,D.willLabelsWordBreak=!1),u.unshift(D)},h=0;h<o;h++)p(h);return u}},s.getSpecificIdentityFromCompositeIdentity=function(t,i,a){var r=t.identity,n=r[i],o=e.data.ScopeIdentityExtractor.getSubset(n.expr,a),s=e.data.createDataViewScopeIdentity(o);return s},s.getCategorySpanSize=function(e,t){return e*t},s.getMaxCategoryWidth=function(e,i){var a=s.getCategorySpanSize(e,i);return a-2*t.CartesianChart.TickLabelPadding},s.getHierarchyLineStyleInfo=function(e){var t=s.getCategorySpanSize(e.categorySpanCount,e.categoryWidth);return s.createHierarchyLineStyleInfo(e.levelIndex,e.stackHeight,e.leafHeight,t)},s.createHierarchyLineStyleInfo=function(e,t,i,a){if(0!==e){var r=[],n={x1:-a/2,y1:t,x2:-a/2,y2:1===e?-i:0,stroke:s.gridlineColor,strokeWidth:1},o={x1:a/2,y1:t,x2:a/2,y2:1===e?-i:0,stroke:s.gridlineColor,strokeWidth:1};if(r.push(n),r.push(o),e>1){var l={x1:-a/2,y1:0,x2:a/2,y2:0,stroke:s.gridlineColor,strokeWidth:1};r.push(l)}return r}},s.prototype.negotiateAxes=function(i,a,r,n,o,l,u,c,d,p,h){var g=e.Prototype.inherit(s.MinimumMargin),f=e.Prototype.inherit(a),m=f.width*this.maxMarginFactor,y=Math.max(s.MinimumMargin.bottom,Math.ceil(f.height*this.maxMarginFactor)),v={left:m,right:m,top:0,bottom:y},w=this.calculateAxes(i,f,g,n,c,u,!1,null,o,p,h),b=l.x&&this.shouldRenderAxis(w.x),C=l.y&&this.shouldRenderAxis(w.y1),S=l.y2&&this.shouldRenderAxis(w.y2,!0),x=this.shouldShowY1OnRight(),P={width:f.width-(g.left+g.right),height:f.height-(g.top+g.bottom)},D=!1;_.isEmpty(i)||i[0].getVisualCategoryAxisIsScalar&&(D=i[0].getVisualCategoryAxisIsScalar());var T=void 0;T=t.AxisHelper.getTickLabelMargins(P,v.left,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,w,v.bottom,c,!1,x,b,C,S),g=this.updateAxisMargins(w,T,r,x,C,S,D?0:d,o);var V=w.y1&&w.y1.values.length,L=w.y2&&w.y2.values.length,M=w.x&&w.x.willLabelsFit,N=w.x&&w.x.willLabelsWordBreak,I=w.x&&w.x.categoryThickness;w=this.calculateAxes(i,f,g,n,c,u,!1,null,o,p,h,T),P.width=f.width-(g.left+g.right),P.height=f.height-(g.top+g.bottom);var A=this.getPreferredPlotArea(w,i,D),O=!this.willAllCategoriesFitInPlotArea(P,A),R=!(w.y1&&w.y1.values.length!==V||w.y2&&w.y2.values.length!==L||w.x&&w.x.willLabelsFit!==M||w.x&&w.x.willLabelsWordBreak!==N||O||this.isHierarchicalCategoryAxis||w.x&&w.x.categoryThickness!==I);if(this.isXScrollBarVisible=!1,this.isYScrollBarVisible=!1,!R){T=t.AxisHelper.getTickLabelMargins(P,v.left,e.TextMeasurementService.measureSvgTextWidth,e.TextMeasurementService.estimateSvgTextHeight,w,v.bottom,c,O,x,b,C,S),g=this.updateAxisMargins(w,T,r,x,C,S,D?0:d,o),w=this.calculateAxes(i,f,g,n,c,u,O,w,o,p,h,T),P.width=f.width-(g.left+g.right),P.height=f.height-(g.top+g.bottom),A=this.getPreferredPlotArea(w,i,D);var E=!this.willAllCategoriesFitInPlotArea(P,A);E&&(this.showLinesOnY&&(this.isXScrollBarVisible=!0,P.height-=this.scrollbarWidth,f.height-=this.scrollbarWidth),this.showLinesOnX&&(this.isYScrollBarVisible=!0,P.width-=this.scrollbarWidth,f.width-=this.scrollbarWidth),w=this.calculateAxes(i,f,g,n,c,u,!0,w,o,p,h,T))}var F=o.x&&w.x?w.x.axisLabel:null,j=o.y&&w.y1?w.y1.axisLabel:null,H=o.y2&&w.y2?w.y2.axisLabel:null,G={x:F,y:j,y2:H};return this.layout={axes:w,axisLabels:G,margin:g,marginLimits:v,viewport:f,plotArea:P,preferredPlotArea:A,tickLabelMargins:T,tickPadding:r,rotateXTickLabels90:O,shouldRenderAxis:{x:b,y:C,y2:S}},this.layout},s.prototype.getPreferredPlotArea=function(e,t,i){var a;if(!i&&this.isScrollable&&!_.isEmpty(t)&&t[0].getPreferredPlotArea){var r=this.showLinesOnY?e.x.categoryThickness:e.y1.categoryThickness,n=this.showLinesOnY?e.x.dataDomain.length:e.y1.dataDomain.length;a=t[0].getPreferredPlotArea(i,n,r)}return a},s.prototype.willAllCategoriesFitInPlotArea=function(t,i){return!(this.showLinesOnY&&i&&e.Double.greaterWithPrecision(i.width,t.width))&&!(this.showLinesOnX&&i&&e.Double.greaterWithPrecision(i.height,t.height))},s.prototype.updateAxisMargins=function(t,i,a,r,n,o,l,u){var c=r?i.yRight:i.yLeft,d=r?i.yLeft:i.yRight,p=i.xMax;c+=a.left,(o&&!r||r&&n)&&(d+=a.right),p+=a.bottom;var h={x:t.x.axisLabel,y:t.y1.axisLabel,y2:t.y2?t.y2.axisLabel:null};null!=h.x&&u.x&&(p+=s.XAxisLabelPadding),null!=h.y&&u.y&&(c+=s.YAxisLabelPadding),null!=h.y2&&u.y2&&(d+=s.YAxisLabelPadding);var g=e.Prototype.inherit(s.MinimumMargin);return g.left=r?d:c,g.right=r?c:d,g.right+=l,g.bottom=p,g},s.prototype.isLogScaleAllowed=function(e){var t=this.layout&&this.layout.axes;if(!t)return!1;switch(e){case 0:return t.x.isLogScaleAllowed;case 1:return t.y1.isLogScaleAllowed;case 2:return t.y2&&t.y2.isLogScaleAllowed}},s.prototype.axesHaveTicks=function(e){if(!this.layout)return!1;var i=this.layout.margin,a=e.width-(i.left+i.right),r=e.height-(i.top+i.bottom);return 0!==t.AxisHelper.getRecommendedNumberOfTicksForXAxis(a)||0!==t.AxisHelper.getRecommendedNumberOfTicksForYAxis(r)},s.prototype.shouldRenderAxisTitle=function(e,t,i){var a=i?"secShowAxisTitle":"showAxisTitle";return!!this.getAxisProperty(e,a,t)},s.prototype.shouldRenderAxis=function(e,t){if(void 0===t&&(t=!1),!e)return!1;var i=t?"secShow":"show";return this.getAxisProperty(e,i,!0)&&e.values&&e.values.length>0},s.prototype.getAxisProperty=function(e,t,i){if(!e)return i;var a=e.isCategoryAxis?this.categoryAxisProperties:this.valueAxisProperties;return a&&null!=a[t]?a[t]:i},s.prototype.addUnitTypeToAxisLabels=function(e){var i=s.getUnitType(e.x.formatter);if(e.x.isCategoryAxis?this.categoryAxisHasUnitType=null!=i:this.valueAxisHasUnitType=null!=i,e.x.axisLabel&&i&&(e.x.isCategoryAxis?e.x.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,e.x.axisLabel,i):e.x.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.x.axisLabel,i)),i=s.getUnitType(e.y1.formatter),e.y1.isCategoryAxis?this.categoryAxisHasUnitType=null!=i:this.valueAxisHasUnitType=null!=i,e.y1.axisLabel&&i&&(e.y1.isCategoryAxis?e.y1.axisLabel=t.AxisHelper.createAxisLabel(this.categoryAxisProperties,e.y1.axisLabel,i):e.y1.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.y1.axisLabel,i)),e.y2){var a=s.getUnitType(e.y2.formatter);this.secondaryValueAxisHasUnitType=null!=a,e.y2.axisLabel&&a&&(e.y2.axisLabel=t.AxisHelper.createAxisLabel(this.valueAxisProperties,e.y2.axisLabel,a,!0))}},s.getUnitType=function(e){if(e&&e.displayUnit&&e.displayUnit.value>1)return e.displayUnit.title},s.hierarchyPlaceholder={placeholder:!0},s.gridlineColor="#d8d8d8",s.YAxisLabelPadding=20,s.XAxisLabelPadding=18,s.MaxMarginFactor=.25,s.MinimumMargin={left:1,right:1,top:8,bottom:25},s})();t.CartesianAxes=c})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){return _.isEmpty(e)?[]:_.filter(e,(function(e){return!t.TrendLineHelper.isDataViewForRegression(e)&&!t.ForecastHelper.isDataViewForForecast(e)}))}var r=e.data.CompiledDataViewMapping,n=e.visuals.DataViewConcatenateUtil,o=e.data.ScalarKeyUtils,s=e.visuals.controls.SvgScrollbar;t.DEFAULT_AXIS_SCALE_TYPE=t.axisScale.linear;var l=6;t.DEFAULT_AXIS_COLOR="#777",(function(e){e[e.Scalar=0]="Scalar",e[e.CategoricalNotConcatenated=1]="CategoricalNotConcatenated",e[e.CategoricalConcatenated=2]="CategoricalConcatenated",e[e.Hierarchical=3]="Hierarchical"})(t.CartesianAxisRenderMode||(t.CartesianAxisRenderMode={}));var u=t.CartesianAxisRenderMode,c=(function(){function c(e){var i=!1;this.trimOrdinalDataOnOverflow=!0,e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.forecastEnabled=e.forecastEnabled,this.columnLabelImprovements=e.columnLabelImprovements,this.hierarchicalAxisEnabled=e.hierarchicalAxisEnabled,this.type=e.chartType,this.isLabelInteractivityEnabled=e.isLabelInteractivityEnabled,this.axisControlImprovements=e.axisControlImprovements,void 0!==e.trimOrdinalDataOnOverflow&&(this.trimOrdinalDataOnOverflow=e.trimOrdinalDataOnOverflow),e.isScrollable&&(i=e.isScrollable),this.animator=e.animator,e.cartesianSmallViewPortProperties&&(this.cartesianSmallViewPortProperties=e.cartesianSmallViewPortProperties),e.legendSmallViewPortProperties&&(this.legendSmallViewPortProperties=e.legendSmallViewPortProperties),e.behavior&&(this.behavior=e.behavior),this.lassoSelectEnabled=e.lassoSelectEnabled),this.axes=new t.CartesianAxes(i,p.ScrollbarWidth,this.trimOrdinalDataOnOverflow),this.svgAxes=new t.SvgCartesianAxes(this.axes),this.svgScrollbar=new s(p.ScrollbarWidth),this.scrollableAxes=new p(this.axes,this.svgScrollbar),this.lassoSelectEnabled&&(this.lassoManager=new t.LassoManager)}return c.getAxisVisibility=function(e){switch(e){case 6:case 5:case 7:return 1;case 9:return 3;default:return 2}},c.prototype.init=function(e){this.visualInitOptions=e,this.layers=[],this.referenceLines=[];var i=this.element=e.element;this.currentViewport=e.viewport,this.hostServices=e.host;var a=this.chartAreaSvg=d3.select(i.get(0)).append("svg");
a.classed(c.ClassName,!0),a.style("position","absolute"),this.behavior&&(this.clearCatcher=t.appendClearCatcher(a),this.interactivityService=t.createInteractivityService(this.hostServices),this.lassoSelectEnabled&&(this.lassoManager.init(a),this.lassoSelectionBehavior=new t.LassoSelectionBehavior(this.behavior),this.lassoManager.behaviors.push(this.lassoSelectionBehavior))),null!=e.style.maxMarginFactor&&this.axes.setMaxMarginFactor(e.style.maxMarginFactor);var r=c.getAxisVisibility(this.type);this.axes.setAxisLinesVisibility(r),this.svgAxes.init(a),this.svgScrollbar.init(a),this.sharedColorPalette=new f(e.style.colorPalette.dataColors),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,12!==this.type?this.interactivityService:void 0,this.axes.isScrollable,void 0,this.legendSmallViewPortProperties),this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.tooltipService=t.createTooltipService(e.host)},c.prototype.isPlayAxis=function(){if(!this.dataViews||!this.dataViews[0])return!1;var e=this.dataViews[0],t=e.categorical&&e.categorical.categories&&e.categorical.categories[0]&&e.categorical.categories[0].source&&e.categorical.categories[0].source.roles&&e.categorical.categories[0].source.roles.Play;return 9===this.type&&(this.animator||this.isMobileChart)&&null!=e.matrix&&(!e.categorical||t)},c.hasCategoryHierarchy=function(e){return e&&e.categorical&&e.categorical.categories&&e.categorical.categories.length>1},c.getIsScalar=function(i,a,r,n,o){if(o&&!n||!c.supportsScalar(r,n))return!1;var s=e.DataViewObjects.getValue(i,a);return!i||null==s||s===t.axisType.scalar},c.supportsScalar=function(e,i){return!(!i||_.isEmpty(i.values))||!t.AxisHelper.isOrdinal(e)},c.getScalarKeys=function(e){return o.getScalarKeys(e,t.cartesianChartProps.scalarKey.scalarKeyMin)},c.getAdditionalTelemetry=function(e){var i={},a=e&&e.categorical&&_.first(e.categorical.categories);return a&&(i.axisType=t.CartesianChart.getIsScalar(e.metadata.objects,t.columnChartProps.categoryAxis.axisType,a.source.type,void 0,c.hasCategoryHierarchy(e))?"scalar":"categorical"),i},c.detectScalarMapping=function(e){if(!e||!e.categorical||!e.categorical.categories)return!1;var i=e.categorical.categories,a=i.for.in.items;if(_.isEmpty(a))return!1;var r=i.for.in.activeItems,n=a[0];if(!_.isEmpty(r)){if(r.length>1)return!1;var o=_.find(a,(function(e){return e.queryName===r[0]}));n=o}var s=n.type;if(!e.metadata)return!1;var l=e.metadata.objects;return c.getIsScalar(l,t.columnChartProps.categoryAxis.axisType,s)},c.prototype.populateObjectProperties=function(i){if(i&&i.length>0){var a=i[0],r=a.metadata,n=!1;r?(a.categorical&&!_.isEmpty(a.categorical.categories)&&(n=!!c.getScalarKeys(a.categorical.categories[0])),this.legendObjectProperties=e.DataViewObjects.getObject(r.objects,"legend",{}),this.referenceLines=this.getStaticReferenceLines(r)):this.legendObjectProperties={},this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(r,n,this.axisControlImprovements),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(r,void 0,this.axisControlImprovements)}},c.prototype.getStaticReferenceLines=function(i){var a=this.sharedColorPalette.getColorByIndex(0).value,r=[],n=e.DataViewObjects.getUserDefinedObjects(i.objects,"xAxisReferenceLine");r.push.apply(r,t.ReferenceLineHelper.readDataView(n,a,"xAxisReferenceLine",0));var o=e.DataViewObjects.getUserDefinedObjects(i.objects,"y1AxisReferenceLine");return r.push.apply(r,t.ReferenceLineHelper.readDataView(o,a,"y1AxisReferenceLine",1)),r},c.prototype.getDataBoundReferenceLines=function(i,a){var r=[],n=[];if(i)if(i.categorical&&i.categorical.values){var o=_.first(i.categorical.values.grouped());if(o)for(var s=0,l=o.values;s<l.length;s++){var u=l[s];n.push(u.source)}}else i.matrix&&i.matrix.valueSources&&(n=i.matrix.valueSources);for(var c=this.sharedColorPalette.getColorByIndex(0).value,d=0,p=n;d<p.length;d++){var h=p[d],g=e.DataViewObjects.getUserDefinedObjects(h.objects,"referenceLine"),f=this.getCartesianRoleKind(h,a);r.push.apply(r,t.ReferenceLineHelper.readDataView(g,c,"referenceLine",f,h.queryName))}return r},c.prototype.getCartesianRoleKind=function(e,t){var i=e.roles;if(t.getAxisLocationForRole&&i)for(var a in i)if(i[a])return t.getAxisLocationForRole(a);return 1},c.prototype.updateInternal=function(a,r){var o=this.dataViews=a.dataViews;if(this.currentViewport=a.viewport,o){if(0===this.layers.length){var s=this.extractMetadataObjects(o);this.layers=this.createAndInitLayers(s)}var l=this.layers;if(null!=r){if(!_.isEmpty(o)){var p=o[0];this.populateObjectProperties(o);var h=this.categoryAxisRenderMode=new d(p).getRenderMode();p.metadata&&(this.background={image:e.DataViewObjects.getValue(p.metadata.objects,t.scatterChartProps.plotArea.image),transparency:e.DataViewObjects.getValue(p.metadata.objects,t.scatterChartProps.plotArea.transparency,t.visualBackgroundHelper.getDefaultTransparency())},h===u.Scalar&&this.loadMoreDataHandler?this.loadMoreDataHandler=null:h===u.Scalar||this.loadMoreDataHandler||(this.loadMoreDataHandler=new m(null,this.hostServices.loadMoreData,c.LoadMoreThreshold))),h===u.CategoricalConcatenated&&(p=n.concatenateCategories(p,t.columnChartProps.general.formatString,t.cartesianRoleNames.category)),this.axes.update(p.categorical?p.categorical.categories:null,this.categoryAxisProperties,this.valueAxisProperties,h),this.svgAxes.update(this.categoryAxisProperties,this.valueAxisProperties)}this.sharedColorPalette.clearPreferredScale();var g=i(o),f=_.filter(o,t.TrendLineHelper.isDataViewForRegression);this.trendLines=[];for(var y=_.filter(o,t.ForecastHelper.isDataViewForForecast),v=0,w=l.length;v<w;v++){var b=g[v],C=b?[b]:[];if(null!=y[v]&&C.push(y[v]),l[v].setData(C),(M=this.referenceLines).push.apply(M,this.getDataBoundReferenceLines(b,l[v])),this.supportsTrendLines(v)){var S=f[v];if(S){var x=v>0,P=t.TrendLineHelper.readDataView(S,b,x,this.sharedColorPalette);(N=this.trendLines).push.apply(N,P)}}w>1&&this.sharedColorPalette.rotateScale()}}if(this.loadMoreDataHandler&&null!=r&&this.loadMoreDataHandler.onLoadMoreDataCompleted(),this.render(!this.hasSetData||a.suppressAnimations,a.resizeMode,r),this.hasSetData=this.hasSetData||!_.isEmpty(o),!_.isEmpty(o)){var D=t.getInvalidValueWarnings(o,!1,!1,!1);this.axes.addWarnings(D);var T=new t.VisualWarningBuilder;if(_.isEmpty(D)||T.add.apply(T,D),this.noLabelsCanBeRendered&&this.columnLabelImprovements){var V={selector:null,warnings:[new t.DataLabelsNotRenderedWarning]};T.addForVisualObject("labels",V)}var p=_.first(o),L=[];new d(p).addObjectWarnings(L),_.isEmpty(L)||T.addForVisualObject.apply(T,["categoryAxis"].concat(L)),this.hostServices.setWarnings(T.complete())}var M,N}},c.prototype.onDataChanged=function(t){this.updateInternal({dataViews:t.dataViews,suppressAnimations:t.suppressAnimations,viewport:this.currentViewport},null!=t.operationKind?t.operationKind:e.VisualDataChangeOperationKind.Create)},c.prototype.onResizing=function(e,t){this.updateInternal({dataViews:this.dataViews,suppressAnimations:!0,viewport:e,resizeMode:t})},c.prototype.scrollTo=function(e){this.scrollableAxes.scrollTo(e)},c.prototype.enumerateObjectInstances=function(i){var a=new t.ObjectEnumerationBuilder,r=this.layers?this.layers.length:0;if("legend"===i.objectName){if(!this.shouldShowLegendCard())return;var n=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.show,this.legend.isVisible()),o=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.showTitle,!0),s=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.titleText,this.layerLegendData?this.layerLegendData.title:""),l=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.labelColor,t.LegendData.DefaultLegendLabelFillColor),u=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.fontSize,this.layerLegendData&&this.layerLegendData.fontSize?this.layerLegendData.fontSize:t.SVGLegend.DefaultFontSizeInPt),c=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.position,t.legendPosition.top);a.pushInstance({selector:null,properties:{show:n,position:c,showTitle:o,titleText:s,labelColor:l,fontSize:u,noLabelsCanBeRendered:this.noLabelsCanBeRendered},objectName:i.objectName})}else"categoryAxis"===i.objectName&&this.axes.hasCategoryAxis()?this.getCategoryAxisValues(a):"valueAxis"===i.objectName?this.getValueAxisValues(a):"y1AxisReferenceLine"===i.objectName||"xAxisReferenceLine"===i.objectName?this.enumerateReferenceLines(a,i.objectName):"referenceLine"===i.objectName?this.supportsDataBoundReferenceLines()&&this.enumerateReferenceLines(a,i.objectName):"trend"===i.objectName?this.supportsTrendLines()&&t.TrendLineHelper.enumerateObjectInstances(a,this.trendLines):("forecast"!==i.objectName||this.forecastEnabled)&&"plotArea"===i.objectName&&t.visualBackgroundHelper.enumeratePlot(a,this.background);if("dataPoint"===i.objectName&&t.ComboChart.isComboChart(this.type))t.ComboChart.enumerateDataPoints(a,i,this.layers);else for(var d=0,p=r;d<p;d++){var h=this.layers[d];h.enumerateObjectInstances&&h.enumerateObjectInstances(a,i)}return a.complete()},c.prototype.enumerateReferenceLines=function(e,i){var a=this.sharedColorPalette.getColorByIndex(0).value,r=_.filter(this.referenceLines,(function(e){return e.type===i}));t.ReferenceLineHelper.enumerateObjectInstances(e,r,a,i)},c.prototype.supportsTrendLines=function(e){return this.allLayerSupports((function(e){return e.supportsTrendLine&&e.supportsTrendLine()}),e)},c.prototype.supportsDataBoundReferenceLines=function(e){return this.allLayerSupports((function(e){return!e.isStacked||!e.isStacked()}),e)},c.prototype.allLayerSupports=function(e,t){var a=i(this.dataViews);if(_.isEmpty(this.layers))return!1;var r=null==t?this.layers:[this.layers[t]];return _.all(r,(function(t,i){return!a[i]||e(t)}))},c.prototype.shouldShowLegendCard=function(){var e=this.layers,t=this.dataViews;if(e&&t)for(var i=e.length,a=0,r=0;r<i;r++){if(e[r].hasLegend())return!0;var n=t[r];if(n&&n.categorical&&n.categorical.values&&n.categorical.values.length>0&&(a++,a>1))return!0}return!1},c.prototype.getAxisScaleOptions=function(e){var i=[t.DEFAULT_AXIS_SCALE_TYPE];return this.axes.isLogScaleAllowed(e)&&i.push(t.axisScale.log),i},c.prototype.getCategoryAxisValues=function(e){if(this.categoryAxisProperties){var i=t.axisType.both,a=!1,r=this.getAxisScaleOptions(0);this.layers&&this.layers[0].getSupportedCategoryAxisType&&(i=this.layers[0].getSupportedCategoryAxisType(),i===t.axisType.scalar?a=!0:(a=t.CartesianHelper.isScalar(i===t.axisType.both,this.categoryAxisProperties),a&&(a=this.categoryAxisRenderMode===u.Scalar))),a||(this.categoryAxisProperties.start=null,this.categoryAxisProperties.end=null);var n={selector:null,properties:{},objectName:"categoryAxis",validValues:{axisScale:r,axisStyle:this.axes.categoryAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly]},propertyTypes:{}};if(n.properties.show=null==this.categoryAxisProperties.show||this.categoryAxisProperties.show,this.axes.isYAxisCategorical()&&(n.properties.position=this.categoryAxisProperties&&null!=this.categoryAxisProperties.position?this.categoryAxisProperties.position:t.yAxisPosition.left),i===t.axisType.both&&(n.properties.axisType=a?t.axisType.scalar:t.axisType.categorical),a&&(n.properties.axisScale=this.categoryAxisProperties.axisScale||t.DEFAULT_AXIS_SCALE_TYPE,n.properties.start=this.categoryAxisProperties.start,n.properties.end=this.categoryAxisProperties.end),n.properties.axisStyle=this.categoryAxisProperties.axisStyle?this.categoryAxisProperties.axisStyle:t.axisStyle.showTitleOnly,n.properties.labelColor=this.categoryAxisProperties.labelColor||t.DEFAULT_AXIS_COLOR,a){n.properties.labelDisplayUnits=this.categoryAxisProperties.labelDisplayUnits?this.categoryAxisProperties.labelDisplayUnits:0;var o=this.categoryAxisProperties.labelPrecision;n.properties.labelPrecision=void 0===o||o<0?t.dataLabelUtils.defaultLabelPrecision:o}if(this.axes.isCategoryAxisDateTime()?(n.propertyTypes.start={dateTime:!0},n.propertyTypes.end={dateTime:!0}):(n.propertyTypes.start={numeric:!0},n.propertyTypes.end={numeric:!0}),this.hierarchicalAxisEnabled&&!a){var s=t.cartesianChartProps.categoryAxis.concatenateLabels.propertyName,l=this.categoryAxisProperties[s];n.properties[s]=void 0!==l?l:c.DefaultConcatenateLabelsValue}n.properties.showAxisTitle=this.categoryAxisProperties.showAxisTitle||!1,n.properties.showAxisTitle&&(n.properties.titleColor=this.categoryAxisProperties.titleColor||n.properties.labelColor),e.pushInstance(n)}},c.prototype.getValueAxisValues=function(e){if(this.valueAxisProperties){var i=this.getAxisScaleOptions(1),a=this.getAxisScaleOptions(2),r={selector:null,properties:{},objectName:"valueAxis",validValues:{axisScale:i,secAxisScale:a,axisStyle:this.axes.valueAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly],secAxisStyle:this.axes.secondaryValueAxisHasUnitType?[t.axisStyle.showTitleOnly,t.axisStyle.showUnitOnly,t.axisStyle.showBoth]:[t.axisStyle.showTitleOnly]},propertyTypes:{}};if(r.properties.show=null==this.valueAxisProperties.show||this.valueAxisProperties.show,r.properties.axisLabel=this.valueAxisProperties.axisLabel,this.axes.isYAxisCategorical()||(r.properties.position=null!=this.valueAxisProperties.position?this.valueAxisProperties.position:t.yAxisPosition.left),r.properties.axisScale=this.valueAxisProperties.axisScale||t.DEFAULT_AXIS_SCALE_TYPE,r.properties.start=this.valueAxisProperties.start,r.properties.end=this.valueAxisProperties.end,r.properties.axisStyle=null!=this.valueAxisProperties.axisStyle?this.valueAxisProperties.axisStyle:t.axisStyle.showTitleOnly,r.properties.labelColor=this.valueAxisProperties.labelColor||t.DEFAULT_AXIS_COLOR,7!==this.type&&8!==this.type){r.properties.labelDisplayUnits=this.valueAxisProperties.labelDisplayUnits?this.valueAxisProperties.labelDisplayUnits:0;var n=this.valueAxisProperties.labelPrecision;r.properties.labelPrecision=void 0===n||n<0?t.dataLabelUtils.defaultLabelPrecision:n}r.properties.showAxisTitle=this.valueAxisProperties.showAxisTitle||!1,r.properties.showAxisTitle&&(r.properties.titleColor=this.valueAxisProperties.titleColor||r.properties.labelColor),2===this.layers.length&&(r.properties.secShow=null!=this.valueAxisProperties.secShow?this.valueAxisProperties.secShow:this.axes.hasY2Axis()),this.axes.hasY2Axis()&&r.properties.secShow&&(r.properties.secAxisLabel="",r.properties.secPosition=null!=this.valueAxisProperties.secPosition?this.valueAxisProperties.secPosition:t.yAxisPosition.right,r.properties.secAxisScale=this.valueAxisProperties.secAxisScale||t.DEFAULT_AXIS_SCALE_TYPE,r.properties.secStart=this.valueAxisProperties.secStart,r.properties.secEnd=this.valueAxisProperties.secEnd,r.properties.secAxisStyle=this.valueAxisProperties.secAxisStyle?this.valueAxisProperties.secAxisStyle:t.axisStyle.showTitleOnly,r.properties.secLabelColor=this.valueAxisProperties.secLabelColor||r.properties.labelColor,r.properties.secLabelDisplayUnits=this.valueAxisProperties.secLabelDisplayUnits?this.valueAxisProperties.secLabelDisplayUnits:0,r.properties.secLabelPrecision=this.valueAxisProperties.secLabelPrecision<0?0:this.valueAxisProperties.secLabelPrecision,r.properties.secShowAxisTitle=this.valueAxisProperties.secShowAxisTitle||!1,r.properties.secShowAxisTitle&&(r.properties.secTitleColor=this.valueAxisProperties.secTitleColor||r.properties.secLabelColor)),r.propertyTypes.start={numeric:!0},r.propertyTypes.end={numeric:!0},e.pushInstance(r)}},c.prototype.onClearSelection=function(){if(this.hasSetData)for(var e=0,t=this.layers.length;e<t;e++){var i=this.layers[e];i.onClearSelection(),i.render(!0)}},c.prototype.extractMetadataObjects=function(e){var t;if(e&&e.length>0){var i=e[0].metadata;i&&(t=i.objects)}return t},c.prototype.createAndInitLayers=function(t){var i=this,a=g.createLayers(this.type,t,this.interactivityService,this.animator,this.axes.isScrollable,this.tooltipsEnabled,this.columnLabelImprovements),r=e.Prototype.inherit(this.visualInitOptions);r.svg=this.svgAxes.getScrollableRegion(),r.labelsContext=this.svgAxes.getLabelsRegion(),r.cartesianHost={updateLegend:function(e){return i.legend.drawLegend(e,i.currentViewport)},getSharedColors:function(){return i.sharedColorPalette},triggerRender:function(e){return i.render(e)}},r.chartType=this.type,r.services={tooltips:this.tooltipService};for(var n=0,o=a.length;n<o;n++)a[n].init(r);return a},c.prototype.renderLegend=function(){for(var e=this.layers,i={title:"",dataPoints:[]},a=function(a,n){r.layerLegendData=e[a].calculateLegend(),r.layerLegendData&&(i.title=0===a?r.layerLegendData.title||"":i.title,i.labelColor=r.layerLegendData.labelColor,_.isEmpty(r.layerLegendData.dataPoints)||r.layerLegendData.dataPoints.forEach((function(e){return e.layerNumber=a})),i.dataPoints=i.dataPoints.concat(r.layerLegendData.dataPoints||[]),i.fontSize=r.layerLegendData.fontSize||t.SVGLegend.DefaultFontSizeInPt,r.layerLegendData.grouped&&(i.grouped=!0))},r=this,n=0,o=e.length;n<o;n++)a(n,o);var s=this.legendObjectProperties;if(s){t.LegendData.update(i,s);var l=s[t.legendProps.position];l&&this.legend.changeOrientation(t.LegendPosition[l])}else this.legend.changeOrientation(t.LegendPosition.Top);(1===i.dataPoints.length&&!i.grouped||this.hideLegends())&&(i.dataPoints=[]),this.legend.drawLegend(i,this.currentViewport)},c.prototype.hideLegends=function(){if(this.cartesianSmallViewPortProperties){var e=this.legend.getOrientation(),i=this.currentViewport.width<=this.cartesianSmallViewPortProperties.minWidthForLegend&&t.Legend.isLeftOrRight(e),a=this.currentViewport.height<=this.cartesianSmallViewPortProperties.minHeightForLegend&&t.Legend.isTopOrBottom(e);return i||a}return!1},c.prototype.isSideLegendExists=function(){return this.legend.isVisible()&&t.Legend.isLeftOrRight(this.legend.getOrientation())},c.prototype.render=function(i,a,r){var n=this;this.visualInitOptions.interactivity&&this.visualInitOptions.interactivity.isInteractiveLegend||this.renderLegend();var o,s=this.legendMargins=this.legend.getMargins(),l=this.legend.getOrientation(),u=this.showAxisTitles(),d=this.shouldRenderAxis(),p=this.getAxisFontSize(),h={height:this.currentViewport.height-s.height,width:this.currentViewport.width-s.width},g=e.Prototype.inherit(t.SvgCartesianAxes.AxisPadding);this.isPlayAxis()&&(h.height-=c.PlayAxisBottomMargin,o={left:t.Legend.isLeft(l)?s.width:0,top:t.Legend.isTop(l)?s.height+h.height:h.height,height:c.PlayAxisBottomMargin,width:h.width}),this.chartAreaSvg.attr({width:h.width,height:h.height}),t.Legend.positionChartArea(this.chartAreaSvg,this.legend);var f=this.calculateInteractivityRightMargin(),m=this.getMinimumDomainExtents(),y=m[0],v=m[1],w=!this.renderedPlotArea||this.renderedPlotArea.height!==h.height||this.renderedPlotArea.width!==h.width;i=i||w;var b=this.axes.negotiateAxes(this.layers,h,g,o,u,d,p,c.AxisTextProperties,f,y,v),C=b.axes.x.isCategoryAxis?b.axes.x:b.axes.y1;this.loadMoreDataHandler&&this.loadMoreDataHandler.setScale(C.scale),this.scrollableAxes.render(b,this.layers,i,(function(e,t,i){return n.renderPlotArea(e,t,i,s,p,a)}),this.loadMoreDataHandler,r===e.VisualDataChangeOperationKind.Append||null!=a),this.lassoSelectionBehavior&&this.lassoSelectionBehavior.update(b),this.chartAreaSvg.on("wheel",(function(){if(n.axes.isXScrollBarVisible||n.axes.isYScrollBarVisible){n.tooltipService.hide();var e=d3.event,t=e.deltaX,i=e.deltaY,a=Math.abs(t)>Math.abs(i)?t:i;n.scrollableAxes.scrollDelta(a),e.preventDefault()}})),this.renderedPlotArea=h},c.prototype.getMinimumDomainExtents=function(){var e=[],i=[];t.ReferenceLineHelper.gatherDomainExtents(this.referenceLines,e,i);var a={min:d3.min(e),max:d3.max(e)},r={min:d3.min(i),max:d3.max(i)};return[a,r]},c.prototype.getPlotAreaRect=function(e,i){var a={left:e.margin.left,top:e.margin.top,width:e.plotArea.width,height:e.plotArea.height};if(this.legend){var r=this.legend.getOrientation();t.Legend.isTop(r)?a.top+=i.height:t.Legend.isLeft(r)&&(a.left+=i.width)}return a},c.prototype.renderBackgroundImage=function(e){t.visualBackgroundHelper.renderBackgroundImage(this.background,this.element,e)},c.prototype.showAxisTitles=function(){var e={x:!0,y:!0,y2:!0};return this.cartesianSmallViewPortProperties&&(this.currentViewport.height<=this.cartesianSmallViewPortProperties.minHeightForAxisLabels&&(e.x=!1,e.y=!1,e.y2=!1),this.currentViewport.width<=this.cartesianSmallViewPortProperties.minWidthForAxisLabels&&(e.y=!1,e.y2=!1)),e},c.prototype.shouldRenderAxis=function(){var e={x:!0,y:!0,y2:!0};return this.cartesianSmallViewPortProperties&&(this.currentViewport.height<=this.cartesianSmallViewPortProperties.minHeightForAxis&&(e.x=!1),this.currentViewport.width<=this.cartesianSmallViewPortProperties.minWidthForAxis&&(e.y=!1,e.y2=!1),this.currentViewport.width<=this.cartesianSmallViewPortProperties.mediumWidthForAxis&&this.isSideLegendExists()&&(e.y=!1,e.y2=!1)),e},c.prototype.getAxisFontSize=function(){var e={x:c.AxisFontSizeInPx,y:c.AxisFontSizeInPx,y2:c.AxisFontSizeInPx};return this.cartesianSmallViewPortProperties&&this.currentViewport.width<=this.cartesianSmallViewPortProperties.maxWidthForMediumFont&&(e.x=c.xAxisSmallFontSizeInPx,e.y=c.yAxisMediumFontSizeInPx,e.y2=c.yAxisMediumFontSizeInPx,this.currentViewport.width<=this.cartesianSmallViewPortProperties.maxWidthForSmallFont&&(e.y=c.yAxisSmallFontSizeInPx,e.y2=c.yAxisSmallFontSizeInPx)),e},c.prototype.calculateInteractivityRightMargin=function(){return this.visualInitOptions.interactivity&&this.visualInitOptions.interactivity.isInteractiveLegend&&!this.trimOrdinalDataOnOverflow?l:0},c.prototype.renderPlotArea=function(e,i,a,r,n,o){a=a||_.any(e,(function(e){return e.shouldSuppressAnimation&&e.shouldSuppressAnimation()}));var s=i.axes,l=i.plotArea,u=this.getPlotAreaRect(i,r),c=t.AnimatorCommon.GetAnimationDuration(this.animator,a),d=this.animator&&this.animator.getEasing();this.renderBackgroundImage(u),_.isEmpty(d)?this.svgAxes.renderAxes(i,c,n):this.svgAxes.renderAxes(i,c,n,d),this.renderReferenceLines(i),this.renderLayers(e,l,s,a,o),this.renderTrendLines(i)},c.prototype.renderTrendLines=function(e){var i=this.svgAxes.getScrollableRegion();t.TrendLineHelper.render(this.trendLines,i,e.axes,e.plotArea)},c.prototype.renderReferenceLines=function(e){var i={graphicContext:this.svgAxes.getScrollableRegion(),axes:e.axes,viewport:e.plotArea,referenceLines:this.referenceLines};t.ReferenceLineHelper.render(i)},c.prototype.getReferenceLineLabels=function(e,i){var a={axes:e,viewport:i,referenceLines:this.referenceLines,hostServices:this.hostServices};return t.ReferenceLineHelper.createLabelDataPoint(a)},c.prototype.renderDataLabels=function(i,a,r,n,o){var s=this.svgAxes.getLabelBackground(),l=this.svgAxes.getLabelsRegion(),u=[];if(this.behavior){var c=t.NewDataLabelUtils.getDataLabelLayoutOptions(this.type),d=new e.LabelLayout(c);u=d.layout(i,r),o&&t.NewDataLabelUtils.drawLabelBackground(s,u,"#FFFFFF",.7);var p=void 0,h=this.animator;if(h&&!n){var g=this.isPlayAxis(),f=g?t.PlayChart.FrameAnimationDuration:h.getDuration();p=t.NewDataLabelUtils.animateDefaultLabels(l,u,f,a,g?"linear":h.getEasing())}else p=t.NewDataLabelUtils.drawDefaultLabels(l,u,a);if(c.allowLeaderLines){var m=_.filter(u,(function(e){return null!=e.leaderLinePoints&&!_.isEmpty(e.leaderLinePoints)&&null!=e.identity}));t.NewDataLabelUtils.drawLabelLeaderLines(l,m,(function(e){return e.identity.getKey()}))}if(this.interactivityService&&this.isLabelInteractivityEnabled){var y={labelItems:p};this.interactivityService.bind(u,new t.LabelsBehavior,y,{isLabels:!0})}}else{var d=new e.LabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset,attemptToMoveLabelsIntoViewport:!0});u=d.layout(i,r),o&&t.NewDataLabelUtils.drawLabelBackground(s,u,"#FFFFFF",.7),t.NewDataLabelUtils.drawDefaultLabels(l,u,a)}for(var v,w=0,b=i;w<b.length;w++){var C=b[w];if(!_.isEmpty(C.labelDataPoints)){v=!0;break}}return!_.isEmpty(u)||!v},c.prototype.renderLayers=function(e,i,a,r,n){var o=[],s=[],l=[],u=!0;r=r||_.any(e,(function(e){return e.shouldSuppressAnimation&&e.shouldSuppressAnimation()}));for(var c=0,d=e;c<d.length;c++){var p=d[c],h=p.render(r,n);if(h){if(this.behavior&&(s=s.concat(h.dataPoints),l.push(h.behaviorOptions)),h.labelDataPointGroups)for(var g=h.labelDataPointGroups,f=0,m=g;f<m.length;f++){var y=m[f];y&&o.push({labelDataPoints:t.NewDataLabelUtils.removeDuplicates(y.labelDataPoints||[]),maxNumberOfLabels:y.maxNumberOfLabels,labelOrientation:h.labelOrientation})}else{var v=h.labelDataPoints||[];o.push({labelDataPoints:t.NewDataLabelUtils.removeDuplicates(v),maxNumberOfLabels:v.length,labelOrientation:h.labelOrientation})}u=u&&h.labelsAreNumeric}}var w=this.getReferenceLineLabels(a,i);if(_.isEmpty(w)||o.unshift({labelDataPoints:w,maxNumberOfLabels:w.length}),this.noLabelsCanBeRendered=!this.renderDataLabels(o,u,i,r,t.ComboChart.isComboChart(this.type)),this.interactivityService){var b={layerOptions:l,clearCatcher:this.clearCatcher};this.interactivityService.bind(s,this.behavior,b)}},c.getPreferredPlotArea=function(e,t,i,a,r,n,o){n||(n={top:0,right:0,bottom:0,left:0});var s={height:i.height-n.top-n.bottom,width:i.width-n.left-n.right};if(!r&&a){var l=c.getPreferredCategorySpan(e,t,o);s.width=Math.max(l,s.width)}return s},c.getPreferredCategorySpan=function(e,t,i){var a=t*e;return i?a:a+t*c.OuterPaddingRatio*2},c.getLayout=function(t,i){var a=i.categoryCount,r=i.availableWidth,n=i.domain,o=i.trimOrdinalDataOnOverflow,s=!!i.isScalar,l=!!i.isScrollable,u=c.getCategoryThickness(t?t.series:null,a,r,n,s,o),d=u*c.OuterPaddingRatio*2,p=e.Double.floorWithPrecision((r-d)/u),h=Math.min(p,a),g=h<a&&l,f=c.OuterPaddingRatio;if(!s&&!g){var m=(r-u*h)/2;f=m/u}return!s&&l&&(h=a),{categoryCount:h,categoryThickness:u,outerPaddingRatio:f,isScalar:s}},c.getCategoryThickness=function(e,t,i,a,r,n){var o;if(t<2)o=i*(1-c.OuterPaddingRatio);else if(r&&a&&a.length>1){var s=c.getMinInterval(e),l=a[a.length-1]-a[0],u=s/(l+s*c.OuterPaddingRatio*2);o=i*u,o=Math.max(o,c.MinScalarRectThickness)}else o=i/(t+2*c.OuterPaddingRatio),n&&(o=Math.max(o,c.MinOrdinalRectThickness));var d=i/(3+2*c.OuterPaddingRatio);return o=Math.min(o,d),!r&&t>=3&&n?Math.max(o,c.MinOrdinalRectThickness):o},c.getMinInterval=function(e){var t=Number.MAX_VALUE;if(e.length>0)for(var i=e[0].data.filter((function(e){return!e.highlight})),a=0,r=i.length-1;a<r;a++)t=Math.min(t,Math.abs(i[a+1].categoryValue-i[a].categoryValue));return t},c.expandCategoryWindow=function(e){var t=1e3;if(c.shouldExpandCategoryWindow(e))for(var i=0,a=e;i<a.length;i++){var r=a[i];if(!r.categorical)return;var n=r.categorical.categories;if(!n||!n.dataReductionAlgorithm||!n.dataReductionAlgorithm.window)return;n.dataReductionAlgorithm={window:{count:t}}}},c.requestFilteredToUniqueValue=function(i){for(var a=0,r=i;a<r.length;a++){var n=r[a],o=n.categorical.categories;e.data.CompiledDataViewMapping.visitCategoricalCategories(o,{visitRole:function(e){var i=e.items;if(!_.isEmpty(i)&&!_.isEmpty(e.activeItems))for(var a=_.filter(i,(function(t){return _.contains(e.activeItems,t.queryName)})),r=0,n=a;r<n.length;r++){var o=n[r];o.filteredToUniqueValueProperty=t.cartesianChartProps.filters.filteredToUniqueValue}}})}},c.applyHierarchicalSorts=function(e,t,i){void 0===i&&(i=1);for(var a=function(e){if(!(e&&e.categorical&&e.categorical.categories&&e.metadata))return"continue";var a=e.metadata.columns,n=e.categorical.categories;return _.any(a,(function(e){return void 0!==e.sort}))?"continue":void r.visitCategoricalCategories(n,{visitRole:function(e,r){if(_.contains(t,e.role)){var n=e.activeItems;if(!_.isEmpty(n))for(var o=0,s=function(e){var t=n[e],r=_.find(a,(function(e){return e.queryName===t}));r&&(r.sort=i,r.sortOrder=o++)},l=0;l<n.length;l++)s(l)}}})},n=0,o=e;n<o.length;n++){var s=o[n];a(s)}},c.shouldExpandCategoryWindow=function(e){if(_.isEmpty(e))return!1;var t=_.any(e,(function(e){var t=e.categorical;if(!t)return!1;var i=t.categories;if(!i)return!1;var a=t.values;return!(!(a&&a.group&&a.group.by)||_.isEmpty(a.group.by.items))}));return!t},c.DefaultConcatenateLabelsValue=!0,c.MinOrdinalRectThickness=20,c.MinScalarRectThickness=2,c.OuterPaddingRatio=.4,c.InnerPaddingRatio=.2,c.TickLabelPadding=2,c.LoadMoreThreshold=1,c.AxisFontSizeInPx=11,c.xAxisSmallFontSizeInPx=9,c.yAxisSmallFontSizeInPx=9,c.yAxisMediumFontSizeInPx=11,c.ClassName="cartesianChart",c.PlayAxisBottomMargin=80,c.FontSize=11,c.FontSizeString=a.PixelConverter.toString(c.FontSize),c.AxisTextProperties={fontFamily:t.Font.Family.regular.css,fontSize:c.FontSizeString},c})();t.CartesianChart=c;var d=(function(){function i(e){this.processDataView(e)}return i.prototype.processDataView=function(a){if(!a||!a.metadata||!a.categorical||_.isEmpty(a.categorical.categories))return void(this.renderMode=u.CategoricalConcatenated);var r=a.metadata,n=a.categorical.categories,o=_.first(n),s=c.getScalarKeys(o),l=c.hasCategoryHierarchy(a),d=c.getIsScalar(r.objects,t.columnChartProps.categoryAxis.axisType,o.source.type,s,l);if(d)return void(this.renderMode=u.Scalar);if(!l)return void(this.renderMode=u.CategoricalNotConcatenated);var p=i.areNonLeafLevelsFilteredToUniqueValue(n),h=e.DataViewObjects.getValue(r.objects,t.cartesianChartProps.categoryAxis.concatenateLabels,c.DefaultConcatenateLabelsValue);if(p&&h)return void(this.renderMode=u.CategoricalNotConcatenated);var g=i.isSortedByCategoryFirst(a),f=_.any(a.categorical.categories,(function(e){return e.source&&e.source.identityExprs})),m=!h&&f&&(g||p);this.renderMode=m?u.Hierarchical:u.CategoricalConcatenated,h||f||(this.warnings=[{selector:null,warnings:[new t.NoIdentityExprWarning]}])},i.prototype.getRenderMode=function(){return this.renderMode},i.prototype.addObjectWarnings=function(e){this.warnings&&e.push.apply(e,this.warnings)},i.isSortedByCategoryFirst=function(e){return!(!e||!e.categorical||_.isEmpty(e.categorical.categories)||!e.metadata||_.isEmpty(e.metadata.columns))&&_.all(e.categorical.categories,(function(e,t){var i=e.source;return i&&null!=i.sort&&i.sortOrder===t}))},i.areNonLeafLevelsFilteredToUniqueValue=function(i){if(_.isEmpty(i))return!1;for(var a=i.length-1,r=0;r<a;r++){var n=i[r].source;if(!n||!e.DataViewObjects.getValue(n.objects,t.cartesianChartProps.filters.filteredToUniqueValue,!1))return!1}return!0},i})();t.CartesianAxisRenderModeSelector=d;var p=(function(){function i(e,t){this.cartesianAxes=e,this.scrollbar=t}return i.filterDataToViewport=function(e){if(e&&e.scrollScale){var a,r=e.scrollScale,n=e.mainAxisScale,o=[],s=t.AxisHelper.invertOrdinalScale(r,e.extent.start),l=s+e.visibleCategoryCount,u=r.domain();if(a=u.slice(s,l),!_.isEqual(a,n.domain())){if(a&&a.length>0){for(var c=e.layers,d=0;d<c.length;d++)o[d]=c[d].setFilteredData(a[0],a[a.length-1]+1);n.domain(a);var p=e.axisProperties,h=void 0;h=e.cartesianAxes.isXScrollBarVisible?p.x:p.y1,h.axis.scale(n),h.scale(n),h.axis.ticks(a.length),h.axis.tickValues(a);var g=h.axis.tickFormat();if(h.values=_.map(a,(function(e){return g(e)})),!_.isEmpty(p.xStack))for(var f=e.tickLabelMargins,m=t.CartesianAxes.getLeafHeight(f.xMax,f.stackHeight,p.xStack.length),y=function(e){var r=p.xStack[e],n=t.AxisHelper.getCategoryThickness(r.scale),o=r.values,s=i.setLabelsAtEdges(a,o);if(r.axis.ticks(a.length).tickValues(a).tickFormat((function(e){var i=o[s[a.indexOf(e)]];return i===t.CartesianAxes.hierarchyPlaceholder?"":_.isString(i)?i:i+""})),0===e)return"continue";for(var l=[],u=[],c=[],d=void 0,h=0;h<s.length;h++){var g=a[h],y=s[h],v=r.values[y];if(v!==t.CartesianAxes.hierarchyPlaceholder){if(null!=d){var w=g-d;l[d]=t.CartesianAxes.getMaxCategoryWidth(w,n),u[d]=t.CartesianAxes.getHierarchyLineStyleInfo({levelIndex:e,stackHeight:f.stackHeight,leafHeight:m,categorySpanCount:w,categoryWidth:n})}c[g]=o[y],d=g}else c[g]=t.CartesianAxes.hierarchyPlaceholder}if(null!=d){var w=a[s.length-1]-d+1;l[d]=t.CartesianAxes.getMaxCategoryWidth(w,n),u[d]=t.CartesianAxes.getHierarchyLineStyleInfo({levelIndex:e,stackHeight:f.stackHeight,
leafHeight:m,categorySpanCount:w,categoryWidth:n})}r.xLabelMaxWidths=l,r.lineStyleInfo=u,r.adjustedValues=c},v=0;v<p.xStack.length;v++)y(v)}return{startIndex:s,endIndex:l-1}}}},i.prototype.render=function(t,a,r,n,o,s){var l=this,u=t.plotArea;if(!(u.width<1||u.height<1)){this.axisScale=null;var d,p,g,f,m,y,v=this.cartesianAxes.isXScrollBarVisible||this.cartesianAxes.isYScrollBarVisible;if(o||v)if(this.cartesianAxes.isYAxisCategorical()){this.axisScale=t.axes.y1.scale,d=t.viewport.width,p=t.margin.top,m=t.axes.y1.categoryThickness;var w=t.axes.y1.outerPadding;y=u.height,f=Math.max(1,e.Double.floorWithPrecision((y-2*w)/m)),g=y}else{this.axisScale=t.axes.x.scale,d=t.margin.left,p=t.viewport.height,m=t.axes.x.categoryThickness;var w=t.axes.x.outerPadding;y=u.width,f=Math.max(1,e.Double.floorWithPrecision((y-2*w)/m)),g=y}if(!v)return o&&(o.viewportDataRange={startIndex:0,endIndex:f},o.shouldLoadMoreData()&&o.loadMoreData()),this.scrollbar.remove(),void n(a,t,r);this.scrollScale=this.axisScale.copy(),this.scrollScale.rangeBands([0,g],.1,0),this.extentLength=this.scrollScale(f-1)+this.scrollScale.rangeBand(),this.scrollHandler=new h({visibleScale:this.axisScale,fullScale:this.scrollScale,onScroll:function(e){var t=l.scrollScale(e),i={start:t,end:null};l.scrollbar.setExtent(i),l.scrollbar.refreshExtentAndVisual()}}),this.axisScale.rangeBands([0,y],c.InnerPaddingRatio,c.OuterPaddingRatio),this.scrollbar.setOrientation(this.cartesianAxes.isXScrollBarVisible),this.scrollbar.setScale(this.scrollScale),this.scrollbar.scrollBarLength=g,this.scrollbar.setExtentLength(this.extentLength),s||this.scrollbar.setExtent({start:0,end:null}),this.renderVisualOptions={axesLayout:t,axisProperties:t.axes,cartesianAxes:this.cartesianAxes,layers:a,loadMoreDataHandler:o,mainAxisScale:this.axisScale,renderDelegate:n,scrollScale:this.scrollScale,tickLabelMargins:t.tickLabelMargins,visibleCategoryCount:f};var b=function(){return l.onRefreshVisual((function(e,t){return i.renderVisual(l.renderVisualOptions,e,t)}))};if(this.scrollbar.render(d,p,b),s&&o){var C=o.viewportDataRange?o.viewportDataRange.startIndex:0;this.scrollTo(C)}else i.renderVisual(this.renderVisualOptions,this.scrollbar.getExtent(),r)}},i.prototype.scrollDelta=function(e){this.scrollHandler.scrollDelta(e)},i.prototype.scrollTo=function(e){this.scrollHandler.scrollTo(e)},i.prototype.onRefreshVisual=function(e){var t=this.scrollbar.getExtent();e(t,!0)},i.setLabelsAtEdges=function(e,i){if(e.length<=1||i[e[0]]!==t.CartesianAxes.hierarchyPlaceholder)return e;var a=e[0],r=e.slice();if(a<i.length&&a>=0){for(;i[a]===t.CartesianAxes.hierarchyPlaceholder&&a>=0;a--);r[0]=a}return r},i.renderVisual=function(e,t,a){var r=i.filterDataToViewport({mainAxisScale:e.mainAxisScale,layers:e.layers,axisProperties:e.axesLayout.axes,scrollScale:e.scrollScale,extent:t,visibleCategoryCount:e.visibleCategoryCount,tickLabelMargins:e.axesLayout.tickLabelMargins,cartesianAxes:e.cartesianAxes});if(r){if(e.loadMoreDataHandler){var n=e.loadMoreDataHandler;n.viewportDataRange=r,n.shouldLoadMoreData()&&n.loadMoreData()}e.renderDelegate(e.layers,e.axesLayout,a)}},i.ScrollbarWidth=10,i})();t.ScrollableAxes=p;var h=(function(){function e(t){this.visibleScale=t.visibleScale,this.fullScale=t.fullScale,this.onScroll=t.onScroll;var i=a.Utility.valueOrDefault(t.timeout,e.defaultTimeoutMs);this.extendScrollTimeout=_.debounce(this.onTimeout,i),this.totalScrollDistance=0}return e.prototype.scrollDelta=function(t){if(!_.isEmpty(this.visibleScale.domain())){this.totalScrollDistance<0&&t>0||this.totalScrollDistance>0&&t<0?this.totalScrollDistance=t:this.totalScrollDistance+=t;var i=e.getStepSize(this.visibleScale);if(Math.abs(this.totalScrollDistance)>=i){this.extendScrollTimeout&&this.extendScrollTimeout.cancel();var a=this.getNewStartIndex(this.totalScrollDistance);this.scrollTo(a),this.totalScrollDistance=0}else this.extendScrollTimeout()}},e.prototype.scrollTo=function(e){var t=this.clampIndex(e);this.onScroll(t)},e.getStepSize=function(e){var t=e.range();if(t.length>1)return t[1]-t[0];var i=e.rangeExtent();return i[1]-i[0]},e.prototype.getNewStartIndex=function(e){var i=e>=0;e=i?e:-e;var a,r=this.visibleScale,n=r.range(),o=r.domain(),s=o[0],l=n[0],u=l+e,c=r.rangeExtent()[1];if(u>c){var d=o.length;a=d}else{var p=t.AxisHelper.invertOrdinalScale(r,u);a=p-s}return(i?1:-1)*a+s},e.prototype.clampIndex=function(e){var t=this.fullScale.domain(),i=_.first(t),a=_.last(t);return Math.max(i,Math.min(a,e))},e.prototype.onTimeout=function(){this.totalScrollDistance=0},e.defaultTimeoutMs=1e3,e})();t.AxisScrollHandler=h;var g;!(function(e){function i(e,i,c,d,p,h,g){void 0===p&&(p=!1);var f=[],m={isScrollable:p,animator:d,interactivityService:c,tooltipsEnabled:h,columnLabelImprovements:g};switch(e){case 1:f.push(a(2,!1,m));break;case 0:f.push(a(1,!1,m));break;case 2:f.push(a(16,!1,m));break;case 17:f.push(r(m));break;case 9:f.push(n(m));break;case 12:f.push(o(m));break;case 11:f.push(s(m));break;case 4:f.push(l(t.ColumnChartType.stackedColumn,m));break;case 3:f.push(l(t.ColumnChartType.clusteredColumn,m));break;case 8:f.push(l(t.ColumnChartType.hundredPercentStackedColumn,m));break;case 6:f.push(l(t.ColumnChartType.stackedBar,m));break;case 5:f.push(l(t.ColumnChartType.clusteredBar,m));break;case 7:f.push(l(t.ColumnChartType.hundredPercentStackedBar,m));break;case 10:var y=u();f.push(l(y,m)),f.push(a(1,!0,m));break;case 13:f.push(l(t.ColumnChartType.clusteredColumn,m)),f.push(a(1,!0,m));break;case 14:f.push(l(t.ColumnChartType.stackedColumn,m)),f.push(a(1,!0,m));break;case 15:f.push(l(t.ColumnChartType.clusteredColumn,m)),f.push(s(m));break;case 16:f.push(l(t.ColumnChartType.stackedColumn,m)),f.push(s(m))}return f}function a(e,i,a,r){var n={animator:a.animator,interactivityService:a.interactivityService,isScrollable:a.isScrollable,tooltipsEnabled:!r&&a.tooltipsEnabled,chartType:e};return i&&(n.chartType=8|n.chartType),new t.LineChart(n)}function r(e){return e.isScrollable=!1,new t.RealTimeLineChart(e)}function n(e){return e.isScrollable=!1,new t.ScatterChart(e)}function o(e){return new t.WaterfallChart(e)}function s(e){return new t.DataDotChart(e)}function l(e,i){var a={animator:i.animator,interactivityService:i.interactivityService,isScrollable:i.isScrollable,tooltipsEnabled:i.tooltipsEnabled,columnLabelImprovements:i.columnLabelImprovements,chartType:e};return new t.ColumnChart(a)}function u(e){var i=t.ColumnChartType.clusteredColumn;if(e){var a=e.general;if(a){switch(a.visualType1){case"Column":i=t.ColumnChartType.clusteredColumn;break;case"ColumnStacked":i=t.ColumnChartType.stackedColumn}a.visualType2}}return i}e.createLayers=i})(g||(g={}));var f=(function(){function e(e){this.palette=e,this.clearPreferredScale()}return e.prototype.getColorScaleByKey=function(e){return this.setPreferredScale(e),this.preferredScale},e.prototype.getNewColorScale=function(){return this.preferredScale},e.prototype.getColorByIndex=function(e){return this.palette.getColorByIndex(e)},e.prototype.getSentimentColors=function(){return this.palette.getSentimentColors()},e.prototype.getBasePickerColors=function(){return this.palette.getBasePickerColors()},e.prototype.clearPreferredScale=function(){this.preferredScale=this.palette.getNewColorScale(),this.rotated=!1},e.prototype.rotateScale=function(){this.preferredScale=this.preferredScale.clone(),this.preferredScale.clearAndRotateScale(),this.rotated=!0},e.prototype.setPreferredScale=function(e){this.rotated||(this.preferredScale=this.palette.getColorScaleByKey(e))},e})();t.SharedColorPalette=f;var m=(function(){function e(e,t,i){void 0===i&&(i=0),this.loadMoreThreshold=i,this.loadMoreCallback=t,this.setScale(e)}return e.prototype.setScale=function(e){e&&(this.loadMoreThresholdIndex=e.domain().length-1-this.loadMoreThreshold)},e.prototype.isLoadingMoreData=function(){return this.loadingMoreData},e.prototype.onLoadMoreDataCompleted=function(){this.loadingMoreData=!1},e.prototype.shouldLoadMoreData=function(){var e=this.viewportDataRange;return!(!e||this.isLoadingMoreData())&&e.endIndex>=this.loadMoreThresholdIndex},e.prototype.loadMoreData=function(){this.isLoadingMoreData()||(this.loadingMoreData=!0,this.loadMoreCallback())},e})();t.CartesianLoadMoreDataHandler=m})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.EnumExtensions,r=e.data.DataRoleHelper,n=2,o=4,s=8,l=16,u=32|l;!(function(e){e[e.clusteredBar=n|s]="clusteredBar",e[e.clusteredColumn=o|s]="clusteredColumn",e[e.hundredPercentStackedBar=n|u]="hundredPercentStackedBar",e[e.hundredPercentStackedColumn=o|u]="hundredPercentStackedColumn",e[e.stackedBar=n|l]="stackedBar",e[e.stackedColumn=o|l]="stackedColumn"})(t.ColumnChartType||(t.ColumnChartType={}));var c=t.ColumnChartType,d={category:"Category",series:"Series",y:"Y"},p=(function(){function p(e){var t=e.chartType;this.chartType=t,this.categoryAxisType=null,this.animator=e.animator,this.isScrollable=e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.columnLabelImprovements=e.columnLabelImprovements}return p.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories){if(i.categorical.dataVolume=4,t.CartesianChart.detectScalarMapping(i)){var a=i.categorical.categories;a.dataReductionAlgorithm={sample:{}};var r=i.categorical.values;r&&r.group&&(r.group.dataReductionAlgorithm={top:{}})}else t.CartesianChart.expandCategoryWindow([i]);t.CartesianChart.requestFilteredToUniqueValue(e.dataViewMappings);var n=p.getSortableRoles(e);t.CartesianChart.applyHierarchicalSorts(e.dataViewMappings,n)}},p.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(!i||!i.categorical||!i.categorical.categories)return null;var a=i.categorical.categories,r=a.for.in,n=r.items,o=r.activeItems,s=["Category","Y"],l=[];if(!_.isEmpty(n)){var u=void 0;i.metadata&&(u=i.metadata.objects);var c=void 0;if(_.isEmpty(o))c=n[0].type;else if(1===o.length){var d=_.find(n,(function(e){return e.queryName===o[0]}));c=d.type}else if(o.length>1)return s;return t.CartesianChart.getIsScalar(u,t.lineChartProps.categoryAxis.axisType,c)?l:s}return null},p.prototype.updateVisualMetadata=function(e,t,i){this.xAxisProperties=e,this.yAxisProperties=t,this.margin=i},p.prototype.init=function(e){this.svg=e.svg,this.svg.classed(p.ColumnChartClassName,!0),this.unclippedGraphicsContext=this.svg.append("g").classed("columnChartUnclippedGraphicsContext",!0),this.mainGraphicsContext=this.unclippedGraphicsContext.append("svg").classed("mainGraphicsContext",!0),this.style=e.style,this.currentViewport=e.viewport,this.hostService=e.host,this.interactivity=e.interactivity,this.colors=this.style.colorPalette.dataColors,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.isComboChart=t.ComboChart.isComboChart(e.chartType),this.element=e.element,this.tooltipService=e.services.tooltips},p.prototype.getCategoryLayout=function(e,i){var a;a=p.isBar(this.chartType)?this.currentViewport.height-(this.margin.top+this.margin.bottom):this.currentViewport.width-(this.margin.left+this.margin.right);var r=this.data?this.data.categoryMetadata:void 0,n=t.AxisHelper.getCategoryValueType(r),o=!!this.data&&this.data.scalarCategoryAxis,s=t.AxisHelper.createDomain(this.data.series,n,o,i.forcedXDomain,i.ensureXDomain);return t.CartesianChart.getLayout(this.data,{availableWidth:a,categoryCount:e,domain:s,isScalar:o,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:i.trimOrdinalDataOnOverflow})},p.converter=function(i,a,r,n,o,s,l,u){void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===o&&(o=null),void 0===u&&(u=!0);var c=t.CartesianHelper.getCategoryAxisProperties(o),g=t.CartesianHelper.getValueAxisProperties(o);n=t.CartesianHelper.isScalar(n,c);var f=t.ColumnUtil.applyUserMinMax(n,i.categorical,c),m=new h(i),y=t.converterHelper.getPivotedCategories(f,t.columnChartProps.general.formatString),v=y.categories,w=y.categoryFormatter,b=y.categoryIdentities,C=f&&f.categories&&f.categories.length>0?f.categories[0].source:void 0,S=t.dataLabelUtils.getDefaultColumnLabelSettings(r||p.isStacked(s)),x=t.LegendData.DefaultLegendLabelFillColor,P=void 0,D=void 0;if(o&&o.objects){var T=o.objects;P=e.DataViewObjects.getFillColor(T,t.columnChartProps.dataPoint.defaultColor),D=e.DataViewObjects.getValue(T,t.columnChartProps.dataPoint.showAllDataPoints),x=e.DataViewObjects.getFillColor(T,t.columnChartProps.legend.labelColor,t.LegendData.DefaultLegendLabelFillColor);var V=T.labels;t.NewDataLabelUtils.updateLabelSettingsFromLabelsObjectWithLabelDensity(V,S,!p.isBar(s))}var L=m.getLegend(a,x,P),M=L.legend.dataPoints,N=L.seriesSources,I=p.createDataPoints(i,v,b,M,L.seriesObjects,m,S,r,n,t.converterHelper.categoryIsAlsoSeriesRole(i,d.series,d.category),y.categoryObjects,P,s,C,u),A=I.series;this.canSupportOverflow(s,A.length)?null!=S.position&&_.include(this.clusteredValidLabelPositionOptions,S.position)||(S.position=t.labelPosition.auto):null!=S.position&&_.include(this.stackedValidLabelPositionOptions,S.position)||(S.position=t.labelPosition.auto);for(var O=[],R=0,E=M.length;R<E;R++)O.push(N[R]);var F=t.converterHelper.createAxesLabels(c,g,C,O);if(!p.isColumn(s)){var j=F.xAxisLabel;F.xAxisLabel=F.yAxisLabel,F.yAxisLabel=j}if(l){for(var H=0,G=A;H<G.length;H++){var k=G[H];l.applySelectionStateToData(k.data)}l.applySelectionStateToData(L.legend.dataPoints)}return{categories:v,categoryFormatter:w,series:A,valuesMetadata:O,legendData:L.legend,hasHighlights:I.hasHighlights,categoryMetadata:C,scalarCategoryAxis:n,labelSettings:S,axesLabels:{x:F.xAxisLabel,y:F.yAxisLabel},hasDynamicSeries:I.hasDynamicSeries,isMultiMeasure:I.isMultiMeasure,defaultDataPointColor:P,showAllDataPoints:D}},p.canSupportOverflow=function(e,t){return!p.isStacked(e)||1===t},p.createDataPoints=function(i,a,n,o,s,l,u,c,d,h,g,f,m,y,v){void 0===c&&(c=!1),void 0===d&&(d=!1);var w=i.categorical,b=e.data.createIDataViewCategoricalReader(i),C=w&&w.values?w.values.grouped():void 0,S=a.length,x=b.hasValues("Y")?b.getSeriesCount("Y"):void 0,P=[];if(x<1||S<1)return{series:P,hasHighlights:!1,hasDynamicSeries:!1,isMultiMeasure:!1};var D=w.categories;y=_.isEmpty(D)?null:D[0].source;for(var T=t.AxisHelper.getCategoryValueType(y),V=t.AxisHelper.isDateTime(T),L=[],M=[],N=[],I=[],A=!(!w.values||!w.values.source),O=!A&&x>1,R=!1,E=b.hasHighlights("Y"),F=0;F<x;F++){for(var j=[],H=[],G=0;G<S;G++){var k=l.getValueBySeriesAndCategory(F,G);if(j[G]=k,E){var z=l.getHighlightBySeriesAndCategory(F,G);H[G]=z,k>=0&&z>=0&&e.Double.greaterOrEqualWithPrecision(k,z)||k<=0&&z<=0&&e.Double.lessOrEqualWithPrecision(k,z)||(R=!0)}}N.push(j),E&&I.push(H)}R&&!p.canSupportOverflow(m,x)&&(R=!1,E=!1,N=I);for(var U=g,B=t.columnChartProps.general.formatString,F=0;F<x;F++){var W=[],q=o[F],K=void 0;if(!A){var Q=!_.isEmpty(C)&&C[0].values?C[0].values[F]:null,Y=Q&&Q.source&&Q.source.objects?Q.source.objects.labels:null;Y&&(K=e.Prototype.inherit(u),t.NewDataLabelUtils.updateLabelSettingsFromLabelsObjectWithLabelDensity(Y,K))}P.push({displayName:q.label,key:"series"+F,index:F,data:W,identity:q.identity,color:q.color,labelSettings:K}),x>1&&(U=s[F]);for(var J=b.getValueMetadataColumn("Y",F),X=t.GradientUtils.getGradientMeasureIndex(w),$=t.GradientUtils.getGradientValueColumn(w),Z=r.getMeasureIndexOfRole(C,"Y"),ee=t.valueFormatter.getLocalizedString("Percentage"),G=0;G<S;G++){0===F&&(L.push(0),M.push(0));var k=t.AxisHelper.normalizeNonFiniteNumber(N[F][G]);if(!(null==k&&F>0)){var te=k,ie=a[G];if((!V||null==ie||ie instanceof Date)&&(V&&ie&&(ie=ie.getTime()),!d||null!=ie&&!isNaN(ie))){var ae=void 0;c&&(ae=t.StackedUtil.getStackedMultiplier(N,G));var re=k,ne=k<0;ae&&(k*=ne?ae.neg:ae.pos);var oe=Math.abs(k),se=void 0;ne?(se=M[G],isNaN(oe)||(M[G]-=oe)):(isNaN(oe)||(L[G]+=oe),se=L[G]);var le=C&&C.length>F&&C[F].values?C[F].values[Z]:null,ue=_.isEmpty(w.categories)?null:w.categories[0],ce=t.SelectionIdBuilder.builder().withCategory(ue,G).withSeries(w.values,le).withMeasure(b.getValueMetadataColumn("Y",F).queryName).createSelectionId(),de=p.getDataPointColor(q,G,U),pe=0===X?null:$,he=void 0,ge=void 0,fe=void 0,z=void 0,me=void 0,ye=void 0;if(E){he=b.getHighlight("Y",G,F),ge=he;var ve=!0;null===he&&(he=0,ve=!1),c&&(he*=ae.pos),fe=Math.abs(he),me=se,he>0?me-=oe-fe:0===he&&k>0&&(me-=oe),ye=t.SelectionId.createWithHighlight(ce);var we=void 0,be=void 0;if(ve&&null!=ge&&null!=he){var Ce=t.valueFormatter.format(he,ee);be=t.converterHelper.formatFromMetadataColumn(ge,J,B),we=be+" ("+Ce+")"}z=c?we:be}var Se=void 0;if(v){if(Se=[],ue){var xe=t.CategoryLevelUtils.getCategoryLevels(i.categorical.categories,G,B),Pe=t.CategoryLevelUtils.concatenateCategoryLevels(xe);Se.push({displayName:Pe.displayName,value:Pe.value})}if(A&&(ue&&ue.source===w.values.source||Se.push({displayName:w.values.source.displayName,value:t.converterHelper.formatFromMetadataColumn(C[F].name,w.values.source,B)})),null!=te){var De=void 0,Te=t.converterHelper.formatFromMetadataColumn(te,J,B);if(c){var Ve=t.valueFormatter.format(oe,ee);De=Te+" ("+Ve+")"}else De=Te;Se.push({displayName:J.displayName,value:De})}null!=z&&Se.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:z}),pe&&null!=pe.values[G]&&Se.push({displayName:pe.source.displayName,value:t.converterHelper.formatFromMetadataColumn(pe.values[G],pe.source,B)}),t.TooltipBuilder.addTooltipMeasures(b,Se,G,A?F:void 0)}var _e=P[F],Le=_e.labelSettings?_e.labelSettings:u,Me=Le.labelColor,Ne=void 0;p.isStacked(m)&&(Ne=this.getStackedLabelColor(ne,F,x,G,N),Me=Ne||F===x-1&&!ne?Me:t.dataLabelUtils.defaultInsideLabelColor);var Ie={categoryValue:ie,value:k,position:se,valueAbsolute:oe,valueOriginal:re,seriesIndex:F,labelSettings:Le,categoryIndex:G,color:de,selected:!1,originalValue:k,originalPosition:se,originalValueAbsolute:oe,identity:ce,key:ce.getKey(),tooltipInfo:Se,labelFill:Me,labelFormatString:J.format,lastSeries:Ne,chartType:m};if(W.push(Ie),E){var Ae={categoryValue:ie,value:he,position:me,valueAbsolute:fe,valueOriginal:ge,seriesIndex:F,labelSettings:Le,categoryIndex:G,color:de,selected:!1,highlight:!0,originalValue:k,originalPosition:se,originalValueAbsolute:oe,drawThinner:R,identity:ye,key:ye.getKey(),tooltipInfo:Se,labelFormatString:J.format,labelFill:Me,lastSeries:Ne,chartType:m};W.push(Ae)}}}}}return{series:P,hasHighlights:E,hasDynamicSeries:A,isMultiMeasure:O}},p.getDataPointColor=function(i,a,r){if(r){var n=e.DataViewObjects.getFillColor(r[a],t.columnChartProps.dataPoint.fill);if(n)return n}return i.color},p.getStackedLabelColor=function(e,i,a,r,n){for(var o=!(e&&i===a-1&&1!==a),s=i+1;s<a;s++){var l=t.AxisHelper.normalizeNonFiniteNumber(n[s][r]);if(null!==l&&((!e||e&&0===i)&&l>0||e&&0!==i)){o=!1;break}}return o},p.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var n=0,o=t.length;n<o;n++){var s=r[n]=e.Prototype.inherit(t[n]);s.data=t[n].data.filter((function(e){return e.categoryIndex>=a&&e.categoryIndex<i}))}return r},p.getInteractiveColumnChartDomElement=function(e){return e.children("svg").get(0)},p.prototype.setData=function(e){var i=p.isStacked100(this.chartType);if(this.data={categories:[],categoryFormatter:null,series:[],valuesMetadata:[],legendData:null,hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,labelSettings:t.dataLabelUtils.getDefaultColumnLabelSettings(i||p.isStacked(this.chartType)),axesLabels:{x:null,y:null},hasDynamicSeries:!1,defaultDataPointColor:null,isMultiMeasure:!1},e.length>0){var a=this.dataView=e[0];if(a&&a.categorical){var r=a.categorical.categories,n=r&&r.length>0?r[0].source:null,o=t.AxisHelper.getCategoryValueType(n),s=t.CartesianChart.hasCategoryHierarchy(a),l=t.CartesianChart.getIsScalar(a.metadata?a.metadata.objects:null,t.columnChartProps.categoryAxis.axisType,o,void 0,s);this.data=p.converter(a,this.cartesianVisualHost.getSharedColors(),i,l,a.metadata,this.chartType,this.interactivityService,this.tooltipsEnabled)}}this.setChartStrategy()},p.prototype.setChartStrategy=function(){switch(this.chartType){case c.clusteredBar:this.columnChart=new t.ClusteredBarChartStrategy;break;case c.clusteredColumn:this.columnChart=new t.ClusteredColumnChartStrategy;break;case c.stackedBar:case c.hundredPercentStackedBar:this.columnChart=new t.StackedBarChartStrategy;break;case c.stackedColumn:case c.hundredPercentStackedColumn:default:this.columnChart=new t.StackedColumnChartStrategy}if(p.isStacked(this.chartType)&&1===this.data.series.length)switch(this.chartType){case c.stackedBar:this.columnChart=new t.ClusteredBarChartStrategy;break;case c.stackedColumn:this.columnChart=new t.ClusteredColumnChartStrategy}},p.prototype.calculateLegend=function(){if(this.interactivity&&this.interactivity.isInteractiveLegend)return this.createInteractiveLegendDataPoints(0);var e=this.data?this.data.legendData:null,t=e?e.dataPoints:[];return _.isEmpty(t)?null:e},p.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},p.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"dataPoint":this.dataView&&!t.GradientUtils.hasGradientRole(this.dataView.categorical)&&this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e)}},p.prototype.enumerateDataLabels=function(e){var i,a=this.data,r=this.data.labelSettings,n=a.series.length,o=!a.hasDynamicSeries&&(n>1||!a.categoryMetadata);if(i=p.canSupportOverflow(this.chartType,a.series.length)?p.clusteredValidLabelPositionOptions:p.stackedValidLabelPositionOptions,t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,r,null,o,i)),0!==n&&o&&r.showLabelPerSeries)for(var s=0;s<n;s++){var l=a.series[s],u=l.labelSettings?l.labelSettings:this.data.labelSettings;e.pushContainer({displayName:l.displayName}),t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,u,l)),e.popContainer()}},p.prototype.getLabelSettingsOptions=function(e,t,i,a,r){return{enumeration:e,dataLabelsSettings:t,show:!0,positionObject:r,labelOrientation:this.columnLabelImprovements&&!p.isBar(this.chartType)&&!i,position:this.columnLabelImprovements&&!i,displayUnits:!p.isStacked100(this.chartType),precision:!0,selector:i&&i.identity?i.identity.getSelector():null,showAll:a,fontSize:!0,labelDensity:this.columnLabelImprovements&&this.data&&this.data.scalarCategoryAxis}},p.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.series.length;if(0!==a)if(i.hasDynamicSeries||a>1||!i.categoryMetadata)for(var r=0;r<a;r++){var n=i.series[r];e.pushInstance({objectName:"dataPoint",displayName:n.displayName,selector:t.ColorHelper.normalizeSelector(n.identity.getSelector()),properties:{fill:{solid:{color:n.color}}}})}else{var o=i.series[0].data,s=i.categoryFormatter;if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:i.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!i.showAllDataPoints}}),i.showAllDataPoints)for(var r=0;r<o.length;r++){var l=o[r],u=i.categories[r];e.pushInstance({objectName:"dataPoint",displayName:s?s.format(u):u,selector:t.ColorHelper.normalizeSelector(l.identity.getSelector(),!0),properties:{fill:{solid:{color:l.color}}}})}}}},p.prototype.calculateAxesProperties=function(i){var a=this.data;this.currentViewport=i.viewport;var r=this.margin=i.margin,n=a&&a.categories?a.categories.length:0,o=a?this.getCategoryLayout(n,i):{categoryCount:0,categoryThickness:t.CartesianChart.MinOrdinalRectThickness,outerPaddingRatio:t.CartesianChart.OuterPaddingRatio,isScalar:!1};if(this.categoryAxisType=o.isScalar?t.axisType.scalar:null,a&&!o.isScalar&&!this.isScrollable&&i.trimOrdinalDataOnOverflow){var s=Math.min(n,o.categoryCount);s!==n&&(a=e.Prototype.inherit(a),a.series=p.sliceSeries(a.series,s),a.categories=a.categories.slice(0,s))}this.columnChart.setData(a);var l=this.getPreferredPlotArea(o.isScalar,o.categoryCount,o.categoryThickness),u=p.isStacked100(this.chartType),c={height:l.height,width:l.width,duration:0,hostService:this.hostService,unclippedGraphicsContext:this.unclippedGraphicsContext,mainGraphicsContext:this.mainGraphicsContext,margin:this.margin,layout:o,animator:this.animator,interactivityService:this.interactivityService,viewportHeight:this.currentViewport.height-(r.top+r.bottom),viewportWidth:this.currentViewport.width-(r.left+r.right),is100Pct:u,isComboChart:this.isComboChart};this.ApplyInteractivity(c),this.columnChart.setupVisualProps(c);var d,h,g=p.isBar(this.chartType);if(g){var f=i.forcedXDomain;i.forcedXDomain=i.forcedYDomain,i.forcedYDomain=f,d=i.ensureYDomain}else h=i.ensureYDomain;return this.xAxisProperties=this.columnChart.setXScale({is100Pct:u,forcedTickCount:i.forcedTickCount,forcedXDomain:i.forcedXDomain,axisScaleType:g?i.valueAxisScaleType:i.categoryAxisScaleType,axisDisplayUnits:g?i.valueAxisDisplayUnits:i.categoryAxisDisplayUnits,axisPrecision:g?i.valueAxisPrecision:i.categoryAxisPrecision,ensureXDomain:d,margin:r}),this.yAxisProperties=this.columnChart.setYScale({is100Pct:u,forcedTickCount:i.forcedTickCount,forcedYDomain:i.forcedYDomain,axisScaleType:g?i.categoryAxisScaleType:i.valueAxisScaleType,axisDisplayUnits:g?i.categoryAxisDisplayUnits:i.valueAxisDisplayUnits,axisPrecision:g?i.categoryAxisPrecision:i.valueAxisPrecision,ensureYDomain:h,margin:r}),i.showCategoryAxisLabel&&this.xAxisProperties.isCategoryAxis||i.showValueAxisLabel&&!this.xAxisProperties.isCategoryAxis?this.xAxisProperties.axisLabel=a.axesLabels.x:this.xAxisProperties.axisLabel=null,i.showValueAxisLabel&&!this.yAxisProperties.isCategoryAxis||i.showCategoryAxisLabel&&this.yAxisProperties.isCategoryAxis?this.yAxisProperties.axisLabel=a.axesLabels.y:this.yAxisProperties.axisLabel=null,[this.xAxisProperties,this.yAxisProperties]},p.prototype.getPreferredPlotArea=function(e,i,a){var r={height:this.currentViewport.height-this.margin.top-this.margin.bottom,width:this.currentViewport.width-this.margin.left-this.margin.right};if(this.isScrollable&&!e){var n=t.CartesianChart.getPreferredCategorySpan(i,a);p.isBar(this.chartType)?r.height=Math.max(n,r.height):r.width=Math.max(n,r.width)}return r},p.prototype.ApplyInteractivity=function(e){var t=this,i=this.interactivity;if(i&&(i.dragDataPoint&&(e.onDragStart=function(e){e.identity&&t.hostService.onDragStart({event:d3.event,data:{data:e.identity.getSelector()}})}),i.isInteractiveLegend)){var a=function(){var e=d3.mouse(t.mainGraphicsContext[0][0]),i=e[0],a=e[1],r=t.columnChart.getClosestColumnIndex(i,a);t.selectColumn(r)},r=p.getInteractiveColumnChartDomElement(this.element);this.svg.on("click",a),d3.select(r).on("click",a).style("touch-action","none");var n=d3.behavior.drag().origin(Object).on("drag",a);this.svg.call(n),d3.select(r).call(n)}},p.prototype.selectLastSelectedColumnOrDefault=function(e){void 0===e&&(e=!1);var i=void 0===this.lastInteractiveSelectedColumnIndex,a=i?t.CartesianHelper.findMaxCategoryIndex(this.data.series):this.lastInteractiveSelectedColumnIndex;this.selectColumn(a,e)},p.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){var i=this.createInteractiveLegendDataPoints(e);this.columnChart.selectColumn(e,this.lastInteractiveSelectedColumnIndex,t),this.cartesianVisualHost.updateLegend(i),this.lastInteractiveSelectedColumnIndex=e}},p.prototype.createInteractiveLegendDataPoints=function(e){var i=this.data;if(!i||_.isEmpty(i.series))return{dataPoints:[]};for(var a=t.columnChartProps.general.formatString,r=[],n=i.categories&&i.categories[e],o=i.series,s=i.legendData&&i.legendData.dataPoints,l=new h(this.dataView),u=0,c=o.length;u<c;u++){var d=l.getValueBySeriesAndCategory(u,e),p=i.valuesMetadata[u],g=t.converterHelper.getFormattedLegendLabel(p,this.dataView.categorical.values,a),f=void 0;if(1===o.length){var m=o[0];f=m.data.length>e&&m.data[e].color}else f=s.length>u&&s[u].color;r.push({color:f,icon:t.LegendIcon.Box,label:g,category:i.categoryFormatter?i.categoryFormatter.format(n):n,measure:t.valueFormatter.format(d,t.valueFormatter.getFormatString(p,a)),identity:t.SelectionId.createNull(),selected:!1})}return{dataPoints:r}},p.prototype.overrideXScale=function(e){this.xAxisProperties=e},p.prototype.render=function(e){var i=this.columnChart.drawColumns(!e,this.columnLabelImprovements),a=this.data,r=this.margin,n=this.currentViewport,o=n.height-(r.top+r.bottom),s=n.width-(r.left+r.right);this.mainGraphicsContext.attr("height",o).attr("width",s),this.tooltipsEnabled&&this.tooltipService.addTooltip(i.eventGroup,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}));var l=[],u=void 0;if(this.interactivityService){for(var c=0,d=a.series.length;c<d;c++)l=l.concat(a.series[c].data);u={datapoints:l,eventGroup:i.eventGroup,bars:i.shapesSelection,hasHighlights:a.hasHighlights,mainGraphicsContext:this.mainGraphicsContext,viewport:i.viewport,axisOptions:i.axisOptions,showLabel:a.labelSettings.show}}return this.interactivity&&this.interactivity.isInteractiveLegend&&this.selectLastSelectedColumnOrDefault(!0),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:l,behaviorOptions:u,labelDataPoints:[],labelDataPointGroups:i.labelDataPointGroups,labelsAreNumeric:!0,labelOrientation:a.labelSettings.labelOrientation}},p.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},p.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.scalarCategoryAxis},p.prototype.getSupportedCategoryAxisType=function(){var e=this.data?this.data.categoryMetadata:void 0,i=t.AxisHelper.getCategoryValueType(e),a=t.AxisHelper.isOrdinal(i);return a?t.axisType.categorical:t.axisType.both},p.prototype.setFilteredData=function(t,i){var a=e.Prototype.inherit(this.data);return a.series=p.sliceSeries(a.series,i,t),a.categories=a.categories.slice(t,i),this.columnChart.setData(a),a},p.getLabelFill=function(e,i,a){return e?e:i&&!a?t.NewDataLabelUtils.defaultInsideLabelColor:t.NewDataLabelUtils.defaultLabelColor},p.prototype.supportsTrendLine=function(){var t=this.dataView,i=e.data.createIDataViewCategoricalReader(t),a=!!this.data&&this.data.scalarCategoryAxis;return this.chartType===c.clusteredColumn&&a&&i.hasValues("Y")},p.prototype.isStacked=function(){return p.isStacked(this.chartType)},p.isBar=function(e){return i.hasFlag(e,n)},p.isColumn=function(e){return i.hasFlag(e,o)},p.isClustered=function(e){return i.hasFlag(e,s)},p.isStacked=function(e){return i.hasFlag(e,l)},p.isStacked100=function(e){return i.hasFlag(e,u)},p.ColumnChartClassName="columnChart",p.AutoLabelPosition="Auto",p.validLabelPositionsAutoClustered=[16,4,1,2],p.validLabelPositionsAutoStacked=[1,4,2],p.clusteredValidLabelPositionOptions=[p.AutoLabelPosition,t.labelPosition.outsideEnd,t.labelPosition.insideEnd,t.labelPosition.insideCenter,t.labelPosition.insideBase],p.stackedValidLabelPositionOptions=[p.AutoLabelPosition,t.labelPosition.insideCenter,t.labelPosition.insideEnd,t.labelPosition.insideBase],p.minimumLabelsToRender=4,p.SeriesClasses=a.CssConstants.createClassAndSelector("series"),p})();t.ColumnChart=p;var h=(function(){function i(t){this.dataView=t&&t.categorical,this.reader=e.data.createIDataViewCategoricalReader(t)}return i.prototype.getLegend=function(e,i,a){var n=[],o=[],s=[],l=!1,u=this.reader,c=new t.ColorHelper(e,t.columnChartProps.dataPoint.fill,a),d=void 0;if(this.dataView&&this.dataView.values){for(var p=this.dataView.values,h=p.grouped(),g=!(!p||!p.source),f=t.columnChartProps.general.formatString,m=0,y=h.length;m<y;m++)for(var v=h[m],w=v.objects,b=v.values,C=0,S=b.length;C<S;C++){var x=b[C],P=x.source;if(!r.hasRole(P,"Gradient")&&!r.hasRole(P,"Tooltips")||r.hasRole(P,"Y")){o.push(P),s.push(x.objects);var D=new t.SelectionIdBuilder;D=D.withMeasure(P.queryName),u.hasDynamicSeries()&&(D=D.withSeries(u.getSeriesValueColumns(),u.getSeriesValueColumnGroup(m)));var T=D.createSelectionId(),V=t.converterHelper.getFormattedLegendLabel(P,p,f),_=g?c.getColorForSeriesValue(w,p.identityFields,P.groupName):c.getColorForMeasure(P.objects,P.queryName);
n.push({icon:t.LegendIcon.Box,color:_,label:V,identity:T,selected:!1}),x.identity&&void 0!==P.groupName&&(l=!0)}}var L=this.dataView.values;d=L&&L.source?L.source.displayName:""}var M={title:d,dataPoints:n,grouped:l,labelColor:i};return{legend:M,seriesSources:o,seriesObjects:s}},i.prototype.getValueBySeriesAndCategory=function(e,t){return this.reader.getValue("Y",t,e)},i.prototype.getHighlightBySeriesAndCategory=function(e,t){return this.reader.getHighlight("Y",t,e)},i})()})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},t.prototype.setData=function(e){this.data=e},t.prototype.setXScale=function(t){var i,a,r=t.forcedXDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.ensureXDomain,u=t.margin,c=this.width;r&&2===r.length&&(i=r[0],a=r[1]);var d=this.xProps=e.ColumnUtil.getCategoryAxis(this.data,c,this.categoryLayout,!1,i,a,n,o,s,l,u),p=this.data.series.length,h=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio)/p;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map((function(e){return e.index}))).rangeBands([0,p*h]),d},t.prototype.setYScale=function(t){var i=(t.is100Pct,t.forcedTickCount),a=t.forcedYDomain,r=t.axisScaleType,n=t.axisDisplayUnits,o=t.axisPrecision,s=t.ensureYDomain,l=t.margin,u=this.viewportHeight,c=e.AxisHelper.createValueDomain(this.data.series,!0)||e.emptyDomain,d=e.AxisHelper.combineDomain(a,c,s),p=e.AxisHelper.scaleShouldClamp(d,c);return this.yProps=e.AxisHelper.createAxis({pixelSpan:u,dataDomain:d,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata[0],formatString:e.valueFormatter.getFormatString(this.data.valuesMetadata[0],e.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:n,axisPrecision:o,shouldClamp:p,margin:l}),this.yProps},t.prototype.createLabelDataPoints=function(){return e.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!1,!0,this.columnLabelImprovements)},t.prototype.drawColumns=function(i,a){var r=this.data;this.columnLabelImprovements=a,this.columnsCenters=null;var n,o=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio),s=o/r.series.length,l={columnWidth:s,categoryWidth:o,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin},u=this.layout=t.getLayout(r,l),c=r.labelSettings;c&&c.show&&(n=this.createLabelDataPoints());var d,p,h=e.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,l);return this.animator&&i&&(d=this.animator.animate({viewModel:r,series:h,layout:u,itemCS:t.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),p=d.shapes),this.animator&&i&&!d.failed||(p=e.ColumnUtil.drawDefaultShapes(r,h,u,t.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),e.ColumnUtil.applyInteractivity(p,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:p,viewport:{height:this.height,width:this.width},axisOptions:l,labelDataPointGroups:n}},t.prototype.selectColumn=function(i,a,r){e.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,t.classes.item.selector,i,a,r),this.moveHandle(i)},t.prototype.getClosestColumnIndex=function(t,i){return e.ColumnUtil.getClosestColumnIndex(t,this.getColumnsCenters())},t.prototype.getColumnsCenters=function(){var t=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map((function(e){return t.xProps.scale(t.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+a}))}}return this.columnsCenters},t.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=d3.select(".interactive-hover-line");if(i.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(i.node().parentNode)),!t||t.length<=1)return void(this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove());var a=t[e];if(this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({x1:a,x2:a}),r.select("circle").attr({cx:a})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:a,x2:a,y1:0,y2:this.height}),r.append("circle").attr({cx:a,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},t.getLayout=function(t,i){var a=i.columnWidth,r=.5*a,n=r/2,o=i.isScalar,s=i.xScale,l=i.yScale,u=i.seriesOffsetScale,c=l(0),d=0;return o&&(d=i.categoryWidth/2),{shapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d+(e.drawThinner?n:0)},y:function(t){return c+e.AxisHelper.diffScaled(l,Math.max(0,t.value),0)},height:function(t){return Math.abs(e.AxisHelper.diffScaled(l,0,t.value))}},shapeLayoutWithoutHighlights:{width:function(e){return a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d},y:function(t){return c+e.AxisHelper.diffScaled(l,Math.max(0,t.originalValue),0)},height:function(t){return Math.abs(e.AxisHelper.diffScaled(l,0,t.originalValue))}},zeroShapeLayout:{width:function(e){return e.drawThinner?r:a},x:function(e){return s(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d+(e.drawThinner?n:0)},y:function(e){return c},height:function(e){return 0}}}},t.classes={item:{class:"column",selector:".column"}},t})();e.ClusteredColumnChartStrategy=t;var i=(function(){function t(){}return t.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},t.prototype.setData=function(e){this.data=e},t.prototype.setYScale=function(t){var i,a,r=t.forcedYDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.ensureYDomain,u=this.height;r&&2===r.length&&(i=r[0],a=r[1]);var c=this.yProps=e.ColumnUtil.getCategoryAxis(this.data,u,this.categoryLayout,!0,i,a,n,o,s,l),d=this.data.series.length,p=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio)/d;return this.seriesOffsetScale=d3.scale.ordinal().domain(this.data.series.map((function(e){return e.index}))).rangeBands([0,d*p]),c},t.prototype.setXScale=function(t){var i=(t.is100Pct,t.forcedTickCount),a=t.forcedXDomain,r=t.axisScaleType,n=t.axisDisplayUnits,o=t.axisPrecision,s=t.ensureXDomain,l=t.margin,u=this.width,c=e.AxisHelper.createValueDomain(this.data.series,!0)||e.emptyDomain,d=e.AxisHelper.combineDomain(a,c,s),p=e.AxisHelper.scaleShouldClamp(d,c);return this.xProps=e.AxisHelper.createAxis({pixelSpan:u,dataDomain:d,zeroScalarDomain:[0,1],metaDataColumn:this.data.valuesMetadata[0],formatString:e.valueFormatter.getFormatString(this.data.valuesMetadata[0],e.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:i,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:r,axisDisplayUnits:n,axisPrecision:o,shouldClamp:p,margin:l}),this.xProps.axis.tickSize(-this.viewportHeight,0),this.xProps},t.prototype.createLabelDataPoints=function(){return e.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!0,!0,this.columnLabelImprovements)},t.prototype.drawColumns=function(i,a){var r=this.data;this.columnLabelImprovements=a,this.barsCenters=null;var n,o=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio),s=o/r.series.length,l={columnWidth:s,categoryWidth:o,xScale:this.xProps.scale,yScale:this.yProps.scale,seriesOffsetScale:this.seriesOffsetScale,isScalar:this.categoryLayout.isScalar,margin:this.margin},u=this.layout=t.getLayout(r,l),c=r.labelSettings;c&&c.show&&(n=this.createLabelDataPoints());var d,p,h=e.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,l);return this.animator&&i&&(d=this.animator.animate({viewModel:r,series:h,layout:u,itemCS:t.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),p=d.shapes),this.animator&&i&&!d.failed||(p=e.ColumnUtil.drawDefaultShapes(r,h,u,t.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),e.ColumnUtil.applyInteractivity(p,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:p,viewport:{height:this.height,width:this.width},axisOptions:l,labelDataPointGroups:n}},t.prototype.selectColumn=function(i,a,r){e.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,t.classes.item.selector,i,a,r),this.moveHandle(i)},t.prototype.getClosestColumnIndex=function(t,i){return e.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},t.prototype.getBarsCenters=function(){var t=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map((function(e){return t.yProps.scale(t.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+a}))}}return this.barsCenters},t.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=d3.select(".interactive-hover-line");if(i.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(i.node().parentNode)),!t||t.length<=1)return void(this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove());var a=t[e];if(this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({y1:a,y2:a}),r.select("circle").attr({cy:a})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:a,y2:a}),r.append("circle").attr({cx:0,cy:a,r:"6px"}).classed("drag-handle",!0)}},t.getLayout=function(t,i){var a=i.columnWidth,r=.5*a,n=r/2,o=i.isScalar,s=i.xScale,l=i.yScale,u=i.seriesOffsetScale,c=s(0),d=0;return o&&(d=i.categoryWidth/2),{shapeLayout:{width:function(t){return Math.abs(e.AxisHelper.diffScaled(s,0,t.value))},x:function(t){return c+e.AxisHelper.diffScaled(s,Math.min(0,t.value),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d+(e.drawThinner?n:0)},height:function(e){return e.drawThinner?r:a}},shapeLayoutWithoutHighlights:{width:function(t){return Math.abs(e.AxisHelper.diffScaled(s,0,t.originalValue))},x:function(t){return c+e.AxisHelper.diffScaled(s,Math.min(0,t.originalValue),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d},height:function(e){return a}},zeroShapeLayout:{width:function(e){return 0},x:function(t){return c+e.AxisHelper.diffScaled(s,Math.min(0,t.value),0)},y:function(e){return l(o?e.categoryValue:e.categoryIndex)+u(e.seriesIndex)-d+(e.drawThinner?n:0)},height:function(e){return e.drawThinner?r:a}}}},t.classes={item:{class:"bar",selector:".bar"}},t})();e.ClusteredBarChartStrategy=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(){}return t.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},t.prototype.setData=function(e){this.data=e},t.prototype.setXScale=function(t){var i,a,r=t.forcedXDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.xReferenceLineValue,u=t.margin,c=this.width;r&&2===r.length&&(i=r[0],a=r[1]);var d=this.xProps=e.ColumnUtil.getCategoryAxis(this.data,c,this.categoryLayout,!1,i,a,n,o,s,l,u);return d},t.prototype.setYScale=function(t){var i=t.is100Pct,a=t.forcedTickCount,r=t.forcedYDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.yReferenceLineValue,u=t.margin,c=this.viewportHeight,d=e.StackedUtil.calcValueDomain(this.data.series,i),p=[d.min,d.max],h=e.AxisHelper.combineDomain(r,p,l),g=e.AxisHelper.scaleShouldClamp(h,p),f=this.data.valuesMetadata[0],m=i?this.graphicsContext.hostService.getLocalizedString("Percentage"):e.valueFormatter.getFormatString(f,e.columnChartProps.general.formatString);return this.yProps=e.AxisHelper.createAxis({pixelSpan:c,dataDomain:h,zeroScalarDomain:[0,1],metaDataColumn:f,formatString:m,outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:n,axisDisplayUnits:o,axisPrecision:s,is100Pct:i,shouldClamp:g,margin:u}),this.yProps},t.prototype.createLabelDataPoints=function(){return e.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!1,!1,this.columnLabelImprovements)},t.prototype.drawColumns=function(i,a){var r=this.data;this.columnLabelImprovements=a,this.columnsCenters=null;var n,o={columnWidth:this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},s=this.layout=t.getLayout(r,o),l=r.labelSettings;l&&l.show&&(n=this.createLabelDataPoints());var u,c,d=e.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,o);return this.animator&&i&&(u=this.animator.animate({viewModel:r,series:d,layout:s,itemCS:t.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),c=u.shapes),this.animator&&i&&!u.failed||(c=e.ColumnUtil.drawDefaultShapes(r,d,s,t.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),e.ColumnUtil.applyInteractivity(c,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:c,viewport:{height:this.height,width:this.width},axisOptions:o,labelDataPointGroups:n}},t.prototype.selectColumn=function(i,a,r){e.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,t.classes.item.selector,i,a,r),this.moveHandle(i)},t.prototype.getClosestColumnIndex=function(t,i){return e.ColumnUtil.getClosestColumnIndex(t,this.getColumnsCenters())},t.prototype.getColumnsCenters=function(){var t=this;if(!this.columnsCenters){var i=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.columnsCenters=r.data.map((function(e){return t.xProps.scale(t.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+a}))}}return this.columnsCenters},t.prototype.moveHandle=function(e){var t=this.getColumnsCenters(),i=d3.select(".interactive-hover-line");if(i.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(i.node().parentNode)),!t||t.length<=1)return void(this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove());var a=t[e];if(this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({x1:a,x2:a}),r.select("circle").attr({cx:a})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:a,x2:a,y1:0,y2:this.height}),r.append("circle").attr({cx:a,cy:this.height,r:"6px"}).classed("drag-handle",!0)}},t.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,n=t.yScale,o=0;return a&&(o=i/2),{shapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-o},y:function(e){return n(e.position)},height:function(e){return n(e.position-e.valueAbsolute)-n(e.position)}},shapeLayoutWithoutHighlights:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-o},y:function(e){return n(e.originalPosition)},height:function(e){return n(e.originalPosition-e.originalValueAbsolute)-n(e.originalPosition)}},zeroShapeLayout:{width:function(e){return i},x:function(e){return r(a?e.categoryValue:e.categoryIndex)-o},y:function(e){return n(e.value>=0?e.position-e.valueAbsolute:e.position)},height:function(e){return 0}}}},t.classes={item:{class:"column",selector:".column"},highlightItem:{class:"highlightColumn",selector:".highlightColumn"}},t})();e.StackedColumnChartStrategy=t;var i=(function(){function t(){}return t.prototype.setupVisualProps=function(e){this.graphicsContext=e,this.margin=e.margin,this.width=this.graphicsContext.width,this.height=this.graphicsContext.height,this.categoryLayout=e.layout,this.animator=e.animator,this.interactivityService=e.interactivityService,this.viewportHeight=e.viewportHeight,this.viewportWidth=e.viewportWidth,this.isComboChart=e.isComboChart},t.prototype.setData=function(e){this.data=e},t.prototype.setYScale=function(t){var i,a,r=t.forcedYDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.ensureYDomain,u=t.margin,c=this.height;r&&2===r.length&&(i=r[0],a=r[1]);var d=this.yProps=e.ColumnUtil.getCategoryAxis(this.data,c,this.categoryLayout,!0,i,a,n,o,s,l,u);return d},t.prototype.setXScale=function(t){var i=t.is100Pct,a=t.forcedTickCount,r=t.forcedXDomain,n=t.axisScaleType,o=t.axisDisplayUnits,s=t.axisPrecision,l=t.ensureXDomain,u=t.margin,c=this.width,d=e.StackedUtil.calcValueDomain(this.data.series,i),p=[d.min,d.max],h=e.AxisHelper.combineDomain(r,p,l),g=e.AxisHelper.scaleShouldClamp(h,p),f=this.data.valuesMetadata[0],m=i?this.graphicsContext.hostService.getLocalizedString("Percentage"):e.valueFormatter.getFormatString(f,e.columnChartProps.general.formatString);return this.xProps=e.AxisHelper.createAxis({pixelSpan:c,dataDomain:h,zeroScalarDomain:[0,1],metaDataColumn:f,formatString:m,outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:a,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:n,axisDisplayUnits:o,axisPrecision:s,is100Pct:i,shouldClamp:g,margin:u}),this.xProps.axis.tickSize(-this.viewportHeight,0),this.xProps},t.prototype.createLabelDataPoints=function(){return e.ColumnUtil.createLabelDataPoints(this.data,this.layout,this.graphicsContext,this.yProps,!0,!1,this.columnLabelImprovements)},t.prototype.drawColumns=function(i,a){var r=this.data;this.columnLabelImprovements=a,this.barsCenters=null;var n,o={columnWidth:this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio),xScale:this.xProps.scale,yScale:this.yProps.scale,isScalar:this.categoryLayout.isScalar,margin:this.margin},s=this.layout=t.getLayout(r,o),l=r.labelSettings;l&&l.show&&(n=this.createLabelDataPoints());var u,c,d=e.ColumnUtil.drawSeries(r,this.graphicsContext.mainGraphicsContext,o);return this.animator&&i&&(u=this.animator.animate({viewModel:r,series:d,layout:s,itemCS:t.classes.item,interactivityService:this.interactivityService,mainGraphicsContext:this.graphicsContext.mainGraphicsContext,viewPort:{height:this.height,width:this.width}}),c=u.shapes),this.animator&&i&&!u.failed||(c=e.ColumnUtil.drawDefaultShapes(r,d,s,t.classes.item,!this.animator,this.interactivityService&&this.interactivityService.hasSelection())),e.ColumnUtil.applyInteractivity(c,this.graphicsContext.onDragStart),{eventGroup:this.graphicsContext.mainGraphicsContext,shapesSelection:c,viewport:{height:this.height,width:this.width},axisOptions:o,labelDataPointGroups:n}},t.prototype.selectColumn=function(i,a,r){e.ColumnUtil.setSelectedColumnOpacity(this.graphicsContext.mainGraphicsContext,t.classes.item.selector,i,a,r),this.moveHandle(i)},t.prototype.getClosestColumnIndex=function(t,i){return e.ColumnUtil.getClosestColumnIndex(i,this.getBarsCenters())},t.prototype.getBarsCenters=function(){var t=this;if(!this.barsCenters){var i=this.categoryLayout.categoryThickness*(1-e.CartesianChart.InnerPaddingRatio);if(this.data.series.length>0){var a=0;this.categoryLayout.isScalar||(a=i/2);var r=this.data.series[0];this.barsCenters=r.data.map((function(e){return t.yProps.scale(t.categoryLayout.isScalar?e.categoryValue:e.categoryIndex)+a}))}}return this.barsCenters},t.prototype.moveHandle=function(e){var t=this.getBarsCenters(),i=d3.select(".interactive-hover-line");if(i.empty()||this.columnSelectionLineHandle||(this.columnSelectionLineHandle=d3.select(i.node().parentNode)),!t||t.length<=1)return void(this.columnSelectionLineHandle&&this.columnSelectionLineHandle.remove());var a=t[e];if(this.columnSelectionLineHandle){var r=this.columnSelectionLineHandle;r.select("line").attr({y1:a,y2:a}),r.select("circle").attr({cy:a})}else{var r=this.columnSelectionLineHandle=this.graphicsContext.unclippedGraphicsContext.append("g");r.append("line").classed("interactive-hover-line",!0).attr({x1:0,x2:this.width,y1:a,y2:a}),r.append("circle").classed("drag-handle",!0).attr({cx:0,cy:a,r:"6px"})}},t.getLayout=function(e,t){var i=t.columnWidth,a=t.isScalar,r=t.xScale,n=t.yScale,o=0;return a&&(o=i/2),{shapeLayout:{width:function(e){return r(e.position)-r(e.position-e.valueAbsolute)},x:function(e){return r(e.position-e.valueAbsolute)},y:function(e){return n(a?e.categoryValue:e.categoryIndex)-o},height:function(e){return i}},shapeLayoutWithoutHighlights:{width:function(e){return r(e.originalPosition)-r(e.originalPosition-e.originalValueAbsolute)},x:function(e){return r(e.originalPosition-e.originalValueAbsolute)},y:function(e){return n(a?e.categoryValue:e.categoryIndex)-o},height:function(e){return i}},zeroShapeLayout:{width:function(e){return 0},x:function(e){return r(e.value>=0?e.position-e.valueAbsolute:e.position)},y:function(e){return n(a?e.categoryValue:e.categoryIndex)-o},height:function(e){return i}}}},t.classes={item:{class:"bar",selector:".bar"},highlightItem:{class:"highlightBar",selector:".highlightBar"}},t})();e.StackedBarChartStrategy=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i="realTimeLineChart",a=1.5,r=3e5,n=(function(){function n(e){this.animator=e.animator,this.maxDataValue=Number.MIN_VALUE,this.newDataInterval=0,this.duration=r}return n.prototype.init=function(e){this.options=e;var a=this.cartesianSVG=e.svg;this.host=e.host,this.currentViewport=e.viewport,this.cartesianVisualHost=e.cartesianHost,a.classed(i,!0).classed("cartesianChart",!0);var r=this.mainGraphicsSVG=a.append("svg");r.classed("mainGraphicsSVG",!0),this.mainGraphicsContext=r.append("g").classed("mainGraphicsContext",!0),this.data={series:[],dataLabelsSettings:t.dataLabelUtils.getDefaultLineChartLabelSettings(!1),axesLabels:{x:null,y:null},hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,categoryData:[]}},n.prototype.setData=function(i){if(this.data||(this.data={series:[],dataLabelsSettings:t.dataLabelUtils.getDefaultLineChartLabelSettings(!1),axesLabels:{x:null,y:null},hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,categoryData:[]}),!_.isEmpty(i)){var a=_.first(i);if(a.categorical){var r=t.CartesianHelper.getCategoryAxisProperties(a.metadata),n=r.duration;n&&(this.duration=n);var o=this.dataViewCat=a.categorical;this.removeOldData();var s=o.categories,l=e.ValueType.fromDescriptor({text:!0});s&&s.length>0&&s[0].source&&s[0].source.type&&(l=s[0].source.type);var u=t.CartesianChart.getIsScalar(a.metadata?a.metadata.objects:null,t.lineChartProps.categoryAxis.axisType,l),c=t.LineChart.converter(a,t.valueFormatter.format(null),this.cartesianVisualHost.getSharedColors(),u);this.mergeNewData(c),this.removeOldData(this.newDataInterval)}}},n.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||!_.isEmpty(this.data.series))},n.prototype.calculateAxesProperties=function(e){return this.currentViewport=e.viewport,this.margin=e.margin,this.newAxisData&&(this.axisData=this.newAxisData),this.newAxisData=this.createAxisData(e),this.axisData||(this.axisData=this.newAxisData),[this.xAxisProperties,this.yAxisProperties]},n.prototype.overrideXScale=function(e){this.xAxisProperties=e},n.prototype.render=function(e,t){if(!this.containsEmptySeries())return this.renderLines(),this.animator&&this.animator.refreshLastUpdate(),{dataPoints:[],behaviorOptions:[],labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:[]}},n.prototype.calculateLegend=function(){if(this.containsEmptySeries())return{title:"",dataPoints:[]};var e=this.data,i=this.dataViewCat,a=[],r=t.lineChartProps.general.formatString,n=null;if(i.values)for(var o=0,s=e.series;o<s.length;o++){var l=s[o],u=t.converterHelper.getFormattedLegendLabel(l.yCol,i.values,r);n=l.yCol,a.push({color:l.color,icon:t.LegendIcon.Line,label:u,identity:l.identity,selected:l.selected})}var c=i?i.values:null,d=c&&c.source?c.source.displayName:"";return{title:d,dataPoints:a,fontSize:t.SVGLegend.DefaultFontSizeInPt}},n.prototype.onClearSelection=function(){},n.prototype.createAxisData=function(i){var a=this.data;if(a){var r;this.containsEmptySeries()||(r=a.series[0].yCol);var n=this.truncateSeries(),o=t.AxisHelper.createDomain(n,a.categoryMetadata?a.categoryMetadata.type:e.ValueType.fromDescriptor({text:!0}),!0,[this.getMinData()+this.newDataInterval,null]),s=i.viewport,l=s.width,u=this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:l,dataDomain:o,metaDataColumn:a.categoryMetadata,formatString:t.valueFormatter.getFormatString(a.categoryMetadata,t.columnChartProps.general.formatString),outerPadding:10,isCategoryAxis:!0,isScalar:!0,isVertical:!1,categoryThickness:null,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,i){return t.CartesianHelper.lookupXValue(a,e,i,!0)},scaleType:t.axisScale.linear,margin:i.margin}),c=t.AxisHelper.createValueDomain(n,!1),d=this.margin,p=this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:s.height-d.top-d.bottom,dataDomain:c,metaDataColumn:r,formatString:t.valueFormatter.getFormatString(r,t.columnChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:t.axisScale.linear,margin:i.margin});return p.axis.orient("left").tickSize(-l),{x:u,y1:p}}},n.prototype.truncateSeries=function(){var t=this.getMinData(),i=this.data.series;return i?_.map(i,(function(i,a){i=e.Prototype.inherit(i),i.data=e.Prototype.inherit(i.data);var r=_.findIndex(i.data,(function(e){return e.categoryValue>=t})),n=0;return r>0&&n++,i.data=i.data.slice(n),i})):[]},n.prototype.removeOldData=function(e){if(void 0===e&&(e=0),!this.containsEmptySeries()){for(var t=this.getMinData(e),i=this.data,a=0,r=i.series;a<r.length;a++){var n=r[a],o=_.findIndex(n.data,(function(e){return e.categoryValue>t}));o>0&&(n.data=n.data.slice(o))}var s=_.findIndex(i.categoryData,(function(e){return e.categoryValue>t}));s>0&&(i.categoryData=this.data.categoryData.slice(s),i.categories=this.data.categories.slice(s))}},n.prototype.mergeNewData=function(e){if(this.containsEmptySeries())return this.data=e,void(this.maxDataValue=this.getMaxData());this.data.series=n.mergeSeries(this.data.series,e.series,this.maxDataValue),n.mergeCategories(this.data,e,this.maxDataValue);var t=this.getMaxData();this.newDataInterval=this.maxDataValue&&t?t-this.maxDataValue:0,this.maxDataValue=t},n.prototype.getMaxData=function(){for(var e=0,t=0,i=this.data.series;t<i.length;t++){var a=i[t];a.data.length&&(e=Math.max(_.last(a.data).categoryValue,e))}return e},n.prototype.getMinData=function(e){return void 0===e&&(e=0),this.maxDataValue-this.duration-e*a},n.prototype.renderLines=function(){var e=this.axisData.x.scale,i=this.axisData.y1.scale,a=this.currentViewport,r=this.margin,n=a.height-r.top-r.bottom,o=a.width-r.left-r.right,s=e(e.domain()[0]+this.newDataInterval)-e(e.domain()[0]),l=d3.svg.line().x((function(t,i){return e(t.categoryValue)})).y((function(e,t){return i(e.value)}));this.mainGraphicsSVG.attr({x:0,height:n,width:o}),this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(0,0));var u=this.mainGraphicsContext.selectAll(".line").data(this.data.series,(function(e){return e.identity.getKey()}));u.enter().append("path").classed("line",!0),u.style("stroke",(function(e){return e.color})).attr("d",(function(e){return l(e.data)})),u.exit().remove(),this.animator&&this.animator.animate({mainGraphicsContext:this.mainGraphicsContext,interactivityService:null,xTranslation:s})},n.prototype.containsEmptySeries=function(){return!this.data||_.isEmpty(this.data.series)},n.mergeCategories=function(e,t,i){var a=t.categories,r=_.findIndex(a,(function(e){return e.categoryValue>i}));r>-1?(e.categories=e.categories.concat(t.categories.slice(r)),e.categoryData=e.categoryData.concat(t.categoryData.slice(r))):(e.categories=t.categories,e.categoryData=t.categoryData)},n.mergeSeries=function(e,t,i){for(var a=[],r=0,n=t;r<n.length;r++){var o=n[r],s=_.find(e,(function(e){return e.identity.equals(o.identity)}));if(s){a.push(s);for(var l=0,u=o.data;l<u.length;l++){var c=u[l];c.categoryValue>i&&s.data.push(c)}}else a.push(o)}return a},n})();t.RealTimeLineChart=n})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){var a=t.utility.SelectionManager,r=(function(){function i(){}return i.converter=function(e){var a={size:i.getSize(e),color:i.getFill(e).solid.color,text:i.DefaultText,toolTipInfo:[{displayName:"Test",value:"1...2....3... can you see me? I am sending random strings to the tooltip"}],selector:t.SelectionId.createNull()},r=e.table;return r?(a.text=r.rows[0][0],e.categorical&&(a.selector=e.categorical.categories[0].identity?t.SelectionId.createWithId(e.categorical.categories[0].identity[0]):t.SelectionId.createNull()),a):a},i.prototype.init=function(e){this.root=d3.select(e.element.get(0)).append("svg").classed("hello",!0),this.svgText=this.root.append("text").style("cursor","pointer").style("stroke","green").style("stroke-width","0px").attr("text-anchor","middle"),this.selectiionManager=new a({hostServices:e.host})},i.prototype.update=function(a){if(a.dataViews||a.dataViews[0]){var r=this.dataView=a.dataViews[0],n=a.viewport,o=i.converter(r);this.root.attr({height:n.height,width:n.width});var s={fontFamily:"tahoma",fontSize:o.size+"px",text:o.text},l=e.TextMeasurementService.estimateSvgTextHeight(s),u=this.selectiionManager;this.svgText.style({fill:o.color,"font-size":s.fontSize,"font-family":s.fontFamily}).attr({y:n.height/2+l/3+"px",x:n.width/2}).text(o.text).on("click",(function(){var e=this;u.select(o.selector).then((function(t){return d3.select(e).style("stroke-width",t.length>0?"2px":"0px")}))})).data([o]),t.TooltipManager.addTooltip(this.svgText,(function(e){return e.data.toolTipInfo}))}},i.getFill=function(e){if(e){var t=e.metadata.objects;if(t){var i=t.general;if(i){
var a=i.fill;if(a)return a}}}return{solid:{color:"red"}}},i.getSize=function(e){if(e){var t=e.metadata.objects;if(t){var i=t.general;if(i){var a=i.size;if(a)return a}}}return 100},i.prototype.enumerateObjectInstances=function(e){var t=[],a=this.dataView;switch(e.objectName){case"general":var r={objectName:"general",displayName:"General",selector:null,properties:{fill:i.getFill(a),size:i.getSize(a)}};t.push(r)}return t},i.prototype.destroy=function(){this.root=null},i.capabilities={dataRoles:[{displayName:"Values",name:"Values",kind:e.VisualDataRoleKind.GroupingOrMeasure}],dataViewMappings:[{table:{rows:{for:{in:"Values"},dataReductionAlgorithm:{window:{count:100}}},rowCount:{preferred:{min:1}}}}],objects:{general:{displayName:e.data.createDisplayNameGetter("Visual_General"),properties:{fill:{type:{fill:{solid:{color:!0}}},displayName:"Fill"},size:{type:{numeric:!0},displayName:"Size"}}}}},i.DefaultText="Invalid DV",i})();i.HelloIVisual=r})(i=t.samples||(t.samples={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i,a){if(a){for(var r,n=a.length,o=0;o<n;o++){var s=a[o];if(s.enumerateObjectInstances){if(s instanceof e.ColumnChart){r=o;continue}s.enumerateObjectInstances(t,i)}}void 0!==r&&a[r].enumerateObjectInstances(t,i)}}function a(t){var i=!_.isEmpty(t.dataViewMappings)&&t.dataViewMappings[0];if(i){var a=i.categorical&&i.categorical.values,r=a.group&&!_.isEmpty(a.group.select)&&a.group.select[0];_.isEmpty(r.for.in.items)&&(a.group.by.items=void 0)}var n=e.CartesianChart.detectScalarMapping(i);if(i&&i.categorical&&(i.categorical.dataVolume=4,n)){var o=i.categorical.categories;o.dataReductionAlgorithm={sample:{}};var s=i.categorical.values;s&&s.group&&(s.group.dataReductionAlgorithm={top:{}})}var l=t.dataViewMappings.length>1&&t.dataViewMappings[1];if(l&&l.categorical&&(l.categorical.dataVolume=4,n)){var o=l.categorical.categories;o.dataReductionAlgorithm={sample:{}};var s=l.categorical.values;s&&s.group&&(s.group.dataReductionAlgorithm={top:{}})}n||e.CartesianChart.expandCategoryWindow(t.dataViewMappings)}function r(t){if(t&&t.dataViewMappings.length>0){var i=t.dataViewMappings[0];if(!e.CartesianChart.detectScalarMapping(i))return["Category","Y","Y2"]}return null}function n(e){return 10===e||13===e||14===e||15===e||16===e}t.enumerateDataPoints=i,t.customizeQuery=a,t.getSortableRoles=r,t.isComboChart=n})(t=e.ComboChart||(e.ComboChart={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=(function(){function i(e){this.isScrollable=e.isScrollable,this.interactivityService=e.interactivityService}return i.prototype.init=function(e){this.options=e,this.svg=e.svg,this.svg.classed(i.ClassName,!0),this.mainGraphicsG=this.svg.append("g").classed("dataDotChartMainGraphicsContext",!0),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.currentViewport=e.viewport,this.hostService=e.host,this.cartesianVisualHost=e.cartesianHost,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity,this.element=e.element},i.prototype.setData=function(a){if(this.data={series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1},a.length>0){var r=a[0];if(r&&r.categorical){var n=this.dataViewCategorical=r.categorical,o=n.categories,s=e.ValueType.fromDescriptor({text:!0});o&&o.length>0&&o[0].source&&o[0].source.type&&(s=o[0].source.type),this.data=i.converter(r,t.valueFormatter.format(null),this.interactivityService)}}},i.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a&&a.series&&a.series.data&&(a.series={data:a.series.data.slice(t,i),xCol:a.series.xCol,yCol:a.series.yCol}),a},i.prototype.calculateAxesProperties=function(a){var r=this;this.currentViewport=a.viewport,this.margin=a.margin;var n=this.clippedData=this.data,o=this.currentViewport,s=this.margin,l=n?n.series:null,u=l&&l.data&&l.data.length>0?[l]:[],c=l&&l.data?l.data.length:0;n.hasHighlights&&(c/=2);var d,p,h=o.width-(s.left+s.right),g=o.height-(s.top+s.bottom);i.hasDataPoint(l)&&(d=l.xCol,p=l.yCol);var f=t.CartesianChart.getLayout(null,{availableWidth:h,categoryCount:c,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:a.trimOrdinalDataOnOverflow}),m=f.categoryThickness*t.CartesianChart.OuterPaddingRatio;this.isScrollable||(this.clippedData=i.createClippedDataIfOverflowed(n,f.categoryCount));var y=t.AxisHelper.createValueDomain(u,!0)||t.emptyDomain,v=t.AxisHelper.combineDomain(a.forcedYDomain,y,a.ensureYDomain);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:g,dataDomain:v,metaDataColumn:p,formatString:t.valueFormatter.getFormatString(p,i.formatStringProp),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,margin:s});var w=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0}),b=t.AxisHelper.createDomain(u,w,!1,a.forcedXDomain,a.ensureXDomain);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:h,dataDomain:b,metaDataColumn:d,formatString:t.valueFormatter.getFormatString(d,i.formatStringProp),outerPadding:m,isScalar:!1,isVertical:!1,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,categoryThickness:f.categoryThickness,getValueFn:function(e,t){return r.lookupXValue(e,t)},isCategoryAxis:!0,margin:s}),[this.xAxisProperties,this.yAxisProperties]},i.createClippedDataIfOverflowed=function(t,i){var a=t.hasHighlights?Math.min(t.series.data.length,2*i):Math.min(t.series.data.length,i);if(a>=t.series.data.length)return t;var r=e.Prototype.inherit(t);return r.series=e.Prototype.inherit(t.series),r.series.data=r.series.data.slice(0,a),r},i.hasDataPoint=function(e){return e&&e.data&&e.data.length>0},i.prototype.lookupXValue=function(e,i){var a=this.data,r=t.AxisHelper.isDateTime(i);if(r)return new Date(e);if(a&&a.series){var n=a.series.data;if(n){var o=n[e];if(o)return o.categoryValue}}return e},i.prototype.overrideXScale=function(e){this.xAxisProperties=e},i.prototype.render=function(a){var r=this;if(this.clippedData){var n=this.clippedData,o=n.series.data,s=n.hasHighlights,l=this.margin,u=this.currentViewport,c=u.width-(l.left+l.right),d=u.height-(l.top+l.bottom),p=this.xAxisProperties.scale,h=this.yAxisProperties.scale,g=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),f=g/2,m=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),y=!!this.interactivityService&&this.interactivityService.hasSelection();this.mainGraphicsContext.attr("width",c).attr("height",d);var v=this.mainGraphicsContext.selectAll(i.DotClassSelector).data(o,(function(e){return e.identity.getKey()}));v.enter().append("circle").classed(i.DotClassName,!0),v.style({fill:m.value}).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,y,s)})).classed("null-value",(function(e){return null===e.value})).attr({r:function(e){return f},cx:function(e){return p(e.categoryIndex)+f},cy:function(e){return h(e.value)}}),v.exit().remove();var w=this.mainGraphicsContext.selectAll(i.DotLabelClassSelector).data(o,(function(e){return e.identity.getKey()}));w.enter().append("text").classed(i.DotLabelClassName,!0).attr({"text-anchor":i.DotLabelTextAnchor,dy:i.DotLabelVerticalOffset}),w.classed("null-value",(function(e){return null===e.value})).classed("overflowed",!1).attr({x:function(e){return p(e.categoryIndex)+f},y:function(e){return h(e.value)}}).text((function(e){return r.yAxisProperties.formatter.format(e.value)}));var b=!1;w.each((function(){if(!b&&!$("<div>").addClass($(this).attr("class")).hasClass("null-value")){var t=e.TextMeasurementService.measureSvgTextElementWidth(this);t>g&&(w.classed("overflowed",!0),b=!0)}})),w.exit().remove();var C=void 0;return this.interactivityService&&(C={dots:v,dotLabels:w,datapoints:o}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:o,behaviorOptions:C,labelDataPoints:[],labelsAreNumeric:!0}}},i.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},i.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},i.prototype.createLegendDataPoints=function(a){var r=this.data;if(!r)return null;var n,o=r.series,s=o.data,l=[],u=this.xAxisProperties?this.xAxisProperties.axisType:e.ValueType.fromDescriptor({text:!0});if(r.series&&r.series.data){var c=r.series.data[0];n=c&&this.lookupXValue(c.categoryValue,u)}if(o.yCol){var d=i.formatStringProp,p=s[a],h=p&&p.value,g=t.converterHelper.getFormattedLegendLabel(o.yCol,this.dataViewCategorical.values,d),f=this.cartesianVisualHost.getSharedColors().getNewColorScale().getColor(i.DotColorKey),m=this.dataViewCategorical.values,y=m&&m.length>a?t.SelectionId.createWithIdAndMeasure(m[a].identity,m[a].source.queryName):t.SelectionId.createWithMeasure(m.source.queryName);l.push({color:f.value,icon:t.LegendIcon.Line,label:g,category:t.valueFormatter.format(n,t.valueFormatter.getFormatString(o.xCol,d)),measure:t.valueFormatter.format(h,t.valueFormatter.getFormatString(o.yCol,d)),identity:y,selected:!1})}return{dataPoints:l}},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.converter=function(e,i,a){var r=e.categorical,n=r.categories&&r.categories.length>0?r.categories[0]:{source:void 0,values:[i],identity:void 0},o=t.AxisHelper.getCategoryValueType(n.source),s=t.AxisHelper.isDateTime(o),l=n.values;if(!_.isEmpty(r.values)){for(var u=r.values[0],c=!!u.highlights,d=[],p=0,h=u.values.length;p<h;p++){var g=new t.SelectionIdBuilder;n.identity&&(g=g.withCategory(n,p));var f=g.withMeasure(u.source.queryName).createSelectionId(),m=l[p];if((!s||null==m||m instanceof Date)&&(d.push({categoryValue:s&&m?m.getTime():m,value:u.values[p],categoryIndex:p,seriesIndex:0,selected:!1,identity:f,highlight:!1}),c)){var y=t.SelectionId.createWithHighlight(f),v=u.highlights[p];d.push({categoryValue:s&&m?m.getTime():m,value:v,categoryIndex:p,seriesIndex:0,selected:!1,identity:y,highlight:!0})}}return a&&a.applySelectionStateToData(d),{series:{xCol:n.source,yCol:u.source,data:d},hasHighlights:c,hasDynamicSeries:!0}}return{series:{data:[]},hasHighlights:!1,hasDynamicSeries:!1}},i.formatStringProp={objectName:"general",propertyName:"formatString"},i.ClassName="dataDotChart",i.DotClassName="dot",i.DotClassSelector=".dot",i.DotColorKey="dataDot",i.DotLabelClassName="label",i.DotLabelClassSelector=".label",i.DotLabelVerticalOffset="0.4em",i.DotLabelTextAnchor="middle",i})();t.DataDotChart=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.CssConstants.createClassAndSelector,r=a.PixelConverter,n=t.NewDataLabelUtils,o=(function(){function a(e){this.labelPositionObjects=[t.labelPosition.outsideEnd,t.labelPosition.insideCenter],e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.axisControlImprovements=e.axisControlImprovements,e.funnelSmallViewPortProperties&&(this.funnelSmallViewPortProperties=e.funnelSmallViewPortProperties),e.animator&&(this.animator=e.animator),e.behavior&&(this.behavior=e.behavior))}return a.converter=function(i,r,n,o,s){void 0===s&&(s=!0);for(var l=e.data.createIDataViewCategoricalReader(i),u=[],c=t.funnelChartProps.general.formatString,d=i.categorical,p=l.hasHighlights("Y"),h=[],g=0,f=l.getSeriesCount("Y");g<f;g++)h.push(l.getValueMetadataColumn("Y",g));var m,y,v,w,b=!1,C=!1,S=!1,x=[],P=this.getDefaultLabelSettings(),D=this.getDefaultPercentLabelSettings(),T=this.getDefaultCategoryLabelSettings(),V=new t.ColorHelper(r,t.funnelChartProps.dataPoint.fill,o),L=t.GradientUtils.getGradientValueColumn(d);if(i&&i.metadata&&i.metadata.objects){var M=i.metadata.objects.labels;M&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(M,P);var N=i.metadata.objects.percentBarLabel;N&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(N,D);var I=i.metadata.objects.categoryAxis;I&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(I,T)}if(!l.hasValues("Y"))return{dataPoints:u,categoryLabels:x,valuesMetadata:h,hasHighlights:p,highlightsOverflow:b,canShowDataLabels:!0,dataLabelsSettings:P,hasNegativeValues:C,allValuesAreNegative:S,percentBarLabelSettings:D,categoryAxisSettings:T,categoryCount:0};m=l.getValue("Y",0,0),p&&(y=l.getHighlight("Y",0,0));var A=t.valueFormatter.getLocalizedString("Percentage");if(l.hasCategories())for(var O=0,R=l.getCategoryCount();O<R;O++){var E=l.getCategoryColumn("Category"),F=l.getCategoryValue("Category",O),j=l.getValueMetadataColumn("Y"),H=t.SelectionIdBuilder.builder().withCategory(E,O).withMeasure(j.queryName).createSelectionId(),G=l.getValue("Y",O),k=t.converterHelper.formatFromMetadataColumn(F,E.source,c),z=void 0;if(s){z=[],z.push({displayName:E.source.displayName,value:k}),null!=G&&z.push({displayName:j.displayName,value:t.converterHelper.formatFromMetadataColumn(G,j,c)});var U=void 0;p&&(U=l.getHighlight("Y",O),null!=U&&z.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(U,j,c)}));var B=L?L.source:void 0;B&&B!==j&&null!=L.values[O]&&z.push({displayName:B.displayName,value:t.converterHelper.formatFromMetadataColumn(l.getValue("Gradient",O),B,c)}),p?a.addFunnelPercentsToTooltip(A,z,n,y?U/y:null,w?U/w:null,!0):a.addFunnelPercentsToTooltip(A,z,n,m?G/m:null,v?G/v:null),t.TooltipBuilder.addTooltipMeasures(l,z,O)}var W=V.getColorForMeasure(l.getCategoryObjects("Category",O),"");if(u.push({label:k,value:G,originalValue:G,categoryOrMeasureIndex:O,identity:H,selected:!1,key:H.getKey(),tooltipInfo:z,color:W,labelFill:P.labelColor}),p){var q=t.SelectionId.createWithHighlight(H),U=l.getHighlight("Y",O);u.push({label:k,value:G,originalValue:G,categoryOrMeasureIndex:O,identity:q,selected:!1,key:q.getKey(),highlight:!0,highlightValue:U,originalHighlightValue:U,tooltipInfo:z,color:W}),w=U}v=G}else for(var O=0,g=0,f=l.getSeriesCount("Y");g<f;g++){var G=l.getValue("Y",O,g),j=l.getValueMetadataColumn("Y",g),H=t.SelectionId.createWithMeasure(j.queryName),z=void 0,W=V.getColorForMeasure(j.objects,"");if(s){if(z=[],null!=G&&z.push({displayName:j.displayName,value:t.converterHelper.formatFromMetadataColumn(G,j,c)}),p){var U=l.getHighlight("Y",O,g);null!=U&&z.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(U,j,c)}),a.addFunnelPercentsToTooltip(A,z,n,y?U/y:null,w?U/w:null,!0)}else a.addFunnelPercentsToTooltip(A,z,n,m?G/m:null,v?G/v:null);t.TooltipBuilder.addTooltipMeasures(l,z,O)}if(u.push({label:j.displayName,value:G,originalValue:G,categoryOrMeasureIndex:g,identity:H,selected:!1,key:H.getKey(),tooltipInfo:z,color:W,labelFill:P.labelColor}),p){var q=t.SelectionId.createWithHighlight(H),K=l.getHighlight("Y",O,g);u.push({label:j.displayName,value:G,originalValue:G,categoryOrMeasureIndex:g,identity:q,key:q.getKey(),selected:!1,highlight:!0,originalHighlightValue:K,highlightValue:K,tooltipInfo:z,color:W}),w=K}v=G}for(var Q=0;Q<u.length;Q+=p?2:1){var Y=u[Q];x.push(Y.label)}S=u.length>0&&_.every(u,(function(e){return(!e.highlight||e.highlightValue<=0)&&e.value<0}));for(var J=0,X=u;J<X.length;J++){var Y=X[J];if(S)Y.value=Math.abs(Y.value),Y.highlight&&(Y.highlightValue=Math.abs(Y.highlightValue));else{var G=Y.value,$=G<0;$&&(Y.value=0);var Z=!1;if(Y.highlight){var U=Y.highlightValue;Z=U<0,Y.highlightValue=Z?0:U}C||(C=$||Z)}e.Double.greaterWithPrecision(Y.highlightValue,Y.value)&&(b=!0)}return{dataPoints:u,categoryLabels:x,valuesMetadata:h,hasHighlights:p,highlightsOverflow:b,canShowDataLabels:!0,dataLabelsSettings:P,hasNegativeValues:C,allValuesAreNegative:S,percentBarLabelSettings:D,categoryAxisSettings:T,categoryCount:x.length}},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"dataPoint":var r=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,n=t.GradientUtils.hasGradientRole(r);n||this.enumerateDataPoints(i);break;case"labels":var o=a.getLabelSettingsOptions(i,this.data.dataLabelsSettings,!0,this.labelPositionObjects);t.dataLabelUtils.enumerateDataLabels(o);break;case"percentBarLabel":var s=a.getLabelSettingsOptions(i,this.data.percentBarLabelSettings,!1);t.dataLabelUtils.enumerateDataLabels(s);break;case"categoryAxis":var l=a.getLabelSettingsOptions(i,this.data.categoryAxisSettings,!0);t.dataLabelUtils.enumerateDataLabels(l)}return i.complete()},a.getLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:i,precision:i,position:i,positionObject:a,fontSize:!0}},a.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.dataPoints;e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:this.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}});for(var r=0;r<a.length;r++){var n=a[r];if(!n.highlight){var o=n.color,s=n.identity.getSelector(),l=!!s.data;e.pushInstance({objectName:"dataPoint",displayName:n.label,selector:t.ColorHelper.normalizeSelector(s,l),properties:{fill:{solid:{color:o}}}})}}}},a.prototype.init=function(i){this.options=i;var r=i.element,o=this.svg=d3.select(r.get(0)).append("svg").classed(a.VisualClassName,!0);this.tooltipService=t.createTooltipService(i.host),this.behavior&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.currentViewport=i.viewport,this.margin=e.Prototype.inherit(a.DefaultMargin);var s=i.style;this.colors=s.colorPalette.dataColors,this.hostServices=i.host,this.behavior&&(this.interactivityService=t.createInteractivityService(this.hostServices)),this.percentGraphicsContext=o.append("g").classed(a.Selectors.percentBar.root.class,!0),this.funnelGraphicsContext=o.append("g"),this.axisGraphicsContext=o.append("g"),this.labelGraphicsContext=o.append("g").classed(n.labelGraphicsContextClass.class,!0),this.updateViewportProperties()},a.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},a.prototype.update=function(i){this.data={dataPoints:[],categoryLabels:[],valuesMetadata:[],hasHighlights:!1,highlightsOverflow:!1,canShowDataLabels:!0,dataLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(),hasNegativeValues:!1,allValuesAreNegative:!1,percentBarLabelSettings:t.dataLabelUtils.getDefaultLabelSettings(!0),categoryAxisSettings:t.dataLabelUtils.getDefaultLabelSettings(!0),categoryCount:0};var r=this.dataViews=i.dataViews;if(this.currentViewport=i.viewport,r&&r.length>0){var n=r[0];if(n.metadata&&n.metadata.objects){var o=e.DataViewObjects.getFillColor(n.metadata.objects,t.funnelChartProps.dataPoint.defaultColor);o&&(this.defaultDataPointColor=o)}n.categorical&&(this.data=a.converter(n,this.colors,this.hostServices,this.defaultDataPointColor,this.tooltipsEnabled),this.interactivityService&&this.interactivityService.applySelectionStateToData(this.data.dataPoints));var s=t.getInvalidValueWarnings(r,!1,!1,!1);this.data.allValuesAreNegative?s.push(new t.AllNegativeValuesWarning):this.data.hasNegativeValues&&s.push(new t.NegativeValuesNotSupportedWarning),this.hostServices.setWarnings(s)}this.updateViewportProperties(),this.updateInternal(i.suppressAnimations)},a.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},a.prototype.onResizing=function(e){this.currentViewport=e,this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:this.currentViewport})},a.prototype.getMaxLabelLength=function(t,i){for(var r=0,n=e.TextMeasurementService.measureSvgTextWidth,o=0,s=t.length;o<s;o++)i.text=t[o],r=Math.max(r,n(i));return r+a.LabelFunnelPadding},a.prototype.updateInternal=function(e){if(null!=this.data){var i=this.data,r=i.dataPoints,o=r.filter((function(e){return!e.highlight})),s=this.isHidingPercentBars(),l=this.setUpAxis(),u=l.margin,c=this.funnelGraphicsContext.attr("transform",t.SVGUtil.translate(u.left,u.top)),d=this.labelGraphicsContext.attr("transform",t.SVGUtil.translate(u.left,u.top));this.percentGraphicsContext.attr("transform",t.SVGUtil.translate(u.left,u.top)),this.svg.style("font-family",t.dataLabelUtils.StandardFontFamily);var p,h,g=a.getLayout(i,l),f=this.getLabels(g);if(this.animator&&!e){var m={viewModel:i,interactivityService:this.interactivityService,layout:g,axisGraphicsContext:this.axisGraphicsContext,shapeGraphicsContext:c,percentGraphicsContext:this.percentGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,axisOptions:l,dataPointsWithoutHighlights:o,labelLayout:f,isHidingPercentBars:s,visualInitOptions:this.options};p=this.animator.animate(m),h=p.shapes}if((!this.animator||e||p.failed)&&(a.drawDefaultAxis(this.axisGraphicsContext,l,s),h=a.drawDefaultShapes(i,r,c,g,this.interactivityService&&this.interactivityService.hasSelection()),a.drawPercentBars(i,this.percentGraphicsContext,g,s),n.drawDefaultLabels(d,f,!1)),this.interactivityService){var y=a.drawInteractorShapes(r,c,g),v={bars:h,interactors:y,clearCatcher:this.clearCatcher,hasHighlights:i.hasHighlights};this.interactivityService.bind(r,this.behavior,v),this.tooltipsEnabled&&this.tooltipService.addTooltip(y,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}))}this.tooltipsEnabled&&this.tooltipService.addTooltip(h,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity})),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},a.prototype.getUsableVerticalSpace=function(){var e=this.margin,t=this.currentViewport.height-(e.top+e.bottom);return t-a.MinBarThickness*this.data.categoryCount},a.prototype.isHidingPercentBars=function(){var e=this.data;if(e.percentBarLabelSettings.show){var t=this.getPercentBarTextHeight(),i=this.getUsableVerticalSpace()-2*a.MinBarThickness*a.PercentBarToBarRatio-2*t;return i<=0}return!0},a.prototype.isSparklines=function(){return this.getUsableVerticalSpace()<=0},a.prototype.setUpAxis=function(){var t=this.data,i=t.dataPoints,r=t.categoryLabels,n=this.currentViewport,o=e.Prototype.inherit(a.DefaultMargin),s=this.isSparklines(),l=this.isHidingPercentBars(),u=l?0:this.getPercentBarTextHeight(),c=n.height-(o.top+o.bottom)-2*u,d=a.MaxMarginFactor,p=t.categoryAxisSettings.labelColor;if(r.length>0&&s)r=[],t.canShowDataLabels=!1;else if(this.showCategoryLabels()){var h=a.getTextProperties(),g=this.getMaxLabelLength(r,h),f=n.width*d,m=Math.min(g,f);o.left=m+a.YAxisPadding}else r=[];var y=n.width-(o.left+o.right),v=a.BarToSpaceRatio,w=d3.max(i.map((function(e){return e.value})));if(t.hasHighlights){var b=d3.max(i.map((function(e){return e.highlightValue})));w=d3.max([w,b])}var C,S=0,x=0,P=c;C=l?c-t.categoryCount*a.MaxBarHeight:c-t.categoryCount*a.MaxBarHeight-2*a.MaxBarHeight*a.PercentBarToBarRatio,t.categoryCount>0&&C>0&&(x=Math.ceil(C/2),P=Math.ceil(c-C/2)),l||(x+=u,P+=u);var D=d3.scale.linear().domain([S,w]).range([y,0]),T=d3.scale.ordinal().domain(d3.range(0,t.categoryCount)).rangeBands([x,P],v,l?v:a.PercentBarToBarRatio);return{margin:o,valueScale:D,categoryScale:T,maxScore:w,maxWidth:y,rangeStart:x,rangeEnd:P,barToSpaceRatio:v,categoryLabels:r,labelColor:p}},a.prototype.getPercentBarTextHeight=function(){var t=a.getTextProperties(this.data.percentBarLabelSettings.fontSize);return e.TextMeasurementService.estimateSvgTextHeight(t)},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.getLayout=function(i,n){var o=i.highlightsOverflow,s=n.categoryScale,l=n.valueScale,u=n.maxScore,c=s.rangeBand(),d=Math.ceil(c/2),p=c*a.OverflowingHighlightWidthRatio,h=p/2,g=i.categoryCount-1,f=Math.abs(l(u)-l(0)),m=function(e){return(f-Math.abs(l(e)-l(0)))/2},y=function(e){return Math.max(a.MinimumInteractorSize,Math.abs(l(e)-l(0)))},v=r.fromPoint(i.percentBarLabelSettings.fontSize),w=a.getTextProperties(i.percentBarLabelSettings.fontSize),b=e.TextMeasurementService.estimateSvgTextBaselineDelta(w),C=e.TextMeasurementService.estimateSvgTextHeight(w)-b;return{percentBarLayout:{mainLine:{x2:function(e){return Math.abs(l(e.value)-l(0))},transform:function(e){var i=l(e.value)-m(e.value),a=e.isTop?s(0)-d:s(g)+c+d;return t.SVGUtil.translate(i,a)}},leftTick:{y2:function(e){return d},transform:function(e){var i=l(e.value)-m(e.value),a=e.isTop?s(0)-d-d/2:s(g)+c+d-d/2;return t.SVGUtil.translate(i,a)}},rightTick:{y2:function(e){return d},transform:function(e){var i=l(e.value)-m(e.value),a=Math.abs(l(e.value)-l(0)),r=i+a,n=e.isTop?s(0)-d-d/2:s(g)+c+d-d/2;return t.SVGUtil.translate(r,n)}},text:{x:function(e){return Math.ceil(Math.abs(l(u)-l(0))/2)},y:function(e){return e.isTop?-d/2-b:C+d/2},style:function(){return"font-size: "+v+";"},transform:function(e){var i=e.isTop?s(0)-d:s(g)+c+d;return t.SVGUtil.translate(0,i)},fill:i.percentBarLabelSettings.labelColor,maxWidth:f}},shapeLayout:{height:function(e){return e.highlight&&o?p:c},width:function(e){return Math.abs(l(a.getValueFromDataPoint(e))-l(0))},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&o?h:0)},x:function(e){var t=a.getValueFromDataPoint(e);return l(t)-m(t)}},shapeLayoutWithoutHighlights:{height:function(e){return c},width:function(e){return Math.abs(l(e.value)-l(0))},y:function(e){return s(e.categoryOrMeasureIndex)+0},x:function(e){return l(e.value)-m(e.value)}},zeroShapeLayout:{height:function(e){return e.highlight&&o?p:c},width:function(e){return 0},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&o?h:0)},x:function(e){return l((l.domain()[0]+l.domain()[1])/2)}},interactorLayout:{height:function(e){return e.highlight&&o?p:c},width:function(e){return y(a.getValueFromDataPoint(e))},y:function(e){return s(e.categoryOrMeasureIndex)+(e.highlight&&o?h:0)},x:function(e){var t=y(a.getValueFromDataPoint(e));return(f-t)/2}}}},a.drawDefaultAxis=function(i,r,n){var o=d3.range(0,r.categoryLabels.length),s=d3.scale.ordinal().domain(o).rangeBands([r.rangeStart,r.rangeEnd],r.barToSpaceRatio,n?r.barToSpaceRatio:a.PercentBarToBarRatio),l=d3.svg.axis().scale(s).orient("right").tickPadding(a.TickPadding).innerTickSize(a.InnerTickSize).ticks(o.length).tickValues(o).tickFormat((function(e){return r.categoryLabels[e]}));i.attr("class","axis hideLinesOnAxis").attr("transform",t.SVGUtil.translate(0,r.margin.top)).call(l),i.selectAll(".tick").call(t.tooltipUtils.tooltipUpdate,r.categoryLabels);var u=r.margin.left-a.LabelFunnelPadding;i.selectAll(".tick text").call(t.AxisHelper.LabelLayoutStrategy.clip,u,e.TextMeasurementService.svgEllipsis).style("fill",r.labelColor?r.labelColor:null)},a.drawDefaultShapes=function(e,i,r,n,o){var s=e.hasHighlights,l=r.selectAll(a.Selectors.funnel.bars.selector).data(i,(function(e){return e.key}));return l.enter().append("rect").attr("class",(function(e){return e.highlight?a.FunnelBarHighlightClass:a.Selectors.funnel.bars.class})),l.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,e.highlight,o,s)})).attr(n.shapeLayout),l.exit().remove(),l},a.getValueFromDataPoint=function(e,t){return void 0===t&&(t=!1),t?e.highlight?e.originalHighlightValue:e.originalValue:e.highlight?e.highlightValue:e.value},a.drawInteractorShapes=function(e,t,i){var r=e.filter((function(e){return!e.highlight&&i.interactorLayout.width(e)===a.MinimumInteractorSize})),n=t.selectAll(a.Selectors.funnel.interactors.selector).data(r,(function(e){return e.key}));return n.enter().append("rect").attr("class",a.Selectors.funnel.interactors.class),n.style("fill-opacity",0).attr(i.interactorLayout),n.exit().remove(),n},a.drawPercentBarComponents=function(i,r,n,o){var s=i.selectAll(a.Selectors.percentBar.mainLine.selector).data(r);s.exit().remove(),s.enter().append("line").classed(a.Selectors.percentBar.mainLine.class,!0),s.attr(n.percentBarLayout.mainLine);var l=i.selectAll(a.Selectors.percentBar.leftTick.selector).data(r);l.exit().remove(),l.enter().append("line").classed(a.Selectors.percentBar.leftTick.class,!0),l.attr(n.percentBarLayout.leftTick);var u=i.selectAll(a.Selectors.percentBar.rightTick.selector).data(r);u.exit().remove(),u.enter().append("line").classed(a.Selectors.percentBar.rightTick.class,!0),u.attr(n.percentBarLayout.rightTick);var c=i.selectAll(a.Selectors.percentBar.text.selector).data(r),d=t.valueFormatter.getLocalizedString("Percentage1");c.exit().remove(),c.enter().append("text").classed(a.Selectors.percentBar.text.class,!0),c.attr(n.percentBarLayout.text).text((function(e){return t.dataLabelUtils.getLabelFormattedText({label:e.percent,format:d,fontSize:o.fontSize,maxWidth:n.percentBarLayout.text.maxWidth})})).append("title").text((function(t){return e.formattingService.formatValue(t.percent,d)}))},a.drawPercentBars=function(e,t,i,r){if(r||!e.dataPoints||e.categoryCount<2)return void a.drawPercentBarComponents(t,[],i,e.percentBarLabelSettings);var n=[e.dataPoints[e.hasHighlights?1:0],e.dataPoints[e.dataPoints.length-1]],o=a.getValueFromDataPoint(n[0]);if(o<=0)return void a.drawPercentBarComponents(t,[],i,e.percentBarLabelSettings);var s=[{value:a.getValueFromDataPoint(n[0]),percent:1,isTop:!0},{value:a.getValueFromDataPoint(n[1]),percent:a.getValueFromDataPoint(n[1])/o,isTop:!1}];a.drawPercentBarComponents(t,s,i,e.percentBarLabelSettings)},a.prototype.showCategoryLabels=function(){return!(this.funnelSmallViewPortProperties&&this.funnelSmallViewPortProperties.hideFunnelCategoryLabelsOnSmallViewPort&&this.currentViewport.height<this.funnelSmallViewPortProperties.minHeightFunnelCategoryLabelsVisible)&&(this.data&&this.data.categoryAxisSettings&&this.data.categoryAxisSettings.show)},a.addFunnelPercentsToTooltip=function(e,i,a,r,n,o){null!=r&&i.push({displayName:a.getLocalizedString("Funnel_PercentOfFirst"+(o?"_Highlight":"")),value:t.valueFormatter.format(r,e)}),null!=n&&i.push({displayName:a.getLocalizedString("Funnel_PercentOfPrevious"+(o?"_Highlight":"")),value:t.valueFormatter.format(n,e)})},a.getTextProperties=function(e){return{fontSize:r.fromPoint(e||t.dataLabelUtils.DefaultFontSizeInPt),fontFamily:a.DefaultFontFamily}},a.getDefaultLabelSettings=function(){return{show:!0,position:e.visuals.labelPosition.insideCenter,displayUnits:0,labelColor:null,fontSize:n.DefaultLabelFontSizeInPt}},a.getDefaultPercentLabelSettings=function(){return{show:!0,position:0,displayUnits:0,labelColor:n.defaultLabelColor,fontSize:n.DefaultLabelFontSizeInPt}},a.getDefaultCategoryLabelSettings=function(){return{show:!0,labelColor:n.defaultLabelColor}},a.prototype.getLabels=function(t){var i=[];if(this.data.dataLabelsSettings.show&&this.data.canShowDataLabels){var a=this.createLabelDataPoints(t.shapeLayout,this.data.dataLabelsSettings),r=new e.LabelLayout({maximumOffset:n.maxLabelOffset,startingOffset:n.startingLabelOffset}),o={labelDataPoints:a,maxNumberOfLabels:a.length},s={width:this.currentViewport.width-this.margin.left,height:this.currentViewport.height-this.margin.top};i=r.layout([o],s)}return i},a.prototype.createLabelDataPoints=function(i,o){var s=this.data,l=s.dataPoints;if(_.isEmpty(l))return[];var u=new Array,c=l[0],d=a.LabelInsidePosition,p=i.height(c);o.position&&o.position===t.labelPosition.outsideEnd&&(d=a.LabelOutsidePosition);var h=null;0===o.displayUnits&&(h=s.dataPoints.reduce((function(e,t){return Math.abs(e.value)>Math.abs(t.value)?e:t})).value);for(var g=t.valueFormatter.getFormatString(s.valuesMetadata[0],t.funnelChartProps.general.formatString),f=n.createColumnFormatterCacheManager(),m=o.fontSize,y={fontFamily:n.LabelTextProperties.fontFamily,fontSize:r.fromPoint(m||n.DefaultLabelFontSizeInPt),fontWeight:n.LabelTextProperties.fontWeight},v=c.labelFill||n.defaultLabelColor,w=c.labelFill||n.defaultInsideLabelColor,b=0,C=l;b<C.length;b++){
var S=C[b],x=a.getValueFromDataPoint(S,!0);if(null!=x&&(!s.hasHighlights||S.highlight)){var P=null!=g?g:c.labelFormatString,D=f.getOrCreate(P,o,h),T=D.format(x);y.text=T;var V=e.TextMeasurementService.measureSvgTextWidth(y),L=e.TextMeasurementService.estimateSvgTextHeight(y),M=1,N={rect:{left:i.x(S),top:i.y(S),width:i.width(S),height:p},orientation:a.LabelOrientation,validPositions:d},I={isPreferred:!0,text:T,textSize:{width:V,height:L},fontSize:m,parentType:M,parentShape:N,insideFill:w,outsideFill:v,identity:S.identity,hasBackground:!1};0===S.value&&(N={validPositions:[256],point:{x:i.x(S),y:i.y(S)+p/2}},M=0,I.parentShape=N,I.parentType=M,I.insideFill=I.outsideFill),u.push(I)}}return u},a.LabelInsidePosition=[1,16],a.LabelOutsidePosition=[16,4],a.LabelOrientation=3,a.DefaultBarOpacity=1,a.DimmedBarOpacity=.4,a.PercentBarToBarRatio=.75,a.TickPadding=0,a.InnerTickSize=0,a.MinimumInteractorSize=15,a.InnerTextClassName="labelSeries",a.Selectors={funnel:{bars:i("funnelBar"),highlights:i("highlight"),interactors:i("funnelBarInteractor")},percentBar:{root:i("percentBars"),mainLine:i("mainLine"),leftTick:i("leftTick"),rightTick:i("rightTick"),text:i("value")}},a.FunnelBarHighlightClass=[a.Selectors.funnel.bars.class,a.Selectors.funnel.highlights.class].join(" "),a.YAxisPadding=10,a.VisualClassName="funnelChart",a.DefaultFontFamily=t.Font.Family.regularSecondary.css,a.BarToSpaceRatio=.1,a.MaxBarHeight=40,a.MinBarThickness=12,a.LabelFunnelPadding=6,a.OverflowingHighlightWidthRatio=.5,a.MaxMarginFactor=.25,a.DefaultMargin={left:5,right:5,top:0,bottom:0},a})();t.FunnelChart=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.CssConstants.createClassAndSelector,r=a.PixelConverter,n=e.data.DataRoleHelper,o=(function(){function a(e){this.lastAngle=-Math.PI/2,e&&(e.gaugeSmallViewPortProperties&&(this.gaugeSmallViewPortProperties=e.gaugeSmallViewPortProperties),this.animator=e.animator,this.tooltipsEnabled=e.tooltipsEnabled)}return a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"axis":this.enumerateAxis(i);break;case"labels":var a=this.data?this.data.minLabel.settings:t.dataLabelUtils.getDefaultGaugeLabelSettings();t.dataLabelUtils.enumerateDataLabels(this.getDataLabelSettingsOptions(i,a));break;case"calloutValue":var a=this.data?this.data.calloutLabel.settings:t.dataLabelUtils.getDefaultGaugeLabelSettings();t.dataLabelUtils.enumerateDataLabels(this.getDataLabelSettingsOptions(i,a));break;case"dataPoint":this.enumerateDataPoint(i)}return i.complete()},a.prototype.getDataLabelSettingsOptions=function(e,t){return{dataLabelsSettings:t,show:!0,precision:!0,displayUnits:!0,fontSize:!0,enumeration:e}},a.prototype.enumerateAxis=function(e){var t=this.dataView;if(t&&t.metadata){var i=a.getGaugeObjectsProperties(t);e.pushInstance({selector:null,objectName:"axis",properties:i})}},a.prototype.enumerateDataPoint=function(e){var i=this.data?this.data.dataPointSettings:a.DefaultDataPointSettings,r={};r.fill={solid:{color:i.fillColor}},null!=i.targetColor&&(r.target={solid:{color:i.targetColor}}),e.pushInstance({selector:null,objectName:t.gaugeProps.dataPoint.target.objectName,properties:r})},a.getGaugeObjectsProperties=function(e){var i={},a=e.metadata.objects,r=!!a&&!!a.axis;return n.hasRoleInDataView(e,t.gaugeRoleNames.minValue)||(i.min=r?a.axis.min:void 0),n.hasRoleInDataView(e,t.gaugeRoleNames.maxValue)||(i.max=r?a.axis.max:void 0),n.hasRoleInDataView(e,t.gaugeRoleNames.targetValue)||(i.target=r?a.axis.target:void 0),i},a.prototype.init=function(e){this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.options=e,this.settings=a.DefaultStyleProperties,this.tooltipService=t.createTooltipService(e.host),this.setMargins(),this.color=d3.scale.ordinal().range(this.style.colorPalette.dataColors.getSentimentColors().map((function(e){return e.value}))),this.hostService=e.host;var i=this.svg=d3.select(this.element.get(0)).append("svg");i.classed(a.VisualClassName,!0);var r=this.mainGraphicsContext=i.append("g");r.attr("class",a.MainGaugeGroupClassName),this.initKpiBands();var n=this.backgroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2).endAngle(Math.PI/2),o=this.foregroundArc=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(-Math.PI/2);this.backgroundArcPath=r.append("path").classed("backgroundArc",!0).attr("d",n),this.foregroundArcPath=r.append("path").datum({endAngle:-Math.PI/2}).classed("foregroundArc",!0).attr("d",o);var s=this.animatedNumberGrapicsContext=i.append("g");this.animatedNumber=new t.AnimatedNumber(s),this.animatedNumber.init(e);var l=this.gaugeVisualProperties=this.getGaugeVisualProperties(),u=this.getAnimatedNumberProperties(l.radius,l.innerRadiusFactor,l.top,l.left);this.animatedNumberGrapicsContext.attr("transform",u.transformString),this.animatedNumber.onResizing(u.viewport)},a.prototype.update=function(i){if(this.currentViewport=i.viewport,i.dataViews&&i.dataViews[0]){var r=this.dataView=i.dataViews[0],n=e.data.createIDataViewCategoricalReader(r);if(i.type&e.VisualUpdateType.Data||!this.data){this.data=t.GaugeConverter.convert(n);var o=t.getInvalidValueWarnings([r],!1,!1,!1);this.hostService.setWarnings(o)}(i.type&e.VisualUpdateType.Resize||i.type&e.VisualUpdateType.ResizeEnd)&&(i.suppressAnimations=!0),this.dataView.single={value:this.data.calloutLabel.value},this.labels=[this.data.minLabel,this.data.maxLabel],this.showTargetLabel=this.data.target.ratio>=0&&this.data.target.ratio<=1&&(this.currentViewport.width>a.MinWidthForTargetLabel||2!==this.getLabelsPosition())&&this.showSideNumbersLabelText()&&this.data.target.label.settings.show,this.setMargins(),this.gaugeVisualProperties=this.getGaugeVisualProperties(),this.drawViewPort(this.gaugeVisualProperties),this.updateInternal(i.suppressAnimations),this.updateCalloutValue(i.suppressAnimations)}},a.prototype.updateCalloutValue=function(e){var t=this.data.calloutLabel.settings;if(this.data.calloutLabel.settings.show){var i=this.getAnimatedNumberProperties(this.gaugeVisualProperties.radius,this.gaugeVisualProperties.innerRadiusFactor,this.gaugeVisualProperties.top,this.gaugeVisualProperties.left);this.animatedNumberGrapicsContext.attr("transform",i.transformString),this.animatedNumber.setTextColor(t.labelColor);var a=this.data.calloutLabel.value,r=this.data.calloutLabel.formatter;this.animatedNumber.setFormatter(r),this.animatedNumber.update({viewport:i.viewport,dataViews:[this.dataView],suppressAnimations:e}),this.animatedNumberGrapicsContext.selectAll("title").remove(),this.animatedNumberGrapicsContext.append("title").text([r.format(a)])}else this.animatedNumber.clear(),this.animatedNumberGrapicsContext.selectAll("title").remove()},a.prototype.initKpiBands=function(){if(this.settings.kpiBands.show)for(var e=this.kpiArcs=[],t=this.kpiArcPaths=[],i=this.mainGraphicsContext,a=0;a<3;a++){var r=d3.svg.arc().innerRadius(0).outerRadius(0).startAngle(0).endAngle(0);e.push(r);var n=i.append("path").attr("d",r);t.push(n)}},a.prototype.updateKpiBands=function(e,t,i,r){if(this.settings.kpiBands.show)for(var n=0;n<r.length;n++)this.kpiArcs[n].innerRadius(e*t-(a.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness)).outerRadius(e*t-a.KpiBandDistanceFromMainArc).startAngle(r[n].start).endAngle(r[n].end),this.kpiArcPaths[n].attr("fill",r[n].fill).attr("d",this.kpiArcs[n]).attr("transform",i)},a.prototype.removeTargetElements=function(){this.targetLine&&(this.targetLine.remove(),this.targetText.remove(),this.targetConnector.remove(),this.targetLine=this.targetConnector=this.targetText=null)},a.prototype.updateTargetLine=function(e,t,i,a){this.targetLine||(this.targetLine=this.mainGraphicsContext.append("line"));var r=this.data.target.ratio*Math.PI,n=a-e*Math.sin(r),o=i-e*Math.cos(r),s=a-t*Math.sin(r),l=i-t*Math.cos(r);this.targetLine.attr({x1:l,y1:s,x2:o,y2:n})},a.prototype.getAnimatedNumberProperties=function(e,i,r,n){var o=Math.PI/4,s=1,l=e*i,u=l-(this.settings.kpiBands.show?a.KpiBandDistanceFromMainArc+this.settings.kpiBands.thickness:0),c=u*Math.cos(o),d=u*Math.sin(o),p=r-d,h=n-c;p*=s,h*=s;var g=2*c,f={transformString:t.SVGUtil.translate(h,p),viewport:{height:d,width:g}};return f},a.prototype.getGaugeVisualProperties=function(){var e=this.currentViewport,i=this.margin,r=e.width-i.right-i.left,n=r/2,o=e.height-i.top-i.bottom,s=Math.min(n,o),l=a.InnerRadiusFactor,u=i.left+n,c=s+(o-s)/2+i.top,d=t.SVGUtil.translate(u,c),p=s*l,h={radius:s,innerRadiusOfArc:p,left:u,top:c,height:o,width:r,margin:i,transformString:d,innerRadiusFactor:l};return h},a.prototype.drawViewPort=function(e){var t=this.settings.kpiBands.separationRadians,i=a.InnerRadiusFactor,r=this.backgroundArc,n=this.color,o=[{fill:n(0),start:-Math.PI/2,end:-Math.PI/2+Math.PI/4-t},{fill:n(1),start:-Math.PI/2+1*Math.PI/4+t,end:-Math.PI/2+3*Math.PI/4-t},{fill:n(2),start:-Math.PI/2+3*Math.PI/4+t,end:Math.PI/2}],s=e.radius,l=e.transformString;this.updateKpiBands(s,i,l,o),r.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2).endAngle(Math.PI/2),this.backgroundArcPath.attr("d",r).attr("transform",l);var u=this.foregroundArc;u.innerRadius(s*i).outerRadius(s).startAngle(-Math.PI/2),this.foregroundArcPath.datum({endAngle:this.lastAngle}).attr("transform",l).attr("d",u);var c=e.innerRadiusOfArc,d=e.left,p=e.top,h=e.margin,g=e.height;this.settings.targetLine.show&&$.isNumeric(this.data.target.label.value)?this.data.target.ratio<0||this.data.target.ratio>1?this.removeTargetElements():(this.updateTargetLine(s,c,d,p),this.renderTarget(s,g,e.width,h)):this.removeTargetElements(),this.svg.attr("height",this.currentViewport.height).attr("width",this.currentViewport.width)},a.prototype.updateInternal=function(e){var i=this.gaugeVisualProperties.height,a=this.gaugeVisualProperties.width,r=this.gaugeVisualProperties.radius,n=this.margin,o=t.AnimatorCommon.GetAnimationDuration(this.animator,e),s=this.data,l=this.lastAngle=-Math.PI/2+Math.PI*this.data.ratio;this.foregroundArcPath.transition().ease(this.settings.transition.ease).duration(o).call(this.arcTween,[l,this.foregroundArc]),this.renderMinMaxLabels(this.labels,r,i,a,n),this.updateVisualConfigurations(),this.updateVisualStyles(),this.tooltipsEnabled&&(this.tooltipService.addTooltip(this.foregroundArcPath,(function(e){return s.tooltipInfo}),(function(e){})),this.tooltipService.addTooltip(this.backgroundArcPath,(function(e){return s.tooltipInfo}),(function(e){})))},a.prototype.updateVisualStyles=function(){var e=this.data.minLabel.settings.labelColor||this.style.labelText.color.value;this.mainGraphicsContext.selectAll("text").style({fill:e})},a.prototype.updateVisualConfigurations=function(){var e=this.settings,t=this.data.dataPointSettings;this.mainGraphicsContext.select("line").attr({stroke:t.targetColor,"stroke-width":e.targetLine.thickness}),this.backgroundArcPath.style("fill",e.arcColors.background),this.foregroundArcPath.style("fill",t.fillColor)},a.prototype.renderMinMaxLabels=function(i,n,o,s,l){if(this.svg.selectAll(a.LabelText.selector).remove(),this.data.minLabel.settings.show)for(var u=this.data.minLabel.settings,c=i.length,d=c-1,p=this.getLabelsPosition(),h=r.fromPoint(u.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),g=this.settings.labels.padding,f=0;f<c;f++){var m=this.gaugeVisualProperties.top,y={text:i[f].text,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:r.fromPoint(u.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight};if(this.showSideNumbersLabelText()){var v=l.left+s/2-n*Math.cos(Math.PI*f/d),w=void 0,b=1===f,C=!1;2===p?(C=!0,m+=g,w=b?"end":"start",y.text=e.TextMeasurementService.getTailoredTextOrDefault(y,n)):(w=b?"start":"end",v+=g*(b?1:-1));var S=this.mainGraphicsContext.append("text").attr({x:v,y:m,dy:C?h:0,class:a.LabelText.class}).style({"text-anchor":w,"font-size":h}).text(y.text).append("title").text(y.text);C||this.truncateTextIfNeeded(S,v,b)}}},a.prototype.truncateTextIfNeeded=function(i,a,r){var n=r?this.currentViewport.width-a:a;i.call(t.AxisHelper.LabelLayoutStrategy.clip,n,e.TextMeasurementService.svgEllipsis)},a.prototype.renderTarget=function(e,i,r,n){var o=this.data.target,s=o.label.value,l=o.ratio,u=e+(i-e)/2+n.top,c=l>.5,d=this.settings.labels.padding,p=c?"start":"end",h=this.data.target.label.formatter,g=Math.asin(a.MinDistanceFromBottom/e)/Math.PI,f=l<g||l>1-g?c?1-g:g:l,m=n.left+r/2-(e+d)*Math.cos(Math.PI*f),y=u-(e+d)*Math.sin(Math.PI*f);this.targetText||(this.targetText=this.mainGraphicsContext.append("text").classed(a.TargetText.class,!0)),this.targetText.attr({x:m,y:y}).style({"text-anchor":p,display:this.showTargetLabel?"":"none","font-size":this.style.labelText.fontSize}).text(h.format(s)),this.truncateTextIfNeeded(this.targetText,m,c),this.targetText.call(t.tooltipUtils.tooltipUpdate,[h.format(s)]),this.targetConnector||(this.targetConnector=this.mainGraphicsContext.append("line").classed(a.TargetConnector.class,!0)),l===f?this.targetConnector.style("display","none"):this.targetConnector.attr({x1:n.left+r/2-e*Math.cos(Math.PI*l),y1:u-e*Math.sin(Math.PI*l),x2:m,y2:y}).style({"stroke-width":this.settings.targetLine.thickness,stroke:this.settings.targetLine.color,display:""})},a.prototype.arcTween=function(e,t){e.attrTween("d",(function(e){var i=d3.interpolate(e.endAngle,t[0]);return function(a){return e.endAngle=i(a),t[1](e)}}))},a.prototype.getLabelsPosition=function(){if(!this.data||!this.data.minLabel.settings.show)return 0;var e=this.labels[0].requiredSpace.width+this.labels[1].requiredSpace.width,t=this.labels[0].requiredSpace.height;return this.currentViewport.height-t>(this.currentViewport.width-e)/2?2:1},a.prototype.setMargins=function(){if(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.smallGaugeMarginsOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible){var e=this.gaugeSmallViewPortProperties.GaugeMarginsOnSmallViewPort;return void(this.margin={top:e,bottom:e,left:e,right:e})}var t=this.getLabelsPosition();if(this.margin={bottom:0,left:0,right:0,top:this.showTargetLabel?a.DefaultTopBottomMargin:0},2===t){if(this.margin.bottom=this.labels[0].requiredSpace.height+2*this.settings.labels.padding,this.showTargetLabel){var i=this.data.target.ratio;i>.5?this.margin.right=a.ReducedLeftRightMargin:this.margin.left=a.ReducedLeftRightMargin}}else if(1===t){var r=2*this.settings.labels.padding;this.margin.left=this.labels[0].requiredSpace.width+r,this.margin.right=this.labels[1].requiredSpace.width+r,this.margin.bottom=r}},a.prototype.showSideNumbersLabelText=function(){return!(this.gaugeSmallViewPortProperties&&this.gaugeSmallViewPortProperties.hideGaugeSideNumbersOnSmallViewPort&&this.currentViewport.height<this.gaugeSmallViewPortProperties.MinHeightGaugeSideNumbersVisible)},a.MinDistanceFromBottom=10,a.MinWidthForTargetLabel=150,a.DefaultTopBottomMargin=20,a.ReducedLeftRightMargin=15,a.VisualClassName="gauge",a.DefaultStyleProperties={transition:{ease:"cubic-in-out"},arcColors:{background:"#e9e9e9",foreground:"#00B8AA"},targetLine:{show:!0,color:"#666666",thickness:2},labels:{count:2,padding:5,fontSize:t.NewDataLabelUtils.DefaultLabelFontSizeInPt},kpiBands:{show:!1,separationRadians:Math.PI/128,thickness:5}},a.DefaultDataPointSettings={fillColor:a.DefaultStyleProperties.arcColors.foreground,targetColor:a.DefaultStyleProperties.targetLine.color},a.InnerRadiusFactor=.7,a.KpiBandDistanceFromMainArc=2,a.MainGaugeGroupClassName="mainGroup",a.LabelText=i("labelText"),a.TargetConnector=i("targetConnector"),a.TargetText=i("targetText"),a})();t.Gauge=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.Utility,i=(function(){function i(){this.scalingType=e.imageScalingType.normal}return i.prototype.init=function(e){this.element=e.element},i.prototype.enumerateObjectInstances=function(e){switch(e.objectName){case"imageScaling":return this.enumerateImageScaling()}return null},i.prototype.enumerateImageScaling=function(){return[{selector:null,objectName:"imageScaling",properties:{imageScalingType:this.scalingType}}]},i.prototype.update=function(i){var a=i.dataViews;if(a&&0!==a.length){var r=a[0].metadata.objects;if(r&&r.general){var n=this.imageBackgroundElement;n||(n=$("<div class='imageBackground' />"),this.imageBackgroundElement=n,this.imageBackgroundElement.appendTo(this.element));var o=i.viewport;n.css("height",o.height),r.imageScaling?this.scalingType=r.imageScaling.imageScalingType.toString():this.scalingType=e.imageScalingType.normal;var s=r.general.imageUrl;t.isLocalUrl(s)&&n.css("backgroundImage","url("+s+")"),this.scalingType===e.imageScalingType.fit?n.css("background-size","100% 100%"):this.scalingType===e.imageScalingType.fill?n.css("background-size","cover"):n.css("background-size","contain")}}},i})();e.ImageVisual=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,i,a){if(!i||0===i.length)return s.status.NOGOAL;var r,n;if(2===i.length){if(r=Math.max.apply(Math,i),n=Math.min.apply(Math,i),e>=n&&e<=r)return s.status.IN_BETWEEN}else r=i[0],n=i[0];switch(a){case t.kpiDirection.positive:if(e<n)return s.status.DROP;break;case t.kpiDirection.negative:if(e>r)return s.status.DROP}return s.status.INCREASE}function a(e,i,a){if(!i||1!==i.length||0===i[0])return"";var r,n="+",o=i[0];switch(r=Math.abs(e-o),a){case t.kpiDirection.positive:e<o&&(n="-");break;case t.kpiDirection.negative:e>o&&(n="-")}var s=Number((100*r/o).toFixed(2));return"("+n+s+"%)"}function r(e,t){switch(e){case s.status.NOGOAL:return t.textGrey;case s.status.INCREASE:return t.good;case s.status.IN_BETWEEN:return t.neutral;case s.status.DROP:return t.bad}}function n(e,t){switch(e){case s.status.NOGOAL:return t.graphGrey;case s.status.INCREASE:return t.good;case s.status.IN_BETWEEN:return t.neutral;case s.status.DROP:return t.bad}}var o=e.data.DataRoleHelper,s=(function(){function s(){}return s.prototype.init=function(e){s.getLocalizedString=e.host.getLocalizedString,this.rootElement=d3.select(e.element.get(0)).append("div").classed("kpiVisual",!0),this.svg=this.rootElement.append("svg");var t=this.mainGroupElement=this.svg.append("g");this.areaFill=t.append("path"),this.lastTrendAxisPointSummaryContainer=this.rootElement.append("div").classed("lastTrendAxisPointSummaryContainer",!0),this.indicatorContainer=this.lastTrendAxisPointSummaryContainer.append("div").classed("indicatorContainer",!0),this.indicatorText=this.indicatorContainer.append("div").classed("indicatorText",!0),this.indicatorIcon=this.indicatorContainer.append("div").classed("powervisuals-glyph",!0),this.goalText=this.lastTrendAxisPointSummaryContainer.append("div").classed("goalText",!0),this.host=e.host},s.prototype.update=function(e){if(e.dataViews&&e.dataViews[0]){var t=this.dataView=e.dataViews[0],i=e.viewport;if((!t.categorical||!t.categorical.values||t.categorical.values.length<1)&&(!t.categorical||!t.categorical.categories||t.categorical.categories.length<1))return this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr("visibility","visible");var a=s.converter(t,i,s.getProp_KPIDirection(t));this.render(a,i)}},s.prototype.render=function(e,t){if(this.setShowDataMissingWarning(!(e.indicatorExists&&e.trendExists)),0===e.dataPoints.length||!e.indicatorExists||!e.trendExists)return this.areaFill.attr("visibility","hidden"),this.svg.attr("visibility","hidden"),void this.lastTrendAxisPointSummaryContainer.attr("style","display:none");this.svg.attr({height:t.height,width:t.width});var o=s.status.NOGOAL;e.targetExists&&e.indicatorExists&&e.trendExists&&(o=i(e.actual,e.goals,e.directionType));var l=e.formattedValue,u=s.indicatorTextSizeInPx;this.lastTrendAxisPointSummaryContainer.attr("style","width:"+t.width+"px;top:"+(t.height-u)/2+"px");var c=r(o,e.colors);this.indicatorText.style({color:c}).text(l),this.indicatorIcon.classed("checkmark",o===s.status.INCREASE),this.indicatorIcon.classed("circle-small",o===s.status.IN_BETWEEN),this.indicatorIcon.classed("exclamation",o===s.status.DROP),this.indicatorIcon.style({color:c});var d=e.showGoal?e.formattedGoalString+" ":"",p=e.showDistanceFromGoal?a(e.actual,e.goals,e.directionType):"";if(this.goalText.text(d+p),e.showTrendLine&&e.historyExists){var h=d3.svg.area().x((function(e){return e.x})).y0(t.height).y1((function(e){return e.y})),g=n(o,e.colors);this.areaFill.attr({d:h(e.dataPoints),stroke:"none",visibility:"visible","fill-opacity":.2}).style({color:g,fill:g})}else this.areaFill.attr("visibility","hidden")},s.prototype.setShowDataMissingWarning=function(e){this.host.setWarnings(e?[new t.VisualKPIDataMissingWarning]:[])},s.getDefaultFormatSettings=function(){return{labelSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,t.Card.DefaultStyle.value.color),textSize:27,wordWrap:!1}},s.getFormatString=function(e){return t.valueFormatter.getFormatString(e,t.AnimatedText.formatStringProp)},s.getProp_Show_KPIGoal=function(t){return!t||!t.metadata||e.DataViewObjects.getValue(t.metadata.objects,s.showKPIGoal,!0)},s.getProp_Show_KPITrendLine=function(t){return!t||!t.metadata||e.DataViewObjects.getValue(t.metadata.objects,s.showKPITrendLine,!0)},s.getProp_Show_KPIDistance=function(t){return!t||!t.metadata||e.DataViewObjects.getValue(t.metadata.objects,s.showKPIDistance,!0)},s.getProp_KPIDirection=function(i){return i&&i.metadata?e.DataViewObjects.getValue(i.metadata.objects,s.directionTypeStringProp,t.kpiDirection.positive):t.kpiDirection.positive},s.getProp_GoodColor=function(t){return t&&t.metadata?e.DataViewObjects.getFillColor(t.metadata.objects,s.goodColorProp,s.kpiGreen):s.kpiGreen},s.getProp_NeutralColor=function(t){return t&&t.metadata?e.DataViewObjects.getFillColor(t.metadata.objects,s.neutralColorProp,s.kpiYellow):s.kpiYellow},s.getProp_BadColor=function(t){return t&&t.metadata?e.DataViewObjects.getFillColor(t.metadata.objects,s.badColorProp,s.kpiRed):s.kpiRed},s.getProp_Indicator_DisplayUnits=function(t){return s.initDefaultLabelSettings(),t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.indicatorDisplayUnitsProp,s.defaultLabelSettings.displayUnits):s.defaultLabelSettings.displayUnits},s.getProp_Indicator_Precision=function(t){return s.initDefaultLabelSettings(),t&&t.metadata?e.DataViewObjects.getValue(t.metadata.objects,s.indicatorPrecisionProp,s.defaultLabelSettings.precision):s.defaultLabelSettings.precision},s.initDefaultLabelSettings=function(){s.defaultCardFormatSetting||(s.defaultCardFormatSetting=s.getDefaultFormatSettings(),s.defaultLabelSettings=s.defaultCardFormatSetting.labelSettings)},s.getFormattedValue=function(i,a,r,n,o){void 0===o&&(o=e.DisplayUnitSystemType.WholeUnits);var l=0===n,u=t.valueFormatter.create({format:s.getFormatString(i),value:n,precision:r,displayUnitSystemType:o,formatSingleValues:!!l,allowFormatBeautification:!0,columnType:i?i.type:void 0});return u.format(a)},s.getFormattedGoalString=function(e,t,i,a){if(!t||0===t.length)return"";var r=s.getLocalizedString("Visual_KPI_Goal_Title")+": "+s.getFormattedValue(e,t[0],i,a);return 2===t.length&&(r+=", "+s.getFormattedValue(e,t[1],i,a)),r},s.converter=function(i,a,r){var n=[],l=i.categorical,u=null,c=null,d="",p="",h=!1,g=!1,f=!1,m=!0;i.categorical.categories||(m=!1);for(var y=l.values,v=i.metadata.columns,w=0,b=v;w<b.length;w++){var C=b[w];o.hasRole(C,"Indicator")&&(g=!0,u=C),o.hasRole(C,"TrendLine")&&(f=!0),o.hasRole(C,"Goal")&&(h=!0,c=C)}if(!(g&&f&&y&&0!==y.length&&y[0].values&&i.categorical.values))return{dataPoints:n,directionType:r,actual:0,goals:[],formattedGoalString:d,targetExists:h,historyExists:m,indicatorExists:g,trendExists:f,formattedValue:p,showGoal:!1,showDistanceFromGoal:!1,showTrendLine:!1,colors:{good:s.kpiGreen,neutral:s.kpiYellow,bad:s.kpiRed,graphGrey:s.kpiGraphGrey,textGrey:s.kpiTextGrey}};var S,x;m&&(S=l.categories[0],x=S.values);for(var P,D=[],T=[],V=s.getColumnsByRole(y,"Indicator"),_=s.getColumnsByRole(y,"Goal"),L=0,M=y[0].values.length;L<M;L++){P=V[0].values[L];for(var N=[],I=0;I<_.length;I++)N.push(_[I].values[L]);T.push(N),D.push(P)}for(var A=Math.max.apply(Math,D),O=Math.min.apply(Math,D),R=a.height*s.trendAreaFilePercentage,E=s.getProp_Indicator_Precision(i),F=s.getProp_Indicator_DisplayUnits(i),L=0;L<D.length;L++){var j=R*(D[L]-O)/(A-O),H=null;m&&(H=t.SelectionId.createWithId(S.identity[L]).getSelector()),n.push({x:L*a.width/(D.length-1),y:a.height-j,actual:D[L],goals:T[L]})}var G,k;n.length>0&&(G=n[n.length-1].actual,k=n[n.length-1].goals),1===n.length&&(m=!1),p=s.getFormattedValue(u,G,E,F,e.DisplayUnitSystemType.DataLabels),d=s.getFormattedGoalString(c,k,E,F);var z=s.getProp_Show_KPIGoal(i),U=s.getProp_Show_KPIDistance(i),B=s.getProp_Show_KPITrendLine(i),W={good:s.getProp_GoodColor(i),neutral:s.getProp_NeutralColor(i),bad:s.getProp_BadColor(i),graphGrey:s.kpiGraphGrey,textGrey:s.kpiTextGrey};return{dataPoints:n,directionType:r,actual:G,goals:k,formattedGoalString:d,targetExists:h,historyExists:m,indicatorExists:g,trendExists:f,formattedValue:p,showGoal:z,showDistanceFromGoal:U,showTrendLine:B,colors:W}},s.getColumnsByRole=function(e,t){for(var i=[],a=0;a<e.length;a++)o.hasRole(e[a].source,t)&&i.push(e[a]);return i},s.prototype.enumerateObjectInstances=function(e){var t=[],i=this.dataView;switch(e.objectName){case"indicator":t.push({selector:null,objectName:"indicator",properties:{indicatorDisplayUnits:s.getProp_Indicator_DisplayUnits(i),indicatorPrecision:s.getProp_Indicator_Precision(i)}});case"trendline":t.push({selector:null,objectName:"trendline",properties:{show:s.getProp_Show_KPITrendLine(i)}});case"goals":t.push({selector:null,objectName:"goals",properties:{showGoal:s.getProp_Show_KPIGoal(i),showDistance:s.getProp_Show_KPIDistance(i)}});case"status":t.push({selector:null,objectName:"status",properties:{direction:s.getProp_KPIDirection(i),goodColor:s.getProp_GoodColor(i),neutralColor:s.getProp_NeutralColor(i),badColor:s.getProp_BadColor(i)}})}return t},s.prototype.destroy=function(){this.svg=null},s.directionTypeStringProp={objectName:"status",propertyName:"direction"},s.goodColorProp={objectName:"status",propertyName:"goodColor"},s.neutralColorProp={objectName:"status",propertyName:"neutralColor"},s.badColorProp={objectName:"status",propertyName:"badColor"},s.showKPIGoal={objectName:"goals",propertyName:"showGoal"},s.showKPIDistance={objectName:"goals",propertyName:"showDistance"},s.showKPITrendLine={objectName:"trendline",propertyName:"show"},s.indicatorDisplayUnitsProp={objectName:"indicator",propertyName:"indicatorDisplayUnits"},s.indicatorPrecisionProp={objectName:"indicator",propertyName:"indicatorPrecision"},s.status={INCREASE:"increase",DROP:"drop",IN_BETWEEN:"in-between",NOGOAL:"no-goal"},s.statusBandingType={Below:"BELOW",Above:"ABOVE"},s.actualTextConsts={VERTICAL_OFFSET_FROM_HALF_HEIGHT:20,FONT_WIDTH_FACTOR:14,RIGHT_MARGIN:10},s.kpiRed="#E81123",s.kpiGreen="#3bb44a",s.kpiYellow="#F2C811",s.kpiTextGrey="#212121",s.kpiGraphGrey="#5F6B6D",s.trendAreaFilePercentage=1,s.estimatedIconHeightInPx=9,s.indicatorTextSizeInPx=60,s})();t.KPIStatusWithHistory=s})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.EnumExtensions,r=a.CssConstants.createClassAndSelector,n=a.PixelConverter,o=e.data.CompiledDataViewMapping,s=(function(){function s(e){var t=this;this.pathXAdjustment=0,this.deferDragMoveOperation=a.DeferUtility.deferUntilNextFrame((function(){if(t.lastDragMoveXPosition){var e=t.findIndex(t.lastDragMoveXPosition-t.margin.left);t.selectColumn(e),t.lastDragMoveXPosition=void 0}})),this.isScrollable=!!e.isScrollable&&e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.lineType=e.chartType?e.chartType:1,this.interactivityService=e.interactivityService,this.animator=e.animator,this.lineClassAndSelector=s.LineClassSelector}return s.hasScalarKey=function(e){var t=!1;return o.visitCategoricalCategories(e,{visitRole:function(e){t=t||_.any(e.items,(function(e){return e.hasScalarKey}))}}),t},s.customizeQuery=function(e){var i=e.dataViewMappings[0];if(i&&i.categorical&&i.categorical.categories){i.categorical.dataVolume=4;var a=i.categorical.categories,r=!1;if(s.canUseScalarKey(i)){r=s.hasScalarKey(a);var n=_.find(e.dataViewMappings,(function(e){return e.usage&&e.usage.forecast}));o.visitCategoricalCategories(a,{visitRole:function(e){for(var i=e.items,a=function(e,a){var r=i[e];if(r.hasScalarKey)return r.scalarKeyMinProperty=t.cartesianChartProps.scalarKey.scalarKeyMin,n&&o.visitCategoricalCategories(n.categorical.categories,{visitRole:function(i){i.items[e].scalarKeyMinProperty=t.cartesianChartProps.scalarKey.scalarKeyMin}}),"break"},r=0,s=_.size(i);r<s;r++){var l=a(r,s);if("break"===l)break}}})}if(t.CartesianChart.detectScalarMapping(i)||r){a.dataReductionAlgorithm={sample:{}};var l=i.categorical.values;l&&l.group&&(l.group.dataReductionAlgorithm={top:{}})}else{_.remove(e.dataViewMappings,(function(e){return e.usage&&e.usage.forecast}));var u=[i];t.CartesianChart.expandCategoryWindow(u);var c=t.ColumnChart.getSortableRoles(e);t.CartesianChart.applyHierarchicalSorts(u,c)}t.CartesianChart.requestFilteredToUniqueValue(e.dataViewMappings)}},s.canUseScalarKey=function(i){var a=e.DataViewObjects.getValue(i.metadata.objects,t.lineChartProps.categoryAxis.axisType);return a!==t.axisType.categorical},s.getSortableRoles=function(i){var a=i.dataViewMappings[0];if(!a||!a.categorical||!a.categorical.categories)return null;var r=a.categorical.categories,n=r.for.in,o=n.items,l=n.activeItems,u=["Category","Y"],c=[];if(!_.isEmpty(o)){var d=void 0;if(a.metadata&&(d=a.metadata.objects),s.hasScalarKey(r)&&t.CartesianChart.getIsScalar(d,t.lineChartProps.categoryAxis.axisType,e.ValueType.fromExtendedType(260)))return c;var p=void 0;if(_.isEmpty(l))p=o[0].type;else if(1===l.length){var h=_.find(o,(function(e){return e.queryName===l[0]}));p=h.type}else if(l.length>1)return u;return t.CartesianChart.getIsScalar(d,t.lineChartProps.categoryAxis.axisType,p)?c:u}return null},s.convertCategoryValue=function(e,t,i){return(t||i)&&e?e.getTime():e},s.converter=function(i,a,r,n,o,l,u,c,d){void 0===c&&(c=!0);var p=t.CartesianHelper.getCategoryAxisProperties(i.metadata);n=t.CartesianHelper.isScalar(n,p);var h,g,f=e.data.createIDataViewCategoricalReader(i),m=u?"Y2":"Y",y=i.categorical,v=!1;if(n){var w=_.first(y.categories);g=t.CartesianChart.getScalarKeys(w),v=n&&g&&!_.isEmpty(g.values),h=v?w:_.last(y.categories)}else h=_.isEmpty(y.categories)?{source:void 0,values:[a],identity:void 0}:_.last(y.categories);var b;v&&(b={displayName:null,type:{dateTime:!0}}),y=t.ColumnUtil.applyUserMinMax(n,y,p);var C,S=t.lineChartProps.general.formatString,x=t.AxisHelper.getCategoryValueType(h.source,n),P=t.AxisHelper.isDateTime(x),D=h.values,T=[],V=[],L=[],M=f.hasCategories()?f.getCategoryCount():1,N=f.getSeriesCount(m),I=y.values,A=!(!I||!I.source),O=t.dataLabelUtils.getDefaultLineChartLabelSettings(u);if(i.metadata&&i.metadata.objects){var R=i.metadata.objects;C=u?void 0:e.DataViewObjects.getFillColor(R,t.lineChartProps.dataPoint.defaultColor);var E=R.labels;t.NewDataLabelUtils.updateLabelSettingsFromLabelsObjectWithLabelDensity(E,O)}var F,j=new t.ColorHelper(r,t.lineChartProps.dataPoint.fill,C);I&&(F=I.grouped());var H;if(l&&(H=I&&I.length>0?_.times(I[0].values.length,(function(){return 0})):[]),f.hasValues(m))for(var G=0;G<N;G++){var k=f.getValueColumn(m,G),z=k.source,U=[],B=F[G],W=t.SelectionIdBuilder.builder().withSeries(I,k).withMeasure(f.getValueMetadataColumn(m,G).queryName).createSelectionId(),q=W.getKey(),K=this.getColor(j,A,I,F,G,B),Q=void 0;
if(!A){var Y=F&&F.length>0&&F[0].values?F[0].values[G]:null,J=Y&&Y.source&&Y.source.objects?Y.source.objects.labels:null;J&&(Q=e.Prototype.inherit(O),t.NewDataLabelUtils.updateLabelSettingsFromLabelsObjectWithLabelDensity(J,Q))}for(var X=Q?Q:O,$=k.highlights&&k.highlights.length>0,Z=-1,ee=0;ee<M;ee++){var te=D[ee],ie=v?g.values[ee].min:te,ae=t.AxisHelper.normalizeNonFiniteNumber($?f.getHighlight(m,ee,G):f.getValue(m,ee,G));if(!(n&&(null==ie||null==ae)||P&&null!=te&&!(te instanceof Date)||(Z++,null==ae&&G>0))){var re=void 0,ne=void 0,oe=void 0;if(c){if(re=[],h.source){oe=t.CategoryLevelUtils.getCategoryLevels(i.categorical.categories,ee,S);var se=t.CategoryLevelUtils.concatenateCategoryLevels(oe);re.push({displayName:se.displayName,value:se.value})}A&&(h.source&&h.source===I.source||re.push({displayName:I.source.displayName,value:t.converterHelper.formatFromMetadataColumn(F[G].name,I.source,S)})),null!=ae&&re.push({displayName:z.displayName,value:t.converterHelper.formatFromMetadataColumn(ae,z,S)}),ne=[],t.TooltipBuilder.addTooltipMeasures(f,ne,ee,A?G:void 0),ne=_.isEmpty(ne)?void 0:ne}var le=new t.SelectionIdBuilder;f.hasCategories()&&(le=le.withCategory(f.getCategoryColumn("Category"),ee)),A&&(le=le.withSeries(I,f.getValueColumn(m,G)));var ue=le.withMeasure(f.getValueMetadataColumn(m,G).queryName).createSelectionId(),ce=h&&!_.isEmpty(h.identity)&&h.identity[ee]?h.identity[ee].key:ee,de={categoryValue:s.convertCategoryValue(ie,P,v),value:ae,categoryIndex:ee,seriesIndex:G,tooltipInfo:re,selected:!1,identity:W,specificIdentity:ue,key:JSON.stringify({series:q,category:ce}),labelFill:X.labelColor,labelFormatString:z.format,labelSettings:X,additionalTooltipItems:ne,hierarchyCategoryLevels:oe};if(l&&(H[ee]+=ae,de.stackedValue=H[ee]),h.objects&&h.objects[ee]&&(de.pointColor=e.DataViewObjects.getFillColor(h.objects[ee],t.lineChartProps.dataPoint.fill)),U[Z]=de,T[ee]||(T[ee]=de),!V[ee]&&f.hasCategories()){var pe=new t.SelectionIdBuilder;V[ee]=pe.withCategory(f.getCategoryColumn("Category"),ee).withMeasure(f.getValueMetadataColumn(m,G).queryName).createSelectionId()}}}o&&o.applySelectionStateToData(_.filter(U,(function(e){return null!=e}))),U.length>0&&L.push({displayName:t.converterHelper.formatFromMetadataColumn(f.getValueDisplayName(m,G),f.getValueMetadataColumn(m,G),S),dynamicDisplayName:A?t.converterHelper.formatFromMetadataColumn(f.getSeriesName(G),f.getSeriesMetadataColumn(),S):void 0,key:q,lineIndex:G,color:K,xCol:v?b:h.source,yCol:f.getValueMetadataColumn(m,G),data:U,identity:W,selected:!1,labelSettings:Q})}var he;if(d&&n&&!l&&!u){he=t.ForecastHelper.readDataView(d,i,r);for(var ge=_.last(T),fe=0,me=he;fe<me.length;fe++)for(var ye=me[fe],ee=ge.categoryIndex,ve=0,we=ye.points;ve<we.length;ve++){var be=we[ve];be.point.x=s.convertCategoryValue(be.point.x,P,v),be.upperBound.x=s.convertCategoryValue(be.upperBound.x,P,v),be.lowerBound.x=s.convertCategoryValue(be.lowerBound.x,P,v);var Ce=be.point.x;Ce<=ge.categoryValue||(ee++,T[ee]||(T[ee]={categoryIndex:ee,categoryValue:Ce,value:be.point.y,seriesIndex:0}),V[ee]||(V[ee]=null))}}p=t.CartesianHelper.getCategoryAxisProperties(i.metadata);var Se=t.CartesianHelper.getValueAxisProperties(i.metadata),xe=f.getMetadataColumns(m),Pe=t.converterHelper.createAxesLabels(p,Se,h.source,xe);return o&&o.applySelectionStateToData(L),{series:L,forecastLines:he,isScalar:n,dataLabelsSettings:O,axesLabels:{x:Pe.xAxisLabel,y:Pe.yAxisLabel},hasDynamicSeries:A,categoryMetadata:h.source,scalarMetadata:b,scalarKeyCount:v?g.values.length:void 0,categories:D,categoryData:T,seriesDisplayName:A&&f.hasValues(m)?t.converterHelper.formatFromMetadataColumn(f.getSeriesDisplayName(),f.getSeriesMetadataColumn(),S):void 0,hasValues:f.hasValues(m),categoryIdentities:V}},s.getInteractiveLineChartDomElement=function(e){return e.children("svg").get(0)},s.getColor=function(e,t,i,a,r,n){var o;return t?a&&a[r]&&(o=a[r].objects):i[r]&&(o=i[r].source.objects),t&&n?e.getColorForSeriesValue(o,i.identityFields,n.name):e.getColorForMeasure(o,i[r].source.queryName)},s.createStackedValueDomain=function(e){if(0===e.length)return null;var t=d3.min(e,(function(e){return d3.min(e.data,(function(e){return e&&e.stackedValue}))})),i=d3.max(e,(function(e){return d3.max(e.data,(function(e){return e&&e.stackedValue}))}));return[t,i]},s.prototype.init=function(e){var i=this;this.options=e,this.element=e.element,this.cartesainSVG=e.svg,this.host=e.host,this.currentViewport=e.viewport,this.colors=e.style.colorPalette.dataColors,this.isInteractiveChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.cartesianVisualHost=e.cartesianHost,this.scaleDetector=new t.SVGScaleDetector(this.cartesainSVG),this.tooltipService=e.services.tooltips;var r=e.chartType;this.isComboChart=10===r||13===r||14===r;var n=e.svg;n.classed(s.ClassName,!0);var o=this.mainGraphicsSVG=n.append("svg").classed("lineChartSVG",!0);this.isComboChart||this.isInteractiveChart||(this.overlayRect=o.append(s.RectOverlayName).classed("tooltip-overlay",!0).style("opacity",t.SVGUtil.AlmostZero)),this.mainGraphicsContext=o.append("g").classed(s.MainGraphicsContextClassName,!0),this.hoverLineContext=n.append("g").classed("hover-line",!0),this.hoverLineContext.append(s.LineElementName).attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0);var l=this.hoverLine=this.hoverLineContext.select(s.LineElementName);if(this.isInteractiveChart&&l.classed("interactive",!0),l.style("opacity",t.SVGUtil.AlmostZero),this.selectionCircles=[],this.xAxisProperties={axis:null,scale:null,axisType:null,formatter:null,graphicsContext:null,values:null,axisLabel:null,isCategoryAxis:!0},this.isInteractiveChart){var u=s.getInteractiveLineChartDomElement(this.element),c=function(){i.lastDragMoveXPosition=d3.mouse(u)[0],i.deferDragMoveOperation()},d=d3.behavior.drag().origin(Object).on("drag",c);d3.select(u).style("touch-action","none").call(d).on("click",c)}a.BrowserUtils.isInternetExplorerOrEdge()?this.pathXAdjustment=5:a.BrowserUtils.isFirefox()&&(this.pathXAdjustment=2*s.interactivityStrokeWidth)},s.prototype.setData=function(e){if(this.data={series:[],dataLabelsSettings:t.dataLabelUtils.getDefaultLineChartLabelSettings(this.isComboChart),axesLabels:{x:null,y:null},hasDynamicSeries:!1,categories:[],categoryMetadata:void 0,categoryData:[],categoryIdentities:[]},e.length>0){var a=e[0],r=_.find(e,(function(e){return t.ForecastHelper.isDataViewForForecast(e)}));if(a&&a.categorical){var n=this.dataViewCat=a.categorical,o=n.categories,l={text:!0},u=void 0;o&&!_.isEmpty(o)&&(o[0].source&&o[0].source.type&&(l=o[0].source.type),u=t.CartesianChart.getScalarKeys(o[0]));var c=t.CartesianChart.hasCategoryHierarchy(a),d=t.CartesianChart.getIsScalar(a.metadata?a.metadata.objects:null,t.lineChartProps.categoryAxis.axisType,l,u,c),p=s.converter(a,t.valueFormatter.format(null),this.cartesianVisualHost.getSharedColors(),d,this.interactivityService,i.hasFlag(this.lineType,16),this.isComboChart,this.tooltipsEnabled,r);this.data=p;var h=this.previousCategoryIds,g=p.categoryIdentities;if(null!=h&&!(h.length>t.AnimatorCommon.MaxDataPointsToAnimate||g.length>t.AnimatorCommon.MaxDataPointsToAnimate)){this.suppressAnimation=!1;for(var f=0,m=Math.min(h.length,g.length);f<m;f++)if(!t.SelectionId.isEqual(h[f],g[f])){this.suppressAnimation=!0;break}}this.previousCategoryIds=g}}},s.prototype.calculateLegend=function(){return this.createLegendDataPoints(0)},s.prototype.hasLegend=function(){return this.data&&(this.data.hasDynamicSeries||this.data.series&&this.data.series.length>1)},s.prototype.setFilteredData=function(t,i){var a=i-t,r=this.clippedData=e.Prototype.inherit(this.data);return r.series=s.sliceSeries(r.series,a,t),r.categories=r.categories.slice(t,i),r},s.prototype.ensureDomainsIncludeForecast=function(e,t,i){if(_.isEmpty(e))return{x:t,y:i};for(var a=[t.min,t.max],r=[i.min,i.max],n=0,o=e;n<o.length;n++){var s=o[n];_.isEmpty(s.points)||(a.push.apply(a,_.map(s.points,(function(e){return e.point.x}))),r.push.apply(r,_.map(s.points,(function(e){return e.point.y}))),a.push.apply(a,_.map(s.points,(function(e){return e.upperBound.x}))),r.push.apply(r,_.map(s.points,(function(e){return e.upperBound.y}))),a.push.apply(a,_.map(s.points,(function(e){return e.lowerBound.x}))),r.push.apply(r,_.map(s.points,(function(e){return e.lowerBound.y}))))}var l={min:d3.min(a),max:d3.max(a)},u={min:d3.min(r),max:d3.max(r)};return{x:l,y:u}},s.prototype.calculateAxesProperties=function(a){var r=this,n=this.data,o=a.viewport,l=a.margin;this.currentViewport=o,this.margin=l;var u=n.series&&n.series.length>0?n.series[0].data.length:0,c=t.CartesianChart.MinOrdinalRectThickness,d=this.data.isScalar,p=a.trimOrdinalDataOnOverflow,h=this.getPreferredPlotArea(d,u,c);if(this.clippedData=void 0,n&&!d&&!this.isScrollable&&p){var g=this.getCategoryCount(u),f=Math.min(u,g);f!==u&&(n=this.clippedData=e.Prototype.inherit(n),this.clippedData.series=s.sliceSeries(n.series,f))}var m,y;n.series&&n.series.length>0&&(m=n.series[0].xCol,y=n.series[0].yCol);var v=this.ensureDomainsIncludeForecast(n.forecastLines,a.ensureXDomain,a.ensureYDomain),w=v.x,b=v.y,C=i.hasFlag(this.lineType,16)?s.createStackedValueDomain(n.series):t.AxisHelper.createValueDomain(n.series,!1),S=a.valueAxisScaleType===t.axisScale.log&&!t.AxisHelper.isLogScalePossible(C),x=t.AxisHelper.combineDomain(a.forcedYDomain,C,b);this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:h.height,dataDomain:x,zeroScalarDomain:[-1,1],metaDataColumn:y,formatString:t.valueFormatter.getFormatString(y,t.lineChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:a.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:a.valueAxisScaleType,axisDisplayUnits:a.valueAxisDisplayUnits,axisPrecision:a.valueAxisPrecision,shouldClamp:!1,margin:l});var P=n.scalarMetadata?n.scalarMetadata:n.categoryMetadata,D=t.AxisHelper.getCategoryValueType(P),T=t.AxisHelper.createDomain(n.series,D,this.data.isScalar,a.forcedXDomain,w),V=a.categoryAxisScaleType===t.axisScale.log&&!t.AxisHelper.isLogScalePossible(T);return this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:h.width,dataDomain:T,zeroScalarDomain:[-1,1],metaDataColumn:m,formatString:t.valueFormatter.getFormatString(m,t.lineChartProps.general.formatString),outerPadding:this.data.isScalar?s.ScalarOuterPadding:0,isScalar:this.data.isScalar,isVertical:!1,forcedTickCount:a.forcedTickCount,maxTickCount:n.scalarKeyCount,useTickIntervalForDisplayUnits:!0,getValueFn:function(e,i){return t.CartesianHelper.lookupXValue(r.data,e,i,r.data.isScalar)},categoryThickness:t.CartesianChart.getCategoryThickness(n.series,u,this.getAvailableWidth(),T,d,p),isCategoryAxis:!0,scaleType:a.categoryAxisScaleType,axisDisplayUnits:a.categoryAxisDisplayUnits,axisPrecision:a.categoryAxisPrecision,margin:l}),this.xAxisProperties.axisLabel=a.showCategoryAxisLabel?n.axesLabels.x:null,this.yAxisProperties.axisLabel=a.showValueAxisLabel?n.axesLabels.y:null,this.xAxisProperties.hasDisallowedZeroInDomain=V,this.yAxisProperties.hasDisallowedZeroInDomain=S,[this.xAxisProperties,this.yAxisProperties]},s.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"dataPoint":this.enumerateDataPoints(e);break;case"labels":this.enumerateDataLabels(e);break;case t.ForecastHelper.forecastObjectName:this.supportsForecast()&&t.ForecastHelper.enumerateObjectInstances(e,this.data.forecastLines)}},s.prototype.enumerateDataPoints=function(e){var i=this.data;if(i&&i.series&&0!==i.series.length)for(var a=t.lineChartProps.general.formatString,r=i.series,n=r.length,o=0;o<n;o++){var s=t.ColorHelper.normalizeSelector(r[o].identity.getSelector()),l=t.converterHelper.getFormattedLegendLabel(r[o].yCol,this.dataViewCat.values,a);e.pushInstance({objectName:"dataPoint",displayName:l,selector:s,properties:{fill:{solid:{color:i.defaultSeriesColor||r[o].color}}}})}},s.prototype.enumerateDataLabels=function(e){var i=this.data,a=this.data.dataLabelsSettings,r=i.series.length,n=this.showLabelPerSeries();if(t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,a,null,n)),0!==r&&n&&a.showLabelPerSeries)for(var o=0;o<r;o++){var s=i.series[o],l=s.labelSettings?s.labelSettings:this.data.dataLabelsSettings;e.pushContainer({displayName:s.displayName}),t.dataLabelUtils.enumerateDataLabels(this.getLabelSettingsOptions(e,l,s)),e.popContainer()}},s.prototype.supportsTrendLine=function(){var e=!!this.data&&this.data.isScalar;return!i.hasFlag(this.lineType,16)&&e&&this.data.hasValues},s.prototype.supportsForecast=function(){var e=!!this.data&&this.data.isScalar;return!i.hasFlag(this.lineType,16)&&e&&this.data.hasValues&&1===this.data.series.length&&!this.hasLegend()},s.prototype.isStacked=function(){return i.hasFlag(this.lineType,16)},s.prototype.shouldSuppressAnimation=function(){return!!this.suppressAnimation},s.prototype.showLabelPerSeries=function(){var e=this.data;return!e.hasDynamicSeries&&(e.series.length>1||!e.categoryMetadata)},s.prototype.getLabelSettingsOptions=function(e,t,i,a){return{enumeration:e,dataLabelsSettings:t,show:!0,displayUnits:!0,precision:!0,selector:i&&i.identity?i.identity.getSelector():null,showAll:a,fontSize:!0,labelDensity:(!this.isComboChart||this.data.series.length>0)&&this.data.isScalar}},s.prototype.overrideXScale=function(e){this.xAxisProperties=e},s.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},s.prototype.render=function(e){var i=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.suppressAnimation&&(i=0),this.previousCategoryCount=this.data.categoryData.length;var a,r=this.buildViewModel(i),n={hoverLine:this.hoverLine,hoverLineContext:this.hoverLineContext,mainGraphicsContext:this.mainGraphicsContext,mainGraphicsSVG:this.mainGraphicsSVG,overlayRect:this.overlayRect};if(this.isInteractiveChart){var o=$.extend(n,{dragHandle:this.dragHandle,selectionCircles:this.selectionCircles});a=s.renderOld(r,o,this.interactivityService,this,this,this.isInteractiveChart),o.dragHandle&&(this.dragHandle=o.dragHandle)}else a=s.renderNew(r,n,this.interactivityService,this,this.tooltipService,this);return t.ForecastHelper.render(this.data.forecastLines,n.mainGraphicsSVG,r.xAxisProperties.scale,r.yAxisProperties.scale,r.currentViewport,r.animationDuration),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),a},s.prototype.buildViewModel=function(e){return{currentViewport:this.currentViewport,data:this.clippedData?this.clippedData:this.data,animationDuration:e,horizontalOffset:this.getXOfFirstCategory(),isComboChart:this.isComboChart,lineClassAndSelector:this.lineClassAndSelector,lineType:this.lineType,margin:this.margin,scale:this.scaleDetector.getScale(),tooltipsEnabled:this.tooltipsEnabled,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties}},s.renderNew=function(e,a,r,n,o,l){var u=e.data;if(u){var c=e.animationDuration,d=u.categories.length*u.series.length;d>t.AnimatorCommon.MaxDataPointsToAnimate&&(c=0);var p,h,g=i.hasFlag(e.lineType,16),f=e.margin,m=e.currentViewport,y=m.height-(f.top+f.bottom),v=m.width-(f.left+f.right),w=e.xAxisProperties.scale,b=e.yAxisProperties.scale,C=e.horizontalOffset,S=u.isScalar,x=r&&r.hasSelection(),P=i.hasFlag(e.lineType,2)||i.hasFlag(e.lineType,16),D=function(e){return w(s.getXValue(e,S))+C};g?(p=function(e){return b(e.stackedValue-e.value)},h=function(e){return b(e.stackedValue)}):(p=b(0),h=function(e){return b(e.value)});var T;P&&(T=d3.svg.area().x(D).y0(p).y1(h).defined((function(e){return e&&null!==e.value})));var V=d3.svg.line().x(D).y(h).defined((function(e){return e&&null!==e.value}));i.hasFlag(e.lineType,4)&&(V.interpolate("basis"),T&&T.interpolate("basis")),a.mainGraphicsSVG.attr("height",y).attr("width",v);var L=void 0;P&&(L=a.mainGraphicsContext.selectAll(s.CategoryAreaSelector.selector).data(u.series,(function(e){return e.identity.getKey()})),L.enter().append(s.PathElementName).classed(s.CategoryAreaSelector.class,!0),L.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return x&&!e.selected?s.DimmedAreaFillOpacity:s.AreaFillOpacity})).transition().ease("linear").duration(c).attr("d",(function(e){return T(e.data)})),L.exit().remove());var M=a.mainGraphicsContext.selectAll(e.lineClassAndSelector.selector).data(u.series,(function(e){return e.identity.getKey()}));M.enter().append(s.PathElementName).classed(e.lineClassAndSelector.class,!0),M.style("stroke",(function(e){return e.color})).style("stroke-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,x,!1)})).transition().ease("linear").duration(c).attr("d",(function(e){return V(e.data)})),M.exit().remove();var N=a.mainGraphicsContext.selectAll(".interactivity-line").data(u.series,(function(e){return e.identity.getKey()}));N.enter().append(s.PathElementName).classed("interactivity-line",!0).style("stroke-width",s.interactivityStrokeWidth),N.attr("d",(function(e){if(!S){var t=s.getFirstPathPointFromSeriesData(e);if(t){var i=_.find(e.data,(function(e){return e&&null!=e.value}));if(i&&i.categoryIndex!==t.categoryIndex){var a=e.data.slice(t.categoryIndex-i.categoryIndex);return V(a)}}}return V(e.data)})),N.exit().remove();var I=a.mainGraphicsContext.selectAll(s.CategorySelector.selector).data(u.series,(function(e){return e.identity.getKey()}));I.enter().append("g").classed(s.CategorySelector.class,!0),I.exit().remove();var A=I.selectAll(s.CategoryValuePoint.selector).data((function(e){return e.data.filter((function(t,i){return s.shouldDrawCircle(e,i)}))}),(function(e){return e.key}));A.enter().append(s.CircleElementName).classed(s.CategoryValuePoint.class,!0),A.style("fill",(function(){var e=d3.select(this.parentNode).datum();return e.color})).style("fill-opacity",(function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,x,!1)})).transition().duration(c).attr({cx:function(e,t){return w(s.getXValue(e,S))+C},cy:function(e,t){return b(g?e.stackedValue:e.value)},r:s.CircleRadius}),A.exit().remove();var O;!e.isComboChart&&S&&(O=I.selectAll(s.CategoryPointSelector.selector).data((function(e){return _.filter(e.data,(function(e){return e&&null!=e.pointColor}))}),(function(e){return e.key})),O.enter().append(s.CircleElementName).classed(s.CategoryPointSelector.class,!0),O.style("fill",(function(e){return e.pointColor})).transition().duration(c).attr({cx:function(e){return w(s.getXValue(e,S))},cy:function(e){return b(g?e.stackedValue:e.value)},r:s.PointRadius}),O.exit().remove());var R;if(u.dataLabelsSettings.show&&(R=s.createLabelDataPoints(e)),e.tooltipsEnabled)if(e.isComboChart){var E=function(e){var t=e.elementCoordinates[0];return n.getTooltipInfoForCombo(e,t)};N&&o.addTooltip(N,E,(function(e){return e.data.identity}),!0),o.addTooltip(A,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}),!0),O&&o.addTooltip(O,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}),!0)}else{a.overlayRect.attr({x:0,width:v,height:y});var E=function(e){var t=e.elementCoordinates[0],i=n.getCategoryIndexFromTooltipEvent(e,t),a=l.getHoverLineDataForCategory(i);return s.getSeriesTooltipInfo(a)};o.addTooltip(a.mainGraphicsSVG,E,(function(e){return s.getIdentityForTooltipEvent(e.data)}),!0),a.mainGraphicsSVG.on("mouseout",(function(){return l.clearHoverLine()}))}var F=void 0,j=void 0;if(r){F=u.series.slice();for(var H=0,G=u.series.length;H<G;H++)for(var k=0,z=u.series[H].data;k<z.length;k++){var U=z[k];null!=U&&F.push(U)}j={lines:M,interactivityLines:N,dots:A,areas:L,tooltipOverlay:a.overlayRect,getCategoryIndex:function(e,t){return n.getCategoryIndexFromSeriesAndPointX(e,t)},categoryIdentities:u.categoryIdentities}}return{dataPoints:F,behaviorOptions:j,labelDataPoints:[],labelsAreNumeric:!0,labelDataPointGroups:R}}},s.renderOld=function(e,a,r,n,o,l){var u=e.data;if(u){var c,d=e.margin,p=e.currentViewport,h=p.height-(d.top+d.bottom),g=e.xAxisProperties.scale,f=e.yAxisProperties.scale,m=u.isScalar,y=p.width-(d.left+d.right),v=p.height-(d.top+d.bottom),w=r&&r.hasSelection();i.hasFlag(e.lineType,2)&&(c=d3.svg.area().x((function(e){return g(s.getXValue(e,m))})).y0(h).y1((function(e){return f(e.value)})).defined((function(e){return null!==e.value})));var b=d3.svg.line().x((function(e){return g(s.getXValue(e,m))})).y((function(e){return f(e.value)})).defined((function(e){return!!e&&null!==e.value}));i.hasFlag(e.lineType,4)&&(b.interpolate("basis"),c&&c.interpolate("basis"));var C=e.horizontalOffset;if(a.mainGraphicsContext.attr("transform",t.SVGUtil.translate(C,0)),a.mainGraphicsSVG.attr("height",v).attr("width",y),a.hoverLineContext.attr("transform",t.SVGUtil.translate(C,0)),i.hasFlag(e.lineType,2)){var S=a.mainGraphicsContext.selectAll(s.CategoryAreaSelector.selector).data(u.series,(function(e){return e.identity.getKey()})),x=S.enter().append("g").classed(s.CategoryAreaSelector.class,!0);x.append(s.PathElementName);var P=a.mainGraphicsContext.selectAll(s.CategoryAreaSelector.selector);P.select(s.PathElementName).transition().ease("linear").duration(e.animationDuration).attr("d",(function(e){return c(e.data)})).style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return w&&!e.selected?s.DimmedAreaFillOpacity:s.AreaFillOpacity})),S.exit().remove()}var D=a.mainGraphicsContext.selectAll(s.CategorySelector.selector).data(u.series,(function(e){return e.identity.getKey()})),T=D.enter().append("g").classed(s.CategorySelector.class,!0);if(T.append(s.PathElementName),T.selectAll(s.CategoryValuePoint.selector).data((function(e){return e.data})).enter().append(s.CircleElementName).classed(s.CategoryValuePoint.class,!0),D.exit().remove(),l&&!a.dragHandle){var V=v;a.dragHandle=a.hoverLineContext.append("circle").attr("cx",0).attr("cy",V).attr("r","6px").classed("drag-handle",!0)}for(var _=D.data().length;a.selectionCircles.length<_;){var L=a.hoverLineContext.append(s.CircleElementName).classed(s.CircleClassName,!0).attr("r",s.CircleRadius).style("opacity",0);a.selectionCircles.push(L)}for(;a.selectionCircles.length>_;)a.selectionCircles.pop().remove();var M=a.mainGraphicsContext.selectAll(s.CategorySelector.selector),N=M.select(s.PathElementName).classed(e.lineClassAndSelector.class,!0).style("stroke",(function(e){return e.color})).style("stroke-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,w,!1)}));N.transition().ease("linear").duration(e.animationDuration).attr("d",(function(e){return b(e.data)}));var I=this,A=M.selectAll(s.CategoryValuePoint.selector),O=A.style("fill",(function(){var e=d3.select(this.parentNode).datum();return e.color})).style("fill-opacity",(function(){var e=d3.select(this.parentNode).datum();return t.ColumnUtil.getFillOpacity(e.selected,!1,w,!1)})).transition().duration(e.animationDuration).attr({cx:function(e,t){var i=d3.select(this.parentNode).datum(),a=I.shouldDrawCircle(i,t);return a?g(I.getXValue(e,m)):0},cy:function(e,t){var i=d3.select(this.parentNode).datum(),a=I.shouldDrawCircle(i,t);return a?f(e.value):0},r:function(e,t){var i=d3.select(this.parentNode).datum(),a=I.shouldDrawCircle(i,t);return a?s.CircleRadius:0}});if(l&&s.hasDataPoint(u.series)){var R=A.size(),E=0;O.each("end",(function(){E++,E===R&&o.selectColumn(t.CartesianHelper.findMaxCategoryIndex(u.series),!0)}))}var F=null;if(u.dataLabelsSettings.show){F=[];for(var j=0,H=u.series.length;j<H;j++)Array.prototype.push.apply(F,u.series[j].data)}D.exit().remove();var G;return u.dataLabelsSettings.show&&(G=s.createLabelDataPoints(e)),null==F?null:{dataPoints:F,behaviorOptions:null,labelDataPoints:null,labelsAreNumeric:null,labelDataPointGroups:G}}},s.getFirstPathPointFromSeriesData=function(e){var t=_.find(e.data,(function(e,t,i){var a=i[t+1];return null!=e&&null!=e.value&&null!=a&&null!=a.value}));return t},s.getSeriesTooltipInfo=function(e){if(!e)return null;var t=e.dataPoints;if(_.isEmpty(t))return null;var i="#000000",a="0",r=10,n=!_.isEmpty(t)&&t[0].seriesDisplayName,o=[],s=0;if(_.any(t,(function(e){return!_.isEmpty(e.additionalTooltipItems)})))for(var l=0,u=t;l<u.length;l++){var c=u[l];if(s>=r)break;if(null!=c.value&&(n&&(o.push({header:c.category,displayName:c.seriesDisplayName,value:c.seriesName}),s++),o.push({header:c.category,color:c.color,displayName:c.measureDisplayName,value:c.measure}),s++,!_.isEmpty(c.additionalTooltipItems)))for(var d=0,p=c.additionalTooltipItems;d<p.length;d++){var h=p[d];if(s>=r)break;o.push({header:c.category,color:i,displayName:h.displayName,value:h.value,opacity:a}),s++}}else for(var g=0,f=t;g<f.length;g++){var c=f[g];if(s>=r)break;null!=c.value&&(o.push({header:c.category,color:c.color,displayName:c.seriesName||c.measureDisplayName,value:c.measure}),s++)}if(!_.isEmpty(e.additionalTooltipItems))for(var m=0,y=e.additionalTooltipItems;m<y.length;m++){var h=y[m];if(s>=r)break;o.push({header:t[0].category,color:i,displayName:h.displayName,value:h.value,opacity:a}),s++}return 0===o.length?null:o},s.prototype.getTooltipInfoForCombo=function(e,t){var i,a=this.getCategoryIndexFromTooltipEvent(e,t),r=e.data;if(r&&r.data&&r.data.length&&(i=_.find(r.data,(function(e){return e&&e.categoryIndex===a}))),i)return i.tooltipInfo},s.isDataPointData=function(e){return e&&null!=e.categoryIndex},s.isForecastPoint=function(e){return e&&null!=e.points},s.getIdentityForTooltipEvent=function(e){if(e)return s.isForecastPoint(e)?void 0:e.identity},s.prototype.getCategoryIndexFromTooltipEvent=function(e,t){var i=e.data;if(!s.isForecastPoint(i))return s.isDataPointData(i)?i.categoryIndex:this.getCategoryIndexFromSeriesAndPointX(i,t)},s.prototype.getCategoryIndexFromSeriesAndPointX=function(e,t){var i=0;if(e&&!_.isEmpty(e.data)&&this.xAxisProperties){t=this.adjustPathXCoordinate(t);var a=s.getFirstPathPointFromSeriesData(e);i=this.xAxisProperties.scale(s.getXValue(a,this.data.isScalar))+this.getXOfFirstCategory()}return this.findIndex(t,i)},s.prototype.getVisualCategoryAxisIsScalar=function(){return!!this.data&&this.data.isScalar},s.prototype.getSupportedCategoryAxisType=function(){var e=this.dataViewCat?this.dataViewCat.categories:void 0,i={text:!0};if(!_.isEmpty(e))return t.axisType.both;var a=t.AxisHelper.isOrdinal(i);return a?t.axisType.categorical:t.axisType.both},s.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e,this.margin,!0)},s.prototype.getCategoryCount=function(e){var i=this.getAvailableWidth(),a=t.CartesianChart.MinOrdinalRectThickness;return Math.min(Math.round((i-a*t.CartesianChart.OuterPaddingRatio*2)/a),e)},s.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},s.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},s.sliceSeries=function(t,i,a){void 0===a&&(a=0);var r=[];if(t&&t.length>0)for(var n=0,o=t.length;n<o;n++)r[n]=e.Prototype.inherit(t[n]),r[n].data=t[n].data.slice(a,a+i);return r},s.prototype.getXOfFirstCategory=function(){if(!this.data.isScalar){var e=this.xAxisProperties.scale;if(e.rangeBand)return e.rangeBand()/2}return 0},s.hasDataPoint=function(e){if(0===e.length)return!1;for(var t=0,i=e.length;t<i;t++)if(e[t].data.length>0)return!0;return!1},s.getXValue=function(e,t){return t?e.categoryValue:e.categoryIndex},s.shouldDrawCircle=function(e,t){var i=e.data[t];if(null==i||null===i.value)return!1;var a=e.data[t-1],r=null==a||null===a.value,n=e.data[t+1],o=null==n||null===n.value;return r&&o},s.prototype.getHoverLineDataForCategory=function(e,t){void 0===t&&(t=!1);var i=this.getChartX(e)+this.getXOfFirstCategory(),a=this.createTooltipData(e);if(a){var r=a.dataPoints;return a.dataPoints.length>0&&this.setHoverLineForTooltip(i),this.setDotsForTooltip(i,r),a}},s.prototype.setHoverLineForTooltip=function(e){e=e||0,this.hoverLine.attr("x1",e).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1)},s.prototype.clearHoverLine=function(){this.hoverLine.style("opacity",t.SVGUtil.AlmostZero),this.hoverLineContext.selectAll(s.HoverLineCircleDot.selector).remove()},s.prototype.setDotsForTooltip=function(e,t){var a=this,r=i.hasFlag(this.lineType,16),n=r?function(e){return a.yAxisProperties.scale(e.stackedValue)}:function(e){return a.yAxisProperties.scale(e.value)},o=this.hoverLineContext.selectAll(s.HoverLineCircleDot.selector).data(t);o.enter().append(s.CircleElementName).classed(s.HoverLineCircleDot.class,!0),o.filter((function(e){return e.value})).attr("fill",(function(e){return e.color})).attr("r",3).attr("cx",e).attr("cy",n),o.exit().remove()},s.prototype.selectColumn=function(e,t){if(void 0===t&&(t=!1),t||this.lastInteractiveSelectedColumnIndex!==e){this.lastInteractiveSelectedColumnIndex=e;var i=this.getChartX(e);this.setHoverLine(i,e);var a=this.createLegendDataPoints(e);a&&this.options.cartesianHost.updateLegend(a)}},s.prototype.setHoverLine=function(e,t){this.hoverLine.attr("x1",e).attr("x2",e).attr("y1",0).attr("y2",this.getAvailableHeight()).style("opacity",1);var i=this;this.mainGraphicsContext.selectAll(s.CategorySelector.selector).selectAll(s.PathElementName).each((function(a){var r=this,n=a.color,o=i.selectionCircles[a.lineIndex];o&&o.attr({cx:e,cy:function(){var t=d3.select(r).node(),a=i.getPosition(e,t);return a.y}}).style({opacity:function(){return _.some(a.data,(function(e){return!!e&&e.categoryIndex===t}))?1:0},fill:n}),i.dragHandle&&i.dragHandle.attr("cx",e)}))},s.prototype.getChartX=function(t){var i=0;this.data.isScalar?t>=0&&t<this.data.categoryData.length&&(i=Math.max(0,this.xAxisProperties.scale(this.data.categoryData[t].categoryValue))):i=Math.max(0,this.xAxisProperties.scale(t));var a=e.visuals.AxisHelper.extent(this.xAxisProperties.scale)[1];return i=Math.min(i,a),isNaN(i)?0:i},s.prototype.findIndex=function(i,a){var r=this.scaleDetector.getScale().x;e.Double.equalWithPrecision(r,1,1e-5)||(i/=r),a&&(i+=a);var n=e.visuals.AxisHelper.invertScale(this.xAxisProperties.scale,i);return this.data.isScalar&&(n=t.AxisHelper.findClosestXAxisIndex(n,this.data.categoryData)),n},s.prototype.getPosition=function(e,i){for(var a,r,n=i.getTotalLength(),o=0,s=n;;){if(r=Math.floor((o+s)/2),a=i.getPointAtLength(r),t.SVGUtil.ensureValidSVGPoint(a),(r===s||r===o)&&a.x!==e)break;if(a.x>e)s=r;else{if(!(a.x<e))break;o=r}}return a},s.prototype.createTooltipData=function(e){var i=this.data;if(i&&0!==i.series.length&&i.categories&&i.categoryData){var a,r=[],n=i.categoryData[e];this.data.isScalar?n&&(a=t.AxisHelper.isDateTime(this.xAxisProperties.axisType)&&!i.scalarMetadata?t.CartesianHelper.lookupXValue(this.data,n.categoryValue,this.xAxisProperties.axisType,this.data.isScalar):i.categories[e]):a=t.CartesianHelper.lookupXValue(this.data,e,this.xAxisProperties.axisType,this.data.isScalar);for(var o,s=t.lineChartProps.general.formatString,l=0,u=i.series;l<u.length;l++){var c=u[l],d=c.data,p=void 0;this.data.isScalar?n&&(p=d.filter((function(e){return e.categoryValue===n.categoryValue}))[0]):p=d[e];var h=p&&p.value;if(null!=h){var g=t.CategoryLevelUtils.concatenateCategoryLevels(n.hierarchyCategoryLevels),f={color:c.color,category:g.value,measureDisplayName:c.displayName,measure:t.valueFormatter.format(h,t.valueFormatter.getFormatString(c.yCol,s)),value:h,stackedValue:p.stackedValue};i.hasDynamicSeries?(f.seriesDisplayName=i.seriesDisplayName,f.seriesName=c.dynamicDisplayName,f.additionalTooltipItems=p.additionalTooltipItems):o||(o=p.additionalTooltipItems),r.push(f)}}if(!_.isEmpty(i.forecastLines))for(var c=_.first(i.series),m=0,y=i.forecastLines;m<y.length;m++){var v=y[m],w=_(v.points).filter((function(e){return e.point.x===n.categoryValue})).first(),h=w&&w.point.y;if(null!=h){var f={color:v.lineColor.solid.color,category:t.valueFormatter.format(a,t.valueFormatter.getFormatString(c.xCol,s)),measureDisplayName:v.displayName,measure:t.valueFormatter.format(h,t.valueFormatter.getFormatString(c.yCol,s)),value:h,stackedValue:void 0,additionalTooltipItems:[{displayName:this.host.getLocalizedString("Visual_Confidence_Band_Upper"),value:t.valueFormatter.format(w.upperBound.y,t.valueFormatter.getFormatString(c.yCol,s))},{displayName:this.host.getLocalizedString("Visual_Confidence_Band_Lower"),value:t.valueFormatter.format(w.lowerBound.y,t.valueFormatter.getFormatString(c.yCol,s))
}]};r.push(f)}}return{dataPoints:r,additionalTooltipItems:o}}},s.prototype.createLegendDataPoints=function(e){var i=this.data;if(i&&i.series&&!(i.series.length<1)){var a,r=[],n=i.categoryData[e];this.isInteractiveChart&&n&&(this.data.isScalar?(a=n.categoryValue,t.AxisHelper.isDateTime(this.xAxisProperties.axisType)&&(a=new Date(a))):a=t.CartesianHelper.lookupXValue(this.data,e,this.xAxisProperties.axisType,this.data.isScalar));for(var o=t.lineChartProps.general.formatString,s=null,l=0,u=i.series.length;l<u;l++){var c=i.series[l],d=c.data,p=void 0;if(this.isInteractiveChart){var h=void 0;if(this.data.isScalar){if(n)for(var g=n.categoryValue,f=0;f<d.length;f++)if(d[f].categoryValue===g){h=d[f];break}}else h=d[e];p=h&&h.value}var m=t.converterHelper.getFormattedLegendLabel(c.yCol,this.dataViewCat.values,o);s=c.yCol,r.push({color:c.color,icon:t.LegendIcon.Line,label:m,category:t.valueFormatter.format(a,t.valueFormatter.getFormatString(c.xCol,o)),measure:t.valueFormatter.format(p,t.valueFormatter.getFormatString(c.yCol,o)),identity:c.identity,selected:c.selected})}var y=this.dataViewCat?this.dataViewCat.values:null,v=y&&y.source?y.source.displayName:"";return{title:v,dataPoints:r,grouped:i.hasDynamicSeries}}},s.createLabelDataPoints=function(a){for(var r,o,l=a.xAxisProperties.scale,u=a.yAxisProperties.scale,c=a.horizontalOffset,d=a.data,p=d.series,h=d.dataLabelsSettings,g=t.NewDataLabelUtils.createColumnFormatterCacheManager(),f=i.hasFlag(a.lineType,16),m=[],y=d.isScalar,v=function(i,d){o=p[i],r=o.labelSettings||h;var v="100"===r.labelDensity,b=t.NewDataLabelUtils.getNumberOfLabelsToRender(a.currentViewport.width,_.parseInt(r.labelDensity),w.minimumLabelsToRender,t.MinMaxLabelDataPointSorter.estimatedLabelWidth),C=!v&&y?b:o.data.length;if(!r.show)return m[i]={labelDataPoints:[],maxNumberOfLabels:0},"continue";var S=t.NewDataLabelUtils.getLabelUnitAndPrecisionForAxis(a.yAxisProperties,r),x=o.data,P=[],D=function(i,d){if(null==i||null==i.value)return null;var p,h=i.labelFormatString,m=g.getOrCreate(h,r,S.units,S.precision),w=t.NewDataLabelUtils.getLabelFormattedText(m.format(i.value)),b={text:w,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:n.fromPoint(r.fontSize),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},C=e.TextMeasurementService.measureSvgTextWidth(b)+t.NewDataLabelUtils.LabelDensityPadding,x=e.TextMeasurementService.estimateSvgTextHeight(b,!0),P=!1;if(f){var D=Math.max(i.stackedValue-i.value,u.domain()[0]),T=a.currentViewport.width;p={rect:{left:l(s.getXValue(i,y))-T/2,top:u(Math.max(i.stackedValue,i.stackedValue-i.value)),width:T,height:Math.abs(u(i.stackedValue)-u(D))},orientation:i.value>=0?1:2,validPositions:s.validStackedLabelPositions},P=!0}else p={point:{x:l(s.getXValue(i,y))+c,y:u(i.value)},radius:0,validPositions:v?[1]:s.getValidLabelPositions(o,d)};var V={isPreferred:!1,text:w,textSize:{width:C,height:x},outsideFill:r.labelColor?r.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:r.labelColor&&f?r.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:P?1:0,parentShape:p,fontSize:r.fontSize,identity:i.identity,key:i.key};return V};if(!_.isEmpty(x))for(var T=0,V=x.length;T<V;T++){var L=D(x[T],T);L&&P.push(L)}m[i]={labelDataPoints:P,maxNumberOfLabels:C}},w=this,b=0,C=p.length;b<C;b++)v(b,C);if(16!==a.lineType){var S=new t.MinMaxLabelDataPointSorter({unsortedLabelDataPointGroups:m,series:p,viewport:a.currentViewport,yAxisProperties:a.yAxisProperties});return S.getSortedDataLabels()}return m},s.prototype.adjustPathXCoordinate=function(t){var i=this.scaleDetector.getScale().x;return t-=e.Double.equalWithPrecision(i,1,1e-5)?this.pathXAdjustment:this.pathXAdjustment*i},s.getValidLabelPositions=function(e,t){var i=e.data,a=i.length,r=t===a-1,n=0===t,o=i[t].value,s=i[t-1]&&i[t-1].value,l=i[t+1]&&i[t+1].value,u=1,c=1;if(null==s?u=0:s>o?u=3:s<o&&(u=2),null===l?c=0:l>o?c=3:l<o&&(c=2),n)switch(c){case 3:return[2,1];default:return[1,2]}if(r)switch(u){case 3:return[2,1];default:return[1,2]}switch(u){case 0:switch(c){case 0:return[1,2,8,4];case 1:return[1,2,4,8];case 3:return[2,1,4,8];case 2:return[1,2,4,8]}case 1:switch(c){case 0:return[1,2,8,4];case 1:return[1,2,8,4];case 3:return[2,1,8,4];case 2:return[1,2,8,4]}case 3:switch(c){case 0:return[2,1,8,4];case 1:return[2,1,4,8];case 3:return[2,1,8,4];case 2:return[1,2,8,4]}case 2:switch(c){case 0:return[1,2,8,4];case 1:return[1,2,4,8];case 3:return[1,2,8,4];case 2:return[1,2,8,4]}}},s.ClassName="lineChart",s.MainGraphicsContextClassName="mainGraphicsContext",s.CategorySelector=r("cat"),s.CategoryValuePoint=r("dot"),s.CategoryPointSelector=r("point"),s.CategoryAreaSelector=r("catArea"),s.HoverLineCircleDot=r("circle-item"),s.LineClassSelector=r("line"),s.PointRadius=5,s.CircleRadius=4,s.PathElementName="path",s.CircleElementName="circle",s.CircleClassName="selection-circle",s.LineElementName="line",s.RectOverlayName="rect",s.ScalarOuterPadding=10,s.interactivityStrokeWidth=10,s.minimumLabelsToRender=4,s.AreaFillOpacity=.4,s.DimmedAreaFillOpacity=.2,s.validStackedLabelPositions=[1,4,2],s})();t.LineChart=s})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs),n=(window.debug,window.jasmine,window.Microsoft);!(function(e){var t;!(function(t){var i=a.Color,o=a.CssConstants.createClassAndSelector,s=e.data.DataRoleHelper,l=e.visuals.EventBubblingUtil,u=a.PixelConverter,c=t.shapes.Polygon;t.MaxLevelOfDetail=23,t.MinLevelOfDetail=1,t.DefaultFillOpacity=.5,t.DefaultBackgroundColor="#000000",t.LeaderLineColor="#000000";var d=(function(){function i(e){this.tooltipsEnabled=e}return i.prototype.init=function(e,i,a,r){this.mapControl=e,this.root=i,i.css("display","inline-block");var n=d3.select(i[0]);n.attr("drag-resize-disabled","true");var o=this.svg=n.append("svg").style("position","absolute").style("pointer-events","none");if(a){var s=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(s)}this.bubbleGraphicsContext=o.append("g").classed("mapBubbles",!0),this.sliceGraphicsContext=o.append("g").classed("mapSlices",!0),this.labelBackgroundGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass.class,!0),this.labelGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass.class,!0),this.sliceLayout=d3.layout.pie().sort(null).value((function(e){return e.value})),this.arc=d3.svg.arc(),this.clearMaxDataPointRadius(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.tooltipService=r},i.prototype.setData=function(e){this.mapData=e},i.prototype.clearDataPoints=function(){this.mapData={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1}},i.prototype.getDataPointCount=function(){return this.mapData?_.filter(this.mapData.dataPoints,(function(e){return!!e.location})).length:0},i.prototype.getDataPointPadding=function(){return 2*this.maxDataPointRadius},i.prototype.clearMaxDataPointRadius=function(){this.maxDataPointRadius=0},i.prototype.setMaxDataPointRadius=function(e){this.maxDataPointRadius=Math.max(e,this.maxDataPointRadius)},i.prototype.getDefaultMap=function(e,t){this.clearDataPoints()},i.prototype.converter=function(e,t,i,a){void 0===a&&(a=!0);var r=this.mapControl,o=e.width/2,s=e.height/2,l=1;this.dataLabelsSettings=t;var u=Math.min(e.width,e.height)/384;this.clearMaxDataPointRadius();for(var c=[],d=[],p=this.mapData?this.mapData.dataPoints:[],h=this.mapData.hasSize,g=0,f=p.length;g<f;g++){var m=p[g],y=m.categoryValue,v=m.location;if(v){var w=r.tryLocationToPixel(new n.Maps.Location(v.latitude,v.longitude)),b=w.x+o,C=w.y+s,S=m.radius*u;this.setMaxDataPointRadius(S);var x=m.subDataPoints,P=x.length;if(1===P){var D=x[0];c.push({x:b,y:C,labeltext:y,radius:S,fill:D.fill,stroke:D.stroke,strokeWidth:l,tooltipInfo:D.tooltipInfo,identity:D.identity,selected:!1,labelFill:t.labelColor})}else{for(var T=[],V=0;V<P;V++){var D=x[V],_=h?D.value:1;T.push({x:b,y:C,labeltext:y,radius:S,fill:D.fill,stroke:D.stroke,strokeWidth:l,value:_,tooltipInfo:D.tooltipInfo,identity:D.identity,selected:!1,labelFill:t.labelColor})}i&&i.applySelectionStateToData(T),d.push(T)}}}return i&&i.applySelectionStateToData(c),{bubbleData:c,sliceData:d}},i.prototype.updateInternal=function(e,i,a,r,n){this.mapRendererData=e,this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px");var o=this.arc,s=r&&r.hasSelection(),l=this.bubbleGraphicsContext.selectAll(".bubble").data(e.bubbleData,(function(e){return e.identity.getKey()})),u=new y(this.mapControl,this.tooltipService);l.enter().append("circle").classed("bubble",!0),l.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})).attr("r",(function(e){return e.radius})).style("fill",(function(e){return e.fill})).style("stroke",(function(e){return e.stroke})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,s,!1)})).style("strokeWidth",(function(e){return e.strokeWidth})).style("stroke-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,s,!1)})).on("mousedown.drag",(function(){return u.onMouseDown(d3.event.target)})),l.exit().remove(),this.tooltipsEnabled&&(this.tooltipService.addTooltip(this.bubbleGraphicsContext,(function(e){return e.data&&e.data.tooltipInfo}),(function(e){return e.data&&e.data.identity})),l.style("pointer-events","all"));var c=e.sliceData,d=this.sliceGraphicsContext.selectAll(".sliceContainer").data(c);d.enter().append("g").classed("sliceContainer",!0),d.exit().remove();var p=this.sliceLayout,h=d.selectAll(".slice").data((function(e){return p(e)}),(function(e){return e.data.identity.getKey()}));h.enter().append("path").classed("slice",!0),h.style("fill",(function(e){return e.data.fill})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,!1)})).style("stroke",(function(e){return e.data.stroke})).style("strokeWidth",(function(e){return e.data.strokeWidth})).style("stroke-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,!1)})).style("cursor","default").attr("transform",(function(e){return t.SVGUtil.translate(e.data.x,e.data.y)})).attr("d",(function(e){return o.innerRadius(0).outerRadius((function(e){return e.data.radius}))(e)})),h.exit().remove(),this.updateInternalDataLabels(i,n),this.tooltipsEnabled&&(this.tooltipService.addTooltip(this.sliceGraphicsContext,(function(e){return e.data&&e.data.data.tooltipInfo}),(function(e){return e.data&&e.data.data.identity})),h.style("pointer-events","all"));for(var g=e.bubbleData.slice(),f=0,m=c.length;f<m;f++)g.push.apply(g,c[f]);var v={bubbleEventGroup:this.bubbleGraphicsContext,sliceEventGroup:this.sliceGraphicsContext,bubbles:l,slices:h,clearCatcher:this.clearCatcher,dataPoints:g};return v},i.prototype.updateInternalDataLabels=function(i,a){var r=this.dataLabelsSettings,n=[];if(r&&(r.show||r.showCategory)){var o=this.createLabelDataPoints(),s=new e.LabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset}),l={labelDataPoints:o,maxNumberOfLabels:o.length};n=s.layout([l],{width:i.width,height:i.height})}t.NewDataLabelUtils.drawLabelBackground(this.labelGraphicsContext,n,e.visuals.DefaultBackgroundColor,e.visuals.DefaultFillOpacity),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,n,!1)},i.prototype.createLabelDataPoints=function(){var a=this.mapRendererData,r=[],n=a.bubbleData;n=n.concat(_.map(a.sliceData,(function(e){return e[0]})));for(var o=this.dataLabelsSettings,s=0,l=n;s<l.length;s++){var c=l[s],d=c.labeltext,p={text:d,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:u.fromPoint(o.fontSize),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},h=e.TextMeasurementService.measureSvgTextWidth(p),g=e.TextMeasurementService.estimateSvgTextHeight(p);r.push({isPreferred:!0,text:d,textSize:{width:h,height:g},outsideFill:o.labelColor?o.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,parentShape:{point:{x:c.x,y:c.y},radius:c.radius,validPositions:i.validLabelPositions},fontSize:o.fontSize,identity:void 0,hasBackground:!0})}return r},i.validLabelPositions=[1,2,4,8],i})();t.MapBubbleDataPointRenderer=d;var p=(function(){function i(e,t){this.filledMapDataLabelsEnabled=e,this.tooltipsEnabled=t}return i.getFilledMapParams=function(e,i){switch(e){case t.MapUtil.CategoryTypes.Continent:case t.MapUtil.CategoryTypes.CountryRegion:return i<10?{level:1,maxPolygons:50,strokeWidth:0}:i<30?{level:1,maxPolygons:20,strokeWidth:0}:{level:1,maxPolygons:5,strokeWidth:0};default:return i<100?{level:1,maxPolygons:5,strokeWidth:6}:i<200?{level:0,maxPolygons:5,strokeWidth:6}:{level:0,maxPolygons:5,strokeWidth:0}}},i.buildPaths=function(e){for(var t=[],i=0;i<e.length;i++){var a=e[i],r=a.geographic;r.length>2&&t.push(a)}return t},i.prototype.init=function(e,i,a,r){this.mapControl=e,this.polygonInfo=new t.MapPolygonInfo,this.root=i;var n=d3.select(i[0]);n.attr("drag-resize-disabled","true");var o=this.svg=n.append("svg").style("position","absolute").style("pointer-events","none");if(a){var s=this.clearSvg=d3.select(this.mapControl.getRootElement()).append("svg").style("position","absolute");this.clearCatcher=t.appendClearCatcher(s)}this.shapeGraphicsContext=o.append("g").classed("mapShapes",!0),this.labelBackgroundGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelBackgroundGraphicsContextClass.class,!0),this.labelGraphicsContext=o.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass.class,!0),this.clearMaxShapeDimension(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.tooltipService=r},i.prototype.setData=function(e){this.mapData=e},i.prototype.clearDataPoints=function(){this.mapData={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1}},i.prototype.getDataPointCount=function(){return this.mapData?_.filter(this.mapData.dataPoints,(function(e){return!!e.paths})).length:0},i.prototype.converter=function(e,t,a){this.clearMaxShapeDimension(),this.dataLabelsSettings=t;for(var r=1,n=[],o=this.mapData?this.mapData.dataPoints:[],s=0,l=o.length;s<l;s++){var u=o[s],c=u.subDataPoints[0],d=u.paths;if(d)for(var p=u.value,h=u.categoryValue,g=c.identity,f=g.getKey(),m=i.getIndexOfLargestShape(d),y=0,v=d.length;y<v;y++){var w=d[y];this.setMaxShapeDimension(w.absoluteBounds.width,w.absoluteBounds.height),n.push({absolutePointArray:w.absolute,path:w.absoluteString,fill:c.fill,stroke:c.stroke,strokeWidth:r,tooltipInfo:c.tooltipInfo,identity:g,selected:!1,key:JSON.stringify({id:f,pIdx:y}),displayLabel:y===m,labeltext:h,catagoryLabeltext:null!=p?p.toString():void 0})}}return a&&a.applySelectionStateToData(n),{shapeData:n}},i.prototype.updateInternal=function(e,i,a,r,n){this.mapRendererData=e,this.svg&&this.svg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.clearSvg&&this.clearSvg.style("width",i.width.toString()+"px").style("height",i.height.toString()+"px"),this.polygonInfo.reCalc(this.mapControl,i.width,i.height),this.shapeGraphicsContext.attr("transform",this.polygonInfo.transformToString(this.polygonInfo.transform));var o=r&&r.hasSelection(),s=this.shapeGraphicsContext.selectAll("polygon").data(e.shapeData,(function(e){return e.key})),l=new y(this.mapControl,this.tooltipService);s.enter().append("polygon").classed("shape",!0).attr("points",(function(e){return e.path})).on("mousedown.drag",(function(){return l.onMouseDown(d3.event.target)})),s.style("fill",(function(e){return e.fill})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.selected,!1,o,!1)})),a&&s.attr("points",(function(e){return e.path})),s.exit().remove(),this.updateInternalDataLabels(i,n),this.tooltipsEnabled&&(this.tooltipService.addTooltip(this.shapeGraphicsContext,(function(e){return e.data&&e.data.tooltipInfo}),(function(e){return e.data&&e.data.identity})),s.style("pointer-events","all"));var u={shapeEventGroup:this.shapeGraphicsContext,shapes:s,clearCatcher:this.clearCatcher,dataPoints:e.shapeData};return u},i.prototype.getDataPointPadding=function(){return 12},i.getIndexOfLargestShape=function(e){for(var t=0,i=0,a=0,r=e.length;a<r;a++){var n=e[a],o=new c(n.absolute),s=Math.abs(c.calculateAbsolutePolygonArea(o.polygonPoints));s>i&&(t=a,i=s)}return t},i.prototype.updateInternalDataLabels=function(i,a){var r=this.dataLabelsSettings,n=[];if(r&&(r.show||r.showCategory)){var o=this.createLabelDataPoints();void 0===this.labelLayout&&(this.labelLayout=new e.FilledMapLabelLayout),n=this.labelLayout.layout(o,{width:i.width,height:i.height},this.polygonInfo.transform,a)}this.drawLabelStems(this.labelGraphicsContext,n,r.show,r.showCategory),t.NewDataLabelUtils.drawLabelBackground(this.labelGraphicsContext,n,e.visuals.DefaultBackgroundColor,e.visuals.DefaultFillOpacity),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,n,!1,r.show&&r.showCategory)},i.prototype.clearMaxShapeDimension=function(){this.maxShapeDimension=0},i.prototype.setMaxShapeDimension=function(e,t){this.maxShapeDimension=Math.max(e,this.maxShapeDimension),this.maxShapeDimension=Math.max(t,this.maxShapeDimension)},i.prototype.createLabelDataPoints=function(){var a=this.mapRendererData,r=[];if(this.filledMapDataLabelsEnabled)for(var n=a.shapeData,o=this.dataLabelsSettings,s=0,l=n;s<l.length;s++){var u=l[s];if(u.displayLabel){var d=void 0,p=void 0,h=0,g=!1;if(this.dataLabelsSettings.show&&!this.dataLabelsSettings.showCategory){if(d=u.catagoryLabeltext,void 0===d)continue}else if(this.dataLabelsSettings.showCategory&&!this.dataLabelsSettings.show){if(d=u.labeltext,void 0===d)continue}else if(this.dataLabelsSettings.showCategory&&this.dataLabelsSettings.show){if(d=u.catagoryLabeltext,p=u.labeltext,void 0===d&&void 0===p)continue;g=!0}if(g){var f={text:p,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.NewDataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight};h=e.TextMeasurementService.measureSvgTextWidth(f)}var m={text:d,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:t.NewDataLabelUtils.LabelTextProperties.fontSize,fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},y=e.TextMeasurementService.measureSvgTextWidth(m),v=e.TextMeasurementService.estimateSvgTextHeight(m);p&&void 0!==u.labeltext&&void 0!==u.catagoryLabeltext&&(v=2*v);var w={parentType:2,parentShape:{polygon:new c(u.absolutePointArray),validPositions:i.validLabelPolygonPositions},text:d,secondRowText:p,textSize:{width:Math.max(y,h),height:v},insideFill:o.labelColor,outsideFill:o.labelColor?o.labelColor:t.NewDataLabelUtils.defaultInsideLabelColor,isPreferred:!1,identity:void 0,hasBackground:!0};r.push(w)}}return r},i.prototype.drawLabelStems=function(e,i,a,r){var n=function(e,t){return e.identity?e.identity.getKeyWithoutHighlight():t};t.NewDataLabelUtils.drawLabelLeaderLines(e,i,n,t.LeaderLineColor)},i.validLabelPolygonPositions=[256,2,1,8,4,16,32,64,128],i})();t.MapShapeDataPointRenderer=p;var h=11,g=1,f=3,m=(function(){function a(e){this.isDestroyed=!1,e.filledMap?(this.dataPointRenderer=new p(e.filledMapDataLabelsEnabled,e.tooltipsEnabled),this.filledMapDataLabelsEnabled=e.filledMapDataLabelsEnabled,this.isFilledMap=!0):(this.dataPointRenderer=new d(e.tooltipsEnabled),this.isFilledMap=!1),this.mapControlFactory=e.mapControlFactory||t.MapUtil.DefaultMapControlFactory,this.mapControlFactory.createMapControl||(this.mapControlFactory.createMapControl=function(e,t){return new n.Maps.Map(e,t)}),this.behavior=e.behavior,this.tooltipsEnabled=e.tooltipsEnabled,this.disableZooming=e.disableZooming,this.disablePanning=e.disablePanning,this.isLegendScrollable=!!e.behavior,this.viewChangeThrottleInterval=e.viewChangeThrottleInterval,this.enableCurrentLocation=e.enableCurrentLocation,this.boundsHaveBeenUpdated=!1,this.bubbleSizeMultiplier=1}return a.prototype.init=function(i){var r=this,o=this.element=i.element;this.pendingGeocodingRender=!1,this.currentViewport=i.viewport,this.style=i.style,this.colors=this.style.colorPalette.dataColors,this.behavior&&(this.interactivityService=t.createInteractivityService(i.host)),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.legend=e.visuals.createLegend(o,i.interactivity&&i.interactivity.isInteractiveLegend,this.interactivityService,this.isLegendScrollable),this.legendHeight=0,this.legendData={dataPoints:[]},this.geoTaggingAnalyzerService=e.createGeoTaggingAnalyzerService(i.host.getLocalizedString),this.host=i.host,this.tooltipService=t.createTooltipService(i.host),i.host.locale&&(this.locale=i.host.locale()),this.geocoder=i.host.geocoder(),this.promiseFactory=i.host.promiseFactory(),this.resetBounds(),this.isDestroyed=!1,this.mapControlFactory.ensureMap(this.locale,(function(){r.isDestroyed||(a.removeHillShading(),n.Maps.loadModule("Microsoft.Maps.Overlays.Style",{callback:function(){r.isDestroyed||(r.initialize(o[0]),r.enableCurrentLocation&&r.createCurrentLocation(o))}}))}))},a.prototype.destroy=function(){this.isDestroyed=!0,this.geocodingContext&&this.geocodingContext.timeout&&this.geocodingContext.timeout.resolve(null)},a.prototype.createCurrentLocation=function(e){var i,a=this,o=r.DomFactory.div().addClass("mapCurrentLocation").appendTo(e);o.on("click",(function(){a.isCurrentLocation?(i&&a.mapControl.entities.remove(i),a.updateInternal(!1,!1),a.isCurrentLocation=!1):a.host.geolocation().getCurrentPosition((function(e){var r=new n.Maps.Location(e.coords.latitude,e.coords.longitude);i&&a.mapControl.entities.remove(i),i=t.MapUtil.CurrentLocation.createPushpin(r),a.mapControl.entities.push(i),a.updateMapView(r,h),a.isCurrentLocation=!0}))}))},a.prototype.addDataPoint=function(e){var t=e.location;this.updateBounds(t.latitude,t.longitude),this.scheduleRedraw()},a.prototype.scheduleRedraw=function(){var e=this;!this.pendingGeocodingRender&&this.mapControl&&(this.pendingGeocodingRender=!0,setTimeout((function(){e.updateInternal(!0,!0),e.pendingGeocodingRender=!1}),a.ScheduleRedrawInterval))},a.prototype.enqueueGeoCode=function(e){var t=this,i=this.geocoder.tryGeocodeImmediate(e.geocodingQuery,this.geocodingCategory);if(i)this.completeGeoCode(e,i);else{var a=this.geocodingContext;this.geocoder.geocode(e.geocodingQuery,this.geocodingCategory,{timeout:a.timeout.promise}).then((function(i){!t.isDestroyed&&i&&a===t.geocodingContext&&t.completeGeoCode(e,i)}))}},a.prototype.completeGeoCode=function(e,t){e.location=t,this.addDataPoint(e)},a.prototype.enqueueGeoCodeAndGeoShape=function(e,t){var i=this,a=this.geocoder.tryGeocodeImmediate(e.geocodingQuery,this.geocodingCategory);if(a)this.completeGeoCodeAndGeoShape(e,t,a);else{var r=this.geocodingContext;this.geocoder.geocode(e.geocodingQuery,this.geocodingCategory,{timeout:r.timeout.promise}).then((function(a){!i.isDestroyed&&a&&r===i.geocodingContext&&i.completeGeoCodeAndGeoShape(e,t,a)}))}},a.prototype.completeGeoCodeAndGeoShape=function(e,t,i){e.location=i,this.enqueueGeoShape(e,t)},a.prototype.enqueueGeoShape=function(e,t){var i=this,a=this.geocoder.tryGeocodeBoundaryImmediate(e.location.latitude,e.location.longitude,this.geocodingCategory,t.level,t.maxPolygons);if(a)this.completeGeoShape(e,t,a);else{var r=this.geocodingContext;this.geocoder.geocodeBoundary(e.location.latitude,e.location.longitude,this.geocodingCategory,t.level,t.maxPolygons,{timeout:r.timeout.promise}).then((function(a){!i.isDestroyed&&a&&r===i.geocodingContext&&i.completeGeoShape(e,t,a)}))}},a.prototype.completeGeoShape=function(e,i,a){var r;0===a.locations.length||a.locations[0].geographic?r=p.buildPaths(a.locations):(t.MapUtil.calcGeoData(a),r=p.buildPaths(a.locations)),e.paths=r,this.addDataPoint(e)},a.prototype.getOptimumLevelOfDetail=function(e,i){var a=this.dataPointRenderer.getDataPointCount();if(0===a)return t.MapUtil.MinLevelOfDetail;for(var r=this.dataPointRenderer.getDataPointPadding(),n=t.MapUtil.MaxLevelOfDetail;n>=t.MapUtil.MinLevelOfDetail;n--){var o=t.MapUtil.latLongToPixelXY(this.minLatitude,this.minLongitude,n),s=t.MapUtil.latLongToPixelXY(this.maxLatitude,this.maxLongitude,n);if(s.x-o.x+r<=e&&o.y-s.y+r<=i)return a<2&&(n=Math.min(t.MapUtil.MaxAutoZoomLevel,n)),n}return t.MapUtil.MinLevelOfDetail},a.prototype.getViewCenter=function(e){var i=t.MapUtil.latLongToPixelXY(this.minLatitude,this.minLongitude,e),a=t.MapUtil.latLongToPixelXY(this.maxLatitude,this.maxLongitude,e);return t.MapUtil.pixelXYToLocation((i.x+a.x)/2,(a.y+i.y)/2,e)},a.prototype.resetBounds=function(){this.boundsHaveBeenUpdated=!1,this.minLongitude=t.MapUtil.MaxAllowedLongitude,this.maxLongitude=t.MapUtil.MinAllowedLongitude,this.minLatitude=t.MapUtil.MaxAllowedLatitude,this.maxLatitude=t.MapUtil.MinAllowedLatitude},a.prototype.updateBounds=function(e,t){this.boundsHaveBeenUpdated=!0,t<this.minLongitude&&(this.minLongitude=t),t>this.maxLongitude&&(this.maxLongitude=t),e<this.minLatitude&&(this.minLatitude=e),e>this.maxLatitude&&(this.maxLatitude=e)},a.legendObject=function(e){return e&&e.metadata&&e.metadata.objects&&e.metadata.objects.legend},a.isLegendHidden=function(e){var i=a.legendObject(e);return null!=i&&i[t.legendProps.show]===!1},a.legendPosition=function(e){var i=a.legendObject(e);return i&&t.LegendPosition[i[t.legendProps.position]]},a.getLegendFontSize=function(e){var i=a.legendObject(e);return i&&i[t.legendProps.fontSize]||t.SVGLegend.DefaultFontSizeInPt},a.isShowLegendTitle=function(e){var i=a.legendObject(e);return i&&i[t.legendProps.showTitle]},a.prototype.legendTitle=function(){var e=a.legendObject(this.dataView);return e&&e[t.legendProps.titleText]||this.legendData.title},a.prototype.renderLegend=function(e){var i=a.isLegendHidden(this.dataView),r=a.isShowLegendTitle(this.dataView),n=this.legendTitle(),o={dataPoints:i?[]:e.dataPoints,grouped:e.grouped,title:r?n:"",fontSize:a.getLegendFontSize(this.dataView)},s=a.legendPosition(this.dataView);void 0!==s?this.legend.changeOrientation(s):this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend(o,this.currentViewport)},a.calculateGroupSizes=function(e,t,i,a,r){for(var n=e.values[0].values.length,o=t.length,s=0,l=n;s<l;++s){var u=null;if(a>=0)for(var c=0;c<o;++c){var d=t[c].values[a].values[s];d&&(null===u?u=d:u+=d)}i.push(u),u&&(r?(r.min=Math.min(r.min,u),r.max=Math.max(r.max,u)):r={min:u,max:u})}return r},a.calculateRadius=function(e,t,i){void 0===i&&(i=1);var a=e?e.max-e.min:0,r=6;return null!=e&&null!=t&&0!==a&&(r=14*((t-e.min)/a)+6),r*i},a.getGeocodingCategory=function(e,t){var i,a=e.type;if(i=t.getFieldTypeFromDescriptor(a))return i;var r=e.displayName;if(i=t.getFieldType(r))return i;var n=e.roles;if(n)for(var o=Object.keys(n),s=0,l=o.length;s<l;++s){var u=t.getFieldType(o[s]);if(u)return u}},a.hasSizeField=function(e,t){if(_.isEmpty(e))return!1;for(var i=0,a=e.length;i<a;i++){var r=e[i].source.roles;if(!r&&i===t&&e[i].source.type.numeric)return!0;if(r)for(var n=Object.keys(r),o=0,s=n.length;o<s;o++){var l=n[o];if("Size"===l)return!0}}return!1},a.shouldEnumerateDataPoints=function(e,t){var i=s.hasRoleInDataView(e,"Series"),a=t?"Size":"Gradient",r=s.hasRoleInDataView(e,a);return i||!r},a.shouldEnumerateCategoryLabels=function(e,t){return!e||t},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;switch(e.objectName){case"dataPoint":if(a.shouldEnumerateDataPoints(this.dataView,this.isFilledMap)){var r=[],n=this.hasDynamicSeries;if(!n){var o=this.dataPointRenderer.converter(this.getMapViewPort(),this.dataLabelsSettings,this.interactivityService,this.tooltipsEnabled);r=o.bubbleData}a.enumerateDataPoints(i,this.dataPointsToEnumerate,this.colors,n,this.defaultDataPointColor,this.showAllDataPoints,r)}break;case"categoryLabels":a.shouldEnumerateCategoryLabels(this.isFilledMap,this.filledMapDataLabelsEnabled)&&t.dataLabelUtils.enumerateCategoryLabels(i,this.dataLabelsSettings,!0,!0);break;case"legend":this.hasDynamicSeries&&a.enumerateLegend(i,this.dataView,this.legend,this.legendTitle());break;case"labels":if(this.filledMapDataLabelsEnabled){this.dataLabelsSettings=this.dataLabelsSettings?this.dataLabelsSettings:t.dataLabelUtils.getDefaultMapLabelSettings();var s={enumeration:i,dataLabelsSettings:this.dataLabelsSettings,show:!0,displayUnits:!0,precision:!0};t.dataLabelUtils.enumerateDataLabels(s)}break;case"bubbles":this.enumerateBubbles(i);break;case"mapControls":this.enumerateMapControls(i)}return i.complete()},a.enumerateDataPoints=function(e,a,r,n,o,s,l){var u=a&&a.length;if(n)for(var c=0;c<u;c++){var d=a[c];e.pushInstance({objectName:"dataPoint",displayName:d.label,selector:t.ColorHelper.normalizeSelector(d.identity.getSelector()),properties:{fill:{solid:{color:d.color}}}})}else if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:o||r.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!s}}),l&&s)for(var c=0;c<l.length;c++){var p=l[c];e.pushInstance({objectName:"dataPoint",displayName:p.labeltext,selector:t.ColorHelper.normalizeSelector(p.identity.getSelector()),properties:{fill:{solid:{color:i.normalizeToHexString(p.fill)}}}})}},a.enumerateLegend=function(i,r,n,o){var s=e.DataViewObject.getValue(this.legendObject(r),t.legendProps.position,t.legendPosition.top);i.pushInstance({selector:null,properties:{show:!a.isLegendHidden(r),position:s,showTitle:a.isShowLegendTitle(r),titleText:o,fontSize:a.getLegendFontSize(r)},objectName:"legend"})},a.prototype.enumerateBubbles=function(e){e.pushInstance({selector:null,properties:{bubbleSize:a.invertBubbleSizeMultiplier(this.bubbleSizeMultiplier)},objectName:"bubbles"})},a.prototype.enumerateMapControls=function(e){e.pushInstance({selector:null,properties:{autoZoom:this.autoZoomEnabled},objectName:"mapControl"})},a.prototype.onDataChanged=function(i){var r=this;this.resetBounds(),this.geocodingContext&&this.geocodingContext.timeout&&this.geocodingContext.timeout.resolve(null),this.geocodingContext={timeout:this.promiseFactory.defer()},this.behavior&&this.behavior.resetZoomPan(),this.dataLabelsSettings=t.dataLabelUtils.getDefaultMapLabelSettings(),this.defaultDataPointColor=null,this.showAllDataPoints=null;var n=this.dataView=i.dataViews[0],o=this.isFilledMap,s=[],l={dataPoints:[],geocodingCategory:null,hasDynamicSeries:!1,hasSize:!1};if(n){if(n.metadata&&n.metadata.objects){var u=n.metadata.objects;this.defaultDataPointColor=e.DataViewObjects.getFillColor(u,t.mapProps.dataPoint.defaultColor),this.showAllDataPoints=e.DataViewObjects.getValue(u,t.mapProps.dataPoint.showAllDataPoints),this.dataLabelsSettings.showCategory=e.DataViewObjects.getValue(u,t.filledMapProps.categoryLabels.show,this.dataLabelsSettings.showCategory);var c=e.DataViewObjects.getValue(u,t.mapProps.mapControls.autoZoom,!0),d=void 0!==this.autoZoomEnabled&&!!c!=!!this.autoZoomEnabled;if(this.autoZoomEnabled=c,c?(this.savedLatitude=void 0,this.savedLongitude=void 0,this.savedZoomLevel=void 0):d?this.updateZoomPanStateFromControl():(this.savedLatitude=e.DataViewObjects.getValue(u,t.mapProps.mapControls.centerLatitude),this.savedLongitude=e.DataViewObjects.getValue(u,t.mapProps.mapControls.centerLongitude),this.savedZoomLevel=e.DataViewObjects.getValue(u,t.mapProps.mapControls.zoomLevel)),d&&this.persistZoomPanState(),o){this.dataLabelsSettings.precision=e.DataViewObjects.getValue(u,t.filledMapProps.labels.labelPrecision,this.dataLabelsSettings.precision),this.dataLabelsSettings.precision=this.dataLabelsSettings.precision!==t.dataLabelUtils.defaultLabelPrecision&&this.dataLabelsSettings.precision<0?0:this.dataLabelsSettings.precision,this.dataLabelsSettings.displayUnits=e.DataViewObjects.getValue(u,t.filledMapProps.labels.labelDisplayUnits,this.dataLabelsSettings.displayUnits);var h=u.labels;h&&(this.dataLabelsSettings.show=void 0!==h.show?h.show:this.dataLabelsSettings.show,
void 0!==h.color&&(this.dataLabelsSettings.labelColor=h.color.solid.color))}else{this.bubbleSizeMultiplier=a.getBubbleSizeMultiplier(e.DataViewObjects.getValue(u,t.mapProps.bubbles.bubbleSize));var g=u.categoryLabels;g&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(g,this.dataLabelsSettings)}}else this.autoZoomEnabled=!0,this.savedLatitude=void 0,this.savedLongitude=void 0,this.savedZoomLevel=void 0;var f=new t.ColorHelper(this.colors,t.mapProps.dataPoint.fill,this.defaultDataPointColor);l=a.converter({dataView:n,colorHelper:f,geoTaggingAnalyzerService:this.geoTaggingAnalyzerService,isFilledMap:o,bubbleSizeMultiplier:this.bubbleSizeMultiplier}),this.hasDynamicSeries=l.hasDynamicSeries,l.hasDynamicSeries?a.isDynamicSeriesWithoutValuesCase(n)?this.legendData=t.Legend.buildFromFirstMatrixRowLevel(n,f,t.mapProps.general.formatString):this.legendData=t.Legend.buildSeriesLegendData(n,f,t.mapProps.general.formatString):this.legendData={dataPoints:[]},this.dataPointsToEnumerate=this.legendData.dataPoints,this.renderLegend(this.legendData),null!=l?(this.geocodingCategory=l.geocodingCategory,this.mapControlFactory.ensureMap(this.locale,(function(){if(!r.isDestroyed){a.removeHillShading();var e;o&&(e=p.getFilledMapParams(r.geocodingCategory,l.dataPoints.length));for(var t=0,i=l.dataPoints;t<i.length;t++){var n=i[t];if(n.location)o&&!n.paths?r.enqueueGeoShape(n,e):r.addDataPoint(n);else{var s=n.categoryValue;null!=s&&""!==s&&(o?r.enqueueGeoCodeAndGeoShape(n,e):r.enqueueGeoCode(n))}}}}))):this.clearDataPoints(),o&&(this.geocodingCategory&&this.geoTaggingAnalyzerService.isGeoshapable(this.geocodingCategory)||s.push(new t.FilledMapWithoutValidGeotagCategoryWarning))}else this.clearDataPoints(),this.renderLegend({dataPoints:[],title:void 0}),this.dataPointsToEnumerate=[];_.isEmpty(s)||this.host.setWarnings(s),this.dataPointRenderer.setData(l),this.updateInternal(!0,!0)},a.getBubbleSizeMultiplier=function(e){return null!=e?g+e/100*f:g},a.invertBubbleSizeMultiplier=function(e){return Math.round((e-g)/f*100).toString()},a.converter=function(r){if(a.isDynamicSeriesWithoutValuesCase(r.dataView))return a.convertDynamicSeriesWithoutValues(r);var n=e.data.createIDataViewCategoricalReader(r.dataView),o=[],s=n.hasDynamicSeries(),l=n.getSeriesColumnIdentityFields(),u=n.getMeasureQueryName("Size");null==u&&(u="");var c=n.hasValues("Size"),d=null,p=t.mapProps.general.formatString,h=r.colorHelper,g=r.bubbleSizeMultiplier,f=r.isFilledMap;if(n.hasCategories()){var m=[],y=void 0;if(c){for(var v=void 0,w=void 0,b=0,C=n.getCategoryCount();b<C;b++){for(var S=void 0,x=0,P=n.getSeriesCount();x<P;x++){var D=n.getValue("Size",b,x);null==S&&null!=D&&(S=0),null!=S&&(S+=D)}m.push(S),null!=S&&((void 0===v||S<v)&&(v=S),(void 0===w||S>w)&&(w=S))}y=void 0!==v&&void 0!==w?{max:w,min:v}:void 0}var T=n.hasCompositeCategories()&&n.hasCategoryWithRole("X")&&n.hasCategoryWithRole("Y"),V=n.hasCategoryWithRole("Category");if(V&&(d=a.getGeocodingCategory(r.dataView.categorical.categories[0].source,r.geoTaggingAnalyzerService)),T||V)for(var b=0,C=n.getCategoryCount();b<C;b++){var _=void 0,L=V?n.getCategoryObjects("Category",b):n.getCategoryObjects("Y",b),M=void 0,N=void 0,I=void 0,A=void 0,O=void 0,R=void 0,E=void 0;if(V){if(_=t.converterHelper.formatFromMetadataColumn(n.getCategoryValue("Category",b),n.getCategoryMetadataColumn("Category"),p),N={displayName:n.getCategoryDisplayName("Category"),value:_},n.hasValues("Y")&&n.hasValues("X")){var F=n.getFirstNonNullValueForCategory("Y",b),j=n.getFirstNonNullValueForCategory("X",b);null!=F&&null!=j&&(M={latitude:F,longitude:j}),I={displayName:n.getValueDisplayName("Y"),value:t.converterHelper.formatFromMetadataColumn(F,n.getValueMetadataColumn("Y"),p)},A={displayName:n.getValueDisplayName("X"),value:t.converterHelper.formatFromMetadataColumn(j,n.getValueMetadataColumn("X"),p)}}}else{var F=n.getCategoryValue("Y",b),j=n.getCategoryValue("X",b);null!=F&&null!=j&&(_=F+", "+j,M={latitude:F,longitude:j},I={displayName:n.getCategoryDisplayName("Y"),value:t.converterHelper.formatFromMetadataColumn(F,n.getCategoryMetadataColumn("Y"),p)},A={displayName:n.getCategoryDisplayName("X"),value:t.converterHelper.formatFromMetadataColumn(j,n.getCategoryMetadataColumn("X"),p)})}var H=c?m[b]:void 0,G=[],P=n.getSeriesCount();c||s||(P=1);for(var x=0;x<P;x++){var k=void 0,z=void 0;if(!s||c||!a.hasNoValuesAtInteresection(n,["Tooltips","X","Y"],b,x)){s?(k=t.converterHelper.formatFromMetadataColumn(n.getSeriesName(x),n.getSeriesMetadataColumn(),p),z=h.getColorForSeriesValue(n.getSeriesObjects(x),l,k)):z=n.hasCategoryWithRole("Series")?h.getColorForSeriesValue(n.getCategoryObjects("Series",b),n.getCategoryColumnIdentityFields("Series"),_):h.getColorForMeasure(L,u);var U=i.parseColorString(z),B=i.hexString(i.darken(U,a.StrokeDarkenColorValue));U.A=a.innerGeometryAlpha;var W=i.rgbString(U),q=(new t.SelectionIdBuilder).withCategory(n.getCategoryColumn(V?"Category":"Y"),b).withMeasure(u);s&&(q=q.withSeries(n.getSeriesValueColumns(),n.getSeriesValueColumnGroup(x))),s&&(O={displayName:n.getSeriesDisplayName(),value:k});var K=void 0;c&&(K=n.getValue("Size",b,x),R={displayName:n.getValueDisplayName("Size"),value:t.converterHelper.formatFromMetadataColumn(K,n.getValueMetadataColumn("Size",x),p)}),n.hasValues("Gradient")&&(E={displayName:n.getValueDisplayName("Gradient"),value:t.converterHelper.formatFromMetadataColumn(n.getValue("Gradient",b,x),n.getValueMetadataColumn("Gradient",x),p)});var Q=[];N&&Q.push(N),O&&Q.push(O),I&&Q.push(I),A&&Q.push(A),R&&Q.push(R),E&&Q.push(E),t.TooltipBuilder.addTooltipMeasures(n,Q,b,x),(K||!c||0===K&&f)&&G.push({value:K,fill:W,stroke:B,identity:q.createSelectionId(),tooltipInfo:Q})}}(H||!c||0===H&&f)&&o.push({geocodingQuery:_,value:H,categoryValue:_,subDataPoints:G,radius:a.calculateRadius(y,H,g),location:M})}}var Y={dataPoints:o,geocodingCategory:d,hasDynamicSeries:s,hasSize:c};return Y},a.convertDynamicSeriesWithoutValues=function(e){var r=e.dataView.matrix,n=[],o=r.rows.root.children;if(!o)return{dataPoints:[],hasDynamicSeries:!0,geocodingCategory:void 0,hasSize:!1};var s,l,u,c,d,p=o.length,h={},g=0,f=a.calculateRadius(void 0,void 0,e.bubbleSizeMultiplier),m=r.rows.root.childIdentityFields,y=r.rows.levels[0].sources[0],v=t.mapProps.general.formatString,w=r.rows.levels[1];if(null!=w&&!_.isEmpty(w.sources)&&(s=w.sources[w.sources.length-1],w.sources.length>=1)){var b=w.sources[0],C=w.sources[1];b&&b.roles.X?(l=b,c=0):b&&b.roles.Y&&(u=b,d=0),C&&C.roles.X?(l=C,c=1):C&&C.roles.Y&&(u=C,d=1)}for(var S,x=0;x<p;x++){var P=o[x],D=P.children,T=t.converterHelper.formatFromMetadataColumn(P.value,y,t.mapProps.general.formatString),V=e.colorHelper.getColorForSeriesValue(P.objects,m,T),L=i.parseColorString(V),M=i.hexString(i.darken(L,a.StrokeDarkenColorValue));L.A=a.innerGeometryAlpha;var N=i.rgbString(L),I={displayName:y.displayName,value:T};if(s&&s.roles.Category){S=a.getGeocodingCategory(s,e.geoTaggingAnalyzerService);for(var A=0,O=D.length;A<O;A++){var R=D[A],E=t.converterHelper.formatFromMetadataColumn(R.value,s,v),F=(new t.SelectionIdBuilder).withColumnIdentity(R.identity,s.queryName),j=F.createSelectionId().getKey(),H=F.withColumnIdentity(P.identity,y.queryName).createSelectionId(),G=h[j];null==G&&(G=g++,h[j]=G);var k=n[G];k||(k={categoryValue:E,geocodingQuery:E,radius:f,subDataPoints:[],value:void 0},n[G]=k);var z={displayName:s.displayName,value:E},U=[];z&&U.push(z),I&&U.push(I),k.subDataPoints.push({fill:N,stroke:M,identity:H,value:void 0,tooltipInfo:U})}}else if(y&&y.roles.Category&&y.roles.Series){S=a.getGeocodingCategory(y,e.geoTaggingAnalyzerService);var H=(new t.SelectionIdBuilder).withColumnIdentity(P.identity,y.queryName).createSelectionId(),B=H.getKey(),G=h[B];null==G&&(G=g++,h[B]=G);var k=n[G];k||(k={categoryValue:T,geocodingQuery:T,radius:f,subDataPoints:[],value:void 0},n[G]=k);var U=[];I&&U.push(I),k.subDataPoints.push({fill:N,stroke:M,identity:H,value:void 0,tooltipInfo:U})}else{if(!(l&&l.roles.X&&u&&u.roles.Y))return{dataPoints:[],hasDynamicSeries:!0,geocodingCategory:"",hasSize:!1};for(var W=0,q=D.length;W<q;W++){var K=D[W],Q=K.levelValues[c].value,Y=K.levelValues[d].value;if(null!=Y||null!=Q){var J=t.converterHelper.formatFromMetadataColumn(Q,l,v),X=t.converterHelper.formatFromMetadataColumn(Y,u,v),$=void 0,Z=void 0,ee=void 0,U=[],E=X+", "+J,F=(new t.SelectionIdBuilder).withColumnIdentity(K.identity,u.queryName),te=F.createSelectionId().getKey(),H=F.withColumnIdentity(P.identity,y.queryName).createSelectionId();ee={latitude:Y,longitude:Q},$={displayName:u.displayName,value:X},Z={displayName:l.displayName,value:J};var G=h[te];null==G&&(G=g++,h[te]=G);var k=n[G];k||(k={categoryValue:E,geocodingQuery:E,radius:f,subDataPoints:[],value:void 0,location:ee},n[G]=k),I&&U.push(I),$&&U.push($),Z&&U.push(Z),k.subDataPoints.push({fill:N,stroke:M,identity:H,value:void 0,tooltipInfo:U})}}}}return{dataPoints:n,hasDynamicSeries:!0,geocodingCategory:S,hasSize:!1}},a.isDynamicSeriesWithoutValuesCase=function(e){return e.matrix&&!e.categorical},a.hasNoValuesAtInteresection=function(e,t,i,a){for(var r=!1,n=0,o=t;n<o.length;n++){var s=o[n];if(e.hasValues(s)&&(r=!0,!_.all(e.getAllValuesForRole(s,i,a),(function(e){return null==e}))))return!1}return r},a.prototype.swapLogoContainerChildElement=function(){var e=this.element.find(".LogoContainer");if(e){var t=e.find("a");if(null==t)return;var i=$("<div>");t.children().clone().appendTo(i),t.remove(),i.appendTo(e)}},a.prototype.onResizing=function(e){this.currentViewport.width===e.width&&this.currentViewport.height===e.height||(this.currentViewport=e,this.renderLegend(this.legendData),this.updateInternal(!1,!1))},a.prototype.initialize=function(e){var i=this,o={credentials:t.MapUtil.Settings.BingKey,showMapTypeSelector:!1,enableClickableLogo:!1,enableSearchLogo:!1,mapTypeId:n.Maps.MapTypeId.road,customizeOverlays:!0,showDashboard:!1,showScalebar:!1,disableKeyboardInput:!0,disableZooming:this.disableZooming,disablePanning:this.disablePanning},s=this.root=r.DomFactory.div().addClass(a.MapContainer.cssClass).appendTo(e);this.mapControl=this.mapControlFactory.createMapControl(s[0],o),void 0!==this.viewChangeThrottleInterval?n.Maps.Events.addThrottledHandler(this.mapControl,"viewchange",(function(){i.onViewChanged()}),this.viewChangeThrottleInterval):n.Maps.Events.addHandler(this.mapControl,"viewchange",(function(){i.onViewChanged()})),n.Maps.Events.addHandler(this.mapControl,"viewchangeend",(function(){i.onViewChangeEnded()})),this.dataPointRenderer.init(this.mapControl,s,!!this.behavior,this.tooltipService),this.pendingGeocodingRender||this.updateInternal(!0,!0)},a.prototype.onViewChanged=function(){this.updateOffsets(!1,!1),this.behavior&&this.behavior.viewChanged(),this.swapLogoContainerChildElement()},a.prototype.onViewChangeEnded=function(){this.autoZoomEnabled===!1&&(this.updateZoomPanStateFromControl(),this.persistZoomPanState()),this.dataPointRenderer.updateInternalDataLabels(this.currentViewport,!0)},a.prototype.getMapViewPort=function(){var e=this.currentViewport,t=this.legend.getMargins(),i={width:e.width-t.width,height:e.height-t.height};return i},a.prototype.updateInternal=function(e,t){if(this.mapControl){var i=this.legend.isVisible();i||(this.legendData={dataPoints:[]});var r=this.element.children(a.MapContainer.selector),o=this.getMapViewPort();if(r.height(o.height),r.width(o.width),this.updateOffsets(e,t),!this.behavior||!this.behavior.hasReceivedZoomOrPanEvent())if(this.autoZoomEnabled===!1)this.updateMapView(new n.Maps.Location(this.savedLatitude,this.savedLongitude),this.savedZoomLevel);else if(this.boundsHaveBeenUpdated){var s=this.getOptimumLevelOfDetail(o.width,o.height),l=this.getViewCenter(s);this.updateMapView(l,s)}}},a.prototype.updateMapView=function(e,t){this.mapControl.setView({center:e,zoom:t,animate:!0})},a.prototype.updateOffsets=function(e,i){var a,r=this.dataView,n=this.getMapViewPort();a=r?this.dataPointRenderer.converter(n,this.dataLabelsSettings,this.interactivityService,this.tooltipsEnabled):{bubbleData:[],shapeData:[],sliceData:[]};var o=this.dataPointRenderer.updateInternal(a,n,e,this.interactivityService,i);t.Legend.positionChartArea(d3.select(this.root[0]),this.legend),this.interactivityService&&o&&this.interactivityService.bind(o.dataPoints,this.behavior,o)},a.prototype.onClearSelection=function(){this.interactivityService.clearSelection(),this.updateOffsets(!1,!1)},a.prototype.clearDataPoints=function(){this.dataPointRenderer.clearDataPoints(),this.legend.drawLegend({dataPoints:[]},this.currentViewport)},a.removeHillShading=function(){n.Maps.Globals.roadUriFormat=n.Maps.Globals.roadUriFormat.replace("&shading=hill","")},a.prototype.updateZoomPanStateFromControl=function(){var e=this.mapControl.getCenter();this.savedLatitude=e.latitude,this.savedLongitude=e.longitude,this.savedZoomLevel=this.mapControl.getZoom()},a.prototype.persistZoomPanState=function(){if(1===this.host.getViewMode())if(this.autoZoomEnabled){var e={replace:[{objectName:"mapControls",properties:{autoZoom:this.autoZoomEnabled},selector:null}]};this.host.persistProperties(e)}else{var e={replace:[{objectName:"mapControls",properties:{centerLatitude:this.savedLatitude,centerLongitude:this.savedLongitude,zoomLevel:this.savedZoomLevel,autoZoom:this.autoZoomEnabled},selector:null}]};this.host.persistProperties(e)}},a.MapContainer={cssClass:"mapControl",selector:".mapControl"},a.innerGeometryAlpha=.6,a.StrokeDarkenColorValue=63.75,a.ScheduleRedrawInterval=3e3,a})();t.Map=m;var y=(function(){function e(e,i,a){void 0===a&&(a=!0),this.mapControl=e,this.tooltipService=i,this.inertia=new t.Inertia(null,a),this.inertia.callback=function(i,a){return t.MapUtil.moveMapDelta(e,i,a)}}return e.prototype.onMouseDown=function(i){var a=this,r=e.getMousePosition(),n=r,o=d3.select(i),s=!1,u=0,c=this.inertia;c.hasStarted()&&c.stop();var d=d3.select(window).on(e.Events.mouseMove,(function(){var i=e.getMousePosition(),r=e.getDelta(n,i),l=r[0],d=r[1];s||(u+=Math.abs(l)+Math.abs(d),u>e.DragPixelThreshold&&(s=!0,o.classed(e.DraggingCSS.class,!0),a.tooltipService.hide())),c.addPoint(i[0],i[1]),t.MapUtil.moveMapDelta(a.mapControl,l,d),n=i})).on(e.Events.mouseup,(function(){if(d.on(e.Events.mouseMove,null).on(e.Events.mouseup,null),s){var t=e.getMousePosition();c.addPoint(t[0],t[1]),o.classed(e.DraggingCSS.class,!1);var i=d3.event.target;i===o.node()&&o.on(e.Events.click,(function(){l.markAsHandled(d3.event),o.on(e.Events.click,null)})),c.start()}}))},e.getMousePosition=function(){var t=e.BodyNode=e.BodyNode||d3.select("body").node();return d3.mouse(t)},e.getDelta=function(e,t){var i=t[0]-e[0],a=t[1]-e[1];return[i,a]},e.DragPixelThreshold=5,e.Events={mouseDown:"mousedown.mapDrag",mouseMove:"mousemove.mapDrag",mouseup:"mouseup.mapDrag",click:"click.mapDrag"},e.DraggingCSS=o("dragging-cursor"),e})();t.MapItemMouseEventHandler=y})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){e.append("div").classed("imgCon",!0).append("img")}function r(e,t){e.selectAll(".imgCon").style({height:n(t.maxHeight)}).selectAll("img").style({"max-height":n(t.maxHeight),"max-width":n(t.maxWidth)})}function n(e){return e+"px"}var o=e.visuals.KpiUtil.getKpiImageMetadata,s=a.CssConstants.createClassAndSelector,l=a.PixelConverter,u=a.UrlUtils,c=e.visuals.controls.internal.TablixUtils.EdgeSettings,d=t.Font.Family.semibold.css,p=t.Font.Family.regular.css,h=10,g=13,f=9,m="#767676",y="#333333",v="#ACACAC",w=t.outline.none,b="#E8E8E8",C=1,S=!0,x="#A6A6A6",P=t.outline.leftOnly,D=3,T=(function(){function a(){this.isInteractivityOverflowHidden=!1}return a.prototype.init=function(e){this.options=e,this.style=e.style;var t=this.currentViewport=e.viewport,i=this.interactivity=e.interactivity;i&&"hidden"===i.overflow&&(this.isInteractivityOverflowHidden=!0);var r=this.element=$("<div/>").addClass(a.MultiRowCardRoot.class).css({height:n(t.height)});e.element.append(r),this.initializeCardRowSelection()},a.prototype.onDataChanged=function(i){var r=i.dataViews;if(r&&r.length>0){var n=this.dataView=r[0],o=n.table.columns,s=n.table.rows,l=i.operationKind!==e.VisualDataChangeOperationKind.Append,u=this.data=a.converter(n,o.length,s.length,this.isInteractivityOverflowHidden);this.setCardDimensions(),this.listView.data(u.dataModel,(function(e){return u.dataModel.indexOf(e)}),l)}else this.data={dataModel:[],dataColumnCount:0,cardTitleSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,m,g),categoryLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,v,f),dataLabelsSettings:t.dataLabelUtils.getDefaultLabelSettings(!0,y,h),cardSettings:a.getCardSettings(null)};this.waitingForData=!1},a.getCardSettings=function(i){var r=i&&i.metadata&&i.metadata.objects?i.metadata.objects:null,n={outline:e.DataViewObjects.getValue(r,t.multiRowCardProps.card.outline,w),color:e.DataViewObjects.getFillColor(r,t.multiRowCardProps.card.outlineColor,b),weight:e.DataViewObjects.getValue(r,t.multiRowCardProps.card.outlineWeight,C)},o=e.DataViewObjects.getValue(r,t.multiRowCardProps.card.barShow,S),s={outline:o?P:t.outline.none,color:e.DataViewObjects.getFillColor(r,t.multiRowCardProps.card.barColor,x),weight:e.DataViewObjects.getValue(r,t.multiRowCardProps.card.barWeight,D)},l=e.DataViewObjects.getValue(r,t.multiRowCardProps.card.cardPadding,a.DefaultStyle.row.marginBottom),u=e.DataViewObjects.getFillColor(r,t.multiRowCardProps.card.cardBackground,a.DefaultStyle.row.background);return{outlineSettings:n,barSettings:s,cardPadding:l,cardBackground:u}},a.prototype.onResizing=function(e){var t=this.currentViewport.height===e.height;if(this.currentViewport=e,this.element.css("height",n(e.height)),this.dataView){var i=this.maxColPerRow;this.maxColPerRow=this.getMaxColPerRow();var a=i===this.maxColPerRow;t&&a||this.listView.viewport(e)}},a.converter=function(i,r,n,s){void 0===s&&(s=!1);var l,c,d,p=[],w=i.table.rows,b=i.table.columns;if(l=t.dataLabelUtils.getDefaultLabelSettings(!0,m,g),c=t.dataLabelUtils.getDefaultLabelSettings(!0,y,h),d=t.dataLabelUtils.getDefaultLabelSettings(!0,v,f),i.metadata&&i.metadata.objects){var C=e.DataViewObjects.getObject(i.metadata.objects,"cardTitle");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(C,l);var S=e.DataViewObjects.getObject(i.metadata.objects,"dataLabels");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(S,c);var x=e.DataViewObjects.getObject(i.metadata.objects,"categoryLabels");t.dataLabelUtils.updateLabelSettingsFromLabelsObject(x,d)}for(var P=0,D=n;P<D;P++){for(var T=w[P],V=null,_=!0,L=void 0,M=!1,N=!1,I=!1,A=[],O=0;O<r;O++){var R=b[O],E=o(R,T[O]),F=void 0,j=void 0;E&&(F=E.class,j=E.statusGraphic),F||(F=t.valueFormatter.format(T[O],t.valueFormatter.getFormatString(R,a.formatStringProp)));var H=void 0!==E&&void 0!==E.caption,G=b[O].displayName;!_||s||R.type.numeric||(null==V?(V=O,L=F,M=t.converterHelper.isWebUrlColumn(R)&&u.isValidUrl(L),N=t.converterHelper.isImageUrlColumn(R)&&u.isValidImageUrl(F),I=H):null!=V&&(_=!1,V=null)),A.push({caption:F,details:G,showURL:t.converterHelper.isWebUrlColumn(R)&&u.isValidUrl(F),showImage:t.converterHelper.isImageUrlColumn(R)&&u.isValidImageUrl(F),showKPI:H,columnIndex:O})}if(null!=V){for(var k=A.slice(0,V),z=A.slice(V+1),U=0,B=z;U<B.length;U++){var W=B[U];W.columnIndex--}A=k.concat(z)}p.push({title:null!=V?L:void 0,showTitleAsURL:M,showTitleAsImage:N,showTitleAsKPI:I,cardItemsData:A})}return{dataModel:p,dataColumnCount:p[0]?p[0].cardItemsData.length:0,cardTitleSettings:l,categoryLabelsSettings:d,dataLabelsSettings:c,cardSettings:a.getCardSettings(i)}},a.getSortableRoles=function(e){if(e&&e.dataViewMappings&&!_.isEmpty(e.dataViewMappings))for(var t=0,i=e.dataViewMappings;t<i.length;t++){var r=i[t];if(r.table){var n=r.table.rows;if(n&&n.for&&n.for.in&&n.for.in.items)return[a.ValuesRole]}}},a.prototype.initializeCardRowSelection=function(){var o=this,s=this.isInteractivityOverflowHidden,u=function(e){var t=e.append("div").classed(a.Card.class,!0);s?t.classed("mrtile",!0):o.cardHasTitle&&t.append("div").classed(a.Title.class,!0).each((function(e){e.showTitleAsImage?i(d3.select(this)):e.showTitleAsURL?d3.select(this).append("a"):e.showTitleAsKPI&&d3.select(this).append("div").classed(a.KPITitle.class,!0).classed(e.title,!0).style({display:"inline-block",verticalAlign:"sub"})}));var r=t.selectAll(a.CardItemContainer.selector).data((function(e){return e.cardItemsData})).enter().append("div").classed(a.CardItemContainer.class,!0);r.append("div").classed(a.Caption.class,!0).each((function(e){e.showURL?d3.select(this).append("a"):e.showImage?i(d3.select(this)):e.showKPI&&d3.select(this).append("div").classed(e.caption,!0).style({display:"inline-block",verticalAlign:"sub"})})),r.append("div").classed(a.Details.class,!0)},c=function(t){var i=o.getStyle(),u=e.TextMeasurementService.estimateSvgTextHeight(a.getTextProperties(!1,i.caption.fontSize)),c=e.TextMeasurementService.estimateSvgTextHeight(a.getTextProperties(!1,i.details.fontSize)),d=e.TextMeasurementService.estimateSvgTextHeight(a.getTextProperties(!0,i.title.fontSize)),p=o.getBorderStyles(i.row.border,i.row.padding);t.style(p).style({"margin-bottom":s?"0px":o.isSingleRowCard?"0px":n(i.row.marginBottom),background:i.row.background}),!s&&o.cardHasTitle&&(t.selectAll(a.Title.selector).filter((function(e){return!e.showTitleAsImage&&!e.showTitleAsKPI})).style({"font-size":l.fromPoint(i.title.fontSize),"line-height":l.toString(d),color:i.title.color}),t.selectAll(a.Title.selector).filter((function(e){return!e.showTitleAsURL&&!e.showTitleAsImage&&!e.showTitleAsKPI})).text((function(e){return e.title})).attr("title",(function(e){return e.title})),t.selectAll(a.TitleUrlSelector).text((function(e){return e.title})).attr({href:function(e){return e.title},target:"_blank",rel:"noopener noreferrer"}),t.selectAll(a.TitleImageSelector).attr("src",(function(e){return e.title})),r(t.selectAll(a.Title.selector),i.imageTitle),t.selectAll(a.KPITitle.selector).each((function(e){var t=d3.select(this);t.classed(e.title)})));var h=t.selectAll(a.Card.selector),g=o.getBorderStyles(i.card.border,i.card.padding);h.style(g),h.selectAll(a.Caption.selector).filter((function(e){return!e.showImage})).style({"line-height":l.toString(u),"font-size":l.fromPoint(i.caption.fontSize)}).filter((function(e){return!e.showKPI})).style({color:i.caption.color}).filter((function(e){return!e.showURL})).text((function(e){return e.caption})).attr("title",(function(e){return e.caption})),h.selectAll(a.CaptionImageSelector).attr("src",(function(e){return e.caption})).style(i.imageCaption);var f=n(i.cardItemContainer.padding.top);h.selectAll(a.CardItemContainer.selector).style({"padding-top":function(e){return o.isInFirstRow(e.columnIndex)?"":f},"padding-right":function(e){return o.isLastRowItem(e.columnIndex,o.dataView.metadata.columns.length)?"0px":n(i.cardItemContainer.paddingRight)},width:function(e){return o.getColumnWidth(e.columnIndex,o.data.dataColumnCount)}}),r(h.selectAll(a.Caption.selector),i.imageCaption),h.selectAll(a.CaptionUrlSelector).attr({href:function(e){return e.caption},target:"_blank",rel:"noopener noreferrer"}).text((function(e){return e.caption})),i.details.isVisible&&h.selectAll(a.Details.selector).text((function(e){return e.details})).style({"font-size":l.fromPoint(i.details.fontSize),"line-height":l.toString(c),color:i.details.color}).attr("title",(function(e){return e.details}))},d=function(e){e.remove()},p={rowHeight:void 0,enter:u,exit:d,update:c,loadMoreData:function(){return o.onLoadMoreData()},viewport:this.currentViewport,baseContainer:d3.select(this.element.get(0)),scrollEnabled:!this.isInteractivityOverflowHidden,isReadMode:function(){return 1!==o.options.host.getViewMode()}};this.listView=t.ListViewFactory.createListView(p)},a.prototype.getBorderStyles=function(e,t){var i={top:null!=e&&null!=e.top,right:null!=e&&null!=e.right,bottom:null!=e&&null!=e.bottom,left:null!=e&&null!=e.left},a={top:null!=t&&null!=t.top,right:null!=t&&null!=t.right,bottom:null!=t&&null!=t.bottom,left:null!=t&&null!=t.left};return{"border-top":i.top?e.top.getCSS():"","border-right":i.right?e.right.getCSS():"","border-bottom":i.bottom?e.bottom.getCSS():"","border-left":i.left?e.left.getCSS():"","padding-top":i.top&&a.top?n(t.top):"","padding-right":i.right&&a.right?n(t.right):"","padding-bottom":i.bottom&&a.bottom?n(t.bottom):"","padding-left":i.left&&a.left?n(t.left):""}},a.prototype.getMaxColPerRow=function(){var e=this.currentViewport.width,t=this.getStyle().cardItemContainer.minWidth,i=this.data.dataColumnCount,a=Math.floor(e/t)||1;return Math.min(i,a)},a.prototype.getRowIndex=function(e){return Math.floor(1*e/this.getMaxColPerRow())},a.prototype.getStyle=function(){var e=a.DefaultStyle,t=this.getCustomStyles();if(!this.isInteractivityOverflowHidden)return $.extend(!0,{},e,t);for(var i=this.currentViewport.width,r={},n=0,o=a.tileMediaQueries;n<o.length;n++){var s=o[n];if(i<=s.maxWidth){r=s.style;break}}return $.extend(!0,{},e,t,r)},a.prototype.getSurroundSettings=function(e){var i=new c(e.weight,e.color),a=e.outline;return{top:t.outline.showTop(a)?i:null,right:t.outline.showRight(a)?i:null,bottom:t.outline.showBottom(a)?i:null,left:t.outline.showLeft(a)?i:null}},a.prototype.getCustomStyles=function(){var e=this.data.dataLabelsSettings,t=this.data.categoryLabelsSettings,i=this.data.cardTitleSettings,a=this.data.cardSettings,r={row:{border:this.getSurroundSettings(a.outlineSettings),marginBottom:a.cardPadding,background:a.cardBackground},card:{border:this.getSurroundSettings(a.barSettings)},details:{fontSize:t.fontSize,color:t.labelColor,isVisible:t.show},caption:{fontSize:e.fontSize,color:e.labelColor},title:{fontSize:i.fontSize,color:i.labelColor}};return r},a.getTextProperties=function(e,t){return{fontFamily:e?d:p,fontSize:l.fromPoint(t)}},a.prototype.getColumnWidth=function(e,t){var i=this.getMaxColPerRow();if(i>=t)return 100/t+"%";var a=this.getRowIndex(e),r=Math.ceil(1*t/i),n=t%i;return a<r||0===n?100/i+"%":100/n+"%"},a.prototype.isLastRowItem=function(e,t){if(e+1===t)return!0;var i=this.getMaxColPerRow();return i-e%i===1},a.prototype.isInFirstRow=function(e){return e<this.getMaxColPerRow()},a.prototype.setCardDimensions=function(){this.cardHasTitle=!1;var e=this.data.dataModel;!this.isInteractivityOverflowHidden&&e&&e.length>0&&(this.cardHasTitle=void 0!==e[0].title,this.isSingleRowCard=1===e.length)},a.prototype.onLoadMoreData=function(){!this.waitingForData&&this.dataView.metadata&&this.dataView.metadata.segment&&(this.options.host.loadMoreData(),this.waitingForData=!0)},a.getDataLabelSettingsOptions=function(e,t,i){return void 0===i&&(i=!1),{enumeration:e,dataLabelsSettings:t,show:i,fontSize:!0}},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder,r=this.data.cardTitleSettings,n=this.data.dataLabelsSettings,o=this.data.categoryLabelsSettings;switch(e.objectName){case"cardTitle":!this.isInteractivityOverflowHidden&&this.cardHasTitle&&t.dataLabelUtils.enumerateDataLabels(a.getDataLabelSettingsOptions(i,r));break;case"dataLabels":t.dataLabelUtils.enumerateDataLabels(a.getDataLabelSettingsOptions(i,n));break;case"categoryLabels":t.dataLabelUtils.enumerateDataLabels(a.getDataLabelSettingsOptions(i,o,!0));break;case t.multiRowCardProps.card.outline.objectName:this.enumerateCard(i)}return i.complete()},a.prototype.enumerateCard=function(e){var i=this.data.cardSettings,a=t.multiRowCardProps.card,r={},n=i.outlineSettings;r[a.outline.propertyName]=n.outline,n.outline!==t.outline.none&&(r[a.outlineColor.propertyName]=n.color,r[a.outlineWeight.propertyName]=n.weight);var o=i.barSettings,s=o.outline!==t.outline.none;r[a.barShow.propertyName]=s,s&&(r[a.barColor.propertyName]=o.color,r[a.barWeight.propertyName]=o.weight),r[a.cardPadding.propertyName]=i.cardPadding,r[a.cardBackground.propertyName]=i.cardBackground,e.pushInstance({selector:null,objectName:a.outline.objectName,properties:r})},a.formatStringProp={objectName:"general",propertyName:"formatString"},a.MultiRowCardRoot=s("multiRowCard"),a.Card=s("card"),a.Title=s("title"),a.CardItemContainer=s("cardItemContainer"),a.Caption=s("caption"),a.Details=s("details"),a.TitleUrlSelector=a.Title.selector+" a",a.CaptionUrlSelector=a.Caption.selector+" a",a.TitleImageSelector=a.Title.selector+" img",a.CaptionImageSelector=a.Caption.selector+" img",a.KPITitle=s("kpiTitle"),a.ValuesRole="Values",a.DefaultStyle={row:{border:null,marginBottom:20,background:void 0,padding:{top:5,right:5,bottom:5,left:5}},card:{border:null,padding:{top:10,right:10,bottom:10,left:10}},cardItemContainer:{paddingRight:20,minWidth:120,padding:{top:7}},imageCaption:{maxHeight:75,maxWidth:100},imageTitle:{maxHeight:75,maxWidth:100}},a.tileMediaQueries=[{maxWidth:250,style:{cardItemContainer:{minWidth:110},imageCaption:{maxHeight:45}}},{maxWidth:490,style:{cardItemContainer:{minWidth:130},imageCaption:{maxHeight:52}}},{maxWidth:750,style:{cardItemContainer:{minWidth:120},imageCaption:{maxHeight:53}}},{maxWidth:Number.MAX_VALUE,style:{cardItemContainer:{padding:{top:5}}}}],a})();t.MultiRowCard=T})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i=a.CssConstants.createClassAndSelector,n=a.KeyUtils,o=a.StringExtensions,s=a.UrlUtils,l=(function(){function e(e){e&&e.viewModelAdapter&&(this.viewModelAdapter=e.viewModelAdapter)}return e.prototype.init=function(e){this.element=e.element,this.host=e.host,this.viewport=e.viewport,this.readOnly=0===this.host.getViewMode(),this.paragraphs=[],this.refreshView()},e.prototype.onResizing=function(e){var t=this.viewport;this.viewport=e,this.updateSize(),this.viewModelAdapter&&this.viewModelAdapter.onResizing(this.element,this.viewport,t)},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(this.paragraphs=[],t&&t.length>0){var i=t[0].metadata.objects;i&&i.general&&(this.paragraphs=i.general.paragraphs)}this.refreshView()},e.prototype.destroy=function(){},e.prototype.focus=function(){if(this.editor)return this.editor.focus(),!0},e.prototype.onViewModeChanged=function(e){this.readOnly=0===e,this.refreshView()},e.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t)},e.prototype.refreshView=function(){var t=this;if(this.readOnly){this.editor&&(this.saveContents(),this.editor.destroy(),this.editor=null),this.element.empty();var i=c.convertParagraphsToHtml(this.paragraphs),a=$("<div>").addClass(e.ClassAndSelector.class).css({"font-family":d.defaultFont,"font-size":d.defaultFontSize}).append(i);this.viewModelAdapter&&this.viewModelAdapter.onDataChanged(a,this.viewport),this.element.append(a)}else{if(!this.editor){this.editor=new d.QuillWrapper(this.readOnly,this.host),this.editor.textChanged=function(){return t.saveContents()},this.element.empty();var r=this.editor.getElement();r.addClass(e.ClassAndSelector.class),r.css({"font-family":d.defaultFont,"font-size":d.defaultFontSize}),this.element.append(r)}this.editor.setContents(c.convertParagraphsToOps(this.paragraphs))}this.updateSize()},e.prototype.saveContents=function(){if(this.editor){var e=this.editor.getContents();this.paragraphs=c.convertDeltaToParagraphs(e);var t=[{objectName:"general",properties:{paragraphs:this.paragraphs},selector:null}];this.host.persistProperties(t)}},e.prototype.updateSize=function(){this.editor&&this.editor.resize(this.viewport)},e.ClassAndSelector=a.CssConstants.createClassAndSelector("textbox"),e})();t.Textbox=l;var u;!(function(e){var t=(function(){function e(e){this.smallViewportProperties=e}return e.prototype.onResizing=function(e,t,i){var a=this.isSmallViewport(i),r=this.isSmallViewport(t);a!==r&&this.applyScaleOnElement(e,r)},e.prototype.onDataChanged=function(e,t){this.isSmallViewport(t)&&this.applyScaleOnElement(e,!0)},
e.prototype.isSmallViewport=function(e){return!!e&&!!this.smallViewportProperties&&(e.height<=this.smallViewportProperties.minHeightToScaleFontSize||e.width<=this.smallViewportProperties.minWidthToScaleFontSize)},e.prototype.applyScaleOnElement=function(t,i){t.find(l.ClassAndSelector.selector).css({"font-size":i?e.scale(d.defaultFontSize):d.defaultFontSize}),t.find(c.TextRunElement.selector).each((function(t,a){var r,n=$(a).css("font-size")||d.defaultFontSize;if(i)r=e.scale(n);else{var o=$(a).data(c.ModelKeyName);r=o.textStyle&&o.textStyle.fontSize?o.textStyle.fontSize:d.defaultFontSize}$(a).css({"font-size":d.getCssFontSize(r)})}))},e.scale=function(e){var t,i=parseInt(e.slice(0,-2),10);return t=i>66?32:i>42?28:i>26?24:i>16?20:i>11?14:12,a.PixelConverter.toString(t)},e})();e.ViewModelAdapter=t;var i=(function(e){function t(){e.call(this,{minHeightToScaleFontSize:1/0,minWidthToScaleFontSize:1/0})}return r(t,e),t})(t);e.AlwaysUseSmallViewport=i})(u=t.TextboxHelpers||(t.TextboxHelpers={}));var c;!(function(e){function i(e){for(var t=[],i={textRuns:[]},a=0,r=e.ops.length;a<r;a++){var o=e.ops[a];if("string"==typeof o.insert){var l=o.insert,u=o.attributes;u&&u.align&&(i.horizontalTextAlignment=u.align);var c=0,d=0,p=void 0;do{if(d=l.indexOf("\n",c),d<0?(p=!1,d=l.length):p=!0,d-c>0){var h=l.substring(c,d),g={value:h};if(u){void 0!==u.link&&s.isValidUrl(u.link)&&(g.url=u.link);var f=n(u);f&&(g.textStyle=f)}i.textRuns.push(g)}p&&(0===i.textRuns.length&&i.textRuns.push({value:""}),t.push(i),i={textRuns:[]}),c=d+1}while(c<l.length)}}return i.textRuns.length>0&&i.textRuns[0].value.length>0&&t.push(i),t}function a(t){for(var i=$(),a=0,r=t.length;a<r;++a){var n=t[a],o=!0,l=$("<p>").data(e.ModelKeyName,n);n.horizontalTextAlignment&&l.css("text-align",n.horizontalTextAlignment);for(var u=0,c=n.textRuns.length;u<c;++u){var p=n.textRuns[u],h=$(e.TextRunElement.name).data(e.ModelKeyName,p),g=p.textStyle;if(g){var f={};g.fontFamily&&(f["font-family"]=d.getCssFontFamily(g.fontFamily)),g.fontSize&&(f["font-size"]=d.getCssFontSize(g.fontSize)),g.fontStyle&&(f["font-style"]=g.fontStyle),g.fontWeight&&(f["font-weight"]=g.fontWeight),g.textDecoration&&(f["text-decoration"]=g.textDecoration),h.css(f)}var m=p.value;if(_.isEmpty(m)||(o=!1),void 0!==p.url){var y=void 0;y=s.isValidUrl(p.url)?$("<a>").attr("href",p.url).attr("rel","noopener noreferrer").attr("target","_blank").text(m):$("<span>").text(m),h.append(y)}else h.text(m);l.append(h)}o&&l.append($("<br>")),i=i.add(l)}return i}function r(e){for(var i=[],a=0,r=e.length;a<r;++a)for(var n=e[a],u=0,c=n.textRuns.length;u<c;++u){var p=n.textRuns[u],h={};n.horizontalTextAlignment&&(h.align=n.horizontalTextAlignment);var g=p.textStyle;g&&(g.fontFamily&&(h.font=t.Font.normalizeFamily(d.getCssFontFamily(l(g.fontFamily)))),g.fontSize&&(h.size=g.fontSize),h.italic="italic"===g.fontStyle||void 0,h.bold="bold"===g.fontWeight||void 0,h.underline="underline"===g.textDecoration||void 0);var f=p.value;p.url&&s.isValidUrl(p.url)&&(h.link=p.url);var m={insert:f,attributes:h};i.push(m),u!==c-1||o.endsWith(f,"\n")||i.push({insert:"\n",attributes:h})}return i}function n(e){var i={};if(e.bold&&(i.fontWeight="bold"),e.font){var a=t.Font.normalizeFamily(_.unescape(e.font),!1);a=d.getFontFamilyForBuiltInFont(a),i.fontFamily=a}return e.italic&&(i.fontStyle="italic"),e.size&&(i.fontSize=e.size),e.underline&&(i.textDecoration="underline"),i}function l(e){return!o.startsWith(e,"'")||o.containsIgnoreCase(e,",")?e:e.slice(1,e.length-1)}e.ModelKeyName="ModelObject",e.TextRunElement={name:"<span>",selector:"span"},e.convertDeltaToParagraphs=i,e.convertParagraphsToHtml=a,e.convertParagraphsToOps=r})(c||(c={}));var d;!(function(r){function s(e){var t=c[e]||e;return t!==r.defaultFont?t:void 0}function l(e){var t=_.findKey(c,(function(t){return t===e||t.indexOf(e)>0}));return t||e}function u(e){return e!==r.defaultFontSize?e:""}var c={"Segoe (Bold)":t.Font.Family.bold.family,"Segoe UI":t.Font.Family.regular.family,"Segoe UI Light":t.Font.Family.light.family,Heading:t.Font.Family.light.family,Body:t.Font.Family.regular.family},d=["Arial","Arial Black","Arial Unicode MS","Calibri","Cambria","Cambria Math","Candara","Comic Sans MS","Consolas","Constantia","Corbel","Courier New","Georgia","Lucida Sans Unicode","Segoe (Bold)","Segoe UI","Segoe UI Light","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Wingdings"].map((function(e){return{label:e,value:c[e]||e}}));r.defaultFont=s("Segoe UI Light");var p=[8,9,10,10.5,11,12,14,16,18,20,24,28,32,36,40,42,44,54,60,66,72,80,88,96].map((function(e){return{label:""+e,value:e+"px"}}));r.defaultFontSize="14px";var h="Left",g=["Left","Center","Right"].map((function(e){var t=e.toLowerCase();return{label:e,value:e===h?"":t,glyph:"align"+t}}));r.getCssFontFamily=s,r.getFontFamilyForBuiltInFont=l,r.getCssFontSize=u;var f=(function(){function i(e,t){var r=this;this.QuillPackage={javaScriptFiles:i.quillJsFiles,cssFiles:i.quillCssFiles},this.textChanged=_.noop,this.host=t,this.$container=$("<div>"),this.readOnly=e,this.localizationProvider={get:function(e){return r.host.getLocalizedString(e)},getOptional:function(e){return r.host.getLocalizedString(e)}},this.dependenciesLoaded=$.Deferred(),i.loadQuillResources?(this.initialized=!1,this.dependenciesLoaded.done((function(){r.rebuildQuillEditor(),r.initialized=!0})),a.requires(this.QuillPackage,(function(){return r.dependenciesLoaded.resolve()}))):(this.rebuildQuillEditor(),this.initialized=!0,this.dependenciesLoaded.resolve())}return i.prototype.getElement=function(){return this.$container},i.prototype.getContents=function(){if(this.initialized)return this.editor.getContents()},i.prototype.setContents=function(e){var t=this;return this.initialized?(this.editor.deleteText(0,this.editor.getLength()),void(e&&this.editor.setContents(e))):void this.dependenciesLoaded.done((function(){return t.setContents(e)}))},i.prototype.resize=function(e){this.$container.width(e.width),this.$container.height(e.height)},i.prototype.setReadOnly=function(e){var t=e!==this.readOnly;this.readOnly=e,this.initialized&&t&&this.rebuildQuillEditor()},i.prototype.setSelection=function(e,t){this.editor&&this.editor.setSelection(e,t)},i.prototype.getSelection=function(e){if(this.editor)return this.editor.getSelection(e)},i.prototype.focus=function(){this.editor&&0===$(document.activeElement).closest(this.$container).length&&this.editor.focus()},i.prototype.destroy=function(){this.host.setToolbar(null),this.$container.remove(),this.$container=null,this.$toolbarDiv=null,this.$editorDiv=null,this.editor=null},i.prototype.getSelectionAtCursor=function(){var e=this.getTextWithoutTrailingBreak(),t=this.getSelection(!0);if(t&&0===t.length){var i=a.WordBreaker.find(t.index,e);return{index:i.start,length:i.end-i.start}}return t},i.prototype.getWord=function(){var e=this.getSelectionAtCursor();return this.getTextWithoutTrailingBreak().slice(e.index,e.index+e.length)},i.prototype.getEditorContainer=function(){if(this.editor)return $(this.editor.container)},i.prototype.getTextWithoutTrailingBreak=function(){return this.editor.getText().slice(0,-1)},i.prototype.rebuildQuillEditor=function(){var e=this,a=null;this.editor&&(a=this.editor.getContents()),this.$container.empty(),this.$container.keydown((function(e){var t=e.which;e.ctrlKey&&n.isCtrlShortcutKey(t)&&e.stopPropagation(),(n.isArrowKey(t)||n.isNudgeModifierKey(t))&&e.stopPropagation(),n.isDeleteKey(t)&&e.stopPropagation()}));var r=this.$editorDiv=$("<div>"),s={readOnly:this.readOnly,formats:["bold","italic","underline","font","size","link","align"],modules:{history:{userOnly:!0}}},l=m.buildToolbarLinkInputTemplate(this.localizationProvider),u=m.LinkInput.buildNode(l);if(!this.readOnly){var c=this.$toolbarDiv;c||(this.$toolbarDiv=c=m.buildToolbar(this,this.localizationProvider,u)),c.addClass("unselectable"),this.host.setToolbar(c),s.modules.toolbar={container:c.get(0)},r.attr("drag-resize-disabled","true")}if(this.editor=new Quill(r.get(0),s),!this.readOnly){var d=new m.LinkInput(u,this.editor,l),p=function(t){t?(e.editor.setSelection(e.getSelectionAtCursor()),d.open()):d.remove()},h=Quill.import("parchment"),g=Quill.import("formats/font");g.value=function(e){var a=i.camelize(g.keyName);return _.escape(t.Font.normalizeFamily(e.style[a]))},g.canAdd=function(e,i){var a=h.query(e,h.Scope.BLOT&(g.scope|h.Scope.TYPE));return null!=a&&(null==g.whitelist||g.whitelist.indexOf(t.Font.normalizeFamily(_.unescape(i)))>-1)},g.add=function(e,a){if(!g.canAdd(e,a))return!1;var r=i.camelize(g.keyName),n=t.Font.normalizeFamily(_.unescape(a));return e.style[r]=n,!0};var f=this.editor.getModule("toolbar");f.addHandler("link",p)}this.$container.append(r),a&&this.setContents(a);var y=_.debounce((function(){return e.onTextChanged()}),i.textChangeThrottle);this.editor.on("text-change",(function(t,a,r){if("api"!==r){for(var n=0,s=t.ops;n<s.length;n++){var l=s[n];if(i.isInsertOp(l)){var u=l.insert;if(u&&o.containsWhitespace(u))return e.onTextChanged(),void y.cancel()}}y()}})),this.editor.root.addEventListener("blur",(function(t){var i=t.relatedTarget||document.activeElement;i&&"SELECT"===i.tagName||"INPUT"===i.tagName||"BUTTON"===i.tagName||i.getAttribute("contentEditable")||e.setSelection(null,null)}),!1)},i.prototype.onTextChanged=function(){this.textChanged()},i.isInsertOp=function(e){var t=e;return null!=t.insert},i.camelize=function(e){var t=e.split("-"),i=_.map(t.slice(1),(function(e){return e[0].toUpperCase()+e.slice(1)})).join("");return t[0]+i},i.textChangeThrottle=600,i.loadQuillResources=!0,i.quillJsFiles=[e.build+"/externals/quill.min.js"],i.quillCssFiles=[e.build+"/externals/quill.base.css"],i})();r.QuillWrapper=f;var m;!(function(e){function n(e,i,a){var n="size",u=o(n);s(n,null,u,!0);var c="font",v=d.map((function(e){return t.Font.normalizeFamily(e.value)})),w=o(c);s(c,v,w,!0);var S="align",D=g.map((function(e){return e.value})),T=o(S);l(T,D);var V=_.map(d,(function(e){return{label:e.label,glyph:e.glyph,value:_.escape(t.Font.normalizeFamily(e.value))}})),L=_.escape(t.Font.normalizeFamily(r.defaultFont)),M=y().addClass("toolbar").append(f().append(m(i.get("RichTextbox_Font_Label"))).append(C(P("Font",i),V,"font",L,(function(e,t){return e.css("font-family",t.value),e}))).append(C(P("Size",i),p,"size",r.defaultFontSize))).append(f().append(x(P("Bold",i),"bold")).append(x(P("Italic",i),"italic")).append(x(P("Underline",i),"underline"))).append(f().append(b("Text Alignment",g,"align",h,i))).append(f().append(x(P("Link",i),"link")).append(a));return M}function o(e){return"formats/"+e}function s(e,t,i,a){void 0===a&&(a=!1),l("attributors/style/"+e,t,i,a)}function l(e,t,i,a){void 0===a&&(a=!1);var r=Quill.import(e);r.whitelist=t,Quill.register(i||e,r,a)}function u(e,t,i){return $('\n                        <a href="#" class="ql-preview" target="_blank"></a>\n                        <input class="input" type="text">\n                        <span class="bar">&nbsp;|&nbsp;</span>\n                        <a class="ql-action ql-save">'+t+'</a>\n                        <a class="ql-action ql-edit">'+i+'</a>\n                        <a class="ql-remove">'+e+"</a>\n                    ")}function c(e){var t=y(),i=e.get("RichTextbox_Link_Done"),a=e.get("RichTextbox_Link_Remove"),r=e.get("RichTextbox_Link_Edit");return t.append(u(a,i,r)),t.html()}function f(){return v().addClass("ql-formats")}function m(e){return $("<label>").text(e)}function y(){return $("<div>")}function v(){return $("<span>")}function w(){return $("<button>")}function b(e,t,i,a,r){var n=t.map((function(e){var t=null!=e.glyph?e.glyph:i+e.value,a=x(P(e.label,r),i,e.value,t);return a}));return n}function C(e,t,i,a,r){var n=S(e,t,a,r).addClass("ql-"+i+" ql-picker");return n}function S(e,t,i,a){for(var r=$("<select>").attr("title",e),n=0;n<t.length;n++){var o=t[n],s=$("<option>").text(o.label);o.value===i?s.attr("selected","selected"):s.attr("value",o.value),void 0!==a&&(s=a(s,o)),r.append(s)}return r}function x(e,t,i,a){var r=w();return null!=e&&r.attr("title",e),null!=t&&r.addClass("ql-"+t),null!=i&&r.attr("value",i),null==a&&(null!=t&&(a=t),null!=i&&(a=(a||"")+i)),null!=a&&r.addClass("powervisuals-glyph "+a),r}function P(e,t){return t.get("RichTextbox_"+e+"_ToolTip")}var D="http://";e.selectors={linkTooltip:i("ql-link-tooltip"),toolbarUrlInput:i("toolbar-url-input")},e.buildToolbar=n,e.buildToolbarLinkInputTemplate=c;var T=(function(){function t(e,i,r){var n=this;this.$container=e,this.quill=i,this.$preview=this.$container.find("a.ql-preview"),this.$textbox=this.$container.find("input[type=text]"),this.textbox=this.$textbox[0],this.$action=this.$container.find("a.ql-action"),this.hide(),this.$textbox.on("keydown",(function(e){e.keyCode===a.DOMConstants.enterKeyCode?(n.save(),e.preventDefault()):e.keyCode===a.DOMConstants.escKeyCode&&(n.hide(),e.preventDefault())})),["mousedown","touchstart"].forEach((function(e){n.$action.on(e,(function(e){n.$container.hasClass(t.editingClass)?(n.save(),e.preventDefault()):(n.edit(),e.preventDefault())})),n.$container.find("a.ql-remove").on(e,(function(e){n.remove(),e.preventDefault()}))})),i.on("selection-change",(function(e){if(null!=e||!$(document.activeElement).is(n.$textbox)){if(null!=e&&0===e.length){var t=void 0;if(a=i.scroll.descendant(Quill.import("formats/link"),e.index),n.link=a[0],t=a[1],null!=n.link)return n.range={index:e.index-t,length:n.link.length()},n.show()}n.hide();var a}}))}return t.buildNode=function(t){return y().addClass(e.selectors.toolbarUrlInput.class).append($(t))},t.prototype.edit=function(){this.$container.addClass(t.editingClass),this.$textbox.focus(),this.textbox.setSelectionRange(0,this.textbox.value.length)},t.prototype.open=function(){this.range=this.quill.getSelection(),this.show(),this.edit()},t.prototype.hide=function(){this.range=this.link=null,this.$container.hide()},t.prototype.remove=function(){this.range=this.range||this.quill.getSelection(),this.quill.formatText(this.range,"link",!1,"user"),this.quill.setSelection(this.range,"silent"),this.hide()},t.prototype.save=function(){var e=this.textbox.value;0===this.range.length&&(this.quill.insertText(this.range.index,e),this.quill.setSelection(this.range.index,e.length),this.range=this.quill.getSelection()),this.quill.formatText(this.range.index,this.range.length,"link",e,"user"),this.quill.setSelection(this.range,"silent"),this.link=this.quill.scroll.descendant(Quill.import("formats/link"),this.range.index)[0],this.show()},t.prototype.show=function(){this.$container.removeClass(t.editingClass),this.$container.show();var e,i=this.range=this.range||this.quill.getSelection();null!=this.link?e=this.link.formats().link:(e=this.quill.getText(i.index,i.length),e=/^\S+@\S+\.\S+$/.test(e)?"mailto:"+e:D+e),this.$textbox.val(e),this.$preview.text(e),this.$preview.attr("href",e)},t.editingClass="ql-editing",t})();e.LinkInput=T})(m||(m={}))})(d=t.RichText||(t.RichText={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=t.utility.SelectionManager;t.cheerMeterProps={dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"}}};var a=(function(){function a(){this.isFirstTime=!0}return a.converter=function(i){if(!i.categorical||!i.categorical.categories)return null;var r=i.categorical.categories[0];if(!r)return null;var n=r.values;if(!n||_.isEmpty(i.categorical.values))return null;var o=i.categorical.values[0].values,s=i.categorical.categories[0].objects,l=s&&s.length>0?s[0]:void 0,u=s&&s.length>1?s[1]:void 0,c=i.metadata.objects,d=a.DefaultBackgroundColor;if(c){var p=c.general;if(p){var h=p.fill;h&&(d=h.solid.color)}}var g=e.DataViewObjects.getFillColor(l,t.cheerMeterProps.dataPoint.fill,a.DefaultFontColor),f=e.DataViewObjects.getFillColor(u,t.cheerMeterProps.dataPoint.fill,a.DefaultFontColor),m=t.SelectionIdBuilder.builder().withCategory(r,0).createSelectionId(),y=t.SelectionIdBuilder.builder().withCategory(r,1).createSelectionId(),v={teamA:{name:n[0],value:o[0],color:g,identity:m},teamB:{name:n[1],value:o[1],color:f,identity:y},background:d};return v},a.prototype.init=function(e){this.selectionManager=new i({hostServices:e.host});var t=this.svg=d3.select(e.element.get(0)).append("svg");this.textOne=t.append("text").style("font-family",a.DefaultFontFamily),this.textTwo=t.append("text").style("font-family",a.DefaultFontFamily)},a.prototype.update=function(e){if(e.dataViews[0]){var i=this.data=a.converter(e.dataViews[0]);if(i){var r=e.suppressAnimations?0:t.AnimatorCommon.MinervaAnimationDuration;this.draw(i,r,e.viewport)}}},a.prototype.getRecomendedFontProperties=function(t,i,r){for(var n,o={fontSize:"",fontFamily:a.DefaultFontFamily,text:t+i},s=1,l=1e3,u=r.width,c=0;s<=l;)if(n=(s+l)/2|0,o.fontSize=n+"px",c=e.TextMeasurementService.measureSvgTextWidth(o),u>c)s=n+1;else{if(!(u<c))break;l=n-1}return o.fontSize=n+"px",c=e.TextMeasurementService.measureSvgTextWidth(o),c>u&&(n--,o.fontSize=n+"px"),o},a.prototype.calculateLayout=function(t,i){var r=t.teamA.name,n=t.teamB.name,o={height:i.height,width:i.width-a.PaddingBetweenText},s=this.getRecomendedFontProperties(r,n,o);s.text=r;var l=0|e.TextMeasurementService.measureSvgTextWidth(s);s.text=n;var u=0|e.TextMeasurementService.measureSvgTextWidth(s),c=(i.width-l-u-a.PaddingBetweenText)/2|0;s.text=r+n;var d=0|e.TextMeasurementService.measureSvgTextHeight(s),p=t.teamA.value+t.teamB.value,h=i.height-d,g=(p-t.teamA.value)/p*h+d/2|0,f=(p-t.teamB.value)/p*h+d/2|0;return{x1:c,x2:c+l+a.PaddingBetweenText,y1:g,y2:f,fontSize:s.fontSize}},a.prototype.ensureStartState=function(e,t){if(this.isFirstTime){this.isFirstTime=!1;var i=t.height/2;this.textOne.attr({x:e.x1,y:i}),this.textTwo.attr({x:e.x2,y:i})}},a.prototype.clearSelection=function(){var e=this;this.selectionManager.clear().then((function(){e.clearSelectionUI()}))},a.prototype.clearSelectionUI=function(){this.textOne.style("stroke","#FFF").style("stroke-width",0),this.textTwo.style("stroke","#FFF").style("stroke-width",0)},a.prototype.updateSelectionUI=function(e){this.textOne.style("stroke","#FFF").style("stroke-width",i.containsSelection(e,this.data.teamA.identity)?"2px":"0px"),this.textTwo.style("stroke","#FFF").style("stroke-width",i.containsSelection(e,this.data.teamB.identity)?"2px":"0px")},a.prototype.draw=function(e,t,i){var a=this,r="back",n=this.textOne,o=this.textTwo;this.svg.attr({height:i.height,width:i.width}).on("click",(function(){a.clearSelection()})).style("background-color",e.background);var s=this.calculateLayout(e,i);this.ensureStartState(s,i),n.style("font-size",s.fontSize).style("fill",e.teamA.color).on("click",(function(){a.selectionManager.select(e.teamA.identity,d3.event.ctrlKey).then((function(e){a.updateSelectionUI(e)})),d3.event.stopPropagation()})).text(e.teamA.name),o.style("font-size",s.fontSize).style("fill",e.teamB.color).on("click",(function(){a.selectionManager.select(e.teamB.identity,d3.event.ctrlKey).then((function(e){a.updateSelectionUI(e)})),d3.event.stopPropagation()})).text(e.teamB.name),n.transition().duration(t).ease(r).attr({y:s.y1,x:s.x1}),o.transition().duration(t).ease(r).attr({y:s.y2,x:s.x2})},a.prototype.destroy=function(){this.svg=null,this.textOne=this.textTwo=null},a.prototype.enumerateObjectInstances=function(e){var t=[],i=this.data;switch(e.objectName){case"dataPoint":if(i)for(var r=[i.teamA,i.teamB],n=0;n<r.length;n++){var o=r[n],s=o.color,l=o.identity,u={objectName:"dataPoint",displayName:o.name,selector:l,properties:{fill:{solid:{color:s}}}};t.push(u)}break;case"general":var c={objectName:"general",displayName:"General",selector:null,properties:{fill:{solid:{color:i?i.background:a.DefaultBackgroundColor}}}};t.push(c)}return t},a.capabilities={dataRoles:[{displayName:"Category",name:"Category",kind:e.VisualDataRoleKind.Grouping},{displayName:"Noise Measure",name:"Y",kind:e.VisualDataRoleKind.Measure}],dataViewMappings:[{categorical:{categories:{for:{in:"Category"}},values:{select:[{bind:{to:"Y"}}]}}}],objects:{dataPoint:{displayName:e.data.createDisplayNameGetter("Visual_DataPoint"),description:e.data.createDisplayNameGetter("Visual_DataPointDescription"),properties:{fill:{displayName:e.data.createDisplayNameGetter("Visual_Fill"),type:{fill:{solid:{color:!0}}}},width:{displayName:"",type:{numeric:!0}}}},general:{displayName:"General",properties:{fill:{displayName:"Background color",type:{fill:{solid:{color:!0}}}}}}}},a.DefaultFontFamily="cursive",a.DefaultFontColor="rgb(165, 172, 175)",a.DefaultBackgroundColor="#243C18",a.PaddingBetweenText=15,a})();t.CheerMeter=a})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.Color,r=a.CssConstants.createClassAndSelector,n=a.PixelConverter,o=e.data.DataRoleHelper,s=(function(){function r(e){e&&(this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.animator=e.animator),this.renderer=new u}return r.prototype.init=function(e){this.options=e,this.element=e.element,this.currentViewport=e.viewport,this.style=e.style,this.host=e.host,this.colors=this.style.colorPalette.dataColors,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.tooltipService=e.services.tooltips;var i=this.svg=e.svg;i.classed(r.ClassName+" "+t.PlayChart.ClassName,!0),this.renderer.init(i,e.labelsContext,this.isMobileChart,this.tooltipsEnabled,this.tooltipService)},r.getAdditionalTelemetry=function(e){var t={hasSize:o.hasRoleInDataView(e,"Size"),hasPlayAxis:o.hasRoleInDataView(e,"Play")};return t},r.getObjectProperties=function(i,a){var r;r=i&&i.metadata&&i.metadata.objects?i.metadata.objects:{};var n={};n.defaultDataPointColor=e.DataViewObjects.getFillColor(r,t.columnChartProps.dataPoint.defaultColor),n.showAllDataPoints=e.DataViewObjects.getValue(r,t.columnChartProps.dataPoint.showAllDataPoints,!1);var o=r.categoryLabels;o&&a&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(o,a);var s=i&&t.GradientUtils.hasGradientRole(i.categorical);return n.fillPoint=e.DataViewObjects.getValue(r,t.scatterChartProps.fillPoint.show,s),n.colorBorder=e.DataViewObjects.getValue(r,t.scatterChartProps.colorBorder.show,!1),n.colorByCategory=e.DataViewObjects.getValue(r,t.scatterChartProps.colorByCategory.show,!1),n},r.converter=function(i,a,n,o){void 0===o&&(o=!0);var s,l,u,c,d,p=e.data.createIDataViewCategoricalReader(i),h=a.viewport,g=a.colors,f=a.interactivityService,m=a.categoryAxisProperties,y=a.valueAxisProperties,v=i.categorical,w=t.GradientUtils.getGradientValueColumn(v);v.categories&&v.categories.length>0?(s=v.categories[0].values,l=t.valueFormatter.create({format:t.valueFormatter.getFormatString(v.categories[0].source,t.scatterChartProps.general.formatString),value:s[0],value2:s[s.length-1]}),c=v.categories[0].identity,u=v.categories[0].objects,d=v.categories[0].source.queryName):(s=[null],l=t.valueFormatter.createDefaultFormatter(null));var b,C=v.categories,S=v.values,x=!!S.source,P=S.grouped(),D=S.source,T=r.getMetadata(P,D),V=t.dataLabelUtils.getDefaultPointLabelSettings(),L=r.getSizeRangeForGroups(P,T.idx.size),M=r.getObjectProperties(i,V),N=new t.ColorHelper(g,t.scatterChartProps.dataPoint.fill,M.defaultDataPointColor),I=r.createDataPointSeries(p,S,T,C,s,l,c,u,N,h,x,V,w,d,M.colorByCategory,n,o),A=_.reduce(I,(function(e,t){return e.concat(t.dataPoints)}),[]);b=x?t.Legend.buildSeriesLegendData(i,N,t.scatterChartProps.general.formatString):{dataPoints:[]};var O=S&&D?D.displayName:"";return O||(O=C&&C.length>0&&C[0].source.displayName?C[0].source.displayName:""),m&&null!==m.showAxisTitle&&m.showAxisTitle===!1&&(T.axesLabels.x=null),y&&null!==y.showAxisTitle&&y.showAxisTitle===!1&&(T.axesLabels.y=null),f&&(f.applySelectionStateToData(A),f.applySelectionStateToData(b.dataPoints)),{xCol:T.cols.x,yCol:T.cols.y,dataPoints:A,dataPointSeries:I,legendData:b,axesLabels:T.axesLabels,size:T.cols.size,sizeRange:L,dataLabelsSettings:V,defaultDataPointColor:M.defaultDataPointColor,hasDynamicSeries:x,showAllDataPoints:M.showAllDataPoints,fillPoint:M.fillPoint,colorBorder:M.colorBorder,colorByCategory:M.colorByCategory}},r.getSizeRangeForGroups=function(e,i){var a={};return e&&e.forEach((function(e){var n=r.getMeasureValue(i,e.values),o=t.AxisHelper.getRangeForColumn(n);(null==a.min||a.min>o.min)&&(a.min=o.min),(null==a.max||a.max<o.max)&&(a.max=o.max)})),a},r.createDataPointSeries=function(e,i,a,n,o,s,l,u,c,d,p,h,g,f,m,y,v){var w=e.hasValues("X"),b=e.hasValues("Y");if(!w&&!b)return[];for(var C=[],S=a.idx,x=t.scatterChartProps.general.formatString,P=i.source,D=i.grouped(),T=0,V=D.length;T<V;T++){var L=D[T],M=L.values,N=r.getMeasureValue(S.x,M),I=r.getMeasureValue(S.y,M),A=r.getMeasureValue(S.size,M),O=void 0;if(p)O=c.getColorForSeriesValue(L.objects,i.identityFields,L.name);else if(!m&&!u){var R=null!=A?A.source.queryName:"";O=c.getColorForMeasure(null,R)}var E={identityKey:L&&L.identity&&L.identity.key||"",dataPoints:[],hasSize:!(!A||!A.values),fill:O};C.push(E);for(var F=0,j=o.length;F<j;F++){var H=o[F],G=w?t.AxisHelper.normalizeNonFiniteNumber(e.getValue("X",F,T)):0,k=b?t.AxisHelper.normalizeNonFiniteNumber(e.getValue("Y",F,T)):0,z=t.AxisHelper.normalizeNonFiniteNumber(e.getValue("Size",F,T));if(null!=G&&null!=k){var U=void 0;if(p)U=c.getColorForSeriesValue(L.objects,i.identityFields,L.name);else if(m)U=c.getColorForSeriesValue(u&&u[F],i.identityFields,H);else{var R=null!=A?A.source.queryName:"";U=c.getColorForMeasure(u&&u[F],R)}var B=_.isEmpty(n)?null:n[0],W=t.SelectionIdBuilder.builder().withCategory(B,F).withSeries(i,L).createSelectionId(),q=void 0;v&&(q=[],B&&q.push({displayName:B.source.displayName,value:t.converterHelper.formatFromMetadataColumn(H,B.source,x)}),p&&(B&&B.source===P||q.push({displayName:P.displayName,value:t.converterHelper.formatFromMetadataColumn(L.name,P,x)})),N&&null!=G&&q.push({displayName:N.source.displayName,value:t.converterHelper.formatFromMetadataColumn(G,N.source,x)}),I&&null!=k&&q.push({displayName:I.source.displayName,value:t.converterHelper.formatFromMetadataColumn(k,I.source,x)}),A&&null!=A.values[F]&&q.push({displayName:A.source.displayName,value:t.converterHelper.formatFromMetadataColumn(A.values[F],A.source,x)}),g&&null!=g.values[F]&&q.push({displayName:g.source.displayName,value:t.converterHelper.formatFromMetadataColumn(g.values[F],g.source,x)}),y&&q.push({displayName:y.column.displayName,value:t.converterHelper.formatFromMetadataColumn(y.label,y.column,x)}),t.TooltipBuilder.addTooltipMeasures(e,q,F,T));var K={x:G,y:k,size:z,radius:{sizeMeasure:A,index:F},fill:U,formattedCategory:r.createLazyFormattedCategory(s,null!=n?H:L.name),selected:!1,identity:W,tooltipInfo:q,labelFill:h.labelColor};E.dataPoints.push(K)}}}return C},r.createLazyFormattedCategory=function(e,t){return new a.Lazy(function(){return e.format(t)})},r.getBubbleRadius=function(e,t,i){var a=null,n=null,o=e.sizeMeasure;if(!o)return r.BubbleRadius;var s=t.min?t.min:0,l=t.max?t.max:0,u=Math.min(s,0),c=Math.max(l,0);if(a={minRange:u,maxRange:c,delta:c-u},n=r.getBubblePixelAreaSizeRange(i,r.MinSizeRange,r.MaxSizeRange),o.values){var d=o.values[e.index];if(null!=d)return r.projectSizeToPixels(d,a,n)/2}return r.BubbleRadius},r.getMeasureValue=function(e,t){return e>=0?t[e]:null},r.getMetadata=function(e,t){var i,a,r,n=o.getMeasureIndexOfRole(e,"X"),s=o.getMeasureIndexOfRole(e,"Y"),l=o.getMeasureIndexOfRole(e,"Size"),u="",c="";if(e&&e.length){var d=e[0];n>=0&&(i=d.values[n].source,u=d.values[n].source.displayName),s>=0&&(a=d.values[s].source,c=d.values[s].source.displayName),l>=0&&(r=d.values[l].source)}return{idx:{x:n,y:s,size:l},cols:{x:i,y:a,size:r},axesLabels:{x:u,y:c}}},r.getDefaultData=function(){return{xCol:void 0,yCol:void 0,dataPoints:[],dataPointSeries:[],legendData:{dataPoints:[]},axesLabels:{x:"",y:""},sizeRange:[],dataLabelsSettings:t.dataLabelUtils.getDefaultPointLabelSettings(),defaultDataPointColor:null,hasDynamicSeries:!1}},r.prototype.renderAtFrame=function(e){this.data=e,this.cartesianVisualHost.triggerRender(!1)},r.prototype.setData=function(e){var i=this;if(this.data=r.getDefaultData(),this.playAxis&&this.playAxis.isCurrentlyPlaying()&&this.playAxis.stop(),e.length>0){var a=e[0]||e[1];if(a){this.categoryAxisProperties=t.CartesianHelper.getCategoryAxisProperties(a.metadata,!0),this.valueAxisProperties=t.CartesianHelper.getValueAxisProperties(a.metadata,!0),this.dataView=a;var n={viewport:this.currentViewport,colors:this.colors,interactivityService:this.interactivityService,categoryAxisProperties:this.categoryAxisProperties,valueAxisProperties:this.valueAxisProperties};if(t.PlayChart.isDataViewPlayable(a)){this.playAxis||(this.playAxis=new t.PlayAxis({animator:this.animator,interactivityService:this.interactivityService,isScrollable:!1}),this.playAxis.init(this.options));var o=this.playAxis.setData(a,(function(e,t){return r.converter(e,n,t,i.tooltipsEnabled)}));this.mergeSizeRanges(o),this.data=o.currentViewModel,this.playAxis.setRenderFunction((function(e){return i.renderAtFrame(e)}))}else this.playAxis&&(this.playAxis.remove(),this.playAxis=null),a.categorical&&a.categorical.values&&(this.data=r.converter(a,n,void 0,this.tooltipsEnabled))}}else this.playAxis&&(this.playAxis.remove(),this.playAxis=null)},r.prototype.mergeSizeRanges=function(e){if(e&&e.currentViewModel){for(var t=e.currentViewModel.sizeRange,i=0,a=e.allViewModels;i<a.length;i++){var r=a[i],n=r.sizeRange;null!=n.min&&(t.min=Math.min(t.min,n.min)),null!=n.max&&(t.max=Math.max(t.max,n.max))}for(var o=0,s=e.allViewModels;o<s.length;o++){var l=s[o];l.sizeRange=t}}},r.prototype.calculateLegend=function(){return this.data&&this.data.legendData},r.prototype.hasLegend=function(){return this.data&&this.data.hasDynamicSeries},r.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"colorByCategory":this.data&&(this.data.hasDynamicSeries||e.pushInstance({objectName:"colorByCategory",selector:null,properties:{show:this.data.colorByCategory}}));break;case"dataPoint":if(!this.playAxis){var a=this.dataView&&this.dataView.categorical?this.dataView.categorical:null;if(!t.GradientUtils.hasGradientRole(a))return this.enumerateDataPoints(e)}break;case"categoryAxis":e.pushInstance({selector:null,properties:{showAxisTitle:!this.categoryAxisProperties||null==this.categoryAxisProperties.showAxisTitle||this.categoryAxisProperties.showAxisTitle},objectName:"categoryAxis"});break;case"valueAxis":e.pushInstance({selector:null,properties:{showAxisTitle:!this.valueAxisProperties||null==this.valueAxisProperties.showAxisTitle||this.valueAxisProperties.showAxisTitle},objectName:"valueAxis"});break;case"categoryLabels":this.data?t.dataLabelUtils.enumerateCategoryLabels(e,this.data.dataLabelsSettings,!0):t.dataLabelUtils.enumerateCategoryLabels(e,null,!0);break;case"fillPoint":if(this.hasSizeMeasure())return;e.pushInstance({objectName:"fillPoint",selector:null,properties:{show:this.data.fillPoint}});break;case"colorBorder":this.hasSizeMeasure()&&e.pushInstance({objectName:"colorBorder",selector:null,properties:{show:this.data.colorBorder}})}},r.prototype.hasSizeMeasure=function(){var e=this.data.sizeRange;return e&&void 0!==e.min},r.prototype.enumerateDataPoints=function(e){var i=this.data;if(i){var a=i.dataPoints.length;if(i.hasDynamicSeries)for(var r=i.legendData.dataPoints.length,n=0;n<r;n++){var o=i.legendData.dataPoints[n];e.pushInstance({objectName:"dataPoint",displayName:o.label,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}}})}else if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:i.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!i.showAllDataPoints}}),i.showAllDataPoints)for(var n=0;n<a;n++){var s=i.dataPoints[n];
e.pushInstance({objectName:"dataPoint",displayName:s.formattedCategory.getValue(),selector:t.ColorHelper.normalizeSelector(s.identity.getSelector(),!0),properties:{fill:{solid:{color:s.fill}}}})}}},r.prototype.supportsTrendLine=function(){var t=this.data;if(!t)return!1;var i=this.dataView,a=e.data.createIDataViewCategoricalReader(i);return!this.hasSizeMeasure()&&t.dataPointSeries.length>0&&a.hasValues("X")&&a.hasValues("Y")},r.prototype.getAxisLocationForRole=function(e){var i=_.find(t.scatterChartCapabilities.dataRoles,(function(t){return t.name===e}));if(i)return 0===i.cartesianKind?0:1},r.getExtents=function(e){var t=e.dataPoints;return _.isEmpty(t)?{minY:0,maxY:0,minX:0,maxX:0}:{minY:d3.min(t,(function(e){return e.y})),maxY:d3.max(t,(function(e){return e.y})),minX:d3.min(t,(function(e){return e.x})),maxX:d3.max(t,(function(e){return e.x}))}},r.prototype.calculateAxesProperties=function(e){var i=this.data,a=this.currentViewport=e.viewport,n=e.margin;this.currentViewport=a,this.margin=n;var o=a.width-(n.left+n.right),s=a.height-(n.top+n.bottom),l={minY:0,maxY:10,minX:0,maxX:10};this.playAxis?(l=this.playAxis.getCartesianExtents(l,r.getExtents),this.playAxis.setPlayControlPosition(e.playAxisControlLayout)):_.isEmpty(i.dataPoints)||(l=r.getExtents(i));var u=[l.minX,l.maxX],c=t.AxisHelper.combineDomain(e.forcedXDomain,u,e.ensureXDomain);this.xAxisProperties=t.AxisHelper.createAxis({pixelSpan:o,dataDomain:c,zeroScalarDomain:[-1,1],metaDataColumn:i.xCol,formatString:t.valueFormatter.getFormatString(i.xCol,t.scatterChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!1,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!0,scaleType:e.categoryAxisScaleType,axisDisplayUnits:e.categoryAxisDisplayUnits,axisPrecision:e.categoryAxisPrecision,margin:n}),this.xAxisProperties.axis.tickSize(-s,0),this.xAxisProperties.axisLabel=this.data.axesLabels.x;var d=t.AxisHelper.combineDomain(e.forcedYDomain,[l.minY,l.maxY],e.ensureYDomain);return this.yAxisProperties=t.AxisHelper.createAxis({pixelSpan:s,dataDomain:d,zeroScalarDomain:[-1,1],metaDataColumn:i.yCol,formatString:t.valueFormatter.getFormatString(i.yCol,t.scatterChartProps.general.formatString),outerPadding:0,isScalar:!0,isVertical:!0,forcedTickCount:e.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,scaleType:e.valueAxisScaleType,axisDisplayUnits:e.valueAxisDisplayUnits,axisPrecision:e.valueAxisPrecision,margin:n}),this.yAxisProperties.axisLabel=this.data.axesLabels.y,[this.xAxisProperties,this.yAxisProperties]},r.prototype.overrideXScale=function(e){this.xAxisProperties=e},r.prototype.shouldSuppressAnimation=function(){return this.data&&this.data.dataPoints&&this.data.dataPoints.length>r.NoAnimationThreshold},r.prototype.render=function(i,a){if(this.data){var n=this.data,o=this.margin,s=this.currentViewport,u=this.interactivityService&&this.interactivityService.hasSelection(),c={width:s.width-(o.left+o.right),height:s.height-(o.top+o.bottom)},d=t.AnimatorCommon.GetAnimationDuration(this.animator,i);this.playAxis&&this.playAxis.isCurrentlyPlaying()&&(this.isMobileChart||d>0)&&(d=t.PlayChart.FrameAnimationDuration);var p=this.playAxis?"linear":"cubic-in-out",h=(!n.sizeRange||!n.sizeRange.min)&&n.fillPoint,g=this.hasSizeMeasure(),f=1===a&&n.dataPoints&&n.dataPoints.length>r.NoRenderResizeThreshold,m={data:n,drawBubbles:g,isPlay:!!this.playAxis,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,viewport:c,hasSelection:u,animationDuration:d,animationOptions:this.options.animation,fillMarkers:h,easeType:p,suppressDataPointRendering:f};if(g){var y=n.dataPoints.sort(r.sortBubbles);m.data=e.Prototype.inherit(m.data),m.data.dataPoints=y}var v=[];(n.dataLabelsSettings&&n.dataLabelsSettings.show||n.dataLabelsSettings.showCategory)&&(v=l.createLabelDataPoints(m));var w=this.renderer.render(m,this.interactivityService);this.isMobileChart&&(w={data:w.data,dataPointsSelection:w.dataPointsSelection,eventGroup:w.eventGroup,plotContext:w.plotContext,host:this.cartesianVisualHost,root:this.svg,visualInitOptions:this.options,xAxisProperties:this.xAxisProperties,yAxisProperties:this.yAxisProperties,background:d3.select(this.element.get(0))});var b;if(this.playAxis&&(b=this.playAxis.render(i,m,s,o),this.interactivityService)){var C={traceLineRenderer:this.renderer.createTraceLineRenderer(b.viewModel)};u&&t.PlayChart.renderTraceLines(b.allDataPoints,C.traceLineRenderer,!i),w.playOptions=C}return{dataPoints:b?b.allDataPoints:n.dataPoints,behaviorOptions:w,labelDataPoints:v,labelsAreNumeric:!1}}},r.getStrokeFill=function(e,t){if(null!=e.size&&t){var a=i.parseColorString(e.fill);return i.hexString(i.darken(a,r.StrokeDarkenColorValue))}return e.fill},r.getBubblePixelAreaSizeRange=function(e,t,i){var a=1;if(e.height>0&&e.width>0){var n=Math.min(e.height,e.width);a=n*n/r.AreaOf300By300Chart}var o=Math.round(t*a),s=Math.round(i*a);return{minRange:o,maxRange:s,delta:s-o}},r.project=function(e,t,i){if(0===t.delta||0===i.delta)return r.rangeContains(t,e)?i.minRange:null;var a=(e-t.minRange)/t.delta;return i.minRange+a*i.delta},r.projectSizeToPixels=function(e,t,i){var a=0;if(t){if(a=i.maxRange,0!==t.delta){var n=Math.min(Math.max(e,t.minRange),t.maxRange);a=r.project(n,t,i)}a=2*Math.sqrt(a/Math.PI)}return Math.round(a)},r.rangeContains=function(e,t){return e.minRange<=t&&t<=e.maxRange},r.getMarkerFillOpacity=function(e,t,i,a){return e||t?i&&!a?r.DimmedBubbleOpacity:r.DefaultBubbleOpacity:0},r.getMarkerStrokeOpacity=function(e,t,i,a){return e&&t?1:i&&!a?r.DimmedBubbleOpacity:r.DefaultBubbleOpacity},r.getMarkerStrokeFill=function(e,t,a){if(e&&t){var n=i.parseColorString(a);return i.hexString(i.darken(n,r.StrokeDarkenColorValue))}return a},r.getMarkerStyle=function(e,t,i,a){return{"stroke-opacity":r.getMarkerStrokeOpacity(null!=e.size,t,i,e.selected),stroke:r.getMarkerStrokeFill(null!=e.size,t,e.fill),fill:e.fill,"fill-opacity":r.getMarkerFillOpacity(null!=e.size,a,i,e.selected)}},r.getSeriesStyle=function(e,t,i,a,n){return{"stroke-opacity":r.getMarkerStrokeOpacity(e,t,i,!1),stroke:r.getMarkerStrokeFill(e,t,n),fill:n,"fill-opacity":r.getMarkerFillOpacity(e,a,i,!1)}},r.getBubbleOpacity=function(e,t){return t&&!e.selected?r.DimmedBubbleOpacity:r.DefaultBubbleOpacity},r.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},r.prototype.getSupportedCategoryAxisType=function(){return t.axisType.scalar},r.sortBubbles=function(e,t){var i=t.radius.sizeMeasure.values[t.radius.index]-e.radius.sizeMeasure.values[e.radius.index];return 0!==i?i:t.identity.getKey().localeCompare(e.identity.getKey())},r.BubbleRadius=6,r.DefaultBubbleOpacity=.85,r.DimmedBubbleOpacity=.4,r.StrokeDarkenColorValue=63.75,r.dataLabelLayoutStartingOffset=2,r.dataLabelLayoutOffsetIterationDelta=6,r.dataLabelLayoutMaximumOffset=r.dataLabelLayoutStartingOffset+2*r.dataLabelLayoutOffsetIterationDelta,r.AreaOf300By300Chart=9e4,r.MinSizeRange=200,r.MaxSizeRange=3e3,r.ClassName="scatterChart",r.NoAnimationThreshold=1e3,r.NoRenderResizeThreshold=1e3,r})();t.ScatterChart=s;var l,u=(function(){function e(){}return e.prototype.init=function(t,i,a,r,n){this.mainGraphicsG=t.append("g").classed(e.MainGraphicsContext.class,!0),this.isMobileChart=a,a&&(this.mainGraphicsBackgroundRect=this.mainGraphicsG.append("rect").classed("backgroundRect",!0).attr({width:"100%",height:"100%"})),this.mainGraphicsContext=this.mainGraphicsG.append("svg"),this.labelGraphicsContext=i,this.tooltipsEnabled=r,this.tooltipService=n,this.mainGraphicsContext.attr("stroke-width","1")},e.prototype.render=function(e,i){var a=e.viewport;this.mainGraphicsContext.attr({width:a.width,height:a.height});var r;return r=e.suppressDataPointRendering?this.removeScatterMarkers():e.animationDuration>0?this.drawScatterMarkers(e):this.drawScatterMarkersNoAnimation(e,e.drawBubbles),e.drawBubbles&&r.order(),this.tooltipsEnabled&&this.tooltipService.addTooltip(this.mainGraphicsContext,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity})),t.SVGUtil.flushAllD3TransitionsIfNeeded(e.animationOptions),{dataPointsSelection:r,eventGroup:this.mainGraphicsG,data:e.data,plotContext:this.mainGraphicsContext}},e.prototype.createTraceLineRenderer=function(e){return new c(e,this.mainGraphicsContext,this.tooltipsEnabled,this.tooltipService)},e.prototype.removeScatterMarkers=function(){return this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).remove(),this.mainGraphicsContext.selectAll(e.DotClass.selector)},e.prototype.drawScatterMarkers=function(t){var i=t.data,a=t.xAxisProperties.scale,r=t.yAxisProperties.scale,n=[{identityKey:"",dataPoints:i.dataPoints}],o=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(n,(function(e){return e.identityKey}));o.enter().append("g").classed(e.ScatterMarkerSeriesGroup.class,!0),o.exit().remove();var l=o.selectAll(e.DotClass.selector).data((function(e){return e.dataPoints}),(function(e){return e.identity.getKey()}));return l.enter().append("circle").classed(e.DotClass.class,!0).style("opacity",0).attr("r",0),l.style({"stroke-opacity":function(e){return s.getMarkerStrokeOpacity(null!=e.size,i.colorBorder,t.hasSelection,e.selected)},stroke:function(e){return s.getStrokeFill(e,i.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return s.getMarkerFillOpacity(null!=e.size,t.fillMarkers,t.hasSelection,e.selected)}}).transition().ease(t.easeType).duration(t.animationDuration).style("opacity",1).attr({r:function(e){return s.getBubbleRadius(e.radius,i.sizeRange,t.viewport)},cx:function(e){return a(e.x)},cy:function(e){return r(e.y)}}),l.exit().transition().ease(t.easeType).duration(t.animationDuration).style("opacity",0).attr("r",0).remove(),l},e.prototype.drawScatterMarkersNoAnimation=function(t,i){var a,r=t.data,n=t.xAxisProperties.scale,o=t.yAxisProperties.scale;if(i){var l=[{identityKey:"",dataPoints:r.dataPoints}];a=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(l,(function(e){return e.identityKey}))}else a=this.mainGraphicsContext.selectAll(e.ScatterMarkerSeriesGroup.selector).data(r.dataPointSeries,(function(e){return e.identityKey}));return a.enter().append("g").classed(e.ScatterMarkerSeriesGroup.class,!0),a.exit().remove(),a.each((function(i){var a=s.getSeriesStyle(i.hasSize,r.colorBorder,t.hasSelection,t.fillMarkers,i.fill),l=d3.select(this);e.applyStyle(this,a);var u=l.selectAll(e.DotClass.selector).data(i.dataPoints,(function(e){return e.identity.getKey()}));u.interrupt(),u.enter().append("circle").classed(e.DotClass.class,!0),u.exit().remove(),u.each((function(i){var n=s.getMarkerStyle(i,r.colorBorder,t.hasSelection,t.fillMarkers);e.styleException(n,a),e.applyStyle(this,n)})),u.attr({r:function(e){return s.getBubbleRadius(e.radius,r.sizeRange,t.viewport)},cx:function(e){return n(e.x)},cy:function(e){return o(e.y)}})})),this.mainGraphicsContext.selectAll(e.DotClass.selector)},e.styleException=function(e,t){if(t)for(var i in e)e[i]===t[i]&&(e[i]=null)},e.applyStyle=function(e,t){for(var i in t){var a=e.style[i],r=t[i];if(null==r){if(""===a)continue}else if(r=r.toString(),r===a)continue;e.style[i]=r}},e.DotClass=r("dot"),e.MainGraphicsContext=r("mainGraphicsContext"),e.ScatterMarkerSeriesGroup=r("scatterMarkerSeriesGroup"),e})();!(function(i){function a(i){for(var a=i.xAxisProperties.scale,o=i.yAxisProperties.scale,l=i.data.sizeRange,u=[],c=i.data.dataPoints,h=i.data.dataLabelsSettings,g=r(i),f=0,m=c;f<m.length;f++){var y=m[f],v=y.formattedCategory.getValue(),w={text:v,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:n.fromPoint(h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},b=e.TextMeasurementService.measureSvgTextWidth(w),C=e.TextMeasurementService.estimateSvgTextHeight(w);u.push({isPreferred:!!g&&d(y.identity.getKey(),g),text:v,textSize:{width:b,height:C},outsideFill:h.labelColor?h.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,parentShape:{point:{x:a(y.x),y:o(y.y)},radius:s.getBubbleRadius(y.radius,l,i.viewport),validPositions:p},identity:y.identity,fontSize:h.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt})}return u}function r(e){var i=e.viewport.width,a=e.viewport.height,r=new t.Point(i/2,a/2),n=o(i,a);return l(r,n,e)}function o(e,i){var a=[],r=e/4,n=i/4;return a.push(new t.Point(r,n)),a.push(new t.Point(3*r,n)),a.push(new t.Point(r,3*n)),a.push(new t.Point(3*r,3*n)),a}function l(e,t,i){for(var a,r=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],n=[],o=i.xAxisProperties.scale,s=i.yAxisProperties.scale,l=0,d=i.data.dataPoints;l<d.length;l++){var p=d[l],h=o(p.x),g=s(p.y),f=u(h,g,e);i.drawBubbles?n[f]||(n[f]=p.identity):(a=c(t[f].x,t[f].y,h,g),a<r[f]&&(n[f]=p.identity,r[f]=a))}for(var m=[],y=0,v=n;y<v.length;y++){var w=v[y];w&&m.push(w.getKey())}return m}function u(e,t,i){return e>i.x&&t<=i.y?0:e<=i.x&&t<=i.y?1:e<=i.x&&t>i.y?2:3}function c(e,t,i,a){return Math.sqrt((e-i)*(e-i)+(t-a)*(t-a))}function d(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(0===e.localeCompare(r))return!0}return!1}var p=[2,1,8,4,16,32,64,128];i.createLabelDataPoints=a})(l||(l={}));var c=(function(){function e(e,t,i,a){this.viewModel=e,this.element=t,this.tooltipsEnabled=i,this.tooltipService=a}return e.prototype.remove=function(){this.element.selectAll(e.TraceLine.selector).remove(),this.element.selectAll(e.TraceBubble.selector).remove()},e.prototype.render=function(i,a){var r=this.viewModel,n=r.viewModel,o=[];if(_.isEmpty(i)||n.suppressDataPointRendering)this.remove();else{for(var l=r.data.currentFrameIndex,u=[],c=0,d=i.length;c<d;c++){o[c]=[],u[c]=!1;for(var p=0,h=r.data.allViewModels.length;p<h&&p<=l;p++){var g=_.find(r.data.allViewModels[p].dataPoints,(function(e,t){return e.identity.getKey()===i[c].identity.getKey()}));null!=g&&(g.frameIndex=p,o[c].push(g),p===l&&(u[c]=!0))}}var f=n.xAxisProperties.scale,m=n.yAxisProperties.scale,y=d3.svg.line().x((function(e){return f(e.x)})).y((function(e){return m(e.y)})).defined((function(e){return null!==e.x&&null!==e.y})),v=this.element.selectAll(e.TraceLine.selector).data(i,(function(e){return e.identity.getKey()}));v.enter().append("path").classed(e.TraceLine.class,!0);var w=[],b=[],C=!1;v.each((function(e,t){var i=this,a=i.hasAttribute("d")?i.getTotalLength():0;w.push(a);var r=$("<svg><path></path></svg>"),n=$("path",r);n.attr("d",y(o[t]));var s=o[t].length>0?n.get()[0].getTotalLength():0;b.push(s),C=C||s<a})),C?a?v.transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).attr("stroke-dashoffset",(function(e,t){return w[t]-b[t]})).transition().ease("linear").duration(1).delay(t.PlayChart.FrameAnimationDuration).style("stroke",(function(e){return s.getStrokeFill(e,!0)})).attr({d:function(e,t){return y(o[t])},"stroke-dasharray":function(e,t){return b[t]+" "+b[t]},"stroke-dashoffset":0}):v.style("stroke",(function(e){return s.getStrokeFill(e,!0)})).attr({d:function(e,t){return y(o[t])},"stroke-dasharray":function(e,t){return b[t]+" "+b[t]},"stroke-dashoffset":0}):(v.style("stroke",(function(e){return s.getStrokeFill(e,!0)})).attr({d:function(e,t){return y(o[t])},"stroke-dasharray":function(e,t){return b[t]+" "+b[t]},"stroke-dashoffset":function(e,t){return b[t]-w[t]}}),a?v.transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).attr("stroke-dashoffset",0):v.attr("stroke-dashoffset",0)),v.exit().remove();for(var S=[],x=0;x<o.length;x++){var P=o[x],D=u[x]?P.slice(0,P.length-1):P;S=S.concat(D)}var T=this.element.selectAll(e.TraceBubble.selector).data(S,(function(e){return e.identity.getKey()+e.x+e.y+e.size}));T.enter().append("circle").style("opacity",0).classed(e.TraceBubble.class,!0),T.attr("cx",(function(e){return f(e.x)})).attr("cy",(function(e){return m(e.y)})).attr("r",(function(e){return s.getBubbleRadius(e.radius,r.data.currentViewModel.sizeRange,r.viewport)})).style({"stroke-opacity":function(e){return s.getBubbleOpacity(e,!0)},stroke:function(e){return s.getStrokeFill(e,r.data.currentViewModel.colorBorder)},fill:function(e){return e.fill},"fill-opacity":function(e){return null!=e.size?.2+e.frameIndex/l*.6:0}}).transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).style("opacity",1),T.exit().transition().ease("linear").duration(t.PlayChart.FrameAnimationDuration).style("opacity",0).remove(),this.tooltipsEnabled&&this.tooltipService.addTooltip(T,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity})),T.sort((function(e,t){return t.size-e.size}))}},e.TraceLine=r("traceLine"),e.TraceBubble=r("traceBubble"),e})(),d=(function(){function t(e){this.dataPoints=e}return t.prototype.queryRegion=function(t){var i=_.filter(this.dataPoints,(function(i){return e.Double.lessOrEqualWithPrecision(t.left,i.x)&&e.Double.lessOrEqualWithPrecision(i.x,t.right)&&e.Double.lessOrEqualWithPrecision(t.bottom,i.y)&&e.Double.lessOrEqualWithPrecision(i.y,t.top)}));return i},t})();t.ScatterChartHitTester=d})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.CssConstants.createClassAndSelector,r=e.data.createDataViewScopeIdentity,n=e.data.DataViewConcatenateCategoricalColumns,o=e.data.DataViewMatrixUtils,s=e.data.SQExprBuilder,l=(function(){function r(e){e&&(this.interactivityService=e.interactivityService)}return r.prototype.init=function(e){var t=this;this.element=e.element,this.svg=e.svg,this.host=e.host,this.isMobileChart=e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService&&(this.playControl=new c(this.element,function(e){return t.moveToFrameAndRender(e)},this.isMobileChart),this.playControl.onPlay((function(){return t.play()})))},r.prototype.setData=function(e,t){if(e){if(this.ridiculousFlagForPersistProperties&&e.metadata)return this.ridiculousFlagForPersistProperties=!1,this.playData;e.matrix||e.categorical?this.playData=u.converter(e,t):this.playData=u.getDefaultPlayData()}else this.playData=u.getDefaultPlayData();return this.lastViewport=void 0,this.playData},r.prototype.render=function(e,t,i,a){var r=this.playData,n=!this.lastViewport||this.lastViewport.height!==i.height||this.lastViewport.width!==i.width;if(this.lastViewport=i,n&&this.stop(),r){var o={data:this.playData,viewModel:t,viewport:i},s=!1;if(this.interactivityService){var l=r.currentViewModel;this.interactivityService.applySelectionStateToData(l.dataPoints),s=this.interactivityService.hasSelection()}this.updateCallout(i,a),this.playControl&&n&&this.playControl.rebuild(r,i);var u=r.allViewModels.map((function(e){return e.dataPoints})),c=_.flatten(u);return{allDataPoints:c,viewModel:o}}},r.prototype.updateCallout=function(i,n){var o=this.playData,s=o.frameData,l=o.currentFrameIndex,u=i.height,c=u-n.top-n.bottom,d=i.width,p=d-n.left-n.right,h=Math.min(u,1.3*d),g=Math.max(12,Math.round(h/7));g=Math.min(g,70);var f={fontSize:a.PixelConverter.toString(g),text:s[l].text||"",fontFamily:t.Font.Family.regular.css},m=e.TextMeasurementService.estimateSvgTextHeight(f)-e.TextMeasurementService.estimateSvgTextBaselineDelta(f),y=[];if(l<s.length&&l>=0&&m<c){var v=p-2*r.calloutOffsetMultiplier*m,w=e.TextMeasurementService.getTailoredTextOrDefault(f,v);y=[w]}var b=this.svg.selectAll(r.PlayCallout.selector).data(y);b.enter().append("text").classed(r.PlayCallout.class,!0),b.text((function(e){return e})).attr({x:p-r.calloutOffsetMultiplier*m,y:function(){return m}}).style({"font-size":g+"px","text-anchor":"end"}),b.exit().remove()},r.prototype.play=function(){var e=this.playData;if(this.isPlaying)this.stop();else if(this.playControl){this.isPlaying=!0,this.playControl.play();var t=Math.round(this.playControl.getCurrentIndex());t>=e.allViewModels.length-1?e.currentFrameIndex=-1:e.currentFrameIndex=t-1,this.playNextFrame(e)}},r.prototype.playNextFrame=function(e,t,i){var a=this;if(!this.isPlaying)return void this.stop();var r=e.currentFrameIndex+1;null!=t&&null!=i&&(r=Math.abs(i-t+1),t=r),r<e.allViewModels.length&&r>-1?(e.currentFrameIndex=r,e.currentViewModel=e.allViewModels[r],this.renderDelegate(e.currentViewModel),this.playControl.setFrame(r),r<e.allViewModels.length&&window.setTimeout((function(){a.playNextFrame(e,t,i)}),u.FrameStepDuration)):this.stop()},r.prototype.stop=function(){this.playControl&&this.playControl.pause(),this.isPlaying=!1},r.prototype.remove=function(){this.playControl&&this.playControl.remove(),d3.selectAll(r.PlayCallout.selector).remove()},r.prototype.setRenderFunction=function(e){this.renderDelegate=e},r.prototype.getCartesianExtents=function(e,t){return this.playData&&this.playData.allViewModels&&this.playData.allViewModels.length>0?u.getMinMaxForAllFrames(this.playData,t):e},r.prototype.setPlayControlPosition=function(e){if(this.playControl){var t=this.playControl.getContainer();t.css("left",e.left?e.left+"px":""),t.css("top",e.top?e.top+"px":"")}},r.prototype.moveToFrameAndRender=function(e){var t=this.playData;if(this.isPlaying=!0,t&&e>=0&&e<t.allViewModels.length&&e!==t.currentFrameIndex){t.currentFrameIndex=e;var i=t.allViewModels[e];t.currentViewModel=i,this.renderDelegate(i)}this.isPlaying=!1},r.prototype.isCurrentlyPlaying=function(){return this.isPlaying},r.PlayCallout=i("play-callout"),r.calloutOffsetMultiplier=.3,r})();t.PlayAxis=l;var u,c=(function(){function e(e,t,i){this.isMobileChart=i,this.createSliderDOM(e),this.renderDelegate=t}return e.prototype.getContainer=function(){return this.playAxisContainer},e.prototype.remove=function(){this.playAxisContainer&&this.playAxisContainer.remove()},e.prototype.pause=function(){this.playButton.removeClass("pause").addClass("play")},e.prototype.play=function(){this.playButton.removeClass("play").addClass("pause")},e.prototype.getCurrentIndex=function(){return Math.round(this.noUiSlider.get())},e.prototype.onPlay=function(e){this.playButtonCircle.off("click"),this.playButtonCircle.on("click",e)},e.prototype.setFrame=function(e){this.noUiSlider.set([e])},e.prototype.rebuild=function(t,i){var a=this,r=this.slider;this.noUiSlider&&this.noUiSlider.destroy();var n=t.labelData,o=e.calucalateSliderSize(n,i.width),s=this.getContainer();o.marginLeft>e.SliderMarginLeft&&(s.css("padding-left",o.marginLeft-e.SliderMarginLeft+"px"),s.css("box-sizing","border-box"));var l=this.updateSliderControl(t,o.width),u=e.adjustWidthRegardingLastItem(n,l,o.width);this.slider.css("width",u+"px"),this.noUiSlider.on("slide",(function(){var e=a.getCurrentIndex();a.renderDelegate(e)}));var c=0;$(".noUi-value",r).each((function(e,t){var i=n.labelInfo[c].labelWidth;$(t).width(i),$(t).css("margin-left",-i/2+"px"),c+=l}))},e.prototype.updateSliderControl=function(t,i){var a=t.labelData,r=this.slider.get(0),n=t.frameData.length,o={start:0===n?0:t.currentFrameIndex,step:1,range:{min:0,max:0===n?0:n-1}},s=null,l=0;if(n>0){var u=e.createPipsFilterFn(t,i,a);l=u.skipStep,s={mode:"steps",density:Math.ceil(100/n),format:{to:function(e){return t.frameData[e].escapedText},from:function(e){return t.frameData.indexOf(e)}},filter:u.filter}}return o.pips=s,noUiSlider.create(r,o),this.noUiSlider=r.noUiSlider,l},e.createPipsFilterFn=function(e,t,i){var a=_.max(_.map(i.labelInfo,(function(e){return e.labelWidth}))),r=1,n=1,o=e.frameData.length>1?t/(e.frameData.length-1):t,s=a/o;s>1.25?(n=Math.ceil(s),r=2):(s>1||i.anyWordBreaks)&&(r=2);var l=function(e,t){return e%n===0?r:0};return{filter:l,skipStep:n}},e.adjustWidthRegardingLastItem=function(t,i,a){var r=t.labelInfo.length,n=Math.floor((r-1)/i)*i,o=a+e.SliderMarginRight-a/r*(n+1),s=t.labelInfo[n].labelWidth,l=s/2-o;if(l>0){var u=e.SliderMaxMargin-e.SliderMarginRight;return l=l>u?u:l,a-l}return a},e.prototype.createSliderDOM=function(t){this.playAxisContainer=$('<div class="play-axis-container"></div>').appendTo(t).css("height",e.PlayControlHeight+"px"),this.playButtonCircle=$('<div class="button-container"></div>').appendTo(this.playAxisContainer),this.isMobileChart&&this.playButtonCircle.addClass("mobile-button-container"),this.playButton=$('<div class="play"></div>').appendTo(this.playButtonCircle),this.slider=$('<div class="sliders"></div>').appendTo(this.playAxisContainer)},e.calucalateSliderSize=function(t,i){var a=0;_.isEmpty(t.labelInfo)||(a=_.first(t.labelInfo).labelWidth/2);var r=Math.max(a,e.SliderMarginLeft);r=Math.min(e.SliderMaxMargin,r);var n=Math.max(i-r-e.SliderMarginRight,1);return{width:n,marginLeft:r}},e.SliderMarginLeft=44,e.SliderMarginRight=20,e.SliderMaxMargin=100,e.PlayControlHeight=80,e})();!(function(i){function l(i,a){var r=i.matrix,s={categories:[],values:e.data.DataViewTransform.createValueColumns()};if(_.isEmpty(r.columns.levels)||r.rows.levels.length<2&&r.columns.levels.length<2)return{metadata:i.metadata,categorical:s};for(var l=1,c=[],d=l,p=r.rows.levels.length;d<p;d++){var h=r.rows.levels[d].sources[0];c.push({source:h,values:[],identity:[],objects:void 0})}var g=!_.isEmpty(r.rows.root.children),f=!_.isEmpty(r.columns.root.children),m=r.columns.levels.length>1&&f,y=r.rows.levels.length>1&&g;if(m&&!y){s.categories=void 0;var v=r.columns.root;s.values.source=r.columns.levels[0].sources[0];for(var w=r.valueSources.length,b=0,C=v.children.length;b<C;b++)for(var S=v.children[b],x=0;x<w;x++){var P=_.create(r.valueSources[x],{groupName:void 0===S.value?null:S.value}),D={identity:S.identity,values:[],source:P};s.values.push(D)}for(var T=r.rows.root.children[a],V=T.values,L=0,M=v.children.length;L<M;L++)for(var x=0;x<w;x++)s.values[L*w+x].values.push(V[L*w+x].value)}else if(m&&g){var T=r.rows.root.children[a];o.forEachLeafNode(T.children,(function(e,t,i){u(i,c)})),s.categories=c,s.values.source=r.columns.levels[0].sources[0];for(var N=[],S=r.columns.root,I=-1;S;){if(S.children&&S.children[0].children)for(var x=0,A=S.children.length;x<A;x++)N.push(S.children[x]);else if(S.children&&T.children){for(var O=S.children.length,x=0;x<O;x++){var P=_.create(r.valueSources[x],{groupName:S.value}),D={identity:S.identity,values:[],source:P};s.values.push(D)}o.forEachLeafNode(T.children,(function(e){for(var t=0;t<O;t++)s.values[I*O+t].values.push(e.values[I*O+t].value)}))}N.length>0?(S=N[0],N=N.splice(1),I++):S=void 0}}else if(y){for(var T=r.rows.root.children[a],R=r.valueSources.length,x=0;x<R;x++){var D={identity:void 0,values:[],source:r.valueSources[x]};s.values.push(D)}o.forEachLeafNode(T.children,(function(e,t,i){u(i,c);for(var a=0;a<R;a++)s.values[a].values.push(e.values[a].value)})),s.categories=c}return n.applyToPlayChartCategorical(i.metadata,t.scatterChartCapabilities.objects,"Category",s)}function u(e,t){var i=e[0].identity;if(e.length>1){for(var a=i.expr,n=1,o=e.length;n<o;n++){var l=e[n].identity.expr;a=s.and(a,l)}i=r(a)}for(var u=0,c=t.length;u<c;u++){t[u].identity.push(i);var d=e[u];t[u].values.push(d.value)}}function c(i,a){var r={};if(i&&i.objects){var n=i.objects;r.currentFrameIndex=e.DataViewObjects.getValue(n,t.scatterChartProps.currentFrameIndex.index,null)}return r}function d(e,i){var a,r=e.metadata,n=t.dataLabelUtils.getDefaultPointLabelSettings(),o=c(r,n),s=[],u=[],d=void 0,p=e.matrix.rows,h=p.root.children?p.root.children.length:0;if(e.matrix&&h>0&&!_.isEmpty(p.levels)&&!_.isEmpty(p.levels[0].sources)){a=p.levels[0].sources[0];var f=t.valueFormatter.getFormatString(a,t.scatterChartProps.general.formatString),m=void 0;if(a.type.numeric){var y=Math.abs(p.root.children[h-1].value-p.root.children[0].value);m=t.valueFormatter.create({format:f,value:y,value2:0})}else m=t.valueFormatter.createDefaultFormatter(f,!0);for(var v=0,w=h;v<w;v++){var b=p.root.children[v],C=m.format(b.value),S=$("<div/>").text(C).html();u.push({escapedText:S,text:C});var x=l(e,v),P={label:S,column:a};d=i(x,P),s.push(d)}}else{var x=l(e,0);d=i(x),s.push(d)}return o.currentFrameIndex=u.length-1,{allViewModels:s,currentViewModel:d,frameData:u,currentFrameIndex:o.currentFrameIndex,labelData:g(u,a)}}function p(){var e={frameData:[],allViewModels:[],currentFrameIndex:0,currentViewModel:void 0,labelData:{anyWordBreaks:!1,labelInfo:[]}};return e}function h(e,t){var i={minY:0,maxY:10,minX:0,maxX:10};if(e.allViewModels&&e.allViewModels.length>0){i.minY=i.minX=Number.MAX_VALUE,i.maxY=i.maxX=Number.MIN_VALUE;for(var a=0,r=e.allViewModels.length;a<r;a++){var n=e.allViewModels[a],o=t(n);i={minY:d3.min([o.minY,i.minY]),maxY:d3.max([o.maxY,i.maxY]),minX:d3.min([o.minX,i.minX]),maxX:d3.max([o.maxX,i.maxX])}}}return i}function g(i,r){for(var n={fontFamily:t.Font.Family.regular.css,fontSize:a.PixelConverter.toString(14)},o=[],s=!1,l=0,u=i;l<u.length;l++){var c=u[l],d=a.WordBreaker.getMaxWordWidth(c.escapedText,e.TextMeasurementService.measureSvgTextWidth,n);s=s||a.WordBreaker.hasBreakers(c.escapedText)||c.escapedText.indexOf("-")>-1,o.push({label:c.escapedText,labelWidth:d})}return{labelInfo:o,anyWordBreaks:s,labelFieldName:r&&r.displayName}}function f(e,t){void 0===t&&(t="Play");var i=e.matrix&&e.matrix.rows&&e.matrix.rows.levels&&e.matrix.rows.levels[0]&&e.matrix.rows.levels[0].sources&&e.matrix.rows.levels[0].sources[0]&&e.matrix.rows.levels[0].sources[0].roles;return i&&i[t]}function m(e,t,i){var a=_.filter(e,(function(e){return e.selected}));a=_.uniq(a,(function(e){return e.identity.getKey()})),t.render(a,i)}i.FrameStepDuration=800,i.FrameAnimationDuration=750,i.ClassName="playChart",i.convertMatrixToCategorical=l,i.converter=d,i.getDefaultPlayData=p,i.getMinMaxForAllFrames=h,i.isDataViewPlayable=f,i.renderTraceLines=m})(u=t.PlayChart||(t.PlayChart={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.PixelConverter,i=e.SlicerUtil.DisplayNameKeys,r=(function(){function a(t,i){this.textProperties={fontFamily:e.Font.Family.regular.css,fontSize:"14px"},this.hasSearchableData=!1,this.verticalSlicerStrategy=t,i&&(this.behavior=i.behavior),this.domHelper=new e.SlicerUtil.DOMHelper,this.hostServices=i.hostServices}return a.prototype.getDefaultValue=function(){if(this.data&&this.data.defaultValue)return this.data.defaultValue.value},a.prototype.getIdentityFields=function(){return e.SlicerUtil.DefaultValueHandler.getIdentityFields(this.dataView)},a.prototype.getUpdatedSelfFilter=function(t){var i=this.dataView&&this.dataView.metadata;if(this.data.searchKey!==t)return e.SlicerUtil.getUpdatedSelfFilter(t,i)},a.prototype.enumerateObjectInstances=function(t){return e.SlicerUtil.ObjectEnumerator.enumerateObjectInstances(t,this.data,this.settings,this.dataView)},a.prototype.onModeChange=function(t){e.SlicerUtil.clearSlicerFilter(this.hostServices,t)},a.prototype.onClear=function(){this.interactivityService.handleClearSelection(),this.interactivityService.persistSelectionFilter(e.slicerProps.filterPropertyIdentifier)},a.prototype.init=function(t,i){var a=this;this.element=i,this.currentViewport=t.visualInitOptions.viewport;var r,o=this.hostServices=t.visualInitOptions.host,s=this.settings=e.DataConversion.DefaultSlicerProperties(),l=this.domHelper;this.behavior&&(r=e.createInteractivityService(o));var u=document.createElement("div");u.className=n.Container.class;var c=this.container=d3.select(u);this.searchContainer=l.addSearch(o,c),this.verticalSlicerStrategy.hasClearSearchButton()&&(this.clearSearchTextButton=l.addClearSearchButton(o,this.searchContainer)),this.body=c.append("div").classed(e.SlicerUtil.Selectors.Body.class,!0);var d=function(e){a.onEnterSelection(e)},p=function(e){a.onUpdateSelection(e,r)},h=function(e){e.remove()},g={rowHeight:l.getRowHeight(s,this.textProperties),enter:d,exit:h,update:p,loadMoreData:function(){return t.loadMoreData()},scrollEnabled:!0,viewport:this.currentViewport,baseContainer:this.body,isReadMode:function(){return 1!==a.hostServices.getViewMode()}};return this.listView=e.ListViewFactory.createListView(g),this.element.get(0).appendChild(u),this.interactivityService=r,r},a.prototype.render=function(e){this.renderVerticalSlicer(this.converter(e.dataView),e);
},a.prototype.renderVerticalSlicer=function(e,t){var i=this;this.currentViewport=t.viewport;var a=t.dataView;if(!a||!this.data||_.isEmpty(this.data.slicerDataPoints))return void(this.listView&&this.listView.empty());this.hasSearchableData=t.hasSearchableData;var r=this.data.slicerSettings,n=this.domHelper;this.updateSelectionStyle(),this.listView.viewport(this.currentViewport).rowHeight(n.getRowHeight(r,this.textProperties)).data(this.data.slicerDataPoints,(function(e){return i.data&&$.inArray(e,i.data.slicerDataPoints)}),t.resetScrollbarPosition)},a.prototype.converter=function(t){var a=this.hostServices.getLocalizedString(i.SelectAll),r=e.DataConversion.convert(t,a,this.interactivityService,this.hostServices);return this.data=r,t&&this.data&&(this.settings=r.slicerSettings,this.dataView=t),r},a.prototype.hasSearchEnabled=function(){return this.verticalSlicerStrategy.shouldShowSearchHeader(this.settings,this.hasSearchableData)},a.prototype.updateSelectionStyle=function(){var e=this.settings;this.container.classed("isMultiSelectEnabled",e&&e.selection&&!e.selection.singleSelect)},a.prototype.onEnterSelection=function(i){var a=this.settings,r=i.append("ul").append("li").classed(n.ItemContainer.class,!0),o=r.append("div").classed(n.Input.class,!0);o.append("input").attr("type","checkbox"),this.verticalSlicerStrategy.customizeInputElement(o),r.each((function(i,r){var n=d3.select(this);i.isImage?n.append("img").classed(e.SlicerUtil.Selectors.LabelImage.class,!0):n.append("span").classed(e.SlicerUtil.Selectors.LabelText.class,!0),null!=i.count&&n.append("span").classed(e.SlicerUtil.Selectors.CountText.class,!0).style("font-size",t.fromPoint(a.slicerText.textSize))}))},a.prototype.onUpdateSelection=function(t,i){var a=this.settings,r=this.data;if(r&&a){var o=this.domHelper,s=this.verticalSlicerStrategy.shouldShowSearchHeader(a,this.hasSearchableData);this.searchContainer.classed(e.SlicerUtil.Selectors.SearchHeaderShow.class,s),this.searchContainer.classed(e.SlicerUtil.Selectors.SearchHeaderCollapsed.class,!s);var l=t.selectAll(e.SlicerUtil.Selectors.LabelText.selector);l.text((function(e){return e.value})).attr("title",(function(e){return e.tooltip})),this.verticalSlicerStrategy.setLabelTextStyle(o,l,a);var u=t.selectAll(e.SlicerUtil.Selectors.LabelImage.selector);u.empty()||u.attr("src",(function(e){return e.value}));var c=t.selectAll(e.SlicerUtil.Selectors.CountText.selector);if(!c.empty()&&this.verticalSlicerStrategy.shouldShowCount()&&(c.text((function(e){return e.count})),o.setSlicerTextStyle(c,a)),i&&this.body){var d=this.body.attr("width",this.currentViewport.width),p=d.selectAll(n.ItemContainer.selector),h=d.selectAll(e.SlicerUtil.Selectors.LabelText.selector),g=d.selectAll(n.Input.selector),f=this.searchContainer.select(e.SlicerUtil.Selectors.SearchInput.selector);if(!f.empty()){var m=f.node(),y=m&&m.value;this.verticalSlicerStrategy.hasClearSearchButton()&&this.domHelper.configureSearchBoxIcon(this.searchContainer,y),(_.isEmpty(y)||_.isEmpty(r.searchKey))&&f.property("value",r.searchKey)}var v={dataPoints:r.slicerDataPoints,slicerContainer:this.container,itemContainers:p,itemLabels:h,itemInputs:g,interactivityService:i,settings:r.slicerSettings,searchInput:f,clearSearchTextButton:this.clearSearchTextButton,slicerValueHandler:this},w={behaviorOptions:v,orientation:0};i.bind(r.slicerDataPoints,this.behavior,w,{overrideSelectionFromData:!0,hasSelectionOverride:r.hasSelectionOverride,slicerValueHandler:this}),e.SlicerWebBehavior.styleSlicerItems(t.select(n.Input.selector),r.hasSelectionOverride,i.isSelectionModeInverted())}else e.SlicerWebBehavior.styleSlicerItems(t.select(n.Input.selector),!1,!1)}},a})();e.VerticalSlicerRenderer=r;var r;!(function(i){var a=(function(){function e(){}return e.prototype.hasClearSearchButton=function(){return!1},e.prototype.setLabelTextStyle=function(e,t,i){e.setSlicerTextStyle(t,i)},e.prototype.shouldShowSearchHeader=function(e,t){return e.search.enabled},e.prototype.shouldShowCount=function(){return!0},e.prototype.customizeInputElement=function(e){e.append("span").classed("checkbox",!0)},e})();i.CheckBoxSlicerStrategy=a;var r=13,n="#333333",o=(function(){function i(){}return i.prototype.hasClearSearchButton=function(){return!0},i.prototype.setLabelTextStyle=function(i,a,o){var s=e.DataConversion.DefaultSlicerProperties();s.slicerText.textSize=t.toPoint(r),s.slicerText.color=n,i.setSlicerTextStyle(a,s)},i.prototype.shouldShowSearchHeader=function(e,t){return e.search.enabled||t},i.prototype.shouldShowCount=function(){return!1},i.prototype.customizeInputElement=function(e){e.append("span").classed("powervisuals-glyph checkmark",!0)},i})();i.CheckListSlicerStrategy=o})(r=e.VerticalSlicerRenderer||(e.VerticalSlicerRenderer={}));var n;!(function(e){var t=a.CssConstants.createClassAndSelector;e.Container=t("slicerContainer"),e.ItemContainer=t("slicerItemContainer"),e.Input=t("slicerCheckbox"),e.Checkbox=t("checkbox")})(n||(n={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.PixelConverter,r=t.SlicerUtil.DisplayNameKeys,n=50,o=80,s=19,l=.8,u={labelText:{marginRight:2,paddingLeft:8,paddingRight:8}},c=(function(){function c(e){this.textProperties={fontFamily:t.Font.Family.regular.css,fontSize:"14px"},e&&(this.behavior=e.behavior),this.domHelper=new t.SlicerUtil.DOMHelper,this.dataStartIndex=0}return c.prototype.getDefaultValue=function(){if(this.data&&this.data.defaultValue)return this.data.defaultValue.value},c.prototype.getIdentityFields=function(){return t.SlicerUtil.DefaultValueHandler.getIdentityFields(this.dataView)},c.prototype.getUpdatedSelfFilter=function(e){var i=this.dataView&&this.dataView.metadata;if(this.data.searchKey!==e)return t.SlicerUtil.getUpdatedSelfFilter(e,i)},c.prototype.enumerateObjectInstances=function(e){return t.SlicerUtil.ObjectEnumerator.enumerateObjectInstances(e,this.data,this.settings,this.dataView)},c.prototype.onModeChange=function(e){t.SlicerUtil.clearSlicerFilter(this.hostServices,e)},c.prototype.onClear=function(){this.interactivityService.handleClearSelection(),this.interactivityService.persistSelectionFilter(t.slicerProps.filterPropertyIdentifier)},c.prototype.init=function(e,i){this.element=i,this.currentViewport=e.visualInitOptions.viewport;var a=this.hostServices=e.visualInitOptions.host;this.settings=t.DataConversion.DefaultSlicerProperties(),this.behavior&&(this.interactivityService=t.createInteractivityService(a)),this.loadMoreData=function(){return e.loadMoreData()};var r=document.createElement("div");r.className=d.container.class;var n=this.container=d3.select(r);this.searchContainer=this.domHelper.addSearch(a,n);var o=this.body=n.append("div").classed(t.SlicerUtil.Selectors.Body.class+" "+d.FlexDisplay.class,!0);return this.leftNavigationArrow=o.append("button").classed(d.NavigationArrow.class+" "+d.LeftNavigationArrow.class,!0),this.itemsContainer=o.append("div").classed(d.ItemsContainer.class+" "+d.FlexDisplay.class,!0),this.rightNavigationArrow=o.append("button").classed(d.NavigationArrow.class+" "+d.RightNavigationArrow.class,!0),this.element.get(0).appendChild(r),this.bindNavigationEvents(),this.interactivityService},c.prototype.render=function(e){var i=this.hostServices.getLocalizedString(r.SelectAll),a=e.dataView;if(this.data=t.DataConversion.convert(a,i,this.interactivityService,this.hostServices),!a||!this.data||_.isEmpty(this.data.slicerDataPoints))return void this.itemsContainer.selectAll("*").remove();this.dataView=a,this.settings=this.data.slicerSettings;var n=this.currentViewport&&e.viewport&&(this.currentViewport.height!==e.viewport.height||this.currentViewport.width!==e.viewport.width);this.isMaxWidthCalculated()&&n||(this.calculateAndSetMaxItemWidth(),this.calculateAndSetTotalItemWidth()),this.currentViewport=e.viewport,this.updateStyle(),this.availableWidth=this.element.find(t.SlicerUtil.Selectors.Body.selector).width()-2*s,this.itemsToDisplay=this.getNumberOfItemsToDisplay(this.availableWidth),0!==this.itemsToDisplay&&this.renderCore()},c.prototype.renderCore=function(){var e=this.data;if(e&&e.slicerDataPoints){this.normalizePosition(e.slicerDataPoints);var t=this.itemsToDisplay,i=this.dataStartIndex;this.container.classed(d.CanScrollRight.class,i+this.itemsToDisplay<=e.slicerDataPoints.length-1),this.container.classed(d.CanScrollLeft.class,i>0),this.renderItems(e.slicerSettings),this.bindInteractivityService(),i+t>=e.slicerDataPoints.length*l&&this.loadMoreData()}},c.prototype.updateStyle=function(){var e=this.data,i=e.slicerSettings;this.container.classed(d.MultiSelectEnabled.class,!i.selection.singleSelect),this.searchContainer.classed(t.SlicerUtil.Selectors.SearchHeaderShow.class,i.search.enabled),this.searchContainer.classed(t.SlicerUtil.Selectors.SearchHeaderCollapsed.class,!i.search.enabled)},c.prototype.renderItems=function(a){var r=this,n=this.itemsToDisplay,o=this.dataStartIndex,s=this.data.slicerDataPoints.slice(o,o+n),l=this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector).data(s,(function(e){return _.indexOf(r.data.slicerDataPoints,e)}));l.enter().append("div").classed(t.SlicerUtil.Selectors.LabelText.class+" "+d.FlexDisplay.class,!0),l.order(),l.style({"font-family":this.textProperties.fontFamily,"padding-left":i.toString(u.labelText.paddingLeft),"padding-right":i.toString(u.labelText.paddingRight),"margin-right":function(e,t){return r.isLastRowItem(t,n)?"0px":i.toString(u.labelText.marginRight)}}),this.domHelper.setSlicerTextStyle(l,a),l.exit().remove(),window.setTimeout((function(){l.attr("title",(function(e){return e.tooltip})).text((function(e){return e.value}));var i=r.element.find(t.SlicerUtil.Selectors.LabelText.selector),a=i.first(),n=a.height(),o=a.width();i.each((function(t,i){e.TextMeasurementService.wordBreakOverflowingText(i,o,n)}))}))},c.prototype.bindInteractivityService=function(){if(this.interactivityService&&this.body){var e=this.body,i=e.selectAll(d.ItemsContainer.selector),a=e.selectAll(t.SlicerUtil.Selectors.LabelText.selector),r=this.data,n=this.searchContainer.select("input");if(!n.empty()){var o=n.node(),s=o.value;(_.isEmpty(s)||_.isEmpty(r.searchKey))&&n.property("value",r.searchKey)}var l={dataPoints:r.slicerDataPoints,slicerContainer:this.container,itemsContainer:i,itemLabels:a,interactivityService:this.interactivityService,settings:r.slicerSettings,slicerValueHandler:this,searchInput:n},u={behaviorOptions:l,orientation:1};this.interactivityService.bind(r.slicerDataPoints,this.behavior,u,{overrideSelectionFromData:!0,hasSelectionOverride:r.hasSelectionOverride}),t.SlicerWebBehavior.styleSlicerItems(this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector),this.interactivityService.hasSelection(),this.interactivityService.isSelectionModeInverted())}else t.SlicerWebBehavior.styleSlicerItems(this.itemsContainer.selectAll(t.SlicerUtil.Selectors.LabelText.selector),!1,!1)},c.prototype.normalizePosition=function(e){var t=this.dataStartIndex;t=Math.min(t,e.length-1),this.dataStartIndex=Math.max(t,0)},c.prototype.bindNavigationEvents=function(){this.registerMouseWheelScrollEvents(),this.registerMouseClickEvents()},c.prototype.registerMouseClickEvents=function(){var e=this,t=this.container.selectAll(d.RightNavigationArrow.selector),i=this.container.selectAll(d.LeftNavigationArrow.selector);t.on("click",(function(){e.scrollRight()})),i.on("click",(function(){e.scrollLeft()}))},c.prototype.registerMouseWheelScrollEvents=function(){var e=this,t=this.body.node();t.addEventListener("mousewheel",(function(t){e.onMouseWheel(t.wheelDelta)})),t.addEventListener("DOMMouseScroll",(function(t){e.onMouseWheel(t.detail)}))},c.prototype.onMouseWheel=function(e){e<0?this.scrollRight():e>0&&this.scrollLeft()},c.prototype.scrollRight=function(){var e=this.itemsToDisplay,t=this.dataStartIndex,i=this.data.slicerDataPoints.length,a=i-1;e+t>a||(t+=1===e?e:e-1,e+t>a&&(t=a-e+1),this.dataStartIndex=t,this.renderCore())},c.prototype.scrollLeft=function(){var e=this.itemsToDisplay,t=this.dataStartIndex,i=0;0!==t&&(1===e&&(t-=e),t=t-e<i?i:t-e+1,this.dataStartIndex=t,this.renderCore())},c.prototype.isLastRowItem=function(e,t){return e===t-1},c.prototype.getScaledTextWidth=function(e){return e/a.TextSizeDefaults.TextSizeMin*o},c.prototype.isMaxWidthCalculated=function(){return void 0!==this.maxItemWidth},c.prototype.calculateAndSetMaxItemWidth=function(){var t=this.getDataPointsCount(),r=0;if(0===t)return void(this.maxItemWidth=r);var o=this.data,s=o.slicerDataPoints,l=Math.min(t,n),u=jQuery.extend(!0,{},this.textProperties),c=o.slicerSettings.slicerText.textSize;u.fontSize=i.fromPoint(c);for(var d=a.WordBreaker.getMaxWordWidth,p=0;p<l;p++){var h=s[p].value;u.text=h,r=Math.max(r,d(h,e.TextMeasurementService.measureSvgTextWidth,u))}this.maxItemWidth=Math.min(r,this.getScaledTextWidth(c))},c.prototype.calculateAndSetTotalItemWidth=function(){var e=this.data,t=u.labelText.paddingLeft+u.labelText.paddingRight+u.labelText.marginRight,i=this.domHelper.getRowsOutlineWidth(e.slicerSettings.slicerText.outline,e.slicerSettings.general.outlineWeight);this.totalItemWidth=this.maxItemWidth+t+i},c.prototype.getNumberOfItemsToDisplay=function(e){var t=this.totalItemWidth;if(0===t)return 0;var i=this.getDataPointsCount(),a=Math.min(i,Math.round(e/t));return Math.max(a,1)},c.prototype.getDataPointsCount=function(){return _.size(this.data.slicerDataPoints)},c})();t.HorizontalSlicerRenderer=c;var d;!(function(e){var t=a.CssConstants.createClassAndSelector;e.container=t("horizontalSlicerContainer"),e.ItemsContainer=t("slicerItemsContainer"),e.NavigationArrow=t("navigationArrow"),e.LeftNavigationArrow=t("left"),e.RightNavigationArrow=t("right"),e.MultiSelectEnabled=t("isMultiSelectEnabled"),e.FlexDisplay=t("flexDisplay"),e.CanScrollRight=t("canScrollRight"),e.CanScrollLeft=t("canScrollLeft")})(d||(d={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=t.SlicerUtil.DOMHelper,r=e.visuals.controls.SlicerHeader,n="slicer-header-wrapper",o="slicer-container",s="slicer-content-wrapper",l="full-screen",u=(function(){function u(e){this.enableInFocusRenderers=!1,this.isInFocus=!1,this.hasSearchableData=!1,e&&(this.behavior=e.behavior,this.enableInFocusRenderers=e.enableInFocusRenderers),this.domHelper=new i,this.activeMode=t.slicerMode.basic,this.slicerOrientation=0}return u.customizeQuery=function(e){if(u.DateSlicerEnabled){var i=e.dataViewMappings[0];if(i&&i.metadata){var a=u.getSlicerMode(i.metadata.objects);if((null===a||u.isRangeSlicerMode(a))&&u.isCategoryItemDateTime(i)){var r=i.categorical.categories.for.in.items;i.categorical.categories=null,i.categorical.values={bind:{to:{role:t.slicerRoles.value,aggregates:{min:!0,max:!0},items:r}}}}}}},u.isCrossFilteredByDefault=function(e){if(!u.DateSlicerEnabled)return!1;var t=e.dataViewMappings[0];if(!t||!t.metadata)return!1;var i=u.getSlicerMode(t.metadata.objects);return null==i?u.isCategoryItemDateTime(t):u.isRangeSlicerMode(i)},u.getSortableRoles=function(e){var i=e.dataViewMappings[0];if(u.DateSlicerEnabled&&i&&i.metadata&&u.isCategoryItemDateTime(i)){var a=u.getSlicerMode(i.metadata.objects);if(null===a||a===t.slicerMode.after||a===t.slicerMode.before||a===t.slicerMode.between)return null}return[t.slicerRoles.value]},u.getSlicerMode=function(i){var a=null;return i&&(a=e.DataViewObjects.getValue(i,t.slicerProps.data.mode,a)),a},u.isCategoryItemDateTime=function(e){if(e&&e.categorical&&e.categorical.categories&&e.metadata){var t=e.categorical.categories.for.in.items;if(!_.isEmpty(t)){var i=t[0];if(i.type&&i.type.dateTime)return!0}}return!1},u.isRangeSlicerMode=function(e){return e===t.slicerMode.before||e===t.slicerMode.between||e===t.slicerMode.after},u.prototype.init=function(e){this.initOptions=e,this.element=e.element,this.currentViewport=e.viewport,this.hostServices=e.host,this.waitingForData=!1,this.container=a.DomFactory.div().addClass(o).appendTo(this.element),this.headerContainer=a.DomFactory.div().appendTo(this.container).addClass(n),this.slicerContainer=a.DomFactory.div().appendTo(this.container).addClass(s),this.initializeSlicerRenderer()},u.prototype.destroy=function(){this.slicerRenderer.onDestroy&&this.slicerRenderer.onDestroy()},u.prototype.update=function(t){this.isInFocus=!!t.isInFocus,t.type&e.VisualUpdateType.Resize&&this.resizing(t.viewport),(!t.type||t.type&e.VisualUpdateType.Data)&&this.dataChanged(t.dataViews,t.operationKind)},u.prototype.dataChanged=function(t,i){if(!_.isEmpty(t)){var a=this.dataView;this.dataView=t[0];var r=i!==e.VisualDataChangeOperationKind.Append&&!e.DataViewAnalysis.hasSameCategoryIdentity(a,this.dataView);this.render(r,!0)}},u.prototype.resizing=function(e){this.currentViewport=e,this.render(!1)},u.prototype.enumerateObjectInstances=function(e){if(this.dataView)switch(e.objectName){case"header":case"modeSelection":return this.slicerHeader.enumerateObjectInstances(e);case"general":var t=this.slicerHeader.enumerateObjectInstances(e),i=this.data?this.data.orientation:0;return t[0].properties.orientation=i,t;default:return this.slicerRenderer.enumerateObjectInstances(e)}},u.prototype.loadMoreData=function(){var e=this.dataView;if(e){var t=e.metadata;!this.waitingForData&&t&&t.segment&&(this.hostServices.loadMoreData(),this.waitingForData=!0)}},u.prototype.onClearSelection=function(){this.interactivityService&&(this.interactivityService.clearSelection(),this.render(!1))},u.converter=function(i,a){if(i){var r,n=null,o=0,s=!1,l=!1,c=t.slicerMode.type.members([t.slicerMode.basic]);u.DropDownSlicerEnabled&&c.push(t.slicerMode.type.members([t.slicerMode.dropdown])[0]);var d=0,p=!1;if(i.metadata&&i.metadata.objects){var h=i.metadata.objects;o=e.DataViewObjects.getValue(h,t.slicerProps.general.orientation,o),n=e.DataViewObjects.getValue(h,t.slicerProps.data.mode,n)}if(i.metadata&&i.metadata.columns){var g=_.filter(i.metadata.columns,(function(e){return e.roles&&null!=e.roles[t.slicerRoles.value]}));if(!_.isEmpty(g)){var f=g[0];if(p=f.type.text===!0,r=f.displayName,u.DateSlicerEnabled){l=f.type.dateTime===!0;var m=!!(f.aggregates&&f.aggregates.min&&f.aggregates.max);null==n?n=l?t.slicerMode.between:t.slicerMode.basic:_.indexOf(t.DateSlicerSupportedModes,n)>-1&&!l&&(n=t.slicerMode.basic),0!==a&&(d=l?m||!this.isRangeSlicerMode(n)?1:2:u.DropDownSlicerEnabled?1:0),l&&(c=t.slicerMode.type.members())}else null!=n&&n!==t.slicerMode.basic&&(n=t.slicerMode.basic,s=!0)}}return{orientation:o,categorySourceName:r,mode:n,shouldUpdateMode:s,switchMode:d,hasSearchableData:p,activeOptions:c}}},u.prototype.render=function(e,t){return this.updateViewport(),this.data=u.converter(this.dataView,this.hostServices.getViewMode()),this.data&&(this.hasSearchableData=this.data.hasSearchableData),this.data&&this.data.shouldUpdateMode?void this.setMode(this.data.mode):(this.updateSlicerRendererIfNeeded(),this.renderSlicerHeader(this.interactivityService),this.slicerRenderer.render({dataView:this.dataView,viewport:this.currentViewport,resetScrollbarPosition:e,hasSearchableData:this.hasSearchableData}),void(t&&(this.waitingForData=!1)))},u.prototype.updateSlicerRendererIfNeeded=function(){if(this.enableInFocusRenderers){var e=this.container.hasClass(l)!==this.isInFocus;if(e)return this.isInFocus?this.container.addClass(l):this.container.removeClass(l),void this.initializeSlicerRenderer()}if(this.data){var i=this.data.mode||t.slicerMode.basic;if(this.activeMode!==i)this.activeMode=i,this.initializeSlicerRenderer();else{var a=this.data.orientation||0;this.slicerOrientation!==a&&(this.slicerOrientation=a,this.initializeSlicerRenderer())}}},u.prototype.updateViewport=function(){var e=(t={height:this.currentViewport.height},t["min-width"]=this.currentViewport.width,t);this.container.css(e);var t},u.prototype.renderSlicerHeader=function(t){var i=this;if(this.dataView){var a=e.data.createIDataViewCategoricalReader(this.dataView);if(!this.slicerHeader){var n={onClear:function(){i.slicerRenderer&&i.slicerRenderer.onClear()},onChange:function(e){i.slicerRenderer&&i.slicerRenderer.onModeChange(e)},host:this.headerContainer,text:this.data.categorySourceName,visibilityState:this.data.switchMode,selectedValue:this.activeMode,hoverContainer:this.element,enableInFocusRenderers:this.enableInFocusRenderers,slicerModeOptions:this.data.activeOptions};this.slicerHeader=new r(n,this.hostServices.getLocalizedString)}this.slicerHeader.update(a,{text:this.data.categorySourceName,selectedValue:this.activeMode,visibilityState:this.data.switchMode,isInFocus:this.isInFocus,slicerModeOptions:this.data.activeOptions})}},u.prototype.setMode=function(e){var t={replace:[{objectName:"general",selector:void 0,properties:{mode:e}}]};this.hostServices.persistProperties(t)},u.prototype.initializeSlicerRenderer=function(){if(this.slicerContainer.empty(),this.enableInFocusRenderers&&this.isInFocus)return void this.initializeInFocusVerticalSlicer();if(this.activeMode===t.slicerMode.basic)switch(this.slicerOrientation){case 1:this.initializeHorizontalSlicer();break;case 0:this.initializeVerticalSlicer()}else this.activeMode===t.slicerMode.dropdown?this.initializeDropdownSlicer():this.initializeDateSlicer()},u.prototype.initializeInFocusVerticalSlicer=function(){var e=this.slicerRenderer=new t.VerticalSlicerRenderer(new t.VerticalSlicerRenderer.CheckListSlicerStrategy,{hostServices:this.hostServices,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i,this.slicerContainer)},u.prototype.initializeVerticalSlicer=function(){var e=this.slicerRenderer=new t.VerticalSlicerRenderer(new t.VerticalSlicerRenderer.CheckBoxSlicerStrategy,{hostServices:this.hostServices,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i,this.slicerContainer)},u.prototype.initializeDateSlicer=function(){var e=this.slicerRenderer=new t.DateSlicer({hostServices:this.hostServices,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i,this.slicerContainer)},u.prototype.initializeHorizontalSlicer=function(){var e=this.slicerRenderer=new t.HorizontalSlicerRenderer({hostServices:this.hostServices,behavior:this.behavior}),i=this.createInitOptions();this.interactivityService=e.init(i,this.slicerContainer)},u.prototype.initializeDropdownSlicer=function(){var e={hostServices:this.hostServices,behavior:this.behavior},i=new t.VerticalSlicerRenderer(new t.VerticalSlicerRenderer.CheckBoxSlicerStrategy,e);this.slicerRenderer=new t.DropdownSlicerRenderer(i,e);var a=this.createInitOptions();this.interactivityService=this.slicerRenderer.init(a,this.slicerContainer)},u.prototype.createInitOptions=function(){var e=this;return{visualInitOptions:this.initOptions,loadMoreData:function(){return e.loadMoreData()}}},u.DateSlicerEnabled=!1,u.DropDownSlicerEnabled=!1,u})();t.Slicer=u})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.visuals.controls.internal.TablixUtils.CellStyle,r=e.visuals.controls.internal.TablixUtils.EdgeSettings,n=e.visuals.controls.internal.TablixUtils.EdgeType,o=e.visuals.controls.TablixColumnWidthManager,s=e.visuals.controls.internal.TablixObjects,l=e.visuals.controls.internal.TablixUtils,u=a.WordBreaker,c=(function(){function t(e,t,i){this.tableDataView=e,this.isDataComplete=t,this.formatter=i}return t.prototype.getColumnHierarchyDepth=function(){return 1},t.prototype.getRowHierarchyDepth=function(){return 1},t.prototype.getLeafCount=function(e){return e.length},t.prototype.getLeafAt=function(e,t){return e[t]},t.prototype.getParent=function(e){return null},t.prototype.getIndex=function(e){return e?this.isRow(e)?e.index:this.getColumnIndex(e):-1},t.prototype.isRow=function(e){if(!e)return!1;var t=e;return void 0!==t.index&&void 0!==t.values},t.prototype.getColumnIndex=function(e){return t.getIndex(this.tableDataView.columns,e)},t.prototype.isLeaf=function(e){return!0},t.prototype.isRowHierarchyLeaf=function(e){return!1},t.prototype.isColumnHierarchyLeaf=function(e){return!0},t.prototype.isFirstItem=function(e,t){return e===t[0]},t.prototype.areAllParentsFirst=function(e,t){return this.isFirstItem(e,t)},t.prototype.isLastItem=function(e,t){return(t===this.tableDataView.columns||this.isDataComplete)&&e===_.last(t)},t.prototype.areAllParentsLast=function(e,t){return this.isLastItem(e,t)},t.prototype.getChildren=function(e){return null},t.prototype.getChildrenLevelDifference=function(e){return 1/0},t.prototype.getCount=function(e){return e.length},t.prototype.getAt=function(e,t){return e[t]},t.prototype.getLevel=function(e){return 0},t.prototype.getIntersection=function(e,i){var a,r=!1,n=new l.CellPosition,o=t.getIndex(this.tableDataView.columns,i);n.column.index=o,n.column.isFirst=0===o,n.column.isLast=o===this.tableDataView.columns.length-1;var u=e;if(null!=u.totalCells)r=!0,a=u.totalCells[o];else{var c=e,d=c.index;n.row.index=d,n.row.isFirst=0===d,n.row.isLast=this.isDataComplete&&d===this.tableDataView.rows.length-1,a=c.values[o]}var p=new l.TablixVisualCell(a,(!1),(!1),r,(!1),i,this.formatter,(!1));p.position=n;var h=e;if(h&&h.values){var g=h.values.objects;if(g){var f=g[o];f&&(p.backColor=s.PropValuesBackColor.getValue(f))}}return p},t.prototype.getCorner=function(e,t){return null},t.prototype.headerItemEquals=function(t,i){if(t===i)return!0;if(t.displayName&&i.displayName){var a=t,r=i;return e.DataViewAnalysis.areMetadataColumnsEquivalent(a,r)}return!(!this.isRow(t)||!this.isRow(i))&&t.index===i.index},t.prototype.bodyCellItemEquals=function(e,t){return e.isMatch(t)},t.prototype.cornerCellItemEquals=function(e,t){return!0},t.prototype.update=function(e,t){this.tableDataView=e,this.isDataComplete=t},t.getIndex=function(e,t){for(var i=0,a=e.length;i<a;i++){var r=e[i];if(null!=r.index&&null!=t.index&&r.index===t.index)return i;if(t===e[i])return i}return-1},t})();t.TableHierarchyNavigator=c;var d=(function(){function o(e,t){this.options=e,t&&this.updateDataView(t)}return o.prototype.updateDataView=function(e){this.tableDataView=e,this.formattingProperties=e.formattingProperties,this.updateTextHeights(),this.hasImage()?this.rowHeight=Math.max(this.textHeightValue,this.formattingProperties.grid.imageHeight):this.rowHeight=this.textHeightValue},o.prototype.updateTextHeights=function(){this.fontSizeHeader=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsHeader={fontFamily:l.FontFamilyHeader,fontSize:a.PixelConverter.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsValue={fontFamily:l.FontFamilyCell,fontSize:a.PixelConverter.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsTotal={fontFamily:l.FontFamilyTotal,fontSize:a.PixelConverter.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsTotal,"a"))},o.prototype.hasImage=function(){return _.any(this.tableDataView.columns,(function(e){return t.converterHelper.isImageUrlColumn(e)}))},o.prototype.getColumnFormatting=function(e){return this.formattingProperties.columnFormatting[e.queryName]},o.prototype.onStartRenderingSession=function(){},o.prototype.onEndRenderingSession=function(){},o.prototype.bindRowHeader=function(e,t){e.totalCells?t.contentHeight=this.textHeightTotal:t.contentHeight=this.rowHeight,l.clearCellStyle(t),this.options.onBindRowHeader&&this.options.onBindRowHeader(e)},o.prototype.unbindRowHeader=function(e,t){},o.prototype.bindColumnHeader=function(t,a){var n=this;a.extension.disableDragResize(),l.resetCellCssClass(a),l.addCellCssClass(a,l.CssClassTablixHeader),l.addCellCssClass(a,l.CssClassTablixColumnHeaderLeaf);var o=new i;o.fontFamily=l.FontFamilyHeader,o.fontColor=l.FontColorHeaders,o.borders.bottom=new r(s.PropGridOutlineWeight.defaultValue,s.PropGridOutlineColor.defaultValue),this.setColumnHeaderStyle(t,a,o);var u=a.extension.contentHost;u=l.appendDiv(u),u.classList.add(l.CssClassWrappingContainer);var c,d=this.getWordWrappingWidth(t.queryName,a,o);null!=d&&(c=this.getWordWrappingLines(t.displayName,d));var p=c&&c.length>1;if(p){a.contentHeight=c.length*this.textHeightHeader;for(var h=0,g=c.length;h<g-1;h++)l.appendDiv(u,c[h]);u=l.appendDiv(u)}else a.contentHeight=this.textHeightHeader;this.sortIconsEnabled()&&(u=l.addSortIconToColumnHeader(t.sort,u),t.sort&&!p&&(a.contentWidth=this.fontSizeHeader+l.SortIconPadding));var f=t.displayName;if(p){var m=_.last(c);l.setCellText(m,u),l.setCellTooltip(f,a.extension.contentHost),a.contentWidth=d}else l.setCellTextAndTooltip(f,u,a.extension.contentHost),a.contentWidth+=e.TextMeasurementService.measureSvgTextWidth(this.textPropsHeader,f);if(a.contentWidth=Math.ceil(a.contentWidth),this.options.onColumnHeaderClick){var y=function(e){if(l.isValidSortClick(e)){var i=l.reverseSort(t.sort);n.options.onColumnHeaderClick(t.queryName?t.queryName:t.displayName,i)}};a.extension.registerClickHandler(y)}a.applyStyle(o)},o.prototype.getWordWrappingLines=function(t,i){return u.splitByWidth(t,this.textPropsHeader,e.TextMeasurementService.measureSvgTextWidth,i,l.WordWrappingMaxLines,void 0,!0)},o.prototype.getWordWrappingWidth=function(e,t,i){if(this.formattingProperties.columnHeaders.wordWrap&&0===this.options.layoutKind){var a;if(t.isColumnResizing()&&t.containerWidth>=0?a=t.containerWidth:this.options.columnWidthManager&&(a=this.options.columnWidthManager.getPersistedColumnWidth(e)),null!=a)return Math.max(0,a-(i.getExtraLeft()+i.getExtraRight()))}},o.prototype.setColumnHeaderStyle=function(e,i,a){var o=this.formattingProperties.grid,s=this.formattingProperties.columnHeaders,l=this.formattingProperties.total,u=this.formattingProperties.values;a.borders.top=new r,a.borders.top.applyParams(t.outline.showTop(s.outline),o.outlineWeight,o.outlineColor,n.Outline),a.borders.bottom=new r,a.borders.bottom.applyParams(t.outline.showBottom(s.outline),o.outlineWeight,o.outlineColor,n.Outline),a.borders.left=new r,i.position.column.isFirst&&(a.borders.left.applyParams(t.outline.showLeft(s.outline),o.outlineWeight,o.outlineColor,n.Outline),t.outline.showLeft(s.outline)||!t.outline.showLeft(l.outline)&&!t.outline.showLeft(u.outline)||(a.paddings.left+=o.outlineWeight)),a.borders.right=new r,i.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(s.outline),o.outlineWeight,o.outlineColor,n.Outline),t.outline.showRight(s.outline)||!t.outline.showRight(l.outline)&&!t.outline.showRight(u.outline)||(a.paddings.right+=o.outlineWeight)):a.borders.right.applyParams(o.gridVertical,o.gridVerticalWeight,o.gridVerticalColor,n.Gridline);var c=this.getColumnFormatting(e);c.styleHeader&&c.fontColor?a.fontColor=c.fontColor:a.fontColor=s.fontColor,c.styleHeader&&c.backColor?a.backColor=c.backColor:a.backColor=s.backColor,a.paddings.top=a.paddings.bottom=o.rowPadding},o.prototype.unbindColumnHeader=function(e,t){l.clearCellStyle(t),l.clearCellTextAndTooltip(t),this.sortIconsEnabled()&&l.removeSortIcons(t),this.options.onColumnHeaderClick&&t.extension.unregisterClickHandler()},o.prototype.bindBodyCell=function(e,t){l.resetCellCssClass(t),this.setBodyContent(e,t),t.contentWidth=Math.ceil(t.contentWidth);var a=new i;e.isTotal?(l.addCellCssClass(t,l.CssClassTablixValueTotal),l.addCellCssClass(t,l.CssClassTableFooter),a.fontFamily=l.FontFamilyTotal,a.borders.top=new r(s.PropGridOutlineWeight.defaultValue,s.PropGridOutlineColor.defaultValue)):e.position.row.isLast?l.addCellCssClass(t,l.CssClassTableBodyCellBottom):(l.addCellCssClass(t,l.CssClassTableBodyCell),
a.borders.bottom=new r(s.PropGridHorizontalWeight.defaultValue,s.PropGridHorizontalColor.defaultValue)),e.isNumeric&&l.addCellCssClass(t,l.CssClassTablixValueNumeric),e.isTotal?this.setFooterStyle(e,t,a):this.setBodyStyle(e,t,a),t.applyStyle(a)},o.prototype.setBodyContent=function(t,i){var a=i.extension.contentHost,r=this.formattingProperties.grid.imageHeight,n=t.textContent;if(t.isTotal?i.contentHeight=this.textHeightTotal:t.isImage?i.contentHeight=r:i.contentHeight=this.textHeightValue,t.isUrl&&t.isValidUrl){var o=this.formattingProperties.values.urlIcon;return l.appendATagToBodyCell(n,a,o),void(o?i.contentWidth=this.fontSizeValue:i.contentWidth=e.TextMeasurementService.measureSvgTextWidth(this.textPropsValue,n))}if(t.isImage&&t.isValidUrl)return l.appendImgTagToBodyCell(n,a,r),void(i.contentWidth=r*l.ImageDefaultAspectRatio);var s=t.kpiContent;return s?($(a).append(s),void(i.contentWidth=this.fontSizeValue)):n?(l.setCellTextAndTooltip(n,a),void(t.isTotal?i.contentWidth=e.TextMeasurementService.measureSvgTextWidth(this.textPropsTotal,n):i.contentWidth=e.TextMeasurementService.measureSvgTextWidth(this.textPropsValue,n))):(l.setCellTextAndTooltip(" ",a),void(i.contentWidth=0))},o.prototype.setBodyStyle=function(e,i,a){var o=this.formattingProperties.grid,s=this.formattingProperties.values,l=this.formattingProperties.total,u=this.formattingProperties.columnHeaders;a.borders.top=new r,i.position.row.isFirst&&a.borders.top.applyParams(t.outline.showTop(s.outline),o.outlineWeight,o.outlineColor,n.Outline),a.borders.bottom=new r,i.position.row.isLast?a.borders.bottom.applyParams(t.outline.showBottom(s.outline),o.outlineWeight,o.outlineColor,n.Outline):a.borders.bottom.applyParams(o.gridHorizontal,o.gridHorizontalWeight,o.gridHorizontalColor,n.Gridline),a.borders.left=new r,i.position.column.isFirst&&(a.borders.left.applyParams(t.outline.showLeft(s.outline),o.outlineWeight,o.outlineColor,n.Outline),t.outline.showLeft(s.outline)||!t.outline.showLeft(l.outline)&&!t.outline.showLeft(u.outline)||(a.paddings.left+=o.outlineWeight)),a.borders.right=new r,i.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(s.outline),o.outlineWeight,o.outlineColor,n.Outline),t.outline.showRight(s.outline)||!t.outline.showRight(l.outline)&&!t.outline.showRight(u.outline)||(a.paddings.right+=o.outlineWeight)):a.borders.right.applyParams(o.gridVertical,o.gridVerticalWeight,o.gridVerticalColor,n.Gridline);var c=this.getColumnFormatting(e.columnMetadata);c.styleValues&&c.fontColor?a.fontColor=c.fontColor:a.fontColor=i.position.row.index%2===0?s.fontColorPrimary:s.fontColorSecondary,e.backColor?a.backColor=e.backColor:c.styleValues&&c.backColor?a.backColor=c.backColor:a.backColor=i.position.row.index%2===0?s.backColorPrimary:s.backColorSecondary,a.paddings.top=a.paddings.bottom=o.rowPadding},o.prototype.setFooterStyle=function(e,i,a){var o=this.formattingProperties.total,s=this.formattingProperties.grid,l=this.formattingProperties.values,u=this.formattingProperties.columnHeaders;a.borders.top=new r,a.borders.top.applyParams(t.outline.showTop(o.outline),s.outlineWeight,s.outlineColor,n.Outline),a.borders.bottom=new r,a.borders.bottom.applyParams(t.outline.showBottom(o.outline),s.outlineWeight,s.outlineColor,n.Outline),a.borders.left=new r,i.position.column.isFirst&&(a.borders.left.applyParams(t.outline.showLeft(o.outline),s.outlineWeight,s.outlineColor,n.Outline),t.outline.showLeft(o.outline)||!t.outline.showLeft(l.outline)&&!t.outline.showLeft(u.outline)||(a.paddings.left+=s.outlineWeight)),a.borders.right=new r,i.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(o.outline),s.outlineWeight,s.outlineColor,n.Outline),t.outline.showRight(o.outline)||!t.outline.showRight(l.outline)&&!t.outline.showRight(u.outline)||(a.paddings.right+=s.outlineWeight)):a.borders.right.applyParams(s.gridVertical,s.gridVerticalWeight,s.gridVerticalColor,n.Gridline);var c=this.getColumnFormatting(e.columnMetadata);c.styleTotal&&c.fontColor?a.fontColor=c.fontColor:a.fontColor=o.fontColor,c.styleTotal&&c.backColor?a.backColor=c.backColor:a.backColor=o.backColor,a.paddings.top=a.paddings.bottom=s.rowPadding},o.prototype.unbindBodyCell=function(e,t){l.clearCellStyle(t),l.clearCellTextAndTooltip(t)},o.prototype.bindCornerCell=function(e,t){t.contentWidth=0},o.prototype.unbindCornerCell=function(e,t){},o.prototype.bindEmptySpaceHeaderCell=function(e){},o.prototype.unbindEmptySpaceHeaderCell=function(e){},o.prototype.bindEmptySpaceFooterCell=function(e){},o.prototype.unbindEmptySpaceFooterCell=function(e){},o.prototype.getHeaderLabel=function(e){return e?e.displayName:""},o.prototype.getCellContent=function(e){return e},o.prototype.hasRowGroups=function(){return!1},o.prototype.sortIconsEnabled=function(){return 0===this.options.layoutKind},o})();t.TableBinder=d;var p=(function(){function i(e){this.isTouchDisabled=e&&e.isTouchDisabled,this.tablixColumnFormattingEnabled=e&&!!e.tablixColumnFormattingEnabled,this.tablixWordWrappingEnabled=e&&!!e.tablixWordWrappingEnabled}return i.customizeQuery=function(e){var t=e.dataViewMappings[0];if(t&&t.table&&t.metadata){var i=t.table.rows,a=t.metadata.objects;i.for.in.subtotalType=s.shouldShowTableTotals(a)?1:0}},i.getSortableRoles=function(){return["Values"]},i.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatVariantMeasureValue,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.getLocalizedString=e.host.getLocalizedString,this.hostServices=e.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},i.converter=function(t,i){var a=t.table,r=e.Prototype.inherit(a);r.visualRows=[];for(var n=0;n<a.rows.length;n++){var o={index:n,values:a.rows[n]};r.visualRows.push(o)}return r.formattingProperties=s.getTableObjects(t,i),r},i.prototype.onResizing=function(e){this.updateViewport(e)},i.prototype.getColumnWidthManager=function(){return this.columnWidthManager},i.prototype.onDataChanged=function(t){var a=t.dataViews;if(a&&a.length>0){var r=this.dataView;if(this.dataView=a[0],this.persistingObjects)return void(this.persistingObjects=!1);var n=i.converter(this.dataView,this.tablixWordWrappingEnabled);t.operationKind===e.VisualDataChangeOperationKind.Append?(this.createOrUpdateHierarchyNavigator(n),this.tablixControl.updateModels(!1,n.visualRows,n.columns),this.refreshControl(!1)):(this.createOrUpdateHierarchyNavigator(n),this.createColumnWidthManager(),this.createOrUpdateTablixControl(n),this.updateInternal(r,n))}this.waitingForData=!1,this.waitingForSort=!1},i.prototype.createColumnWidthManager=function(){var e=this;this.columnWidthManager?this.columnWidthManager.updateDataView(this.dataView):this.columnWidthManager=new o(this.dataView,(!1),function(t){return e.persistColumnWidths(t)})},i.prototype.persistColumnWidths=function(e){this.persistingObjects=!0,this.hostServices.persistProperties(e)},i.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},i.prototype.refreshControl=function(e){(t.visibilityHelper.partiallyVisible(this.element)||1===this.getLayoutKind())&&this.tablixControl.refresh(e)},i.prototype.getLayoutKind=function(){return this.isInteractive?0:1},i.prototype.createOrUpdateHierarchyNavigator=function(e){var t=!this.dataView.metadata.segment;if(this.tablixControl)this.hierarchyNavigator.update(e,t);else{var i=new c(e,t,this.formatter);this.hierarchyNavigator=i}},i.prototype.createOrUpdateTablixControl=function(e){if(this.tablixControl){var t=this.tablixControl.getBinder();t.updateDataView(e)}else this.tablixControl=this.createControl(this.hierarchyNavigator,e)},i.prototype.createControl=function(e,i){var a=this,r=this.getLayoutKind(),n=i.formattingProperties.general.textSize,o={onBindRowHeader:function(e){return a.onBindRowHeader(e)},onColumnHeaderClick:function(e,t){return a.onColumnHeaderClick(e,t)},layoutKind:r,columnWidthManager:this.columnWidthManager},l=new d(o,i),u=1===r?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(l):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(l,this.columnWidthManager),c=document.createElement("div");this.element.append(c);var p={interactive:this.isInteractive,enableTouchSupport:!this.isTouchDisabled,layoutKind:r,fontSize:s.getTextSizeInPx(n)};return new t.controls.TablixControl(e,u,l,c,p)},i.prototype.updateInternal=function(e,i){var a=this,r=i.formattingProperties.general.textSize;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize(t.converterHelper.hasImageUrlColumn(this.dataView)),this.tablixControl.fontSize=s.getTextSizeInPx(r),this.tablixControl.wordWrapColumnHeaders=this.tablixWordWrappingEnabled&&i.formattingProperties.columnHeaders.wordWrap,this.verifyHeaderResize(),this.tablixControl.updateModels(!0,i.visualRows,i.columns);var n=this.createTotalsRow(this.dataView);this.tablixControl.rowDimension.setFooter(n),this.tablixControl.viewport=this.currentViewport;var o=this.shouldClearControl(e,this.dataView);setTimeout((function(){a.refreshControl(o);var e=a.columnWidthManager.onColumnsRendered(a.tablixControl.layoutManager.columnWidthsToPersist);a.persistingObjects&&!e&&(a.persistingObjects=!1)}),0)},i.prototype.shouldClearControl=function(t,i){return!(this.waitingForSort&&t&&i)||!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata)},i.prototype.createTotalsRow=function(e){if(!s.shouldShowTableTotals(e.metadata.objects))return null;var t=e.table.totals;if(!t||0===t.length)return null;for(var i=[],a=e.table.columns,r=0,n=a.length;r<n;++r){var o=a[r],l=t[o.index];null!=l?i.push(l):i.push(0===r?this.getLocalizedString("TableTotalLabel"):"")}return{totalCells:i}},i.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},i.prototype.onColumnHeaderClick=function(e,t){this.waitingForSort=!0,this.hostServices.onCustomSort(l.getCustomSortEventArgs(e,t))},i.prototype.needsMoreData=function(e){if(this.waitingForData||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),a=t*i.preferredLoadMoreThreshold;return this.hierarchyNavigator.getIndex(e)>=a},i.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;return this.dataView&&s.enumerateObjectInstances(e,i,this.dataView,t.controls.TablixType.Table,this.tablixColumnFormattingEnabled,this.tablixWordWrappingEnabled),i.complete()},i.prototype.enumerateObjectRepetition=function(){var e=[];return this.dataView&&s.enumerateObjectRepetition(e,this.dataView,t.controls.TablixType.Table),e},i.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},i.prototype.onViewModeChanged=function(e){this.tablixControl&&this.tablixControl.toggleTouchBindings(1!==e),this.updateViewport(this.currentViewport)},i.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},i.preferredLoadMoreThreshold=.8,i})();t.Table=p})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){function i(e){if(e){for(var t=e;t.parent;)t=t.parent;return t.isSubtotal}return!1}function n(e,t,i,a){return new h(e,t,i,a)}var o=t.controls.internal.TablixUtils.CellStyle,s=t.controls.internal.TablixUtils.EdgeSettings,l=t.controls.internal.TablixUtils.EdgeType,u=t.controls.internal.TablixObjects,c=t.controls.internal.TablixUtils,d=a.UrlUtils,p=(function(e){function t(t,i,a,r,n,o){var s,l;if(i)for(s=i;s.parent;)s=s.parent;if(a)for(l=a;l.parent;)l=l.parent;var u=l&&!!l.isSubtotal,c=!u&&a&&!!a.isSubtotal,d=s&&!!s.isSubtotal,p=!d&&i&&!!i.isSubtotal;e.call(this,t,p,c,d,u,r,n,o)}return r(t,e),Object.defineProperty(t.prototype,"isMeasure",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValidUrl",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValidImage",{get:function(){return!1},enumerable:!0,configurable:!0}),t})(c.TablixVisualCell);t.MatrixVisualBodyItem=p,t.createMatrixHierarchyNavigator=n;var h=(function(){function t(e,i,a,r){this.matrix=e,this.rowHierarchy=t.wrapMatrixHierarchy(e.rows),this.columnHierarchy=t.wrapMatrixHierarchy(e.columns),this.formatter=a,this.compositeGroupSeparator=r,this.isDataComplete=i,this.update()}return t.prototype.getDataViewMatrix=function(){return this.matrix},t.prototype.getColumnHierarchyDepth=function(){return Math.max(this.columnHierarchy.levels.length,1)},t.prototype.getRowHierarchyDepth=function(){return Math.max(this.rowHierarchy.levels.length,1)},t.prototype.getLeafCount=function(e){var t=this.getMatrixHierarchy(e);return t?t.leafNodes.length:0},t.prototype.getLeafAt=function(e,t){var i=this.getMatrixHierarchy(e);return i?i.leafNodes[t]:null},t.prototype.getLeafIndex=function(e){return e.leafIndex},t.prototype.getParent=function(e){return 0===e.level?null:e.parent},t.prototype.getIndex=function(e){return e?e.index:-1},t.prototype.isLeaf=function(e){return!e.children||0===e.children.length},t.prototype.isRowHierarchyLeaf=function(e){return!0},t.prototype.isColumnHierarchyLeaf=function(e){return!1},t.prototype.isFirstItem=function(e,t){return e===_.first(t)},t.prototype.areAllParentsFirst=function(e,t){if(!e)return!1;var i=this.getParent(e);return i?this.isFirstItem(e,e.siblings)&&this.areAllParentsFirst(i,i.siblings):this.isFirstItem(e,e.siblings)},t.prototype.isLastItem=function(e,t){if(e!==_.last(t))return!1;if(!this.isItemRow(e)||this.isDataComplete)return!0;for(var i=e.parent;i;){if(i!==_.last(i.siblings))return!0;i=i.parent}return!1},t.prototype.isItemRow=function(e){if(!e)return!1;for(var t=e;t.parent;)t=t.parent;return t.siblings===this.rowHierarchy.root.children},t.prototype.areAllParentsLast=function(e,t){if(!e)return!1;var i=this.getParent(e);return i?this.isLastItem(e,e.siblings)&&this.areAllParentsLast(i,i.siblings):this.isLastItem(e,e.siblings)},t.prototype.getChildren=function(e){return e.children},t.prototype.getChildrenLevelDifference=function(e){for(var t=1/0,i=this.getChildren(e),a=0,r=i.length;a<r;a++)t=Math.min(t,i[a].level-e.level);return t},t.prototype.getCount=function(e){return e.length},t.prototype.getAt=function(e,t){return e[t]},t.prototype.getLevel=function(e){return e.level},t.prototype.getIntersection=function(e,t){var i,a,r,n=e.leafIndex,o=t.leafIndex;return i=e.values?e.values[t.leafIndex]:void 0,i?(a=this.matrix.valueSources[i.valueSourceIndex||0],r=new p(i.value,e,t,a,this.formatter,(!1))):r=new p((void 0),e,t,(void 0),this.formatter,(!1)),r.position.row.index=n,r.position.row.indexInSiblings=e.siblings.indexOf(e),r.position.row.isFirst=0===n,r.position.row.isLast=this.isDataComplete&&n===this.rowHierarchy.leafNodes.length-1,r.position.column.index=o,r.position.column.indexInSiblings=t.siblings.indexOf(t),r.position.column.isFirst=0===o,r.position.column.isLast=o===this.columnHierarchy.leafNodes.length-1,i&&i.objects&&(r.backColor=u.PropValuesBackColor.getValue(i.objects)),r},t.prototype.getCorner=function(e,t){var i=this.columnHierarchy.levels,a=this.rowHierarchy.levels;if(t===i.length-1||0===i.length){var r=a[e];if(r)return{metadata:1===r.sources.length?r.sources[0]:null,displayName:_.map(r.sources,(function(e){return e.displayName})).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!0,isRowHeaderLeaf:e===a.length-1}}if(e===a.length-1){var r=i[t];if(r)return{metadata:1===r.sources.length?r.sources[0]:null,displayName:_.map(r.sources,(function(e){return e.displayName})).join(this.compositeGroupSeparator),isColumnHeaderLeaf:!1,isRowHeaderLeaf:!0}}return{metadata:null,displayName:"",isColumnHeaderLeaf:!1,isRowHeaderLeaf:!1}},t.prototype.headerItemEquals=function(e,t){return!(!e||!t)&&e===t},t.prototype.bodyCellItemEquals=function(e,t){return e.position.isMatch(t.position)},t.prototype.cornerCellItemEquals=function(e,t){var i=e,a=t;return!(!i||!a)&&(i.displayName===a.displayName&&i.isColumnHeaderLeaf===a.isColumnHeaderLeaf&&i.isRowHeaderLeaf===a.isRowHeaderLeaf&&i.metadata===a.metadata)},t.prototype.getMatrixColumnHierarchy=function(){return this.columnHierarchy},t.prototype.getMatrixRowHierarchy=function(){return this.rowHierarchy},t.prototype.update=function(e,i,a,r){void 0===r&&(r=!0),i&&(this.matrix=i,null!=a&&(this.isDataComplete=a),this.rowHierarchy=t.wrapMatrixHierarchy(i.rows),r&&(this.columnHierarchy=t.wrapMatrixHierarchy(i.columns))),this.updateHierarchy(this.rowHierarchy,e),r&&(this.updateHierarchy(this.columnHierarchy,!1),t.updateStaticColumnHeaders(this.columnHierarchy))},t.wrapMatrixHierarchy=function(t){var i=e.Prototype.inherit(t);return i.leafNodes=[],i},t.prototype.updateHierarchy=function(e,t){e.leafNodes.length>0&&(e.leafNodes.length=0),e.root.children&&this.updateRecursive(e,e.root.children,null,e.leafNodes,t)},t.prototype.updateRecursive=function(e,t,i,a,r){for(var n,o=this,s=u.PropColumnFormatString.getPropertyID(),l=0,c=t.length;l<c;l++){var d=t[l];if(d.siblings=t,i&&(d.parent=i),n||(n=e.levels[d.level]),n)if(d.levelValues){var p=_.map(d.levelValues,(function(e){var t=n.sources[e.levelSourceIndex||0];return o.formatter(e.value,t,s,!1)}));d.valueFormatted=p.join(this.compositeGroupSeparator),d.queryName=1!==n.sources.length?void 0:n.sources[0].queryName}else{var h=n.sources[d.levelSourceIndex||0];d.valueFormatted=h.displayName,d.queryName=h.queryName}d.index=l,d.children&&d.children.length>0?(r&&(d.leafIndex=a.length,a.push(d)),this.updateRecursive(e,d.children,d,a,r)):r&&d.isSubtotal||(d.leafIndex=a.length,a.push(d))}},t.updateStaticColumnHeaders=function(e){var t=e.leafNodes;if(t&&t.length>0)for(var i=e.levels[t[0].level].sources,a=0,r=t.length;a<r;a++){var n=t[a];if(!n.identity&&_.isEmpty(n.levelValues)){var o=i[n.levelSourceIndex?n.levelSourceIndex:0];o&&(n.valueFormatted=o.displayName)}}},t.prototype.getMatrixHierarchy=function(e){var t=this.rowHierarchy.root.children;if(t&&e===t)return this.rowHierarchy;var i=this.columnHierarchy.root.children;return i&&e===i?this.columnHierarchy:null},t})();t.MatrixHierarchyNavigator=h;var g=(function(){function r(e,t){this.hierarchyNavigator=e,this.options=t}return r.prototype.onDataViewChanged=function(e){this.formattingProperties=e,this.updateTextHeights()},r.prototype.updateTextHeights=function(){this.fontSizeHeader=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsHeader={fontFamily:c.FontFamilyHeader,fontSize:a.PixelConverter.toString(this.fontSizeHeader)},this.textHeightHeader=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsHeader,"a")),this.fontSizeValue=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsValue={fontFamily:c.FontFamilyCell,fontSize:a.PixelConverter.toString(this.fontSizeValue)},this.textHeightValue=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsValue,"a")),this.fontSizeTotal=a.PixelConverter.fromPointToPixel(this.formattingProperties.general.textSize),this.textPropsTotal={fontFamily:c.FontFamilyTotal,fontSize:a.PixelConverter.toString(this.fontSizeTotal)},this.textHeightTotal=Math.ceil(e.TextMeasurementService.measureSvgTextHeight(this.textPropsTotal,"a"))},r.prototype.onStartRenderingSession=function(){},r.prototype.onEndRenderingSession=function(){},r.prototype.bindRowHeader=function(e,t){c.resetCellCssClass(t);var i=new o,a=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(e);a&&(c.addCellCssClass(t,c.CssClassMatrixRowHeaderLeaf),i.borders.right=new s(u.PropGridOutlineWeight.defaultValue,u.PropGridOutlineColor.defaultValue)),e.isSubtotal&&(i.paddings.left=c.CellPaddingLeftMatrixTotal),t.contentWidth=0,this.bindHeader(e,t,t.extension.contentHost,this.getRowHeaderMetadata(e),i),t.contentWidth=Math.ceil(t.contentWidth),this.options.onBindRowHeader&&this.options.onBindRowHeader(e),this.setRowHeaderStyle(t,e,i),t.applyStyle(i)},r.prototype.setRowHeaderStyle=function(e,a,r){var n=this.formattingProperties.grid,o=this.formattingProperties.rowHeaders,u=this.formattingProperties.values,c=this.formattingProperties.columnHeaders,d=this.formattingProperties.grandTotal;r.borders.top=new s,e.position.row.isFirst&&(r.borders.top.applyParams(t.outline.showTop(o.outline),n.outlineWeight,n.outlineColor,l.Outline),!t.outline.showTop(o.outline)&&t.outline.showTop(u.outline)&&(r.paddings.top+=n.outlineWeight)),r.borders.bottom=new s,e.position.row.isLast?(r.borders.bottom.applyParams(t.outline.showBottom(o.outline),n.outlineWeight,n.outlineColor,l.Outline),!t.outline.showBottom(o.outline)&&t.outline.showBottom(u.outline)&&(r.paddings.bottom+=n.outlineWeight)):r.borders.bottom.applyParams(n.gridHorizontal,n.gridHorizontalWeight,n.gridHorizontalColor,l.Gridline),r.borders.left=new s,e.position.column.isFirst&&(r.borders.left.applyParams(t.outline.showLeft(o.outline),n.outlineWeight,n.outlineColor,l.Outline),!t.outline.showLeft(o.outline)&&t.outline.showLeft(c.outline)&&(r.paddings.left+=n.outlineWeight)),r.borders.right=new s,e.position.column.isLast?r.borders.right.applyParams(t.outline.showRight(o.outline),n.outlineWeight,n.outlineColor,l.Outline):r.borders.right.applyParams(n.gridVertical,n.gridVerticalWeight,n.gridVerticalColor,l.Gridline),d.applyToHeaders&&i(a)?(r.fontColor=d.fontColor||o.fontColor,r.backColor=d.backColor||o.backColor):(r.fontColor=o.fontColor,r.backColor=o.backColor),r.paddings.top=r.paddings.bottom=n.rowPadding},r.prototype.unbindRowHeader=function(e,t){c.clearCellStyle(t),c.clearCellTextAndTooltip(t)},r.prototype.bindColumnHeader=function(e,t){c.resetCellCssClass(t);var i=new o,a=!1,r=t.extension.contentHost;r=c.appendDiv(r),r.classList.add(c.CssClassWrappingContainer),t.contentWidth=0;var n=this.hierarchyNavigator&&this.hierarchyNavigator.isLeaf(e);if(n){if(i.borders.bottom=new s(u.PropGridOutlineWeight.defaultValue,u.PropGridOutlineColor.defaultValue),c.addCellCssClass(t,c.CssClassTablixColumnHeaderLeaf),c.addCellCssClass(t,c.CssClassTablixValueNumeric),this.options.showSortIcons){var l=this.getSortableHeaderColumnMetadata(e);l&&(this.registerColumnHeaderClickHandler(l,t),r=c.addSortIconToColumnHeader(l.sort,r),l.sort&&(t.contentWidth=this.fontSizeHeader+c.SortIconPadding))}e.isSubtotal&&e.parent&&e.parent.children.length>1&&e.parent.children[0].isSubtotal&&(a=!0)}t.extension.disableDragResize(),this.bindHeader(e,t,r,this.getColumnHeaderMetadata(e),i,a),t.contentWidth=Math.ceil(t.contentWidth),this.setColumnHeaderStyle(t,e,i),t.applyStyle(i)},r.prototype.setColumnHeaderStyle=function(e,a,r){var n=this.formattingProperties.grid,o=this.formattingProperties.columnHeaders,u=this.formattingProperties.values,c=this.formattingProperties.grandTotal,d=this.formattingProperties.columnFormatting[a.queryName];d&&d.styleHeader&&d.fontColor?r.fontColor=d.fontColor:c.applyToHeaders&&i(a)?r.fontColor=c.fontColor||o.fontColor:r.fontColor=o.fontColor,d&&d.styleHeader&&d.backColor?r.backColor=d.backColor:c.applyToHeaders&&i(a)?r.backColor=c.backColor||o.backColor:r.backColor=o.backColor,r.paddings.top=r.paddings.bottom=n.rowPadding,r.borders.top=new s,e.position.row.isFirst&&r.borders.top.applyParams(t.outline.showTop(o.outline),n.outlineWeight,n.outlineColor,l.Outline),r.borders.bottom=new s,e.position.row.isLast?r.borders.bottom.applyParams(t.outline.showBottom(o.outline),n.outlineWeight,n.outlineColor,l.Outline):r.borders.bottom.applyParams(n.gridHorizontal,n.gridHorizontalWeight,n.gridHorizontalColor,l.Gridline),r.borders.left=new s,e.position.column.isFirst&&!t.outline.showLeft(o.outline)&&t.outline.showLeft(u.outline)&&(r.paddings.left+=n.outlineWeight),r.borders.right=new s,e.position.column.isLast?(r.borders.right.applyParams(t.outline.showRight(o.outline),n.outlineWeight,n.outlineColor,l.Outline),!t.outline.showRight(o.outline)&&t.outline.showRight(u.outline)&&(r.paddings.right+=n.outlineWeight)):r.borders.right.applyParams(n.gridVertical,n.gridVerticalWeight,n.gridVerticalColor,l.Gridline)},r.prototype.unbindColumnHeader=function(e,t){c.clearCellStyle(t),c.clearCellTextAndTooltip(t);var i=this.getSortableHeaderColumnMetadata(e);i&&this.unregisterColumnHeaderClickHandler(t),this.options.showSortIcons&&c.removeSortIcons(t)},r.prototype.bindHeader=function(i,a,r,n,o,s){c.addCellCssClass(a,c.CssClassTablixHeader),o.fontFamily=c.FontFamilyHeader,o.fontColor=c.FontColorHeaders;var l=this.formattingProperties.grid.imageHeight;if(t.converterHelper.isImageUrlColumn(n)?a.contentHeight=l:i.isSubtotal?a.contentHeight=this.textHeightTotal:a.contentHeight=this.textHeightValue,i.isSubtotal&&(c.addCellCssClass(a,c.CssClassTablixValueTotal),o.fontFamily=c.FontFamilyTotal,!s))return c.setCellTextAndTooltip(this.options.totalLabel,r,a.extension.contentHost),void(a.contentWidth=e.TextMeasurementService.measureSvgTextWidth(this.textPropsTotal,this.options.totalLabel));var u=this.getHeaderLabel(i);return u?t.converterHelper.isWebUrlColumn(n)&&d.isValidUrl(u)?(c.appendATagToBodyCell(u,r),void(a.contentWidth+=e.TextMeasurementService.measureSvgTextWidth(this.textPropsHeader,u))):t.converterHelper.isImageUrlColumn(n)&&d.isValidImageUrl(u)?(c.appendImgTagToBodyCell(i.valueFormatted,r,l),void(a.contentWidth+=l*c.ImageDefaultAspectRatio)):(c.setCellTextAndTooltip(u,r,a.extension.contentHost),void(a.contentWidth+=e.TextMeasurementService.measureSvgTextWidth(i.isSubtotal?this.textPropsTotal:this.textPropsHeader,u))):void(r.innerHTML=c.StringNonBreakingSpace)},r.prototype.registerColumnHeaderClickHandler=function(e,t){var i=this;if(this.options.onColumnHeaderClick){var a=function(t){if(c.isValidSortClick(t)){var a=c.reverseSort(e.sort);i.options.onColumnHeaderClick(e.queryName?e.queryName:e.displayName,a)}};t.extension.registerClickHandler(a)}},r.prototype.unregisterColumnHeaderClickHandler=function(e){this.options.onColumnHeaderClick&&e.extension.unregisterClickHandler()},r.prototype.bindBodyCell=function(t,i){c.resetCellCssClass(i);var a=new c.CellStyle;i.contentHeight=this.textHeightValue;var r=t.kpiContent;if(r)$(i.extension.contentHost).append(r),i.contentWidth=this.fontSizeValue;else{var n=this.textPropsValue;c.addCellCssClass(i,c.CssClassTablixValueNumeric),t.isTotal&&(c.addCellCssClass(i,c.CssClassTablixValueTotal),a.fontFamily=c.FontFamilyTotal,i.contentHeight=this.textHeightTotal,n=this.textPropsTotal);var o=t.textContent;o&&(c.setCellTextAndTooltip(o,i.extension.contentHost),i.contentWidth=e.TextMeasurementService.measureSvgTextWidth(n,o))}i.contentWidth=Math.ceil(i.contentWidth),this.setBodyCellStyle(i,t,a),i.applyStyle(a)},r.prototype.setBodyCellStyle=function(e,i,a){var r=this.formattingProperties.grid,n=this.formattingProperties.values,o=this.formattingProperties.subtotals,u=this.formattingProperties.grandTotal,c=this.formattingProperties.rowHeaders,d=this.formattingProperties.columnHeaders;a.paddings.top=a.paddings.bottom=r.rowPadding,a.borders.top=new s,e.position.row.isFirst&&(a.borders.top.applyParams(t.outline.showTop(n.outline),r.outlineWeight,r.outlineColor,l.Outline),!t.outline.showTop(n.outline)&&t.outline.showTop(c.outline)&&(a.paddings.top+=r.outlineWeight)),a.borders.bottom=new s,e.position.row.isLast?(a.borders.bottom.applyParams(t.outline.showBottom(n.outline),r.outlineWeight,r.outlineColor,l.Outline),!t.outline.showBottom(n.outline)&&t.outline.showBottom(c.outline)&&(a.paddings.bottom+=r.outlineWeight)):a.borders.bottom.applyParams(r.gridHorizontal,r.gridHorizontalWeight,r.gridHorizontalColor),a.borders.left=new s,e.position.column.isFirst&&a.borders.left.applyParams(t.outline.showLeft(n.outline),r.outlineWeight,r.outlineColor,l.Outline),a.borders.right=new s,e.position.column.isLast?(a.borders.right.applyParams(t.outline.showRight(n.outline),r.outlineWeight,r.outlineColor,l.Outline),!t.outline.showRight(n.outline)&&t.outline.showRight(d.outline)&&(a.paddings.right+=r.outlineWeight)):a.borders.right.applyParams(r.gridVertical,r.gridVerticalWeight,r.gridVerticalColor,l.Gridline);var p,h,g=i.columnMetadata&&this.formattingProperties.columnFormatting[i.columnMetadata.queryName];g&&(i.isGrandTotal?(h=g.styleTotal&&g.fontColor,p=g.styleTotal&&g.backColor):i.isSubtotal?(h=g.styleSubTotals&&g.fontColor,p=g.styleSubTotals&&g.backColor):(h=g.styleValues&&g.fontColor,p=g.styleValues&&g.backColor));var f;f=this.formattingProperties.general.rowSubtotals&&o.backColor?i.position.row.indexInSiblings:i.position.row.index;var m=f%2===0?n.fontColorPrimary:n.fontColorSecondary,y=f%2===0?n.backColorPrimary:n.backColorSecondary;i.isGrandTotal?(a.fontColor=h||u.fontColor||o.fontColor||m,a.backColor=p||u.backColor||o.backColor||y):i.isSubtotal?(a.fontColor=h||o.fontColor||m,a.backColor=p||o.backColor||y):(a.fontColor=h||m,a.backColor=i.backColor||p||y)},r.prototype.unbindBodyCell=function(e,t){c.clearCellStyle(t),c.clearCellTextAndTooltip(t)},r.prototype.bindCornerCell=function(t,i){c.resetCellCssClass(i);var a=new o;a.fontFamily=c.FontFamilyHeader,a.fontColor=c.FontColorHeaders,i.contentHeight=this.textHeightHeader,i.contentWidth=0;var r=i.extension.contentHost;if(r=c.appendDiv(r),r.classList.add(c.CssClassWrappingContainer),t.isColumnHeaderLeaf&&(c.addCellCssClass(i,c.CssClassTablixColumnHeaderLeaf),a.borders.bottom=new s(u.PropGridOutlineWeight.defaultValue,u.PropGridOutlineColor.defaultValue),this.options.showSortIcons)){var n=this.getSortableCornerColumnMetadata(t);n&&(this.registerColumnHeaderClickHandler(n,i),r=c.addSortIconToColumnHeader(n?n.sort:void 0,r),n.sort&&(i.contentWidth=this.fontSizeHeader+c.SortIconPadding))}c.setCellTextAndTooltip(t.displayName,r,i.extension.contentHost),i.contentWidth+=e.TextMeasurementService.measureSvgTextWidth(this.textPropsHeader,t.displayName),i.contentWidth=Math.ceil(i.contentWidth),t.isRowHeaderLeaf&&c.addCellCssClass(i,c.CssClassMatrixRowHeaderLeaf),c.addCellCssClass(i,c.CssClassTablixHeader),this.setCornerCellsStyle(i,a),i.applyStyle(a),i.extension.disableDragResize()},r.prototype.setCornerCellsStyle=function(e,i){var a=this.formattingProperties.grid,r=this.formattingProperties.columnHeaders,n=this.formattingProperties.rowHeaders;i.fontColor=r.fontColor||n.fontColor,i.backColor=r.backColor||n.backColor,i.paddings.top=i.paddings.bottom=a.rowPadding,i.borders.top=new s,e.position.row.isFirst&&i.borders.top.applyParams(t.outline.showTop(r.outline),a.outlineWeight,a.outlineColor,l.Outline),i.borders.bottom=new s,e.position.row.isLast?i.borders.bottom.applyParams(t.outline.showBottom(r.outline),a.outlineWeight,a.outlineColor,l.Outline):i.borders.bottom.applyParams(a.gridHorizontal,a.gridHorizontalWeight,a.gridHorizontalColor,l.Gridline),i.borders.left=new s,e.position.column.isFirst&&(i.borders.left.applyParams(t.outline.showLeft(r.outline),a.outlineWeight,a.outlineColor,l.Outline),!t.outline.showLeft(r.outline)&&t.outline.showLeft(n.outline)&&(i.paddings.left+=a.outlineWeight)),i.borders.right=new s,i.borders.right.applyParams(a.gridVertical,a.gridVerticalWeight,a.gridVerticalColor,l.Gridline)},r.prototype.unbindCornerCell=function(e,t){c.clearCellStyle(t),c.clearCellTextAndTooltip(t),this.options.showSortIcons&&c.removeSortIcons(t),e.isColumnHeaderLeaf&&this.unregisterColumnHeaderClickHandler(t)},r.prototype.bindEmptySpaceHeaderCell=function(e){},r.prototype.unbindEmptySpaceHeaderCell=function(e){},r.prototype.bindEmptySpaceFooterCell=function(e){},r.prototype.unbindEmptySpaceFooterCell=function(e){},r.prototype.getHeaderLabel=function(e){return e.valueFormatted},r.prototype.getCellContent=function(e){return e.textContent||""},r.prototype.hasRowGroups=function(){
var e=this.hierarchyNavigator.getDataViewMatrix();return!!(e&&e.rows&&e.rows.levels&&0!==e.rows.levels.length)},r.prototype.getSortableCornerColumnMetadata=function(e){if(e.isColumnHeaderLeaf)return e.metadata},r.prototype.getRowHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.rows)return this.getHierarchyMetadata(t.rows,e.level)}},r.prototype.getColumnHeaderMetadata=function(e){if(this.hierarchyNavigator&&e){var t=this.hierarchyNavigator.getDataViewMatrix();if(t&&t.columns)return this.getHierarchyMetadata(t.columns,e.level)}},r.prototype.getHierarchyMetadata=function(e,t){if(e&&e.levels&&!(e.levels.length<t)){var i=e.levels[t];if(i&&i.sources&&0!==i.sources.length)return i.sources[0]}},r.prototype.getSortableHeaderColumnMetadata=function(e){var t=this.hierarchyNavigator.getDataViewMatrix();if(!t.rows||!t.rows.levels||0===t.rows.levels.length)return null;var i=t.valueSources&&t.valueSources.length>1,a=t.columns?t.columns.levels.length:0;i?a--:1===a&&t.columns.levels[0]&&t.columns.levels[0].sources&&t.columns.levels[0].sources[0]&&t.columns.levels[0].sources[0].roles&&t.columns.levels[0].sources[0].roles.Values&&(a=0);var r=-1;return 0===a?r=e.levelSourceIndex:e.isSubtotal&&(i?e.parent&&0===e.parent.level&&(r=e.levelSourceIndex):0===e.level&&(r=e.levelSourceIndex)),r!==-1?(r=r?r:0,t.valueSources[r]):null},r})();t.MatrixBinder=g;var f=(function(){function i(e){this.isTouchDisabled=e&&e.isTouchDisabled,this.matrixConditionalFormattingEnabled=e&&e.matrixConditionalFormattingEnabled,this.tablixColumnFormattingEnabled=e&&e.tablixColumnFormattingEnabled}return i.customizeQuery=function(e){var t=e.dataViewMappings[0];if(t&&t.matrix&&t.metadata){var i=t.matrix;_.isEmpty(i.columns.for.in.items)||(i.rows.dataReductionAlgorithm.window.count=100);var a=t.metadata.objects;i.rows.for.in.subtotalType=u.shouldShowRowSubtotals(a)?2:0,i.columns.for.in.subtotalType=u.shouldShowColumnSubtotals(a)?2:0}},i.getSortableRoles=function(){return["Rows","Values"]},i.prototype.init=function(e){this.element=e.element,this.style=e.style,this.updateViewport(e.viewport),this.formatter=t.valueFormatter.formatVariantMeasureValue,this.isInteractive=e.interactivity&&null!=e.interactivity.selection,this.hostServices=e.host,this.persistingObjects=!1,this.waitingForData=!1,this.lastAllowHeaderResize=!0,this.waitingForSort=!1},i.getFormattingProperties=function(e){return u.getMatrixObjects(e)},i.prototype.onResizing=function(e){this.updateViewport(e)},i.prototype.getColumnWidthManager=function(){return this.columnWidthManager},i.prototype.onDataChanged=function(t){var a=t.dataViews;if(a&&a.length>0){var r=this.dataView;this.dataView=a[0];var n=i.getFormattingProperties(this.dataView),o=n.general.textSize;if(t.operationKind===e.VisualDataChangeOperationKind.Append){var s=r.matrix.rows.root!==this.dataView.matrix.rows.root;this.createOrUpdateHierarchyNavigator(s),s&&this.tablixControl.updateModels(!1,this.dataView.matrix.rows.root.children,this.dataView.matrix.columns.root.children),this.refreshControl(!1)}else{this.createOrUpdateHierarchyNavigator(!0),this.createColumnWidthManager(),this.createTablixControl(o);var l=this.tablixControl.getBinder();l.onDataViewChanged(n),this.updateInternal(o,r)}}this.waitingForData=!1,this.waitingForSort=!1},i.prototype.createColumnWidthManager=function(){var e=this,i=this.hierarchyNavigator.getMatrixColumnHierarchy();this.columnWidthManager?this.persistingObjects||this.columnWidthManager.updateDataView(this.dataView,i.leafNodes):this.columnWidthManager=new t.controls.TablixColumnWidthManager(this.dataView,(!0),function(t){return e.persistColumnWidths(t)},i.leafNodes)},i.prototype.persistColumnWidths=function(e){this.persistingObjects=!0,this.hostServices.persistProperties(e)},i.prototype.updateViewport=function(e){this.currentViewport=e,this.tablixControl&&(this.tablixControl.viewport=this.currentViewport,this.verifyHeaderResize(),this.refreshControl(!1))},i.prototype.refreshControl=function(e){(t.visibilityHelper.partiallyVisible(this.element)||1===this.getLayoutKind())&&this.tablixControl.refresh(e)},i.prototype.getLayoutKind=function(){return this.isInteractive?0:1},i.prototype.createOrUpdateHierarchyNavigator=function(e){var t=!this.dataView.metadata.segment;if(this.tablixControl)this.hierarchyNavigator.update(!1,this.dataView.matrix,t,e);else{var i=n(this.dataView.matrix,t,this.formatter,this.hostServices.getLocalizedString("ListJoin_Separator"));this.hierarchyNavigator=i}},i.prototype.createTablixControl=function(e){this.tablixControl||(this.tablixControl=this.createControl(this.hierarchyNavigator,e))},i.prototype.createControl=function(e,i){var a=this,r=this.getLayoutKind(),n={onBindRowHeader:function(e){a.onBindRowHeader(e)},totalLabel:this.hostServices.getLocalizedString(c.TotalLabel),onColumnHeaderClick:function(e,t){return a.onColumnHeaderClick(e,t)},showSortIcons:0===r},o=new g(this.hierarchyNavigator,n),s=1===r?t.controls.internal.DashboardTablixLayoutManager.createLayoutManager(o):t.controls.internal.CanvasTablixLayoutManager.createLayoutManager(o,this.columnWidthManager),l=document.createElement("div");this.element.append(l);var d={interactive:this.isInteractive,enableTouchSupport:!this.isTouchDisabled,layoutKind:r,fontSize:u.getTextSizeInPx(i)};return new t.controls.TablixControl(e,s,o,l,d)},i.prototype.updateInternal=function(e,i){var a=this;1===this.getLayoutKind()&&this.tablixControl.layoutManager.adjustContentSize(t.converterHelper.hasImageUrlColumn(this.dataView)),this.tablixControl.fontSize=u.getTextSizeInPx(e),this.verifyHeaderResize(),this.tablixControl.updateModels(!this.persistingObjects,this.dataView.matrix.rows.root.children,this.dataView.matrix.columns.root.children),this.tablixControl.viewport=this.currentViewport;var r=this.shouldClearControl(i,this.dataView);setTimeout((function(){a.refreshControl(r);var e=a.columnWidthManager.onColumnsRendered(a.tablixControl.layoutManager.columnWidthsToPersist);a.persistingObjects&&!e&&(a.persistingObjects=!1)}),0)},i.prototype.shouldClearControl=function(t,i){return!(this.waitingForSort&&t&&i)||!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata)},i.prototype.onBindRowHeader=function(e){this.needsMoreData(e)&&(this.hostServices.loadMoreData(),this.waitingForData=!0)},i.prototype.onColumnHeaderClick=function(e,t){this.waitingForSort=!0,this.hostServices.onCustomSort(c.getCustomSortEventArgs(e,t))},i.prototype.needsMoreData=function(e){if(this.waitingForData||!this.hierarchyNavigator.isLeaf(e)||!this.dataView.metadata||!this.dataView.metadata.segment)return!1;var t=this.tablixControl.rowDimension.getItemsCount(),a=t*i.preferredLoadMoreThreshold;return this.hierarchyNavigator.getLeafIndex(e)>=a},i.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder;return this.dataView&&u.enumerateObjectInstances(e,i,this.dataView,t.controls.TablixType.Matrix,this.tablixColumnFormattingEnabled),i.complete()},i.prototype.enumerateObjectRepetition=function(){if(this.matrixConditionalFormattingEnabled){var e=[];return this.dataView&&u.enumerateObjectRepetition(e,this.dataView,t.controls.TablixType.Matrix),e}},i.prototype.shouldAllowHeaderResize=function(){return 1===this.hostServices.getViewMode()},i.prototype.onViewModeChanged=function(e){this.tablixControl&&this.tablixControl.toggleTouchBindings(1!==e),this.updateViewport(this.currentViewport)},i.prototype.verifyHeaderResize=function(){var e=this.shouldAllowHeaderResize();e!==this.lastAllowHeaderResize&&(this.lastAllowHeaderResize=e,this.tablixControl.layoutManager.setAllowHeaderResize(e))},i.preferredLoadMoreThreshold=.8,i})();t.Matrix=f})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.CssConstants,r=(function(){function a(e){this.tooltipsEnabled=e&&e.tooltipsEnabled,e&&e.animator&&(this.animator=e.animator,this.isScrollable=!!e.isScrollable&&e.isScrollable,this.behavior=e.behavior)}return a.getLayout=function(e,i){var r=t.dataLabelUtils.createColumnFormatterCacheManager(),n=e.showCategory,o=e.show||e.showCategory;return{shapeClass:function(e){return a.getNodeClass(e,!1)},shapeLayout:a.createTreemapShapeLayout(!1),highlightShapeClass:function(e){return a.getNodeClass(e,!0)},highlightShapeLayout:a.createTreemapShapeLayout(!0),zeroShapeLayout:a.createTreemapZeroShapeLayout(),majorLabelClass:function(e){return a.MajorLabelClassName},majorLabelLayout:{x:function(e){return e.x+a.TextMargin},y:function(e){return e.y+a.TextMargin+a.MajorLabelTextSize}},majorLabelText:function(t){return a.createMajorLabelText(t,e,i,r)},minorLabelClass:function(e){return a.MinorLabelClassName},minorLabelLayout:{x:function(e){return e.x+a.TextMargin},y:function(e){return e.y+e.dy-a.TextMargin}},minorLabelText:function(t){return a.createMinorLabelText(t,e,i,r)},areMajorLabelsEnabled:function(){return n},areMinorLabelsEnabled:function(){return o}}},a.prototype.init=function(e){this.options=e;var i=e.element;i.empty(),this.svg=d3.select(i.get(0)).append("svg").style("position","absolute").classed(a.ClassName,!0),this.shapeGraphicsContext=this.svg.append("g").classed(a.ShapesClassName,!0),this.labelGraphicsContext=this.svg.append("g").classed(a.LabelsGroupClassName,!0),this.element=i,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.style=e.style,this.treemap=d3.layout.treemap().sticky(!1).sort((function(e,t){return e.size-t.size})).value((function(e){return e.size})).round(!1),this.behavior&&(this.interactivityService=t.createInteractivityService(e.host)),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.colors=this.style.colorPalette.dataColors,this.hostService=e.host,this.tooltipService=t.createTooltipService(e.host)},a.converter=function(i,r,n,o,s,l,u){void 0===u&&(u=!0);var c,d,p,h=e.data.createIDataViewCategoricalReader(i),g={key:"root",name:"root",originalValue:void 0,children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},f=[],m=[],y="",v=new t.ColorHelper(r,t.treemapProps.dataPoint.fill),w=void 0;if(i&&i.metadata&&i.metadata.objects){var b=i.metadata.objects;n.show=e.DataViewObjects.getValue(b,t.treemapProps.labels.show,n.show),n.labelColor=e.DataViewObjects.getFillColor(b,t.treemapProps.labels.color,n.labelColor),n.displayUnits=e.DataViewObjects.getValue(b,t.treemapProps.labels.labelDisplayUnits,n.displayUnits),n.precision=e.DataViewObjects.getValue(b,t.treemapProps.labels.labelPrecision,n.precision),n.showCategory=e.DataViewObjects.getValue(b,t.treemapProps.categoryLabels.show,n.showCategory)}if(h.hasValues(t.treemapRoles.values)||h.hasValues(t.treemapRoles.gradient)){var C=h.hasValues(t.treemapRoles.values)?t.treemapRoles.values:t.treemapRoles.gradient,S=i.categorical;p=h.hasHighlights(C);var x=t.treemapProps.general.formatString,P=a.getValuesFromCategoricalDataView(i,p,C),D=P.values,T=P.highlights,V=P.totalValue;P.highlightsOverflow&&(p=!1,D=T),c=P.hasNegativeValues,d=P.allValuesAreNegative;var L=a.getCullableValue(V,s),M=h.hasDynamicSeries();w=!1;var N=h.getValueColumn(t.treemapRoles.gradient,0);if(null!=S.categories||_.isEmpty(D)){if(S.categories&&S.categories.length>0){var I=h.getSeriesCount(C),A=1===I,O=S.categories[0];y=O.source.displayName;for(var R=t.valueFormatter.getFormatString(O.source,x),E=0,F=D.length;E<F;E++){var b=O.objects&&O.objects[E],j=v.getColorForSeriesValue(b,O.identityFields,O.values[E]),H=t.valueFormatter.format(O.values[E],R),G=D[E],k=0,z=G[k],U=p&&T?T[E][k]:void 0,B=void 0,W=void 0;if(u){B=[],W={displayName:O.source.displayName,value:H},B.push(W);var q=h.getValueMetadataColumn(C,k);null!=z&&B.push({displayName:q.displayName,value:t.converterHelper.formatFromMetadataColumn(z,q,x)}),null!=U&&B.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(U,q,x)});var K=N?N.source:void 0;A&&K&&K!==q&&null!=N.values[E]&&B.push({displayName:K.displayName,value:t.converterHelper.formatFromMetadataColumn(N.values[E],K,x)}),t.TooltipBuilder.addTooltipMeasures(h,B,E,k)}var Q=t.SelectionIdBuilder.builder().withCategory(O,E).withMeasure(A?h.getValueMetadataColumn(C,k).queryName:void 0).createSelectionId(),Y=JSON.stringify({nodeKey:Q.getKey(),depth:1}),J={key:Y,name:H,originalValue:void 0,color:j,selected:!1,identity:Q,tooltipInfo:B,highlightedTooltipInfo:B,labelFormatString:1===I?t.valueFormatter.getFormatString(h.getValueMetadataColumn(C,k),x):R};p&&(J.highlightMultiplier=0!==z?U/z:0,J.highlightValue=d&&null!=U?Math.abs(U):U,J.originalHighlightValue=U),m.push({label:H,color:j,icon:t.LegendIcon.Box,identity:Q,selected:!1});for(var X=0,$=0;k<I;k++){var Z=h.getValueColumn(C,k),ee=G[k],te=void 0,ie=a.checkValueForShape(ee,L,d,w);if(w=ie.dataWasCulled,ie.validShape&&(X+=ee,p&&(te=T[E][k],$+=te),!A)){var ae=null;ae=h.hasDynamicSeries()?t.converterHelper.formatFromMetadataColumn(h.getSeriesName(k),h.getSeriesMetadataColumn(),x):t.converterHelper.formatFromMetadataColumn(h.getValueDisplayName(C,k),h.getValueMetadataColumn(C,k),x);var re=S?S.values:null,ne=Z.source.queryName,oe=t.SelectionIdBuilder.builder().withCategory(O,E).withSeries(re,Z).withMeasure(ne).createSelectionId(),se=JSON.stringify({nodeKey:oe.getKey(),depth:2}),le=p&&0!==te?te:void 0,ue=void 0;u&&(ue=[],ue.push(W),M&&(O&&O.source===re.source||ue.push({displayName:re.source.displayName,value:t.converterHelper.formatFromMetadataColumn(h.getSeriesName(k),re.source,x)})),null!=ee&&ue.push({displayName:Z.source.displayName,value:t.converterHelper.formatFromMetadataColumn(ee,Z.source,x)}),null!=U&&ue.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(le,Z.source,x)}),t.TooltipBuilder.addTooltipMeasures(h,ue,E,M?k:void 0));var ce={key:se,name:ae,size:d?Math.abs(ee):ee,originalValue:ee,color:j,selected:!1,identity:oe,tooltipInfo:ue,highlightedTooltipInfo:ue,labelFormatString:t.valueFormatter.getFormatString(Z.source,x)};p&&(ce.highlightMultiplier=0!==ee?te/ee:0,ce.highlightValue=d&&null!=te?Math.abs(te):null,ce.originalHighlightValue=te),null==J.children&&(J.children=[]),J.children.push(ce),f.push(ce)}}X&&(J.size=d?Math.abs(X):X,J.originalValue=X,g.children.push(J),f.push(J)),p&&(J.highlightMultiplier=X?$/X:0)}}}else for(var k=0,I=h.getSeriesCount(C);k<I;k++){var Z=h.getValueColumn(C,k),z=D[0][k],ie=a.checkValueForShape(z,L,d,w);if(w=ie.dataWasCulled,ie.validShape){var de=M?t.converterHelper.formatFromMetadataColumn(h.getSeriesValueColumnGroup(k).name,h.getSeriesMetadataColumn(),x):t.converterHelper.formatFromMetadataColumn(h.getValueDisplayName(C,k),Z.source,x),Q=(new t.SelectionIdBuilder).withSeries(i.categorical.values,M?Z:void 0).withMeasure(Z.source.queryName).createSelectionId(),Y=Q.getKey(),j=M?v.getColorForSeriesValue(h.getSeriesObjects(k),S.values.identityFields,t.converterHelper.getSeriesName(Z.source)):v.getColorForMeasure(Z.source.objects,Z.source.queryName),le=p?T[0][k]:void 0,B=void 0;if(u){if(B=[],M){var pe=h.getSeriesMetadataColumn(),he=h.getSeriesValueColumnGroup(k).name;B.push({displayName:pe.displayName,value:t.converterHelper.formatFromMetadataColumn(he,pe,x)})}null!=z&&B.push({displayName:Z.source.displayName,value:t.converterHelper.formatFromMetadataColumn(z,Z.source,x)}),null!=le&&B.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:t.converterHelper.formatFromMetadataColumn(le,Z.source,x)}),t.TooltipBuilder.addTooltipMeasures(h,B,0,M?k:void 0)}var J={key:Y,name:de,size:d?Math.abs(z):z,originalValue:z,color:j,selected:!1,identity:Q,tooltipInfo:B,highlightedTooltipInfo:B,labelFormatString:t.valueFormatter.getFormatString(Z.source,x)};p&&T&&(J.highlightMultiplier=0!==z?le/z:0,J.highlightValue=d&&null!=le?Math.abs(le):le,J.originalHighlightValue=le),g.children.push(J),f.push(J),m.push({label:de,color:j,icon:t.LegendIcon.Box,identity:Q,selected:!1})}}}return o&&(o.applySelectionStateToData(f),o.applySelectionStateToData(m)),{root:g,hasHighlights:p,legendData:{title:y,dataPoints:m,fontSize:t.SVGLegend.DefaultFontSizeInPt},dataLabelsSettings:n,legendObjectProperties:l,dataWasCulled:w,hasNegativeValues:c,allValuesAreNegative:d}},a.normalizedValue=function(e,t){return null==e||isNaN(e)?0:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t?Math.abs(e):e<0?0:e},a.getValuesFromCategoricalDataView=function(t,i,r){for(var n=e.data.createIDataViewCategoricalReader(t),o=n.getCategoryCount()||1,s=n.getSeriesCount(r),l=[],u=[],c=0,d=0;d<o;d++)l.push([]),i&&u.push([]);for(var p,h,g=void 0,f=0;f<s;f++)for(var m=0;m<o;m++){var y=n.getValue(r,m,f);l[m].push(y);var v=void 0;i&&(v=n.getHighlight(r,m,f),u[m].push(v),null==v&&(v=0)),g=void 0===g?(!i||v<=0)&&y<=0:g&&(!i||v<=0)&&y<=0,p||(p=y<0||!!i&&v<0)}g=!!g;for(var f=0;f<s;f++)for(var m=0;m<o;m++){var y=l[m][f];if(y=a.normalizedValue(y,g),c+=y,i){var v=u[m][f];v=a.normalizedValue(v,g),!h&&e.Double.greaterWithPrecision(v,y)&&(h=!0)}}return{values:l,highlights:i?u:void 0,highlightsOverflow:i?h:void 0,totalValue:g?Math.abs(c):c,hasNegativeValues:p,allValuesAreNegative:g}},a.getCullableValue=function(e,t){var i=t.width*t.height,r=a.CullableArea/i;return r*e},a.prototype.update=function(e){var i=this.dataViews=e.dataViews;this.currentViewport=e.viewport;var r=i&&i.length>0&&i[0].categorical?i[0].categorical:void 0,n=t.dataLabelUtils.getDefaultTreemapLabelSettings(),o=null;if(r){var s=i[0],l=s.metadata,u=void 0;l&&(u=l.objects),u&&(o=u.legend),this.data=a.converter(s,this.colors,n,this.interactivityService,this.currentViewport,o,this.tooltipsEnabled)}else{var c={key:"root",name:"root",originalValue:void 0,children:[],selected:!1,highlightMultiplier:0,identity:t.SelectionId.createNull(),color:void 0},d={title:"",dataPoints:[]},p={root:c,hasHighlights:!1,legendData:d,dataLabelsSettings:n,dataWasCulled:!1,hasNegativeValues:!1,allValuesAreNegative:!1};this.data=p}if(this.updateInternal(e.suppressAnimations),i){var h=t.getInvalidValueWarnings(i,!1,!1,!1);this.data.allValuesAreNegative?h.push(new t.AllNegativeValuesWarning):this.data.hasNegativeValues&&h.push(new t.NegativeValuesNotSupportedWarning),this.hostService.setWarnings(h)}},a.prototype.onDataChanged=function(e){this.update({suppressAnimations:e.suppressAnimations,dataViews:e.dataViews,viewport:this.currentViewport})},a.prototype.onResizing=function(e){this.update({suppressAnimations:!0,dataViews:this.dataViews,viewport:e})},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.prototype.enumerateObjectInstances=function(e){var i=this.data;if(i){var a=e.objectName,r=new t.ObjectEnumerationBuilder,n=this.data.dataLabelsSettings?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultTreemapLabelSettings();switch(a){case"dataPoint":var o=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,s=t.GradientUtils.hasGradientRole(o);s||this.enumerateDataPoints(r,i);break;case"legend":return this.enumerateLegend(i);case"labels":var l={enumeration:r,dataLabelsSettings:n,show:!0,displayUnits:!0,precision:!0};t.dataLabelUtils.enumerateDataLabels(l);break;case"categoryLabels":t.dataLabelUtils.enumerateCategoryLabels(r,n,!1,!0)}return r.complete()}},a.prototype.enumerateDataPoints=function(e,i){var a=i.root.children;if(!_.isEmpty(a))for(var r=0;r<a.length;r++){var n=a[r];e.pushInstance({displayName:n.name,selector:t.ColorHelper.normalizeSelector(n.identity.getSelector()),properties:{fill:{solid:{color:n.color}}},objectName:"dataPoint"})}},a.prototype.enumerateLegend=function(i){var a={legend:i.legendObjectProperties},r=e.DataViewObjects.getValue(a,t.treemapProps.legend.show,this.legend.isVisible()),n=e.DataViewObjects.getValue(a,t.treemapProps.legend.showTitle,!0),o=e.DataViewObjects.getValue(a,t.treemapProps.legend.titleText,this.data.legendData.title),s=e.DataViewObject.getValue(a,t.legendProps.labelColor,this.data.legendData?this.data.legendData.labelColor:t.LegendData.DefaultLegendLabelFillColor),l=e.DataViewObject.getValue(a,t.legendProps.fontSize,this.data.legendData&&this.data.legendData.fontSize?this.data.legendData.fontSize:t.SVGLegend.DefaultFontSizeInPt),u=e.DataViewObjects.getValue(a,t.treemapProps.legend.position,t.legendPosition.top);return[{selector:null,objectName:"legend",properties:{show:r,position:u,showTitle:n,titleText:o,labelColor:s,fontSize:l}}]},a.checkValueForShape=function(e,t,i,a){var r=void 0;return e?(r=i?Math.abs(e)<t:e<t,r?(a=a||r,{validShape:!1,dataWasCulled:a}):{validShape:!0,dataWasCulled:a}):{validShape:!1,dataWasCulled:a}},a.prototype.calculateTreemapSize=function(){var e=this.legend.getMargins();return{height:this.currentViewport.height-e.height,width:this.currentViewport.width-e.width}},a.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0);var i=this.calculateTreemapSize();this.svg.attr({width:i.width,height:i.height}),t.Legend.positionChartArea(this.svg,this.legend),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.hasChildrenWithIdentity=function(e){var t=e.children;if(!t)return!1;var i=t.length;if(0===i)return!1;for(var a=i-1;a>=0;a--)if(t[a].identity.hasIdentity())return!0;return!1},a.canDisplayMajorLabel=function(e){if(1!==e.depth)return!1;if(_.isEmpty(e.name))return!1;var t=e.dx-2*a.TextMargin;if(t<a.MinTextWidthForMajorLabel)return!1;var i=a.MajorLabelTextSize+2*a.TextMargin;return!(e.dy<i)},a.canDisplayMinorLabel=function(e,t){if(e.depth<1||e.depth>2)return!1;if(1===e.depth&&(e.children||!t.show))return!1;if(_.isEmpty(e.name))return!1;var i=e.dx-2*a.TextMargin;if(i<a.MinTextWidthForMinorLabel)return!1;var r=a.MinorLabelTextSize+2*a.TextMargin;if(e.dy<r)return!1;if(1===e.depth){var n=e.y+a.MajorLabelTextSize+2*a.TextMargin;if(e.y+e.dy-n<r)return!1}else if(2===e.depth){var o=e.parent,n=Math.max(o.y+a.MajorLabelTextSize+2*a.TextMargin,e.y);if(e.y+e.dy-n<r)return!1}return!0},a.createMajorLabelText=function(t,i,r,n){var o=t.dx-2*a.TextMargin,s=a.MajorLabelTextProperties,l={text:t.name,fontFamily:s.fontFamily,fontSize:s.fontSize};return e.TextMeasurementService.getTailoredTextOrDefault(l,o)},a.createMinorLabelText=function(e,i,r,n){var o=e.dx-2*a.TextMargin,s=e.name;if(i.show){var l=n.getOrCreate(e.labelFormatString,i,r);s=t.dataLabelUtils.getLabelFormattedText({label:null!=e.originalHighlightValue?e.originalHighlightValue:e.originalValue,maxWidth:o,formatter:l}),i.showCategory&&2===e.depth&&(s=t.dataLabelUtils.getLabelFormattedText({label:e.name,maxWidth:o})+" "+s)}return t.dataLabelUtils.getLabelFormattedText({label:s,maxWidth:o,fontSize:i.fontSize})},a.getFill=function(e,t){return e.depth>1&&!e.identity.hasIdentity()&&!t?i.noneValue:a.hasChildrenWithIdentity(e)?i.noneValue:e.color},a.getFillOpacity=function(e,t,i,r){return i?r?null:a.DimmedShapeOpacity.toString():!t||e.selected?null:e.depth>1&&e.parent.selected?null:a.hasChildrenWithIdentity(e)?null:a.DimmedShapeOpacity.toString()},a.prototype.updateInternal=function(e){var i=this.data,r=i&&i.hasHighlights,n=i?i.dataLabelsSettings:null,o=t.AnimatorCommon.GetAnimationDuration(this.animator,e);this.options.interactivity&&this.options.interactivity.isInteractiveLegend||!this.data||this.renderLegend(),this.initViewportDependantProperties(o);var s=this.calculateTreemapSize();this.treemap.size([s.width,s.height]);var l=i&&i.root?this.treemap.nodes(i.root):[],u=l.filter((function(e){return null!=e.highlightMultiplier&&(!e.children||0===e.children.length)})),c=[],d=[],p=null;n.showCategory&&(c=l.filter((function(e){return a.canDisplayMajorLabel(e)}))),(n.show||n.showCategory)&&(d=l.filter((function(e){return a.canDisplayMinorLabel(e,n)})),0===n.displayUnits&&(p=d3.max(d,(function(e){return Math.abs(e.value)}))));var h,g,f,m,y,v=a.getLayout(n,p);if(this.animator&&!e){var w={viewModel:i,nodes:l,highlightNodes:u,majorLabeledNodes:c,minorLabeledNodes:d,shapeGraphicsContext:this.shapeGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,interactivityService:this.interactivityService,layout:v,labelSettings:n};y=this.animator.animate(w),h=y.shapes,g=y.highlightShapes,f=y.majorLabels,m=y.minorLabels}if(!this.animator||e||y.failed){var b=this.interactivityService&&this.interactivityService.hasSelection(),C=this.shapeGraphicsContext;h=a.drawDefaultShapes(C,l,b,r,v),g=a.drawDefaultHighlightShapes(C,u,b,r,v);var S=this.labelGraphicsContext;f=a.drawDefaultMajorLabels(S,c,n,v),m=a.drawDefaultMinorLabels(S,d,n,v)}if(this.interactivityService){var x={shapes:h,highlightShapes:g,majorLabels:f,minorLabels:m,nodes:l,hasHighlights:i.hasHighlights};this.interactivityService.bind(l,this.behavior,x)}this.tooltipsEnabled&&this.addTooltips(h,g),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.addTooltips=function(e,t){this.tooltipService.addTooltip(e,(function(e){return e.data.highlightedTooltipInfo?e.data.highlightedTooltipInfo:e.data.tooltipInfo}),(function(e){return e.data.identity})),this.tooltipService.addTooltip(t,(function(e){return e.data.highlightedTooltipInfo}),(function(e){return e.data.identity}))},a.prototype.renderLegend=function(){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.currentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.currentViewport)},a.getNodeClass=function(e,t){var i;switch(e.depth){case 1:i=a.ParentGroupClassName;break;case 2:i=a.NodeGroupClassName;break;case 0:i=a.RootNodeClassName}return i+=" "+(t?a.HighlightNodeClassName:a.TreemapNodeClassName)},a.createTreemapShapeLayout=function(e){return void 0===e&&(e=!1),{x:function(e){return e.x},y:function(t){return t.y+(e?t.dy*(1-t.highlightMultiplier):0)},width:function(e){return Math.max(0,e.dx)},height:function(t){return Math.max(0,t.dy*(e?t.highlightMultiplier:1))}}},a.createTreemapZeroShapeLayout=function(){return{x:function(e){return e.x},y:function(e){return e.y+e.dy},width:function(e){return Math.max(0,e.dx)},height:function(e){return 0}}},a.drawDefaultShapes=function(e,t,i,r,n){var o=!1,s=e.selectAll("."+a.TreemapNodeClassName).data(t,(function(e){return e.key}));return s.enter().append("rect").attr("class",n.shapeClass),s.style("fill",(function(e){return a.getFill(e,o)})).style("fill-opacity",(function(e){return a.getFillOpacity(e,i,r,o)})).attr(n.shapeLayout),s.exit().remove(),s},a.drawDefaultHighlightShapes=function(e,t,i,r,n){var o=!0,s=e.selectAll("."+a.HighlightNodeClassName).data(t,(function(e){return e.key+"highlight"}));return s.enter().append("rect").attr("class",n.highlightShapeClass),s.style("fill",(function(e){return a.getFill(e,o)})).style("fill-opacity",(function(e){return a.getFillOpacity(e,i,r,o)})).attr(n.highlightShapeLayout),s.exit().remove(),s},a.drawDefaultMajorLabels=function(e,t,i,r){var n=e.selectAll("."+a.MajorLabelClassName).data(t,(function(e){return e.key}));return n.enter().append("text").attr("class",r.majorLabelClass),n.attr(r.majorLabelLayout).text(r.majorLabelText).style("fill",(function(){return i.labelColor})),n.exit().remove(),n},a.drawDefaultMinorLabels=function(e,t,i,r){var n=e.selectAll("."+a.MinorLabelClassName).data(t,(function(e){return e.key}));return n.enter().append("text").attr("class",r.minorLabelClass),n.attr(r.minorLabelLayout).text(r.minorLabelText).style("fill",(function(){return i.labelColor})),n.exit().remove(),n},a.cleanMinorLabels=function(e){var t=[],i=e.selectAll("."+a.LabelsGroupClassName).selectAll("."+a.MinorLabelClassName).data(t);i.exit().remove()},a.DimmedShapeOpacity=.4,a.ClassName="treemap",a.LabelsGroupClassName="labels",a.MajorLabelClassName="majorLabel",a.MinorLabelClassName="minorLabel",a.ShapesClassName="shapes",a.TreemapNodeClassName="treemapNode",a.RootNodeClassName="rootNode",a.ParentGroupClassName="parentGroup",a.NodeGroupClassName="nodeGroup",a.HighlightNodeClassName="treemapNodeHighlight",a.TextMargin=5,a.MinorLabelTextSize=10,a.MinTextWidthForMinorLabel=18,a.MajorLabelTextSize=12,a.MinTextWidthForMajorLabel=22,a.MajorLabelTextProperties={fontFamily:t.Font.Family.regular.css,fontSize:a.MajorLabelTextSize+"px"},a.CullableArea=9,a})();t.Treemap=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i=e.visuals.KpiUtil.getKpiImageMetadata,n=a.CssConstants.createClassAndSelector,o=(function(o){function s(t){o.call(this,s.cardClassName),this.isScrollable=!1,this.displayUnitSystemType=e.DisplayUnitSystemType.WholeUnits,t&&(this.isScrollable=!!t.isScrollable,t.animator&&(this.animator=t.animator),null!=t.displayUnitSystemType&&(this.displayUnitSystemType=t.displayUnitSystemType),t.cardSmallViewportProperties&&(this.cardSmallViewportProperties=t.cardSmallViewportProperties))}return r(s,o),s.prototype.init=function(e){this.animationOptions=e.animation;var t=e.element;this.kpiImage=d3.select(t.get(0)).append("div").classed(s.KPIImage.class,!0);var i=this.svg=d3.select(t.get(0)).append("svg");this.graphicsContext=i.append("g"),this.currentViewport=e.viewport,this.hostServices=e.host,this.style=e.style,this.updateViewportProperties(),this.isScrollable&&(i.attr("class",s.cardClassName),this.labelContext=i.append("g"))},s.prototype.onDataChanged=function(i){var a,r=i.dataViews[0];if(r){this.getMetaDataColumn(r),r.single&&(a=r.single.value),this.cardFormatSetting=this.getDefaultFormatSettings();var n=r.metadata;if(n){var o=n.objects;if(o){var s=this.cardFormatSetting.labelSettings;s.labelColor=e.DataViewObjects.getFillColor(o,t.cardProps.labels.color,s.labelColor),s.precision=e.DataViewObjects.getValue(o,t.cardProps.labels.labelPrecision,s.precision),s.fontSize=e.DataViewObjects.getValue(o,t.cardProps.labels.fontSize,s.fontSize),s.precision!==t.dataLabelUtils.defaultLabelPrecision&&s.precision<0&&(s.precision=0),s.displayUnits=e.DataViewObjects.getValue(o,t.cardProps.labels.labelDisplayUnits,s.displayUnits),s.showCategory=e.DataViewObjects.getValue(o,t.cardProps.categoryLabels.show,s.showCategory),s.categoryLabelColor=e.DataViewObjects.getFillColor(o,t.cardProps.categoryLabels.color,s.categoryLabelColor),this.cardFormatSetting.wordWrap=e.DataViewObjects.getValue(o,t.cardProps.wordWrap.show,this.cardFormatSetting.wordWrap),this.cardFormatSetting.textSize=e.DataViewObjects.getValue(o,t.cardProps.categoryLabels.fontSize,this.cardFormatSetting.textSize)}}}this.updateInternal(a,!0,!0)},s.prototype.onResizing=function(e){this.currentViewport=e,this.updateViewportProperties(),this.updateInternal(this.value,!0,!0)},s.prototype.updateViewportProperties=function(){var e=this.currentViewport;this.svg.attr("width",e.width).attr("height",e.height)},s.prototype.setTextProperties=function(e,t){s.cardTextProperties.fontSize=a.PixelConverter.fromPoint(t),s.cardTextProperties.text=e},s.prototype.getCardFormatTextSize=function(){return this.cardFormatSetting.textSize},s.prototype.isSmallViewport=function(){return!!(this.cardSmallViewportProperties&&this.currentViewport.width<=this.cardSmallViewportProperties.cardSmallViewportWidth)},s.prototype.getCardPrecision=function(e){return void 0===e&&(e=!1),e?t.dataLabelUtils.defaultLabelPrecision:this.cardFormatSetting.labelSettings.precision},s.prototype.getCardDisplayUnits=function(e){return void 0===e&&(e=!1),e?0:this.cardFormatSetting.labelSettings.displayUnits},s.prototype.getAdjustedFontHeight=function(e,t,i){var a=o.prototype.getAdjustedFontHeight.call(this,e,t,i);return Math.min(a,s.DefaultStyle.card.maxFontSize);
},s.prototype.clear=function(e){void 0===e&&(e=!1),this.svg.select(s.Value.selector).text(""),e||this.svg.select(s.Label.selector).text(""),o.prototype.clear.call(this)},s.prototype.updateInternal=function(r,n,o){void 0===o&&(o=!1);var l=this.value,u=t.AnimatorCommon.GetAnimationDuration(this.animator,n);if(void 0===r)return void(void 0!==l&&this.clear());var c=this.metaDataColumn,d=this.cardFormatSetting.labelSettings,p=this.isSmallViewport(),h=this.getCardPrecision(p),g=this.getCardDisplayUnits(p),f=0===g,m=this.getFormatString(c),y=t.valueFormatter.create({format:m,value:f?r:g,precision:t.dataLabelUtils.getLabelPrecision(h,m),displayUnitSystemType:f&&h===t.dataLabelUtils.defaultLabelPrecision?this.displayUnitSystemType:e.DisplayUnitSystemType.WholeUnits,formatSingleValues:!!f,allowFormatBeautification:!0,columnType:c?c.type:void 0}),v=this.cardFormatSetting,w=a.PixelConverter.fromPointToPixel(d.fontSize),b=s.DefaultStyle.value;this.setTextProperties(r,this.getCardFormatTextSize());var C=d.showCategory?e.TextMeasurementService.estimateSvgTextHeight(s.cardTextProperties):0,S=C+s.DefaultStyle.label.paddingTop,x=this.currentViewport.width,P=this.currentViewport.height,D=this.getTranslateX(x),T=(P-S-w)/2,V=i(c,r,1);if(this.isScrollable){if(!o&&l===r)return;if(l===r||!_.isEmpty(r)&&"string"==typeof r||(r=y.format(r)),V)this.graphicsContext.selectAll("text").remove(),this.displayStatusGraphic(V,D,T,w);else{this.kpiImage.selectAll("div").remove();var L=this.getTranslateY(w+T),M=this.graphicsContext.attr("transform",t.SVGUtil.translate(D,L)).selectAll("text").data([r]);if(M.enter().append("text").attr("class",s.Value.class),M.text((function(e){return e})).style({"font-size":a.PixelConverter.fromPoint(d.fontSize),fill:d.labelColor,"font-family":b.fontFamily,"text-anchor":this.getTextAnchor()}),v.wordWrap){var N=M.node();e.TextMeasurementService.wordBreak(N,x,P-S);var I=N.childElementCount;if(I>1){var A=w;w*=I,T=(P-S-w)/2,L=this.getTranslateY(A+T),this.graphicsContext.attr("transform",t.SVGUtil.translate(D,L))}}else M.call(t.AxisHelper.LabelLayoutStrategy.clip,x,e.TextMeasurementService.svgEllipsis);M.append("title").text((function(e){return e})),M.exit().remove()}if(d.showCategory&&c&&c.displayName){var O=[c.displayName],R=this.getTranslateY(w+S+T),E=this.labelContext.attr("transform",t.SVGUtil.translate(D,R)).selectAll("text").data(O);E.enter().append("text").attr("class",s.Label.class),E.text((function(e){return e})).style({"font-size":a.PixelConverter.fromPoint(this.getCardFormatTextSize()),fill:d.categoryLabelColor,"text-anchor":this.getTextAnchor()});var F=E.node();F&&(v.wordWrap?e.TextMeasurementService.wordBreak(F,x/2,P-R):E.call(t.AxisHelper.LabelLayoutStrategy.clip,x,e.TextMeasurementService.svgEllipsis)),E.append("title").text((function(e){return e})),E.exit().remove()}else this.labelContext.selectAll("text").remove()}else V?(this.graphicsContext.selectAll("text").remove(),this.displayStatusGraphic(V,D,T,w)):(this.kpiImage.selectAll("div").remove(),this.doValueTransition(l,r,this.displayUnitSystemType,this.animationOptions,u,o,y),this.graphicsContext.call(t.tooltipUtils.tooltipUpdate,[r]));this.value=r},s.prototype.displayStatusGraphic=function(e,i,a,r){this.graphicsContext.selectAll("text").remove();var n=this.kpiImage.select("div");n&&!n.empty()||(n=this.kpiImage.append("div")),n.attr("class",e.class).style("position","absolute").style("font-size",r+"px");var o=n.node().offsetWidth,s=n.node().offsetHeight;n.style("transform",t.SVGUtil.translateWithPixels(i-o/2,this.getTranslateY(r+a)-s))},s.prototype.getDefaultFormatSettings=function(){return{labelSettings:t.dataLabelUtils.getDefaultCardLabelSettings(s.DefaultStyle.value.color,s.DefaultStyle.label.color,s.DefaultStyle.value.textSize),wordWrap:!1,textSize:s.DefaultStyle.label.textSize}},s.prototype.enumerateObjectInstances=function(e){this.cardFormatSetting||(this.cardFormatSetting=this.getDefaultFormatSettings());var i=this.cardFormatSetting,a=new t.ObjectEnumerationBuilder;switch(e.objectName){case"categoryLabels":t.dataLabelUtils.enumerateCategoryLabels(a,i.labelSettings,!0,!0,i.textSize);break;case"labels":var r={enumeration:a,dataLabelsSettings:i.labelSettings,show:!0,displayUnits:!0,precision:!0,fontSize:!0};t.dataLabelUtils.enumerateDataLabels(r);break;case"wordWrap":a.pushInstance({objectName:"wordWrap",selector:null,properties:{show:i.wordWrap}})}return a.complete()},s.cardClassName="card",s.Label=n("label"),s.Value=n("value"),s.KPIImage=n("caption"),s.cardTextProperties={fontSize:null,text:null,fontFamily:t.dataLabelUtils.LabelTextProperties.fontFamily},s.DefaultStyle={card:{maxFontSize:200},label:{textSize:12,color:"#a6a6a6",paddingTop:8},value:{textSize:27,color:"#333333",fontFamily:t.Font.Family.regularSecondary.css}},s})(t.AnimatedText);t.Card=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=t.ShapeMapType.Role,a=t.ShapeMapType.Projection,r=e.visuals.standardGeoJson,n=(u={},u[r.australiaStates]={projections:[a.mercator,a.equirectangular,a.orthographic]},u[r.austriaStates]={projections:[a.mercator,a.equirectangular,a.orthographic]},u[r.brazilStates]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.canadaProvinces]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.franceRegions]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.germanyStates]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.irelandCounties]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.italyRegions]={projections:[a.mercator,a.equirectangular,a.orthographic]},u[r.mexicoStates]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.netherlandsProvinces]={projections:[a.mercator,a.equirectangular,a.orthographic]},u[r.ukCountries]={projections:[a.orthographic,a.equirectangular,a.mercator]},u[r.usaStates]={projections:[a.albersUsa,a.equirectangular,a.mercator,a.orthographic]},u),o=[a.mercator,a.equirectangular,a.orthographic],s=(function(){function s(e){this.resetToDefault=!1,e&&(this.behavior=e.behavior,this.behavior&&(this.behavior.shapeMap=this),this.tooltipsEnabled=e.tooltipsEnabled)}return s.prototype.init=function(e){this.root=e.element,this.hostServices=e.host,this.tooltipService=t.createTooltipService(e.host),this.viewport=e.viewport,this.svg=d3.select(this.root.get(0)).append("svg").attr("class","shapeMap").attr("width",this.viewport.width).attr("height",this.viewport.height).attr("drag-resize-disabled","true").style("position","absolute"),this.behavior&&(this.clearCatcher=t.appendClearCatcher(this.svg),this.interactivityService=t.createInteractivityService(this.hostServices)),this.mapG=this.svg.append("g"),this.colors=e.style.colorPalette.dataColors,this.legend=t.createLegend(this.root,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,!0)},s.prototype.update=function(e){if(this.viewport=e.viewport,!_.isEmpty(e.dataViews)&&e.dataViews[0]){this.populateObjectProperties(e.dataViews[0]);var i=new t.ColorHelper(this.colors,t.mapProps.dataPoint.fill,this.defaultDataPointColor);this.viewModel=s.converter(e.dataViews[0],this.interactivityService,i,this.tooltipsEnabled),this.legendData=this.createLegendData(e.dataViews[0],i),this.render(e.suppressAnimations)}},s.prototype.populateObjectProperties=function(i){if(i&&i.metadata){var a=i.metadata;this.defaultDataPointColor=e.DataViewObjects.getFillColor(a.objects,t.mapProps.dataPoint.defaultColor),this.showAllDataPoints=e.DataViewObjects.getValue(a.objects,t.mapProps.dataPoint.showAllDataPoints),a?this.legendObjectProperties=e.DataViewObjects.getObject(a.objects,"legend",{}):this.legendObjectProperties={}}},s.prototype.enumerateObjectInstances=function(i){if(this.viewModel){var a=new t.ObjectEnumerationBuilder;switch(i.objectName){case"legend":if(!this.viewModel.hasDynamicSeries)return;var r=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.show,this.legend.isVisible()),n=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.showTitle,!0),l=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.titleText,this.legendData?this.legendData.title:""),u=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.labelColor,t.LegendData.DefaultLegendLabelFillColor),c=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.fontSize,this.legendData&&this.legendData.fontSize?this.legendData.fontSize:t.SVGLegend.DefaultFontSizeInPt),d=e.DataViewObject.getValue(this.legendObjectProperties,t.legendProps.position,t.legendPosition.top);a.pushInstance({selector:null,properties:{show:r,position:d,showTitle:n,titleText:l,labelColor:u,fontSize:c},objectName:i.objectName});break;case"shape":this.viewModel.shapeMap?a.pushInstance({objectName:"shape",selector:null,properties:{map:_.clone(this.viewModel.shapeMap),projectionEnum:this.viewModel.projectionEnum},validValues:{projectionEnum:s.validProjectionsForShapeMap(this.viewModel.shapeMap)}}):a.pushInstance({objectName:"shape",selector:null,properties:{map:{}},validValues:{projectionEnum:o}});break;case"zoom":a.pushInstance({objectName:"zoom",selector:null,properties:{autoZoom:this.viewModel.autoZoom,selectionZoom:this.viewModel.selectionZoom,manualZoom:this.viewModel.manualZoom}});break;case"defaultColors":a.pushInstance({objectName:"defaultColors",selector:null,properties:{defaultShow:this.viewModel.defaultShow,defaultColor:this.viewModel.defaultShow?this.viewModel.defaultColor:null,borderColor:this.viewModel.borderColor,borderThickness:this.viewModel.borderThickness}});break;case"dataPoint":this.viewModel.hasDynamicSeries&&this.enumerateDataPoints(a)}return a.complete()}},s.getStandardGeoJsonFiles=function(){return _.clone(n)},s.validProjectionsForShapeMap=function(e){if(!e||!e.name)return o;var t=n[e.name];return!t||_.isEmpty(t.projections)?o:t.projections},s.prototype.enumerateDataPoints=function(e){var t=this.viewModel;if(t)if(t.hasDynamicSeries&&this.legendData)for(var i=0;i<this.legendData.dataPoints.length;i++){var a=this.legendData.dataPoints[i];e.pushInstance({objectName:"dataPoint",displayName:a.label,selector:a.identity.getSelector(),properties:{fill:{solid:{color:a.color}}}})}else if(e.pushInstance({objectName:"dataPoint",selector:null,properties:{defaultColor:{solid:{color:this.defaultDataPointColor||this.colors.getColorByIndex(0).value}}}}).pushInstance({objectName:"dataPoint",selector:null,properties:{showAllDataPoints:!!this.showAllDataPoints}}),this.showAllDataPoints)for(var r=0,n=t.dataPoints;r<n.length;r++){var a=n[r];e.pushInstance({objectName:"dataPoint",displayName:a.location,selector:a.identity.getSelector(),properties:{fill:{solid:{color:a.color}}}})}},s.prototype.getDataPointFromShape=function(e){return this.matcher.getDataPointFromShape(e)},s.getObjectProperties=function(i){var a=i&&i.metadata&&i.metadata.objects?i.metadata.objects:{},r=e.DataViewObjects.getValue(a,t.shapeMapProps.shape.map,null),n=s.validProjectionsForShapeMap(r),o=n[0],l=e.DataViewObjects.getValue(a,t.shapeMapProps.shape.projectionEnum,o);return _.contains(n,l)||(l=o),{map:r,projectionEnum:l,autoZoom:e.DataViewObjects.getValue(a,t.shapeMapProps.zoom.autoZoom,!1),selectionZoom:e.DataViewObjects.getValue(a,t.shapeMapProps.zoom.selectionZoom,!1),manualZoom:e.DataViewObjects.getValue(a,t.shapeMapProps.zoom.manualZoom,!1),defaultShow:e.DataViewObjects.getValue(a,t.shapeMapProps.defaultColors.defaultShow,!0),defaultColor:e.DataViewObjects.getFillColor(a,t.shapeMapProps.defaultColors.defaultColor,"#DDDDDD"),borderColor:e.DataViewObjects.getFillColor(a,t.shapeMapProps.defaultColors.borderColor,"#999999"),borderThickness:e.DataViewObjects.getValue(a,t.shapeMapProps.defaultColors.borderThickness,1)}},s.converter=function(a,r,n,o){void 0===o&&(o=!0);var l,u,c,d,p,h=[],g=0;a&&(l=e.data.createIDataViewCategoricalReader(a),u=l.getMeasureQueryName(i.value),c=l.getCategoryDisplayName(i.category),d=l.getCategoryMetadataColumn(i.category),p=l.getCategoryColumn(i.category));var f,m=!1,y=!1,v=!1;l&&(m=l.hasDynamicSeries(),y=l.hasValues(i.value),v=l.hasCategoryWithRole(i.category),f=l.getMeasureQueryName(i.value),null==f&&(f=""));var w=a&&l&&l.hasCategories();if(w){var b=t.shapeMapProps.general.formatString;g=l.getSeriesCount();for(var C=0;C<l.getCategoryCount();C++){var S=l.getValue(i.value,C),x=void 0,P=v?l.getCategoryObjects(i.category,C):l.getCategoryObjects(i.value,C),D=void 0,T=void 0,V=void 0,_=l.getSeriesColumnIdentityFields();v&&(x=l.getCategoryValue(i.category,C),D={displayName:l.getCategoryDisplayName(i.category),value:t.converterHelper.formatFromMetadataColumn(x,l.getCategoryMetadataColumn(i.category),b)}),g=l.getSeriesCount(),l.hasValues(i.value)||(g=1);for(var L=0;L<g;L++){var M=void 0;M=m?n.getColorForSeriesValue(l.getSeriesObjects(L),_,l.getSeriesName(L)):l.hasCategoryWithRole(i.series)?n.getColorForSeriesValue(l.getCategoryObjects(i.series,C),l.getCategoryColumnIdentityFields(i.series),x):n.getColorForMeasure(P,f);var N=(new t.SelectionIdBuilder).withCategory(l.getCategoryColumn(v?i.category:i.value),C).withMeasure(l.getMeasureQueryName(i.value));m&&(N=N.withSeries(l.getSeriesValueColumns(),l.getValueColumn(i.value,L)),T={displayName:l.getSeriesDisplayName(),value:t.converterHelper.formatFromMetadataColumn(l.getSeriesName(L),l.getSeriesMetadataColumn(),b)}),y&&(S=l.getValue(i.value,C,L),V={displayName:l.getValueDisplayName(i.value),value:t.converterHelper.formatFromMetadataColumn(S,l.getValueMetadataColumn(i.value,L),b)});var I=[];o&&(D&&I.push(D),T&&I.push(T),V&&I.push(V),t.TooltipBuilder.addTooltipMeasures(l,I,C,L)),null==S&&y||h.push({location:x,identity:N.createSelectionId(),value:S,selected:!1,tooltipInfo:I,color:M})}}}r&&r.applySelectionStateToData(h);var A=s.getObjectProperties(a);return{shapeMap:A.map,projectionEnum:A.projectionEnum,autoZoom:A.autoZoom,selectionZoom:A.selectionZoom,manualZoom:A.manualZoom,defaultShow:A.defaultShow,defaultColor:A.defaultColor,borderColor:A.borderColor,borderThickness:A.borderThickness,dataPoints:h,categoryName:c,dataAvailable:w,hasDynamicSeries:m,seriesCount:g}},s.createProjection=function(e){var t=d3.geo[e]();return e===a.orthographic&&t.clipAngle(90),t},s.adjustProjection=function(e,t,i,a,r,n){if(void 0===n&&(n=1),e.scale(1).translate([0,0]),t>0){var o=d3.geo.centroid(r);e.rotate(o.map((function(e,i){return i<t?-e:0})))}var s=d3.geo.path().projection(e).bounds(r),l=s[0][0],u=s[1][0],c=s[0][1],d=s[1][1],p=Math.abs(u-l),h=Math.abs(d-c),g=Math.min(i/p,a/h);g*=n,e.scale(g);var f=(i-g*(u+l))/2,m=(a-g*(d+c))/2;e.translate([f,m])},s.prototype.createGetColorFunction=function(){var e=this;return function(t){var i=e.matcher.getDataPointFromShape(t);return i&&null!=i.color?i.color:e.viewModel.defaultColor}},s.rotationAxes=function(e){switch(e){case a.albersUsa:return 0;case a.mercator:case a.equirectangular:return 1;case a.orthographic:return 2;default:return 0}},s.prototype.createLegendData=function(i,a){var r,n=e.data.createIDataViewCategoricalReader(i),o=[];if(n.hasDynamicSeries()){r=n.getSeriesDisplayName();for(var s=n.getSeriesColumnIdentityFields(),l=0,u=n.getSeriesCount();l<u;l++){var c=a.getColorForSeriesValue(n.getSeriesObjects(l),s,n.getSeriesName(l)),d=(new t.SelectionIdBuilder).withSeries(n.getSeriesValueColumns(),n.getSeriesValueColumnGroup(l)).createSelectionId();o.push({color:c,label:t.valueFormatter.format(n.getSeriesName(l)),icon:t.LegendIcon.Circle,identity:d,selected:!1})}}var p={dataPoints:o,title:r,fontSize:e.DataViewObject.getValue(this.legendObjectProperties,"fontSize",t.SVGLegend.DefaultFontSizeInPt)};return p},s.prototype.zoomOnClick=function(e){this.viewModel&&this.viewModel.selectionZoom&&(!e&&this.selectionZoomShape||e&&e.id&&this.selectionZoomShape&&this.selectionZoomShape.id&&this.selectionZoomShape.id===e.id?this.selectionZoomShape=null:this.selectionZoomShape=e,this.render(!1,!0))},s.prototype.resetToDefaultMap=function(){var i={type:e.GeoJsonTypes.shared,name:r.usaStates,content:void 0},a=t.ShapeMapType.Projection.albersUsa;this.hostServices.persistProperties([{objectName:"shape",selector:null,properties:{map:i,projectionEnum:a},validValues:{projectionEnum:s.validProjectionsForShapeMap(i)}}])},s.loadFeatureCollection=function(e){for(var t in e.objects)return topojson.feature(e,e.objects[t])},s.prototype.featuresToZoomTo=function(e,t){var i=this;if(t&&this.selectionZoomShape)return{type:"FeatureCollection",features:[this.selectionZoomShape]};if(this.viewModel.autoZoom){var a={type:"FeatureCollection",features:e.features.filter((function(e){return!!i.getDataPointFromShape(e)}))};if(a.features.length>0)return a}return e},s.prototype.render=function(e,i){var a=this;if(!this.viewModel.shapeMap||!this.viewModel.shapeMap.content)return void(this.resetToDefault||(this.resetToDefault=!0,this.resetToDefaultMap()));this.resetToDefault=!1,this.mapG.transition(),this.shapes&&this.shapes.transition(),this.shapes&&this.shapes.exit()&&this.shapes.exit().transition(),this.manualZoomDisconnect(),this.viewModel.projectionEnum!==this.projectionEnum&&(this.projection=null),this.projectionEnum=this.viewModel.projectionEnum,this.renderLegend(),t.Legend.positionChartArea(this.svg,this.legend);var r=this.getMapViewport();this.svg.attr("width",r.width).attr("height",r.height);var n=JSON.parse(this.viewModel.shapeMap.content),o=s.loadFeatureCollection(n);this.matcher=new l.Matcher(o.features,this.viewModel.dataPoints,this.viewModel.categoryName);var u=this.featuresToZoomTo(o,i),c=this.projection&&!this.viewModel.autoZoom&&!this.viewModel.selectionZoom&&this.prevAutoZoom===this.viewModel.autoZoom&&this.prevManualZoom===this.viewModel.manualZoom&&this.prevSelectionZoom===this.viewModel.selectionZoom&&this.prevShapeMapName===this.viewModel.shapeMap.name&&this.prevMapViewportWidth===r.width&&this.prevMapViewportHeight===r.height;this.prevAutoZoom=this.viewModel.autoZoom,this.prevManualZoom=this.viewModel.manualZoom,this.prevSelectionZoom=this.viewModel.selectionZoom,this.prevShapeMapName=this.viewModel.shapeMap.name,this.prevMapViewportWidth=r.width,this.prevMapViewportHeight=r.height;var d;if(c)d=this.projection;else{d=s.createProjection(this.viewModel.projectionEnum);var p=s.rotationAxes(this.viewModel.projectionEnum),h=.9;s.adjustProjection(d,p,r.width,r.height,u,h)}var g=this.createGetColorFunction();if(this.mapG.style("stroke-width",this.viewModel.borderThickness/2).style("stroke",this.viewModel.borderColor).style("fill",this.viewModel.defaultColor),this.shapes=this.mapG.selectAll("path").data(this.visibleFeatures(o),this.shapeKeyFunction(o)),!this.projection||e)this.projection=d,this.path=d3.geo.path().projection(this.projection),this.shapes.enter().append("path"),this.shapes.attr("d",this.path).style("fill",g).attr("opacity",1),this.shapes.exit().remove(),this.manualZoomConnect();else{var f=600;if(this.path=d3.geo.path().projection(this.projection),this.shapes.enter().append("path").style("fill",g).attr("opacity",0).attr("d",this.path),this.shapes.transition().duration(f).style("fill",g).attr("opacity",1),this.shapes.exit().transition().duration(f).style("fill",g).attr("opacity",0).remove(),s.projectionsEqual(this.projection,d))this.projection=d,this.shapes.attr("d",this.path),this.shapes.exit().attr("d",this.path),this.manualZoomConnect();else{var m=this.projection,y=d;this.mapG.transition().duration(f).tween("projection transition",(function(){var e=m.scale&&d3.interpolate(m.scale(),y.scale()),t=m.translate&&d3.interpolate(m.translate(),y.translate()),i=m.rotate&&d3.interpolate(m.rotate(),y.rotate());return m=null,y=null,function(r){e&&a.projection.scale(e(r)),t&&a.projection.translate(t(r)),i&&a.projection.rotate(i(r)),a.shapes.attr("d",a.path),a.shapes.exit().attr("d",a.path)}})).each("end",(function(){return a.manualZoomConnect()}))}}if(this.tooltipsEnabled){var v=[];this.viewModel.dataAvailable||(v=this.matcher.shapeProps.map((function(e){return e.propName})).sort()),this.tooltipService.addTooltip(this.shapes,(function(e){if(a.viewModel.dataAvailable){var t=a.matcher.getDataPointFromShape(e.data);return t?t.tooltipInfo:[{displayName:a.viewModel.categoryName,value:a.matcher.getShapeProp(e.data,a.matcher.shapePropName)}]}return v.map((function(t){return{displayName:t?t:"ID",value:a.matcher.getShapeProp(e.data,t)}}))}),(function(e){var t=a.matcher.getDataPointFromShape(e.data);if(t)return t.identity}))}if(this.behavior&&this.interactivityService){var w={shapes:this.shapes,clearCatcher:this.clearCatcher};this.interactivityService.bind(this.viewModel.dataPoints,this.behavior,w)}},s.prototype.visibleFeatures=function(e){var t=this;return this.viewModel.defaultShow?e.features:e.features.filter((function(e){return!!t.getDataPointFromShape(e)}))},s.prototype.shapeKeyFunction=function(e){return e.features[0]&&null!=e.features[0].id?function(e){return e.id}:null},s.projectionsEqual=function(e,t){return!(e.scale&&!_.isEqual(e.scale(),t.scale()))&&(!(e.rotate&&!_.isEqual(e.rotate(),t.rotate()))&&!(e.translate&&!_.isEqual(e.translate(),t.translate())))},s.prototype.manualZoomConnect=function(){var e=this;if(!this.zoom&&this.viewModel.manualZoom){var t=4,i=16,a=this.projection.scale();this.zoom=d3.behavior.zoom().translate(this.projection.translate()).scale(a).scaleExtent([a/t,a*i]),this.zoom.on("zoom",(function(){e.projection.translate(e.zoom.translate()).scale(e.zoom.scale()),e.shapes.attr("d",e.path)})),this.svg.call(this.zoom)}},s.prototype.manualZoomDisconnect=function(){this.zoom&&this.zoom.on("zoom",null),this.zoom=null},s.prototype.getMapViewport=function(){var e=this.viewport,t=this.legend.getMargins(),i={width:e.width-t.width,height:e.height-t.height};return i},s.prototype.renderLegend=function(){var e=this.legendData,i=this.legendObjectProperties;if(i){t.LegendData.update(e,i);var a=i[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a])}else this.legend.changeOrientation(t.LegendPosition.Top);var r=1===e.dataPoints.length&&!e.grouped&&!this.viewModel.hasDynamicSeries;r&&(e.dataPoints=[]),this.legend.drawLegend(e,this.viewport)},s.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},s.capabilities=t.shapeMapCapabilities,s})();t.ShapeMap=s;var l;!(function(e){var t=(function(){function e(e,t,i){this.shapes=e,this.dataPoints=t,this.categoryName=i,this.shapeProps=this.countShapeProps(this.shapes),this.shapeProps=this.shapeProps.sort(this.getShapePropCompareFunction(this.categoryName)),this.buildMappings()}return e.prototype.getDataPointFromShape=function(e){var t=this.getShapeProp(e,this.shapePropName);return t||0===t?this.shapeToData[t]:null},e.prototype.getShapeFromDataPoint=function(e){var t=e.location;return this.dataToShape[t]},e.prototype.countShapeProps=function(e){for(var t={},i=0,a=e.length,r=0;r<a;r++){var n=e[r];n.hasOwnProperty("id")&&i++;for(var o in n.properties)t.hasOwnProperty(o)?t[o]++:t[o]=1}var s=[];for(var o in t)t.hasOwnProperty(o)&&s.push({propName:o,count:t[o]});return i>0&&s.push({propName:"",count:i}),s},e.prototype.getShapePropCompareFunction=function(e){return function(t,i){if(t.count!==i.count)return i.count-t.count;if(e){if(t.propName===e)return-1;if(i.propName===e)return 1;if(e=e.toLowerCase().trim(),t.propName.toLowerCase().trim()===e)return-1;if(i.propName.toLowerCase().trim()===e)return 1}return 0}},e.prototype.getShapeProp=function(e,t){return""===t?e.id:e.properties[t]},e.prototype.removeAtIndex=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e.prototype.buildMappings=function(){var e=0;e:for(var t=0;t<this.shapeProps.length;t++){var i=this.shapeProps[t];if(e>i.count)break e;for(var a=0,r={},n={},o=this.shapes,s=this.dataPoints,l=o.length-1;l>=0;l--){var u=o[l],c=this.getShapeProp(u,i.propName);if(c||0===c){t:for(var d=0;d<s.length;d++){var p=s[d],h=p.location;if(null!=h&&(h===c||h.toLowerCase&&c.toLowerCase&&h.toLowerCase()===c.toLowerCase())){r[h]=u,n[c]=p,o=this.removeAtIndex(o,l),s=this.removeAtIndex(s,d),a++;break t}}if(0===o.length||0===s.length){e=a,this.shapePropName=i.propName,this.shapeToData=n,this.dataToShape=r;break e}}}a>e&&(e=a,this.shapePropName=i.propName,this.shapeToData=n,this.dataToShape=r)}},e})();e.Matcher=t})(l=t.Matching||(t.Matching={}));var u})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.PixelConverter,n=e.data.SQExprBuilder,o=a.Color;t.DateSlicerSupportedModes=[t.slicerMode.after,t.slicerMode.before,t.slicerMode.between];var s=150,l=9,u="Segoe UI,wf_segoe-ui_normal,helvetica,arial,sans-serif",c=t.slicerMode.between,d="date-slicer-range",p="date-slicer",h="date-slicer-head",g="date-slicer-input",f="drag-resize-disabled",m="date-slicer-slider",y="date-slicer-control",v=(function(){function a(t){this.isRendered=!1,t&&(this.hostServices=t.hostServices);var i=e.common;this.culture=Globalize.culture(i?i.cultureInfo:"")}return a.DefaultDateInputSettings=function(){return{textSize:9,fontColor:"#000000",background:null}},a.DefaultSliderSettings=function(){return{color:"#666666",show:!0}},Object.defineProperty(a.prototype,"activeMode",{get:function(){return this.data.mode||c},enumerable:!0,configurable:!0}),a.prototype.init=function(e,t){this.options=e,this.host=t},a.prototype.onModeChange=function(e){if(_.indexOf(t.DateSlicerSupportedModes,e)>-1){if(!this.data)return;this.updateMode(e)}else t.SlicerUtil.clearSlicerFilter(this.hostServices,e)},a.prototype.onClear=function(){this.data.value=this.data.initialValue,this.data.state=0,this.updateProperties()},a.prototype.render=function(i){if(!_.isEmpty(i.dataView)){if(this.dataView=i.dataView,this.reader=e.data.createIDataViewCategoricalReader(this.dataView),!a.isValid(this.reader))return void(this.isRendered&&(this.disableSlicer(),this.hostServices.setWarnings([new t.DateSlicerNoDataWarning])));this.isRendered&&this.enableSlicer();var r=this.data&&this.data.properties?this.data.properties.filter:null;this.data=a.converter(this.reader,r),this.isRendered||this.initControls(),this.setDate(this.data.value),this.range=new t.DateRange(this.data.dateBounds.min,this.data.dateBounds.max,this.data.value.min,this.data.value.max),this.updateDateControls(),this.updateSlider(this.activeMode),this.updateProperties()}},a.prototype.enumerateObjectInstances=function(e){if("date"===e.objectName){if(this.data&&this.data.dateStyle)return[{selector:null,objectName:"date",properties:{fontColor:this.data.dateStyle.fontColor,background:this.data.dateStyle.background,textSize:this.data.dateStyle.textSize}}]}else if("slider"===e.objectName)return[{selector:null,objectName:"Slider",properties:{show:this.data.sliderSettings.show,color:this.data.sliderSettings.color}}]},a.isValid=function(e){var i=e.getMetadataColumns(t.slicerRoles.value);if(!_.isEmpty(i)){var a=i[0];if(a.aggregates&&a.aggregates.min&&a.aggregates.max)return!0}return!1},a.converter=function(i,r){var n={state:0,mode:null,properties:{},sliderSettings:a.DefaultSliderSettings(),dateStyle:a.DefaultDateInputSettings()},s=i.getMetadataColumns(t.slicerRoles.value);if(_.isEmpty(s))return n;var l=s[0],u=l.aggregates,c=t.valueFormatter.getFormatString(l,null);n.formatter=t.valueFormatter.createDefaultFormatter(c),n.identity=l.expr,n.value={min:u.min,max:u.max},n.initialValue={min:u.min,max:u.max},n.dateBounds={min:n.value.min,max:n.value.max};var d=i.getStaticObjects();d?(n.properties.startDate=e.DataViewObjects.getValue(d,t.slicerProps.data.startDate,null),n.properties.endDate=e.DataViewObjects.getValue(d,t.slicerProps.data.endDate,null),n.properties.mode=e.DataViewObjects.getValue(d,t.slicerProps.data.mode,null),n.dateStyle.background=e.DataViewObjects.getFillColor(d,t.slicerProps.date.background,n.dateStyle.background),n.dateStyle.fontColor=e.DataViewObjects.getFillColor(d,t.slicerProps.date.fontColor,n.dateStyle.fontColor),n.dateStyle.textSize=e.DataViewObjects.getValue(d,t.slicerProps.date.textSize,n.dateStyle.textSize),n.sliderSettings.color=e.DataViewObjects.getFillColor(d,t.slicerProps.slider.color,n.sliderSettings.color),n.sliderSettings.show=e.DataViewObjects.getValue(d,t.slicerProps.slider.show,n.sliderSettings.show),n.properties.startDate&&(n.state|=1,n.value.min=n.properties.startDate,n.properties.startDate<n.dateBounds.min&&(n.dateBounds.min=n.properties.startDate)),n.properties.endDate&&(n.state=n.state|=2,n.value.max=n.properties.endDate,n.properties.endDate>n.dateBounds.max&&(n.dateBounds.max=n.properties.endDate)),n.value.min>n.dateBounds.max&&(n.value.max=n.dateBounds.max=n.value.min),n.value.max<n.dateBounds.min&&(n.value.min=n.dateBounds.min=n.value.max),null!=n.properties.mode&&(n.mode=n.properties.mode)):(n.state=0,n.properties.startDate=null,n.properties.endDate=null,n.properties.mode=null);var p=o.parseColorString(n.sliderSettings.color);return n.sliderSettings.activeColor=o.calculateHighlightColor(p,.5,.2),n.properties.filter=r,n.properties.bounds={min:n.dateBounds.min,max:n.dateBounds.max},n},a.prototype.initControls=function(){this.isRendered=!0,this.createHtmlControls(),this.updateMode(this.data.mode)},a.prototype.createHtmlControls=function(){this.container=r.DomFactory.div().addClass(p).appendTo(this.host),this.container.on("keyup keydown",(function(e){e.stopPropagation()}));var e=r.DomFactory.div().addClass(h).css(this.getFontStyles(),t.NewDataLabelUtils.LabelTextProperties.fontSize).appendTo(this.container),i=r.DomFactory.div().addClass(d).appendTo(e);this.dtStartContainer=r.DomFactory.div().addClass(y).appendTo(i),this.dtEndContainer=r.DomFactory.div().addClass(y).appendTo(i),this.dtStart=this.createDatePicker(this.dtStartContainer,0),this.dtEnd=this.createDatePicker(this.dtEndContainer,1),this.sliderContainer=r.DomFactory.div().addClass(m).appendTo(this.container)},a.prototype.createDatePicker=function(e,t){var i=this,a=r.DomFactory.textBox().attr("type","text").attr(f,"true").addClass(g).appendTo(e);a.on("change",(function(e){var r=a.val();i.onDateChange(r,t)})),a.datepicker({showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0,nextText:"",prevText:"",firstDay:this.culture.calendar.firstDay,dayNamesMin:this.culture.calendar.days.namesAbbr,dateFormat:this.culture.calendar.patterns.d.replace("yyyy","yy").toLowerCase(),monthNamesShort:this.culture.calendar.months.names}),a.on("click",(function(e){a.datepicker("show")}));var n=a.datepicker("widget");return a.datepicker("option","beforeShow",(function(){i.fixPosition(n,a,1e3)})),a},a.prototype.fixPosition=function(e,i,a){var r=this;setTimeout((function(){e.visible()?t.SlicerUtil.fixWidgetPosition(e,i,null,!0):a>0&&r.fixPosition(e,i,a-20)}),20)},a.prototype.getFontStyles=function(){return e={},e["font-size"]=i.fromPointToPixel(l),e["font-family"]=u,e["font-weight"]=t.NewDataLabelUtils.LabelTextProperties.fontWeight,e;var e},a.prototype.updateSliderControl=function(){var e=this;if(this.slider&&this.mode===this.activeMode){var i=this.range.getScaledValue(),n=[];this.activeMode!==t.slicerMode.before&&n.push(i.min),this.activeMode!==t.slicerMode.after&&n.push(i.max),this.slider.set(n)}else this.slider&&(this.slider.destroy(),this.sliderContainer.empty()),this.mode=this.activeMode,this.sliderElement=r.DomFactory.div().appendTo(this.sliderContainer),noUiSlider.create(this.sliderElement.get(0),this.createSliderOptions()),this.slider=this.sliderElement.get(0).noUiSlider,this.slider.on("slide",(function(t,i,a){window.requestAnimationFrame((function(){var t=e.parseSliderValue(a);e.setDate(t)}))})),this.slider.on("change",(function(t,i,r){var n=e.sliderElement.hasClass("noUi-state-tap")?300:0;setTimeout((function(){var t=e.parseSliderValue(r),n=a.getChangeType(e.activeMode,i);e.updateDate(t,n)}),n)})),this.applyHandlesHoverState(this.sliderContainer.find(".noUi-handle"));this.sliderContainer.find(".noUi-connect").css({"background-color":this.data.sliderSettings.color}),this.sliderContainer.find(".noUi-handle").each((function(t,i){
$(i).css({"background-color":$(i).is(":hover")?e.data.sliderSettings.activeColor:e.data.sliderSettings.color})}))},a.prototype.disableSlicer=function(){this.disableSlider(),1&this.data.state||(this.dtStart.val(""),this.dtStart.prop("disabled",!0),this.disableInput(this.dtStart,this.data.dateStyle.fontColor)),2&this.data.state||(this.dtEnd.val(""),this.dtEnd.prop("disabled",!0),this.disableInput(this.dtEnd,this.data.dateStyle.fontColor)),this.data.dateBounds.min=this.data.dateBounds.max=null,this.updateProperties()},a.prototype.disableSlider=function(){if(this.sliderElement&&this.sliderElement.get(0).setAttribute("disabled","true"),this.sliderContainer.css("opacity","0.1"),this.slider){var e=[0,100];this.slider.set(e)}},a.prototype.enableSlicer=function(){this.sliderElement&&this.sliderElement.get(0).removeAttribute("disabled"),this.sliderContainer.css("opacity","1.0"),this.dtStart.prop("disabled",!1),this.dtEnd.prop("disabled",!1)},a.prototype.applyHandlesHoverState=function(e){var t=this,i=!1,a=!1,r="#000000";e.on("mouseover",(function(){a=!0,i||$(event.target).css({"background-color":r})})).on("mouseout",(function(){a=!1,i||$(event.target).css({"background-color":t.data.sliderSettings.color})})).on("mousedown touchstart",(function(){i=!0;var e=event.target;$(e).css({"background-color":t.data.sliderSettings.activeColor});var a=function(){$(document).off("mouseup touchEnd",a),i&&(i=!1,$(e).css({"background-color":t.data.sliderSettings.color}))};$(document).on("mouseup touchEnd",a)})).on("mouseup touchend",(function(){i=!1;var e=event.target;$(e).css({"background-color":a?r:t.data.sliderSettings.color})}))},a.prototype.updateDateControls=function(){var e={"font-size":i.fromPointToPixel(this.data.dateStyle.textSize),"font-family":u,"font-weight":t.NewDataLabelUtils.LabelTextProperties.fontWeight};this.dtStart.parent().css(e),this.dtEnd.parent().css(e);var a={color:this.data.dateStyle.fontColor,"background-color":this.data.dateStyle.background?this.data.dateStyle.background:""};this.dtStart.css(a),this.dtEnd.css(a)},a.prototype.disableInput=function(e,t){var i=o.parseColorString(t);i.A=.3,e.css({color:o.rgbString(i)})},a.prototype.createSliderOptions=function(){var e,i,a=this.range.getScaledValue();switch(this.activeMode){case t.slicerMode.before:e=a.max,i="lower";break;case t.slicerMode.after:e=a.min,i="upper";break;case t.slicerMode.between:e=[a.min,a.max],i=!0}var r={connect:i,behaviour:"tap",range:{min:0,max:100},start:e};return r},a.prototype.parseSliderValue=function(e){var i=this.range.getScaledValue();switch(this.activeMode){case t.slicerMode.before:i.max=e;break;case t.slicerMode.after:i.min=e;break;case t.slicerMode.between:i.min=e[0],i.max=e[1]}return this.range.setScaledValue(i),this.range.getValue()},a.prototype.setDate=function(e,t){void 0===t&&(t=null),null==t?(this.dtStart.val(Globalize.format(e.min,"d",this.culture)),this.dtEnd.val(Globalize.format(e.max,"d",this.culture))):0===t?this.dtStart.val(Globalize.format(e.min,"d",this.culture)):1===t&&this.dtEnd.val(Globalize.format(e.max,"d",this.culture))},a.prototype.updateSlider=function(e){e===t.slicerMode.after?(this.dtEnd.prop("disabled",!0),this.disableInput(this.dtEnd,this.data.dateStyle.fontColor),this.dtStart.prop("disabled",!1)):e===t.slicerMode.before?(this.dtEnd.prop("disabled",!1),this.dtStart.prop("disabled",!0),this.disableInput(this.dtStart,this.data.dateStyle.fontColor)):(this.dtEnd.prop("disabled",!1),this.dtStart.prop("disabled",!1)),this.container.width()<=s||!this.data.sliderSettings.show?this.sliderContainer.hide():(this.sliderContainer.show(),this.updateSliderControl()),this.data.dateBounds.min.getTime()===this.data.dateBounds.max.getTime()&&this.disableSlider()},a.prototype.updateMode=function(e){var i=this.data.mode;null==e&&(e=c),this.data.mode=e,e===t.slicerMode.before?(i===t.slicerMode.after&&1&this.data.state&&(this.data.value.max=this.data.value.min,this.data.value.min=this.data.dateBounds.min,this.data.state=2),this.data.state&=-2):e===t.slicerMode.after&&(i===t.slicerMode.before&&2&this.data.state&&(this.data.value.min=this.data.value.max,this.data.state=1),this.data.state&=-3),this.updateProperties()},a.prototype.updateDate=function(e,t){void 0===t&&(t=null),null==t?(this.data.value.min=e.min,this.data.value.max=e.max):0===t?(this.data.value.min=e.min,null!==this.data.dateBounds.min&&this.data.value.min.getTime()===this.data.dateBounds.min.getTime()?this.data.state&=-2:this.data.state|=1):1===t&&(this.data.value.max=e.max,null!==this.data.dateBounds.max&&this.data.value.max.getTime()===this.data.dateBounds.max.getTime()?this.data.state&=-3:this.data.state|=2),this.updateProperties()},a.prototype.onDateChange=function(e,t){var i=Globalize.parseDate(e,null,this.culture);return null==i?void this.setDate(this.data.value,t):0===t&&i>this.data.value.max||1===t&&i<this.data.value.min?void this.setDate(this.data.value,t):void this.updateDate({min:i,max:i},t)},a.prototype.updateProperties=function(){var e={min:this.data.value.min,max:this.data.value.max},t={min:this.data.dateBounds.min,max:this.data.dateBounds.max},i={startDate:1&this.data.state?this.data.value.min:null,endDate:2&this.data.state?this.data.value.max:null,mode:this.data.mode,filter:e,bounds:t};if(this.requireToUpdate(i)){this.data.properties.filter=e,this.data.properties.bounds=t;var r=a.createPersistProperties(i,this.data.identity,this.data.state);this.hostServices.persistProperties(r),this.hostServices.onSelect({visualObjects:[]})}},a.createFilter=function(i,a,r,o){var s=null,l=i.filter,u=i.bounds,c=null,d=new Date(l.min.getTime());d.setHours(0,0,0,0);var p=new Date(l.max.getTime());p.setHours(23,59,59,999);var h=n.dateTime(d),g=n.dateTime(p);if(null===u.min&&null==u.max)1&r&&2&r?s=n.between(o,h,g):1&r?s=n.compare(2,o,h):2&r&&(s=n.compare(4,o,g));else if(a===t.slicerMode.between&&(1&r||2&r)){var f=n.dateTime(p);s=n.between(o,h,f)}else a===t.slicerMode.after&&1&r?s=n.compare(2,o,h):a===t.slicerMode.before&&2&r&&(s=n.compare(4,o,g));return null!==s&&(c=e.data.SemanticFilter.fromSQExpr(s)),c},a.createPersistProperties=function(e,i,r){var n=null==e.mode?c:e.mode,o=a.createFilter(e,n,r,i),s={replace:[{objectName:"data",selector:void 0,properties:{}},{objectName:"general",selector:void 0,properties:{}}],remove:[{objectName:"data",selector:void 0,properties:{}}]};return null!==o&&(s.replace[1].properties[t.slicerProps.general.filter.propertyName]=o),1&r&&null!==e.startDate?s.replace[0].properties[t.slicerProps.data.startDate.propertyName]=e.startDate:null==e.startDate&&(s.remove[0].properties[t.slicerProps.data.startDate.propertyName]=!0),2&r&&null!==e.endDate?s.replace[0].properties[t.slicerProps.data.endDate.propertyName]=e.endDate:null==e.endDate&&(s.remove[0].properties[t.slicerProps.data.endDate.propertyName]=!0),null!=e.mode&&(s.replace[0].properties[t.slicerProps.data.mode.propertyName]=e.mode),s},a.getChangeType=function(e,i){var a=null;switch(e){case t.slicerMode.after:a=0;break;case t.slicerMode.before:a=1;break;default:a=0===i?0:1}return a},a.prototype.requireToUpdate=function(e){return(null!==this.data.properties.filter||0!==this.data.state||e.mode!==this.data.properties.mode&&(e.mode!==c||null!==this.data.properties.mode))&&!(null!=this.data.properties.filter&&t.DateUtil.isEqual(e.startDate,this.data.properties.startDate)&&t.DateUtil.isEqual(e.endDate,this.data.properties.endDate)&&e.mode===this.data.properties.mode&&t.DateUtil.isEqual(e.filter.min,this.data.properties.filter.min)&&t.DateUtil.isEqual(e.filter.max,this.data.properties.filter.max)&&t.DateUtil.isEqual(e.bounds.min,this.data.properties.bounds.min)&&t.DateUtil.isEqual(e.bounds.max,this.data.properties.bounds.max))},a})();t.DateSlicer=v})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.PixelConverter,n=10,o=(function(){function a(e,t){var i=this;this.verticalSlicerRenderer=e,this.popup=$("<div />").addClass("slicer-dropdown-popup"),this.content=$("<div />").addClass("slicer-dropdown-content"),this.hostServices=t.hostServices,this.popup.addClass("visual"),$("body").append(this.popup),this.popup.append(this.content),this.requireUpdate=!0,this.isHidden=!0,$(window).resize((function(){i.popup&&(i.popup.hide(),i.isHidden=!0,i.unbindHide())}))}return a.prototype.onClear=function(){this.verticalSlicerRenderer.onClear()},a.prototype.onModeChange=function(e){this.popup.remove(),this.verticalSlicerRenderer.onModeChange(e)},a.prototype.enumerateObjectInstances=function(e){return this.verticalSlicerRenderer.enumerateObjectInstances(e)},a.prototype.init=function(e,t){return this.container=t,this.interactivityService=this.verticalSlicerRenderer.init(e,this.content),this.interactivityService},a.prototype.onDestroy=function(){this.popup.remove()},a.prototype.render=function(e){this.options=e,this.requireUpdate=!0,this.renderMenu(),this.popup.is(":hidden")||this.showPopup()},a.prototype.renderMenu=function(){var a=this;this.menu||(this.menu=r.DomFactory.div(),this.menu.addClass("slicer-dropdown-menu"),this.container.append(this.menu),this.menu.click((function(e){a.onRenderMenuClick(e)}))),this.menu.empty();var n=r.DomFactory.div();if(n.addClass("slicer-restatement"),this.menu.append(n),this.settings=this.defaultRestatementSetting(),this.options.dataView.metadata&&this.options.dataView.metadata.objects){var o=this.options.dataView.metadata.objects;this.settings.selectAllEnabled=e.DataViewObjects.getValue(o,t.slicerProps.selection.selectAllCheckboxEnabled,this.settings.selectAllEnabled),this.settings.background=e.DataViewObjects.getFillColor(o,t.slicerProps.items.background,this.settings.background),this.settings.fontColor=e.DataViewObjects.getFillColor(o,t.slicerProps.items.fontColor,this.settings.fontColor),this.settings.textSize=e.DataViewObjects.getValue(o,t.slicerProps.items.textSize,this.settings.textSize)}n.text(this.getRestatementText()),this.menu.css({"background-color":this.settings.background,color:this.settings.fontColor,"font-size":i.fromPointToPixel(this.settings.textSize)}),this.icon=$("<i />").addClass("dropdown-chevron"),this.icon.addClass("powervisuals-glyph"),this.icon.addClass("chevron-down"),this.icon.appendTo(this.menu)},a.prototype.onRenderMenuClick=function(e){return e.stopPropagation(),this.popup.is(":hidden")?(this.bindHide(),this.showPopup(),void(this.isHidden=!1)):(this.popup.hide(),this.icon.removeClass("chevron-up"),this.icon.addClass("chevron-down"),this.isHidden=!0,void this.unbindHide())},a.prototype.showPopup=function(){var e=this;window.requestAnimationFrame((function(){var i=e.menu.width()+n;e.popup.css({width:i}),e.icon.removeClass("chevron-down"),e.icon.addClass("chevron-up"),t.SlicerUtil.fixWidgetPosition(e.popup,e.menu,null,!0),e.requireUpdate&&(e.verticalSlicerRenderer.renderVerticalSlicer(e.data,e.options),e.requireUpdate=!1),e.popup.show()}))},a.prototype.onClick=function(e){var t=$(e.target);t.parents(".slicer-dropdown-popup").length||t.is(".slicer-dropdown-menu")||t.parents(".slicer-dropdown-menu").length||this.popup&&(this.popup.hide(),this.icon.removeClass("chevron-up"),this.icon.addClass("chevron-down"),this.isHidden=!0,this.unbindHide())},a.prototype.defaultRestatementSetting=function(){return{textSize:10,fontColor:"#000000",background:null,selectAllEnabled:!1}},a.prototype.bindHide=function(){$(document).bind("mousedown",$.proxy(this.onClick,this)),$(document).bind("touchstart",$.proxy(this.onClick,this))},a.prototype.unbindHide=function(){$(document).unbind("mousedown",this.onClick),$(document).unbind("touchstart",this.onClick)},a.prototype.getRestatementText=function(){this.data=this.verticalSlicerRenderer.converter(this.options.dataView);var e=_.countBy(this.data.slicerDataPoints,(function(e){return e.selected?"selected":"unselected"}));if(this.settings.selectAllEnabled){var t=this.data.slicerDataPoints[0].selected;if(t)return this.hostServices.getLocalizedString("Slicer_Restatement_All");var i=e.unselected-1;return e.selected&&0!==i?1!==e.selected||this.interactivityService.isSelectionModeInverted()?this.interactivityService.isSelectionModeInverted()&&1===i?_.findLast(this.data.slicerDataPoints,(function(e){return!e.selected})).value:this.hostServices.getLocalizedString("Slicer_Restatement_Multiple"):_.find(this.data.slicerDataPoints,(function(e){return e.selected})).value:this.hostServices.getLocalizedString("Slicer_Restatement_All")}return e.selected&&e.unselected?1===e.selected?_.find(this.data.slicerDataPoints,(function(e){return e.selected})).value:this.hostServices.getLocalizedString("Slicer_Restatement_Multiple"):this.hostServices.getLocalizedString("Slicer_Restatement_All")},a})();t.DropdownSlicerRenderer=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoMapLocation"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoMapLocationMessage",i="NoMapLocationKey",a="NoMapLocationValue",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e})();e.NoMapLocationWarning=t;var i=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NoValidGeotaggedCategory"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoValidGeotaggedCategoryMessage",i="NoValidGeotaggedCategoryKey",a="NoValidGeotaggedCategoryValue",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e})();e.FilledMapWithoutValidGeotagCategoryWarning=i;var a=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"GeometryCulledWarning"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="GeometryCulledWarningMessage",i="GeometryCulledWarningKey",a="GeometryCulledWarningVal",r={message:e.get(t),title:e.get(i),detail:e.get(a)};return r},e})();e.GeometryCulledWarning=a;var r=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NegativeValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_NegativeValues",i={message:e.get(t),title:"",detail:""};return i},e})();e.NegativeValuesNotSupportedWarning=r;var n=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"AllNegativeValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_AllNegativeValues",i={message:e.get(t),title:"",detail:""};return i},e})();e.AllNegativeValuesWarning=n;var o=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"NaNNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_NanValues",i={message:e.get(t),title:"",detail:""};return i},e})();e.NaNNotSupportedWarning=o;var s=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"InfinityValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_InfinityValues",i={message:e.get(t),title:"",detail:""};return i},e})();e.InfinityValuesNotSupportedWarning=s;var l=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ValuesOutOfRange"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_VisualizationOutOfRange",i={message:e.get(t),title:"",detail:""};return i},e})();e.ValuesOutOfRangeWarning=l;var u=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ZeroValuesNotSupported"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_ZeroValues",i={message:e.get(t),title:"",detail:""};return i},e})();e.ZeroValueWarning=u;var c=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"VisualKPIDataMissing"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="Visual_KPI_DataMissing",i={message:e.get(t),title:"",detail:""};return i},e})();e.VisualKPIDataMissingWarning=c;var d=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"ScriptVisualNotRefreshed"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="ScriptVisualRefreshWarningMessage",i="ScriptVisualRefreshWarningValue",a={message:e.get(t),title:e.get(t),detail:e.get(i)};return a},e})();e.ScriptVisualRefreshWarning=d;var p=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"DateSlicerNoData"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="VisualWarning_DateSlicerNoData",i={message:e.get(t),title:"",detail:""};return i},e})();e.DateSlicerNoDataWarning=p;var h=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"DataLabelsNotRendered"},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="DataLabelsNotRenderedMessage",i="DataLabelsNotRenderedValue",a={message:e.get(t),title:e.get(t),detail:e.get(i)};return a},e})();e.DataLabelsNotRenderedWarning=h;var g=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return e.code},enumerable:!0,configurable:!0}),e.prototype.getMessages=function(e){var t="NoIdentityExprMessage",i="NoIdentityExprValue",a={message:e.get(t),title:e.get(t),detail:e.get(i)};return a},e.code="NoIdentityExprWarning",e})();e.NoIdentityExprWarning=g;var f=(function(){function e(){}return e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.warnings||(this.warnings=[]),(i=this.warnings).push.apply(i,e),this;var i},e.prototype.addForVisualObject=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.visualObjectWarnings||(this.visualObjectWarnings={});var a=this.visualObjectWarnings[e]=this.visualObjectWarnings[e]||[];return a.push.apply(a,t),this},e.prototype.complete=function(){if(!_.isEmpty(this.warnings)||null!=this.visualObjectWarnings)return{warnings:this.warnings,visualObjectWarnings:this.visualObjectWarnings}},e})();e.VisualWarningBuilder=f})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=t.labelPosition,r=a.PixelConverter,n=a.CssConstants.createClassAndSelector,o=(function(){function a(e){this.isScrollable=e.isScrollable,this.tooltipsEnabled=e.tooltipsEnabled,this.interactivityService=e.interactivityService,this.columnLabelImprovements=e.columnLabelImprovements}return a.prototype.init=function(e){this.svg=e.svg,this.svg.classed(a.WaterfallClassName,!0),this.style=e.style,this.currentViewport=e.viewport,this.hostServices=e.host,this.interactivity=e.interactivity,this.cartesianVisualHost=e.cartesianHost,this.options=e,this.element=e.element,this.tooltipService=e.services.tooltips,this.colors=this.style.colorPalette.dataColors,this.mainGraphicsSVG=this.svg.append("svg"),this.mainGraphicsContext=this.mainGraphicsSVG.append("g").classed(a.MainGraphicsContextClassName,!0),this.labelGraphicsContext=this.mainGraphicsSVG.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass.class,!0)},a.converter=function(i,r,n,o,s,l,u){void 0===u&&(u=!0);var c,d,p,h,g=e.data.createIDataViewCategoricalReader(i),f=a.formatStringProp,m=i.categorical.categories||[],y=s.increaseFill.solid.color,v=s.decreaseFill.solid.color,w=s.totalFill.solid.color,b=n.getLocalizedString(a.TotalLabel),C=n.getLocalizedString(a.IncreaseLabel),S=n.getLocalizedString(a.DecreaseLabel),x=[{label:C,color:y,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("increase").createSelectionId(),selected:!1},{label:S,color:v,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("decrease").createSelectionId(),selected:!1},{label:b,color:w,icon:t.LegendIcon.Box,identity:t.SelectionIdBuilder.builder().withMeasure("total").createSelectionId(),selected:!1}],P=0,D=0,T=0,V=[],L=[],M=void 0;if(g.hasValues("Tooltips")&&(h=g.getAllValueMetadataColumnsForRole("Tooltips",void 0)),g.hasValues("Y")){M=g.getValueMetadataColumn("Y");var N=M.format;if(_.isEmpty(m))P=T=g.getValue("Y",0),D=0;else{var I=m[0];c=I.source,L=I.values.slice(),L.push(b),g.hasValues("Tooltips")&&(p=g.getSeriesCount("Tooltips"),d=_.map(new Array(p),(function(){return 0})));for(var A=0,O=g.getCategoryCount();A<O;A++){var R=L[A],E=g.getValue("Y",A)||0,F=t.SelectionIdBuilder.builder().withCategory(I,A).withMeasure(M.queryName).createSelectionId(),j=void 0;if(u){j=[],j.push({displayName:c.displayName,value:t.converterHelper.formatFromMetadataColumn(R,c,f)}),null!=E&&j.push({displayName:M.displayName,value:t.converterHelper.formatFromMetadataColumn(E,M,f)});var H=g.getAllValuesForRole("Tooltips",A);if(H&&h){for(var G=0;G<H.length;G++)d[G]+=H[G];for(var k=0;k<H.length;k++)null!=H[k]&&h[k]&&j.push({displayName:h[k].displayName,value:t.converterHelper.formatFromMetadataColumn(H[k],h[k],f)})}}var z=E>0?y:v;V.push({value:E,position:P,color:z,categoryValue:R,categoryIndex:A,seriesIndex:0,selected:!1,identity:F,highlight:!1,key:F.getKey(),tooltipInfo:j,labelFill:o.labelColor,labelFormatString:N}),P+=E,P>T&&(T=P),P<D&&(D=P)}}var U=void 0;if(u){U=[],c&&U.push({displayName:c.displayName,value:b}),null!=P&&U.push({displayName:M.displayName,value:t.converterHelper.formatFromMetadataColumn(P,M,f)});var H=g.getAllValuesForRole("Tooltips",0,void 0);if(d=d?d:H,H&&h)for(var k=0;k<d.length;k++)null!=d[k]&&U.push({displayName:h[k].displayName,value:t.converterHelper.formatFromMetadataColumn(d[k],h[k],f)})}var B=t.SelectionId.createNull();V.push({value:P,position:0,color:w,categoryValue:b,categoryIndex:A,identity:B,seriesIndex:0,selected:!1,highlight:!1,key:B.getKey(),tooltipInfo:U,labelFill:o.labelColor,labelFormatString:N,isTotal:!0})}l&&l.applySelectionStateToData(V);var W=t.CartesianHelper.getCategoryAxisProperties(i.metadata),q=t.CartesianHelper.getValueAxisProperties(i.metadata),K=t.converterHelper.createAxesLabels(W,q,c,[M]);return{series:[{data:V}],categories:L,categoryMetadata:c,valuesMetadata:M,legend:{dataPoints:x},hasHighlights:!1,positionMin:D,positionMax:T,dataLabelsSettings:o,sentimentColors:s,axesLabels:{x:K.xAxisLabel,y:K.yAxisLabel}}},a.prototype.setData=function(e){var i=this.getSentimentColorsFromObjects(null),r=e.length>0?e[0]:void 0;if(this.data={series:[{data:[]}],categories:[],valuesMetadata:null,legend:{dataPoints:[]},hasHighlights:!1,categoryMetadata:null,scalarCategoryAxis:!1,positionMax:0,positionMin:0,dataLabelsSettings:t.dataLabelUtils.getDefaultWaterfallLabelSettings(!1,void 0),sentimentColors:i,axesLabels:{x:null,y:null}},r){if(r.metadata&&r.metadata.objects){var n=r.metadata.objects,o=n.labels;o&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(o,this.data.dataLabelsSettings,!0),i=this.getSentimentColorsFromObjects(n)}r.categorical&&(this.data=a.converter(r,this.colors,this.hostServices,this.data.dataLabelsSettings,i,this.interactivityService,this.tooltipsEnabled))}},a.prototype.enumerateObjectInstances=function(e,i){switch(i.objectName){case"sentimentColors":this.enumerateSentimentColors(e);break;case"labels":var r={enumeration:e,dataLabelsSettings:this.data.dataLabelsSettings,positionObject:a.validLabelPositionsOptions,show:!0,displayUnits:!0,precision:!0,fontSize:!0,labelOrientation:this.columnLabelImprovements,position:this.columnLabelImprovements};t.dataLabelUtils.enumerateDataLabels(r)}},a.prototype.enumerateSentimentColors=function(e){var t=this.data.sentimentColors;e.pushInstance({selector:null,properties:{increaseFill:t.increaseFill,decreaseFill:t.decreaseFill,totalFill:t.totalFill},objectName:"sentimentColors"})},a.prototype.calculateLegend=function(){return this.data.legend},a.prototype.hasLegend=function(){return!0},a.createClippedDataIfOverflowed=function(t,i){var a=t,r=t.series[0].data;return t&&i<r.length&&(a=e.Prototype.inherit(t),a.series=[{data:r.slice(0,i)}],a.categories=t.categories.slice(0,i)),a},a.prototype.calculateAxesProperties=function(e){var i=this;this.currentViewport=e.viewport,this.margin=e.margin;var r=this.clippedData=this.data,n=r.categories.length,o=this.getPreferredPlotArea(!1,n,t.CartesianChart.MinOrdinalRectThickness),s=t.CartesianChart.getLayout(null,{availableWidth:o.width,categoryCount:n,domain:null,isScalar:!1,isScrollable:this.isScrollable,trimOrdinalDataOnOverflow:e.trimOrdinalDataOnOverflow});this.isScrollable||(r=this.clippedData=a.createClippedDataIfOverflowed(r,s.categoryCount));var l=a.getXAxisCreationOptions(r,o.width,s,e,this.margin),u=a.getYAxisCreationOptions(r,o.height,e,this.margin),c=this.xAxisProperties=t.AxisHelper.createAxis(l),d=this.yAxisProperties=t.AxisHelper.createAxis(u),p=this.xAxisProperties.categoryThickness*(1-t.CartesianChart.InnerPaddingRatio),h=t.dataLabelUtils.createColumnFormatterCacheManager(),g=r.dataLabelsSettings,f=t.NewDataLabelUtils.getLabelUnitAndPrecisionForAxis(d,g);return this.layout={categoryCount:s.categoryCount,categoryThickness:s.categoryThickness,isScalar:s.isScalar,outerPaddingRatio:s.outerPaddingRatio,categoryWidth:p,labelText:function(e){var i=h.getOrCreate(e.labelFormatString,g,f.units,f.precision);return t.dataLabelUtils.getLabelFormattedText({label:i.format(e.value)})},labelLayout:t.dataLabelUtils.getLabelLayoutXYForWaterfall(c,p,d,u.dataDomain),filter:function(e){return t.dataLabelUtils.doesDataLabelFitInShape(e,d,i.layout)},style:{fill:function(e){return e.isLabelInside?t.dataLabelUtils.defaultInsideLabelColor:e.labelFill}}},this.xAxisProperties.axisLabel=e.showCategoryAxisLabel?r.axesLabels.x:null,this.yAxisProperties.axisLabel=e.showValueAxisLabel?r.axesLabels.y:null,[c,d]},a.lookupXValue=function(e,i,a){var r=e.series[0].data;return i===r.length-1?r[i].categoryValue:t.CartesianHelper.lookupXValue(e,i,a,!1)},a.getXAxisCreationOptions=function(e,i,r,n,o){var s=t.AxisHelper.getCategoryValueType(e.categoryMetadata),l=t.AxisHelper.createDomain(e.series,s,!1,n.forcedXDomain,n.ensureXDomain),u=r.categoryThickness,c=u*r.outerPaddingRatio;return{pixelSpan:i,dataDomain:l,metaDataColumn:e.categoryMetadata,formatString:t.valueFormatter.getFormatString(e.categoryMetadata,a.formatStringProp),isScalar:!1,outerPadding:c,categoryThickness:u,getValueFn:function(t,i){return a.lookupXValue(e,t,i)},forcedTickCount:n.forcedTickCount,isCategoryAxis:!0,axisDisplayUnits:n.categoryAxisDisplayUnits,axisPrecision:n.categoryAxisPrecision,margin:o}},a.getYAxisCreationOptions=function(e,i,r,n){var o=t.AxisHelper.combineDomain(r.forcedYDomain,[e.positionMin,e.positionMax],r.ensureYDomain);return{pixelSpan:i,dataDomain:o,zeroScalarDomain:[0,1],isScalar:!0,isVertical:!0,metaDataColumn:e.valuesMetadata,formatString:t.valueFormatter.getFormatString(e.valuesMetadata,a.formatStringProp),outerPadding:0,forcedTickCount:r.forcedTickCount,useTickIntervalForDisplayUnits:!0,isCategoryAxis:!1,axisDisplayUnits:r.valueAxisDisplayUnits,axisPrecision:r.valueAxisPrecision,margin:n}},a.prototype.getPreferredPlotArea=function(e,i,a){return t.CartesianChart.getPreferredPlotArea(i,a,this.currentViewport,this.isScrollable,e,this.margin)},a.prototype.getVisualCategoryAxisIsScalar=function(){return!1},a.prototype.overrideXScale=function(e){this.xAxisProperties=e},a.prototype.setFilteredData=function(t,i){var a=this.clippedData=e.Prototype.inherit(this.data);return a.series=[{data:a.series[0].data.slice(t,i)}],a.categories=a.categories.slice(t,i),a},a.prototype.createRects=function(e){var t=this.mainGraphicsContext,i=t.selectAll(a.CategoryValueClasses.selector),r=i.data(e,(function(e){return e.key}));return r.enter().append("rect").attr("class",(function(e){return a.CategoryValueClasses.class.concat(e.highlight?"highlight":"")})),r.exit().remove(),r},a.prototype.createConnectors=function(e){var t=this.mainGraphicsContext,i=t.selectAll(a.WaterfallConnectorClasses.selector),r=i.data(e.slice(0,e.length-1),(function(e){return e.key}));return r.enter().append("line").classed(a.WaterfallConnectorClasses.class,!0),r.exit().remove(),r},a.prototype.render=function(e){var i=this,r=this.clippedData.series[0].data,n=this.createRects(r),o=this.createConnectors(r);this.tooltipsEnabled&&this.tooltipService.addTooltip(n,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}));var s=this.interactivityService&&this.interactivityService.hasSelection(),l=this.xAxisProperties.scale,u=this.yAxisProperties.scale,c=u(0);this.mainGraphicsSVG.attr("height",this.getAvailableHeight()).attr("width",this.getAvailableWidth()),n.style("fill",(function(e){return e.color})).style("fill-opacity",(function(e){return e.isTotal?t.ColumnUtil.DefaultOpacity:t.ColumnUtil.getFillOpacity(e.selected,e.highlight,s,i.data.hasHighlights)})).attr("width",this.layout.categoryWidth).attr("x",(function(e){return l(e.categoryIndex)})).attr("y",(function(e){return a.getRectTop(u,e.position,e.value)})).attr("height",(function(e){return c-u(Math.abs(e.value))})),o.attr({x1:function(e){return l(e.categoryIndex)},y1:function(e){return u(e.position+e.value)},x2:function(e){return l(e.categoryIndex+1)+i.layout.categoryWidth},y2:function(e){return u(e.position+e.value)}});var d=this.data.dataLabelsSettings,p=[];(d&&d.show||d.showCategory)&&(p=this.createLabelDataPoints());var h=void 0;return this.interactivityService&&(h={bars:n}),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),{dataPoints:this.data.series[0].data,behaviorOptions:h,labelDataPoints:p,labelsAreNumeric:!0,labelOrientation:d.labelOrientation}},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.prototype.getSupportedCategoryAxisType=function(){return t.axisType.categorical},a.getRectTop=function(e,t,i){return i<0?e(t):e(t)-(e(0)-e(i))},a.prototype.getAvailableWidth=function(){return this.currentViewport.width-(this.margin.left+this.margin.right)},a.prototype.getAvailableHeight=function(){return this.currentViewport.height-(this.margin.top+this.margin.bottom)},a.prototype.getSentimentColorsFromObjects=function(i){var r=this.colors.getSentimentColors(),n=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.increaseFill,r[2].value),o=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.decreaseFill,r[0].value),s=e.DataViewObjects.getFillColor(i,t.waterfallChartProps.sentimentColors.totalFill,a.defaultTotalColor);return{increaseFill:{solid:{color:n}},decreaseFill:{solid:{color:o}},totalFill:{solid:{color:s}}}},a.prototype.createLabelDataPoints=function(){for(var i=[],n=this.data,o=this.xAxisProperties.scale,s=this.yAxisProperties.scale,l=s(0),u=n.series,c=t.NewDataLabelUtils.createColumnFormatterCacheManager(),d=n.dataLabelsSettings,p=t.NewDataLabelUtils.getLabelUnitAndPrecisionForAxis(this.yAxisProperties,d),h=0,g=u;h<g.length;h++)for(var f=g[h],m=0,y=f.data;m<y.length;m++){var v=y[m],w={left:o(v.categoryIndex),top:a.getRectTop(s,v.position,v.value),width:this.layout.categoryWidth,height:l-s(Math.abs(v.value))},b=v.labelFormatString,C=c.getOrCreate(b,this.data.dataLabelsSettings,p.units,p.precision),S=t.NewDataLabelUtils.getLabelFormattedText(C.format(v.value)),x={text:S,fontFamily:t.NewDataLabelUtils.LabelTextProperties.fontFamily,fontSize:r.fromPoint(d.fontSize||t.NewDataLabelUtils.DefaultLabelFontSizeInPt),fontWeight:t.NewDataLabelUtils.LabelTextProperties.fontWeight},P=e.TextMeasurementService.measureSvgTextWidth(x),D=e.TextMeasurementService.estimateSvgTextHeight(x,!0),T=this.getValidPositions(d.position,v.value);i.push({isPreferred:!0,text:S,textSize:{width:P,height:D},outsideFill:d.labelColor?d.labelColor:t.NewDataLabelUtils.defaultLabelColor,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:1,
parentShape:{rect:w,orientation:v.value>=0?1:2,validPositions:T},fontSize:d.fontSize,identity:void 0})}return i},a.prototype.getValidPositions=function(e,i){if(0===i)return a.validZeroLabelPosition;switch(e){case t.labelPosition.insideEnd:return[4];case t.labelPosition.insideCenter:return[1];case t.labelPosition.insideBase:return[2];case t.labelPosition.outsideEnd:return[16];default:return a.validLabelPositionsAuto}},a.formatStringProp={objectName:"general",propertyName:"formatString"},a.WaterfallClassName="waterfallChart",a.MainGraphicsContextClassName="mainGraphicsContext",a.IncreaseLabel="Waterfall_IncreaseLabel",a.DecreaseLabel="Waterfall_DecreaseLabel",a.TotalLabel="Waterfall_TotalLabel",a.CategoryValueClasses=n("column"),a.WaterfallConnectorClasses=n("waterfall-connector"),a.AutoLabelPosition="Auto",a.defaultTotalColor="#00b8aa",a.validLabelPositionsOptions=[a.AutoLabelPosition,i.outsideEnd,i.insideEnd,i.insideCenter,i.insideBase],a.validLabelPositionsAuto=[16,4,1,2],a.validZeroLabelPosition=[16,8],a})();t.WaterfallChart=o})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.visuals.controls.TouchUtils,r=a.CssConstants.createClassAndSelector,n=r("tooltip-container"),o=r("tooltip-content-container"),s=r("arrow"),l=r("tooltip-header"),u=r("tooltip-row"),c=r("tooltip-color-cell"),d=r("tooltip-title-cell"),p=r("tooltip-value-cell"),h=(function(){function e(e,t){this.isTooltipVisible=!1,this.options=t,this.rootElement=e}return e.prototype.isVisible=function(){return this.isTooltipVisible},e.prototype.setTestScreenSize=function(e,t){this.customScreenWidth=e,this.customScreenHeight=t},e.prototype.show=function(e,t){this.isTooltipVisible=!0,this.tooltipContainer||(this.tooltipContainer=this.createTooltipContainer(this.rootElement)),e&&this.setTooltipContent(e),this.tooltipContainer.style("display","").transition().duration(0).style("opacity",this.options.opacity),t&&this.setPosition(t)},e.prototype.move=function(e,t){this.tooltipContainer||(this.tooltipContainer=this.createTooltipContainer(this.rootElement)),e&&this.setTooltipContent(e),this.setPosition(t)},e.prototype.hide=function(){this.isTooltipVisible&&(this.isTooltipVisible=!1,this.tooltipContainer.transition().duration(this.options.animationDuration).style("opacity",0).each("end",(function(){this.style.display="none"})))},e.prototype.createTooltipContainer=function(e){var t=d3.select(e).append("div").attr("class",n.class);return t.append("div").attr("class",s.class),t.append("div").attr("class",o.class),t.style("display","none"),t},e.prototype.setTooltipContent=function(e){if(!_.isEqual(e,this.currentContent)){this.currentContent=e;var t=u.selector,i=this.tooltipContainer.select(o.selector);if(i.selectAll(l.selector).remove(),i.selectAll(u.selector).remove(),0!==e.length){e[0].header&&i.append("div").attr("class",l.class).text(e[0].header);var a=i.selectAll(t).data(e),r=a.enter().append("div").attr("class",u.class);if(_.any(e,(function(e){return e.color}))){var n=r.filter((function(e){return e.color})).append("div").attr("class",c.class);n.append("svg").attr({width:"100%",height:"15px"}).append("circle").attr({cx:"5",cy:"8",r:"5"}).style({fill:function(e){return e.color},"fill-opacity":function(e){return null!=e.opacity?e.opacity:1}})}var s=r.append("div").attr("class",d.class),h=r.append("div").attr("class",p.class);s.text((function(e){return e.displayName})),h.text((function(e){return e.value}))}}},e.prototype.getTooltipContainerBounds=function(){var e;return"none"===this.tooltipContainer.style("display")?(this.tooltipContainer.style("display",""),e=this.tooltipContainer.node().getBoundingClientRect(),this.tooltipContainer.style("display","none")):e=this.tooltipContainer.node().getBoundingClientRect(),e},e.prototype.getTooltipPosition=function(e,t){var a=this.getTooltipContainerBounds(),r=Math.floor(e.width/2),n=0,o=0,s=new i.Point(e.left+r,e.top+r),l=7;return 0===t?(n+=3*l+r,o-=2*l+r):1===t?(n-=2*l+a.width+r,o-=2*l+r):3===t?(n+=3*l+r,o-=a.height-2*l+r):2===t&&(n-=2*l+a.width+r,o-=a.height-2*l+r),s.offset(n,o),s},e.prototype.setPosition=function(e){var t=this.getClickedScreenArea(e),i=this.getTooltipPosition(e,t);this.setTooltipContainerClass(t),this.tooltipContainer.style({left:i.x+"px",top:i.y+"px"}),this.setArrowPosition(t)},e.prototype.setTooltipContainerClass=function(e){var t;switch(e){case 0:case 3:t="left";break;case 1:case 2:t="right"}this.tooltipContainer.attr("class",n.class).classed(t,!0)},e.prototype.setArrowPosition=function(e){var t,i=this.getArrowElement();t=0===e?"top left":1===e?"top right":3===e?"bottom left":"bottom right",i.attr("class","arrow").classed(t,!0)},e.prototype.getArrowElement=function(){return this.tooltipContainer.select(s.selector)},e.prototype.getClickedScreenArea=function(e){var t=this.customScreenWidth||window.innerWidth,a=this.customScreenHeight||window.innerHeight,r=e.width/2,n=new i.Point(e.left+r,e.top+r),o=t/2,s=a/2;return n.x<o&&n.y<s?0:n.x>=o&&n.y<s?1:n.x<o&&n.y>=s?3:n.x>=o&&n.y>=s?2:void 0},e})();t.TooltipContainer=h;var g=(function(){function e(t){this.tooltipOptions=t,t||(this.tooltipOptions=e.DefaultTooltipOptions)}return e.prototype.isTooltipComponentVisible=function(){return this.tooltipContainer&&this.tooltipContainer.isVisible()},e.prototype.show=function(e,t){this.ensureTooltipContainer(),this.tooltipContainer.show(e,this.convertRect(t))},e.prototype.move=function(e,t){this.ensureTooltipContainer(),this.tooltipContainer.move(e,this.convertRect(t))},e.prototype.hide=function(){this.ensureTooltipContainer(),this.tooltipContainer.hide()},e.prototype.convertRect=function(e){return new t.Rect(e.x,e.y,e.width,e.height)},e.prototype.ensureTooltipContainer=function(){if(!this.tooltipContainer){var t=$(e.parentContainerSelector).get(0);this.tooltipContainer=new h(t,this.tooltipOptions)}},e.DefaultTooltipOptions={opacity:1,animationDuration:250,offsetX:10,offsetY:10},e.parentContainerSelector="body",e.highlightedValueDisplayNameResorceKey="Tooltip_HighlightedValueDisplayName",e})();t.ToolTipComponent=g;var f;!(function(e){function a(i,a,o,s){if(e.ShowTooltips){var m=d3.select(g.parentContainerSelector).node();i.on("mouseover.tooltip",(function(){var i=d3.event.target,n=d3.select(i).datum();if(!C&&d(d3.event)){w=t.getCoordinates(m,!0);var o=t.getCoordinates(i,!0),s={data:n,coordinates:w,elementCoordinates:o,context:i,isTouchEvent:!1};c();var l=e.ToolTipInstance.isTooltipComponentVisible()?16:e.tooltipMouseOverDelay;v=r(s,a,l)}})),i.on("mouseout.tooltip",(function(){C||(c(),v=n()),s&&s()})),i.on("mousemove.tooltip",(function(){var e=d3.event.target,i=d3.select(e).datum();if(!C&&d(d3.event)){w=t.getCoordinates(m,!0);var r=t.getCoordinates(e,!0),n={data:i,coordinates:w,elementCoordinates:r,context:e,isTouchEvent:!1};l(n,a,o)}}));var b=p(),S=h(),x="pointerdown"===b||"MSPointerDown"===b;y||(f(b),y=!0),i.on(b,(function(){var i=d3.event.target,n=d3.select(i).datum();u();var o=t.getCoordinates(m,x),s=t.getCoordinates(i,x),l={data:n,coordinates:o,elementCoordinates:s,context:i,isTouchEvent:!0};c(),v=r(l,a,e.tooltipTouchDelay)})),i.on(S,(function(){c(),C&&clearTimeout(C),C=setTimeout((function(){C=0}),e.handleTouchDelay)}))}}function r(e,t,i){return setTimeout((function(){return s(e,t)}),i)}function n(){return setTimeout((function(){return u()}),e.tooltipMouseOutDelay)}function o(e){g.localizationOptions=e}function s(t,i){var a=b||i(t);if(!_.isEmpty(a)){var r=w||t.coordinates,n=m(r[0],r[1],t.isTouchEvent);e.ToolTipInstance.show(a,n)}}function l(t,i,a){b=void 0,a&&(b=i(t));var r=m(t.coordinates[0],t.coordinates[1],t.isTouchEvent);e.ToolTipInstance.move(b,r)}function u(){e.ToolTipInstance.hide()}function c(){v&&clearTimeout(v)}function d(e){var t=!0,i=e;if(void 0!==i.buttons){var a=0!==i.buttons;t=!a}return t}function p(){var e="touchstart";return window.PointerEvent?e="pointerdown":window.MSPointerEvent&&(e="MSPointerDown"),e}function h(){var e="touchend";return window.PointerEvent?e="pointerup":window.MSPointerEvent&&(e="MSPointerUp"),e}function f(t){d3.select(g.parentContainerSelector).on(t,(function(t,i){e.ToolTipInstance.hide()}))}function m(e,t,a){var r=0,n=e,o=t;if(a){r=12;var s=r/2;n=Math.max(e-s,0),o=Math.max(t-s,0)}return new i.Rectangle(n,o,r,r)}var y=!1;e.ShowTooltips=!0,e.ToolTipInstance=new g,e.tooltipMouseOverDelay=350,e.tooltipMouseOutDelay=500,e.tooltipTouchDelay=350,e.handleTouchDelay=1e3;var v,w,b,C=0;e.addTooltip=a,e.setLocalizedStrings=o})(f=t.TooltipManager||(t.TooltipManager={}));var m;!(function(e){function i(e,t,i,n,o,s,l,u,c,d){var p,h=[],g=void 0;l=0|l;var f=t?t.categories:o;if(f&&f.length>0)if(f.length>1){for(var m=[],y=0,v=f.length;y<v;y++)m.push(f[y].source);p={value:i,metadata:m}}else p={value:i,metadata:[f[0].source]};if(t&&t.values){if(p&&p.metadata[0]===t.values.source||(g=t.values.source),t.values.length>0){var w=t.values[l],b=!!(w&&w.source&&w.source.isAutoGeneratedColumn);b||h.push({value:n,highlightedValue:c,metadata:w})}var C=a(d,u);null!=C&&h.push(C)}if(s)for(var y=0,S=s.length;y<S;y++){var x=s[y];p&&p.metadata[0]===x.metadata.source||h.push({value:x.value,metadata:x.metadata})}var P=r(e,p,g,h);return P}function a(e,t){return e?{value:e.values[t],metadata:{source:e.source,values:[]}}:null}function r(e,t,i,a){var r=[];if(t)if(t.metadata.length>1){for(var n="",s=0,l=t.metadata.length;s<l;s++)0!==s&&(n+="/"),n+=t.metadata[s].displayName;var u=o(t.metadata[0],e,t.value);r.push({displayName:n,value:u})}else{var u=o(t.metadata[0],e,t.value);r.push({displayName:t.metadata[0].displayName,value:u})}if(i){var c=void 0;if(a.length>0){var d=a[0].metadata.source;c=o(i,e,d.groupName)}r.push({displayName:i.displayName,value:c})}for(var s=0;s<a.length;s++){var p=a[s];if(p&&p.metadata){var h=p.metadata.source,f=p.value,m=p.highlightedValue;if(f||0===f){var y=o(h,e,f);r.push({displayName:h.displayName,value:y})}if(m||0===m){var v=o(h,e,m),n=g.localizationOptions.highlightedValueDisplayName;r.push({displayName:n,value:v})}}}return r}function n(e,i,a,r){var n=e.getAllValuesForRole("Tooltips",a,r),o=e.getAllValueMetadataColumnsForRole("Tooltips",r);if(n&&o)for(var s=0;s<n.length;s++)null!=n[s]&&o[s]&&i.push({displayName:o[s].displayName,value:t.converterHelper.formatFromMetadataColumn(n[s],o[s],t.GaugeConverter.formatStringProp)})}function o(e,i,a){var r=s(e,i);return t.valueFormatter.format(a,r)}function s(e,i){if(e){var a=t.valueFormatter.getFormatString(e,i,!0);return a||e.format}return null}e.createTooltipInfo=i,e.createGradientToolTipData=a,e.addTooltipMeasures=n})(m=t.TooltipBuilder||(t.TooltipBuilder={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t){return void 0===t&&(t=new e.DataColorPalette),{titleText:{color:{value:"#333"}},subTitleText:{color:{value:"#919191"}},colorPalette:{foreground:{value:"#333"},background:{value:"#fff"},tableAccent:{value:t.getColorByIndex(0).value},dataColors:t},labelText:{color:{value:"#333"},fontSize:"11px"},isHighContrast:!1}}t.create=i})(t=e.visualStyles||(e.visualStyles={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=a.CssConstants.createClassAndSelector,r=(function(){function a(e){e&&(this.sliceWidthRatio=e.sliceWidthRatio,this.animator=e.animator,this.isScrollable=!!e.isScrollable&&e.isScrollable,this.disableGeometricCulling=!!e.disableGeometricCulling&&e.disableGeometricCulling,this.behavior=e.behavior,this.tooltipsEnabled=e.tooltipsEnabled,e.smallViewPortProperties&&(this.maxHeightToScaleDonutLegend=e.smallViewPortProperties.maxHeightToScaleDonutLegend)),null==this.sliceWidthRatio&&(this.sliceWidthRatio=a.defaultSliceWidthRatio)}return a.converter=function(e,t,i,r,o,s,l){void 0===l&&(l=!0);var u=new n.DonutChartConverter(e,t,i,l);u.convert();var c=d3.layout.pie().sort(null).value((function(e){return e.percentage}));s&&(s.applySelectionStateToData(u.dataPoints),s.applySelectionStateToData(u.legendData.dataPoints));var d=!o&&r?a.cullDataByViewport(u.dataPoints,u.maxValue,r):u.dataPoints;return{dataPointsToDeprecate:d,dataPoints:c(d),unCulledDataPoints:u.dataPoints,dataPointsToEnumerate:u.legendData.dataPoints,legendData:u.legendData,hasHighlights:u.hasHighlights,highlightsOverflow:u.highlightsOverflow,dataLabelsSettings:u.dataLabelsSettings,legendObjectProperties:u.legendObjectProperties,maxValue:u.maxValue,visibleGeometryCulled:u.dataPoints.length!==d.length,hasNegativeValues:u.hasNegativeValues,allValuesAreNegative:u.allValuesAreNegative}},a.prototype.init=function(e){this.options=e;var i=e.element;i.empty(),this.parentViewport=e.viewport,this.currentViewport={height:e.viewport.height,width:e.viewport.width},this.formatter=t.valueFormatter.format,this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[],fontSize:t.SVGLegend.DefaultFontSizeInPt},hasHighlights:!1,highlightsOverflow:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings(),hasNegativeValues:!1,allValuesAreNegative:!1},this.drilled=!1,this.allowDrilldown=!1,this.style=e.style,this.colors=this.style.colorPalette.dataColors,this.radius=0,this.isInteractive=e.interactivity&&e.interactivity.isInteractiveLegend;var r=this.settings;if(this.behavior&&(this.interactivityService=t.createInteractivityService(e.host)),this.legend=t.createLegend(i,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable),this.hostService=e.host,this.tooltipService=t.createTooltipService(e.host),this.isInteractive){this.chartRotationAnimationDuration=r&&r.chartRotationAnimationDuration?r.chartRotationAnimationDuration:0;var n=this.legendContainer=d3.select(i.get(0)).append("div").classed(a.InteractiveLegendClassName,!0);this.interactivityState={interactiveLegend:new o(this,n,this.colors,e,this.settings),valueToAngleFactor:0,sliceAngles:[],currentRotate:0,interactiveChosenSliceFinishedSetting:!1,lastChosenInteractiveSliceIndex:0,totalDragAngleDifference:0,currentIndexDrag:0,previousIndexDrag:0,previousDragAngle:0,donutCenter:{x:0,y:0}}}this.svg=d3.select(i.get(0)).append("svg").style("position","absolute").classed(a.ClassName,!0),this.behavior&&(this.clearCatcher=t.appendClearCatcher(this.svg)),this.mainGraphicsContext=this.svg.append("g"),this.mainGraphicsContext.append("g").classed("slices",!0),this.labelGraphicsContext=this.svg.append("g").classed(t.NewDataLabelUtils.labelGraphicsContextClass.class,!0),this.pie=d3.layout.pie().sort(null).value((function(e){return e.percentage}))},a.prototype.update=function(i){var r=i.viewport;this.parentViewport=r;var n=this.dataViews=i.dataViews;if(n&&n.length>0&&n[0].categorical){var o=n[0].metadata,s=void 0;if(o){var l=o.objects;l&&(s=e.DataViewObjects.getFillColor(l,t.donutChartProps.dataPoint.defaultColor))}this.data=a.converter(n[0],this.colors,s,this.currentViewport,this.disableGeometricCulling,this.interactivityService,this.tooltipsEnabled),this.data.defaultDataPointColor=s,this.options.interactivity&&this.options.interactivity.isInteractiveLegend||this.renderLegend()}else this.data={dataPointsToDeprecate:[],dataPointsToEnumerate:[],dataPoints:[],unCulledDataPoints:[],legendData:{title:"",dataPoints:[]},hasHighlights:!1,highlightsOverflow:!1,dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings(),hasNegativeValues:!1,allValuesAreNegative:!1};if(this.initViewportDependantProperties(),this.initDonutProperties(),this.updateInternal(this.data,i.suppressAnimations),this.hasSetData=!0,n){var u=t.getInvalidValueWarnings(n,!1,!1,!1);this.data.allValuesAreNegative?u.push(new t.AllNegativeValuesWarning):this.data.hasNegativeValues&&u.push(new t.NegativeValuesNotSupportedWarning),this.hostService.setWarnings(u)}},a.prototype.onDataChanged=function(e){this.update({dataViews:e.dataViews,suppressAnimations:e.suppressAnimations,viewport:this.currentViewport})},a.prototype.onResizing=function(e){this.update({dataViews:this.dataViews,suppressAnimations:!0,viewport:e})},a.prototype.enumerateObjectInstances=function(e){var i=new t.ObjectEnumerationBuilder,a=this.data&&this.data.dataLabelsSettings?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultDonutLabelSettings();switch(e.objectName){case"legend":this.enumerateLegend(i);break;case"dataPoint":this.enumerateDataPoints(i);break;case"labels":var r={enumeration:i,dataLabelsSettings:a,show:!0,displayUnits:!0,precision:!0,fontSize:!0,labelStyle:!0};t.dataLabelUtils.enumerateDataLabels(r)}return i.complete()},a.prototype.enumerateDataPoints=function(e){var i=this.data;if(i)for(var a=i.dataPointsToEnumerate,r=a.length,n=0;n<r;n++){var o=a[n];e.pushInstance({objectName:"dataPoint",displayName:o.label,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}}})}},a.prototype.enumerateLegend=function(i){var a=this.data;if(a){var r={legend:a.legendObjectProperties},n=e.DataViewObjects.getValue(r,t.donutChartProps.legend.show,this.legend.isVisible()),o=e.DataViewObjects.getValue(r,t.donutChartProps.legend.showTitle,!0),s=e.DataViewObjects.getValue(r,t.donutChartProps.legend.titleText,this.data.legendData.title),l=e.DataViewObject.getValue(r,t.legendProps.labelColor,this.data.legendData.labelColor),u=e.DataViewObject.getValue(r,t.legendProps.fontSize,this.data.legendData.fontSize),c=e.DataViewObjects.getValue(r,t.donutChartProps.legend.position,t.legendPosition.top);i.pushInstance({selector:null,objectName:"legend",properties:{show:n,position:c,showTitle:o,titleText:s,labelColor:l,fontSize:u}})}},a.prototype.setInteractiveChosenSlice=function(e){var i=this;if(0!==this.interactivityState.sliceAngles.length){this.interactivityState.lastChosenInteractiveSliceIndex=e,this.interactivityState.interactiveChosenSliceFinishedSetting=!1;var a=this.currentViewport,r=e%this.data.dataPoints.length,n=this.interactivityState.sliceAngles[r];this.svg.select("g").transition().duration(this.chartRotationAnimationDuration).ease("elastic").attr("transform",t.SVGUtil.translateAndRotate(a.width/2,a.height/2,0,0,n)).each("end",(function(){i.interactivityState.interactiveChosenSliceFinishedSetting=!0})),this.interactivityState.currentRotate=n,this.interactivityState.interactiveLegend.updateLegend(r),this.svg.selectAll(".slice").attr("opacity",(function(e,t){return t===r?1:.6})),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)}},a.prototype.calculateRadius=function(){var e=this.currentViewport;if(!this.isInteractive&&this.data&&this.data.dataLabelsSettings.show){var t=e.height/e.width,i=2+1/(1+Math.exp(-5*(t-1)));return Math.min(e.height,e.width)/i}return Math.min(e.height,e.width)/2},a.prototype.getScaleForLegendArrow=function(){var e=1;return this.maxHeightToScaleDonutLegend&&this.currentViewport.height<this.maxHeightToScaleDonutLegend&&(e=this.currentViewport.height/this.maxHeightToScaleDonutLegend),e},a.prototype.initViewportDependantProperties=function(e){void 0===e&&(e=0),this.currentViewport.height=this.parentViewport.height,this.currentViewport.width=this.parentViewport.width;var i=this.currentViewport;if(this.isInteractive)i.height-=a.InteractiveLegendContainerHeight;else{var r=this.legend.getMargins();i.height-=r.height,i.width-=r.width}this.svg.attr({width:i.width,height:i.height}),this.isInteractive?(this.legendContainer.style({width:"100%",height:a.InteractiveLegendContainerHeight+"px",overflow:"hidden",top:0}),this.svg.style("top",a.InteractiveLegendContainerHeight)):t.Legend.positionChartArea(this.svg,this.legend),this.previousRadius=this.radius;var n=this.radius=this.calculateRadius(),o=i.width/2,s=i.height/2;this.arc=d3.svg.arc(),this.outerArc=d3.svg.arc().innerRadius(n*a.OuterArcRadiusRatio).outerRadius(n*a.OuterArcRadiusRatio),this.isInteractive?(this.mainGraphicsContext.attr("transform",t.SVGUtil.translate(o,s)),this.labelGraphicsContext.attr("transform",t.SVGUtil.translate(o,s))):(this.mainGraphicsContext.transition().duration(e).attr("transform",t.SVGUtil.translate(o,s)),this.labelGraphicsContext.transition().duration(e).attr("transform",t.SVGUtil.translate(o,s))),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.initDonutProperties=function(){this.donutProperties={viewport:this.currentViewport,radius:this.radius,arc:this.arc.innerRadius(0).outerRadius(this.radius*a.InnerArcRadiusRatio),outerArc:this.outerArc,innerArcRadiusRatio:a.InnerArcRadiusRatio,outerArcRadiusRatio:a.OuterArcRadiusRatio,dataLabelsSettings:this.data.dataLabelsSettings}},a.prototype.mergeDatasets=function(t,i){var a=d3.set();i.forEach((function(e){a.add(e.identity?e.identity.getKey():e.data.identity.getKey())}));var r=t.filter((function(e){return!a.has(e.identity?e.identity.getKey():e.data.identity.getKey())})).map((function(t){var i=e.Prototype.inherit(t);return void 0===i.percentage?i.data.percentage=0:i.percentage=0,i}));return d3.merge([i,r])},a.prototype.updateInternal=function(e,i,r){void 0===r&&(r=0);var n=this.currentViewport;if(r=r||t.AnimatorCommon.GetAnimationDuration(this.animator,i),this.animator){var o,s=a.InnerArcRadiusRatio,l=a.getLayout(this.radius,this.sliceWidthRatio,s,n),u=void 0,c=void 0,d=e.dataLabelsSettings,p=[];if(d&&d.show&&(p=this.createLabels()),!i){var h={viewModel:e,colors:this.colors,graphicsContext:this.mainGraphicsContext,labelGraphicsContext:this.labelGraphicsContext,interactivityService:this.interactivityService,layout:l,radius:this.radius,sliceWidthRatio:this.sliceWidthRatio,viewport:n,labels:p,innerArcRadiusRatio:s};u=this.animator.animate(h),o=u.shapes,c=u.highlightShapes}(i||u.failed)&&(o=a.drawDefaultShapes(this.svg,e,l,this.colors,this.radius,this.interactivityService&&this.interactivityService.hasSelection(),this.sliceWidthRatio,this.data.defaultDataPointColor),c=a.drawDefaultHighlightShapes(this.svg,e,l,this.colors,this.radius,this.sliceWidthRatio),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,p,!1,!0,!0),t.NewDataLabelUtils.drawLabelLeaderLines(this.labelGraphicsContext,p)),this.assignInteractions(o,c,e),this.tooltipsEnabled&&this.addTooltips(o,c)}else this.updateInternalToMove(e,r);t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},a.prototype.createLabels=function(){var i=new e.DonutLabelLayout({maximumOffset:t.NewDataLabelUtils.maxLabelOffset,startingOffset:t.NewDataLabelUtils.startingLabelOffset},this.donutProperties),a=this.createLabelDataPoints();return i.layout(a)},a.prototype.createLabelDataPoints=function(){var e=this.data,i=[],a=t.dataLabelUtils.createColumnFormatterCacheManager(),r=null;0===e.dataLabelsSettings.displayUnits&&(r=d3.max(e.dataPoints,(function(e){return Math.abs(e.data.measure)})));for(var n=0;n<this.data.dataPoints.length;n++){var o=this.createLabelDataPoint(e.dataPoints[n],r,a);i.push(o)}return i},a.prototype.createLabelDataPoint=function(e,i,a){var r,n,o,s,l,u=this.outerArc.centroid(e),c=t.DonutLabelUtils.getXPositionForDonutLabel(u[0]),d=u[1],p=this.data.dataLabelsSettings,h=a.getOrCreate(e.data.labelFormatString,p,i),g=c<0?4:8,f={point:{x:c,y:d},validPositions:[g],radius:0},m=p.labelColor?p.labelColor:t.NewDataLabelUtils.defaultLabelColor,y=p.labelStyle,v=p.fontSize,w="",b=this.data.hasHighlights,C=this.data.highlightsOverflow;if(y===t.labelStyle.both||y===t.labelStyle.data){var S=void 0;S=b&&!C?e.data.originalHighlightValue:e.data.originalMeasure,r=null!=S?h.format(S):null,n=t.NewDataLabelUtils.getTextSize(r,v)}switch(y!==t.labelStyle.both&&y!==t.labelStyle.category||(o=e.data.label,s=t.NewDataLabelUtils.getTextSize(o,v)),y){case t.labelStyle.both:w=o,r&&(w=w+" ("+r+")"),l=t.NewDataLabelUtils.getTextSize(w,v);break;case t.labelStyle.category:l=_.clone(s),w=o;break;case t.labelStyle.data:l=_.clone(n),w=r}var x=t.DonutLabelUtils.getLabelLeaderLineForDonutChart(e,this.donutProperties,f.point),P=t.DonutLabelUtils.getLabelLeaderLinesSizeForDonutChart(x);return{isPreferred:!0,text:"",tooltip:w,textSize:l,outsideFill:m,fontSize:v,identity:e.data.identity,parentShape:f,insideFill:t.NewDataLabelUtils.defaultInsideLabelColor,parentType:0,alternativeScale:i,donutArcDescriptor:e,angle:(e.startAngle+e.endAngle)/2-Math.PI/2,dataLabel:r,dataLabelSize:n,categoryLabel:o,categoryLabelSize:s,leaderLinePoints:x,linesSize:P}},a.prototype.renderLegend=function(){if(!this.isInteractive){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.parentViewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.parentViewport)}},a.prototype.addInteractiveLegendArrow=function(){if(this.data&&this.data.dataPoints&&0!==this.data.dataPoints.length){var e=11,i=16.5;if(!this.interactiveLegendArrow){var r=this.svg.append("g");r.append("path").classed(a.InteractiveLegendArrowClassName,!0).attr("d","M1.5,2.6C0.65,1.15,1.85,0,3,0l27,0c1.65,0,2.35,1.15,1.5,2.6L18,26.45c-0.8,1.45-2.15,1.45-2.95,0L1.95,2.6z"),this.interactiveLegendArrow=r}var n=this.currentViewport,o=this.getScaleForLegendArrow(),s=(n.height-2*this.radius)/2+e*o,l=n.width/2-i*o;this.interactiveLegendArrow.attr("transform",t.SVGUtil.translateAndScale(l,s,o))}},a.prototype.calculateSliceAngles=function(){var e=[],t=this.data.dataPoints;if(0===t.length)return this.interactivityState.valueToAngleFactor=0,void(this.interactivityState.sliceAngles=[]);for(var i=0,a=0,r=t.length;a<r;a++)i+=t[a].data.percentage;this.interactivityState.valueToAngleFactor=360/i;for(var n=0,a=0,r=t.length;a<r;a++){var o=t[a].data.percentage*this.interactivityState.valueToAngleFactor;n+=o,e.push(o/2-n)}this.interactivityState.sliceAngles=e},a.prototype.assignInteractions=function(e,t,i){if(this.isInteractive)this.assignInteractiveChartInteractions(e);else if(this.interactivityService){var a=i.dataPoints.map((function(e){return e.data})),r={clearCatcher:this.clearCatcher,slices:e,highlightSlices:t,allowDrilldown:this.allowDrilldown,visual:this,hasHighlights:i.hasHighlights};this.interactivityService.bind(a,this.behavior,r)}},a.prototype.assignInteractiveChartInteractions=function(e){var t=this,i=this.svg;this.interactivityState.interactiveChosenSliceFinishedSetting=!0;var a=i.node().getBoundingClientRect();this.interactivityState.donutCenter={x:a.left+a.width/2,y:a.top+a.height/2},this.interactivityState.totalDragAngleDifference=0,this.interactivityState.currentRotate=0,this.calculateSliceAngles(),e.on("click",(function(e,i){d3.event.defaultPrevented||t.setInteractiveChosenSlice(i)}));var r=d3.behavior.drag().origin(Object).on("dragstart",(function(){return t.interactiveDragStart()})).on("drag",(function(){return t.interactiveDragMove()})).on("dragend",(function(){return t.interactiveDragEnd()}));i.style("touch-action","none").call(r)},a.prototype.getAngleFromDragEvent=function(){var e,t,i=this.interactivityState,a=d3.event.sourceEvent;if(a.type.toLowerCase().indexOf("touch")!==-1){if(1!==a.touches.length)return null;var r=a.touches[0];e=r.pageX,t=r.pageY}else e=a.pageX,t=a.pageY;var n={x:e-i.donutCenter.x,y:-t+i.donutCenter.y},o=180*Math.atan2(n.y,n.x)/Math.PI;return o},a.prototype.interactiveDragStart=function(){this.interactivityState.totalDragAngleDifference=0,this.interactivityState.previousDragAngle=this.getAngleFromDragEvent()},a.prototype.interactiveDragMove=function(){var e=this.data.dataPoints,i=this.currentViewport,r=this.interactivityState;if(r.interactiveChosenSliceFinishedSetting===!0){var n=this.getAngleFromDragEvent();if(!n)return;var o=r.previousDragAngle-n;r.totalDragAngleDifference+=o,r.previousDragAngle=n,r.currentRotate+=o,this.svg.select("g").attr("transform",t.SVGUtil.translateAndRotate(i.width/2,i.height/2,0,0,this.interactivityState.currentRotate));var s=e[0].data.percentage*r.valueToAngleFactor,l=r.currentRotate<=0?r.currentRotate*-1%360:360-r.currentRotate%360;r.currentIndexDrag=0;for(var u=e.length;r.currentIndexDrag<u&&l>s;)r.currentIndexDrag<u-1&&(s+=e[r.currentIndexDrag+1].data.percentage*r.valueToAngleFactor),r.currentIndexDrag++;r.currentIndexDrag!==r.previousIndexDrag&&(r.interactiveLegend.updateLegend(r.currentIndexDrag),this.svg.selectAll(".slice").attr("opacity",(function(e,t){return t===r.currentIndexDrag?a.OpaqueOpacity:a.SemiTransparentOpacity})),r.previousIndexDrag=r.currentIndexDrag)}},a.prototype.interactiveDragEnd=function(){0!==this.interactivityState.totalDragAngleDifference&&(this.setInteractiveChosenSlice(this.interactivityState.currentIndexDrag),d3.event.sourceEvent.stopPropagation())},a.prototype.updateInternalToMove=function(e,i){void 0===i&&(i=0);var r=this.svg,n=this.pie,o=this.key,s=this.arc,l=this.radius,u=this.previousRadius,c=this.sliceWidthRatio,d=this.svg.select(".slices").selectAll("path"+a.sliceClass.selector).data().map((function(e){return e.data}));0===d.length&&(d=e.dataPointsToDeprecate);var p=this.mergeDatasets(d,e.dataPointsToDeprecate),h=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(n(e.dataPointsToDeprecate),o);h.enter().insert("path").classed(a.sliceClass.class,!0).each((function(e){this._current=e})),h=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(n(p),o);var g=l*c;if(a.isSingleColor(e.dataPoints),h.style("fill",(function(e){return e.data.color})).style("fill-opacity",(function(i){return t.ColumnUtil.getFillOpacity(i.data.selected,!1,!1,e.hasHighlights)})).style("stroke","white").style("stroke-dasharray",(function(e){return a.drawStrokeForDonutChart(l,a.InnerArcRadiusRatio,e,c)})).style("stroke-width",(function(e){return e.data.strokeWidth})).transition().duration(i).attrTween("d",(function(e){var t=d3.interpolate(this._current,e),i=d3.interpolate(u*a.InnerArcRadiusRatio,l*a.InnerArcRadiusRatio);return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(i(e))(t(e))}})),h=r.select(".slices").selectAll("path"+a.sliceClass.selector).data(n(e.dataPointsToDeprecate),o),h.exit().transition().delay(i).duration(0).remove(),!this.isInteractive){var f=e.dataLabelsSettings,m=[];f&&f.show&&(m=this.createLabels()),t.NewDataLabelUtils.drawDefaultLabels(this.labelGraphicsContext,m,!1,!0),t.NewDataLabelUtils.drawLabelLeaderLines(this.labelGraphicsContext,m)}var y=void 0;e.hasHighlights?(y=r.select(".slices").selectAll("path"+a.sliceHighlightClass.selector).data(n(e.dataPointsToDeprecate),o),y.enter().insert("path").classed(a.sliceHighlightClass.class,!0).each((function(e){this._current=e})),a.isSingleColor(e.dataPoints),y.style("fill",(function(e){return e.data.color})).style("fill-opacity",1).style("stroke","white").style("stroke-dasharray",(function(e){return a.drawStrokeForDonutChart(l,a.InnerArcRadiusRatio,e,c,e.data.highlightRatio)})).style("stroke-width",(function(e){return 0===e.data.highlightRatio?0:e.data.strokeWidth})).transition().duration(i).attrTween("d",(function(e){var t=d3.interpolate(this._current,e),i=d3.interpolate(u*a.InnerArcRadiusRatio,a.getHighlightRadius(l,c,e.data.highlightRatio));return this._current=t(0),function(e){return s.innerRadius(g).outerRadius(i(e))(t(e))}})),y.exit().transition().delay(i).duration(0).remove()):r.selectAll("path"+a.sliceHighlightClass.selector).transition().delay(i).duration(0).remove(),this.assignInteractions(h,y,e),this.tooltipsEnabled&&this.addTooltips(h,y),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options),this.isInteractive&&(this.addInteractiveLegendArrow(),this.interactivityState.interactiveLegend.drawLegend(this.data.dataPointsToDeprecate),this.setInteractiveChosenSlice(this.interactivityState.lastChosenInteractiveSliceIndex?this.interactivityState.lastChosenInteractiveSliceIndex:0))},a.prototype.addTooltips=function(e,t){this.tooltipService.addTooltip(e,(function(e){return e.data.data.tooltipInfo}),(function(e){return e.data.data.identity})),t&&this.tooltipService.addTooltip(t,(function(e){
return e.data.data.tooltipInfo}),(function(e){return e.data.data.identity}))},a.drawDefaultShapes=function(e,i,r,n,o,s,l,u){var c=e.select(".slices").selectAll("path"+a.sliceClass.selector).data(i.dataPoints,(function(e){return e.data.identity.getKey()}));return c.enter().insert("path").classed(a.sliceClass.class,!0),a.isSingleColor(i.dataPoints),c.style("fill",(function(e){return e.data.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!1,s,i.hasHighlights)})).style("stroke-width",(function(e){return e.data.strokeWidth})).attr(r.shapeLayout.attrs).style(r.shapeLayout.styles),c.exit().remove(),c},a.drawDefaultHighlightShapes=function(e,i,r,n,o,s){var l=e.select(".slices").selectAll("path"+a.sliceHighlightClass.selector).data(i.dataPoints.filter((function(e){return null!=e.data.highlightRatio})),(function(e){return e.data.identity.getKey()}));return l.enter().insert("path").classed(a.sliceHighlightClass.class,!0).each((function(e){this._current=e})),a.isSingleColor(i.dataPoints),l.style("fill",(function(e){return e.data.color})).style("fill-opacity",(function(e){return t.ColumnUtil.getFillOpacity(e.data.selected,!0,!1,i.hasHighlights)})).style("stroke","white").style("stroke-width",(function(e){return 0===e.data.highlightRatio?0:e.data.strokeWidth})).attr(r.highlightShapeLayout.attrs).style(r.highlightShapeLayout.styles),l.exit().remove(),l},a.isSingleColor=function(e){if(e.length>1){var t=e.length-1;e[t].data.isLastInDonut=e[t].data.color===e[0].data.color}},a.drawStrokeForDonutChart=function(e,t,i,r,n){void 0===n&&(n=1);var o,s,l=e*t*n,u=(i.endAngle-i.startAngle)*l;if(r){var c=e*r,d=n*e*(a.InnerArcRadiusRatio-r),p=(i.endAngle-i.startAngle)*c;if(i.data.highlightRatio&&(u=(i.endAngle-i.startAngle)*(d+c)),i.data.isLastInDonut)return"0 "+u+" "+d+" "+p+" "+d;o=u+d+p,s=d}else i.data.isLastInDonut?(o=u,s=2*l):(o=u+l,s=l);return"0 "+o+" "+s},a.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},a.getLayout=function(e,t,i,r){var n=e*t,o=e*i,s=n||a.EffectiveZeroValue,l=d3.svg.arc().innerRadius(n),u=d3.svg.arc().innerRadius(n).outerRadius(o),c=d3.svg.arc().innerRadius(n).outerRadius(s);return{shapeLayout:{attrs:{d:function(e){return u(e)}},styles:{"stroke-dasharray":function(r){return a.drawStrokeForDonutChart(e,i,r,t)}}},highlightShapeLayout:{attrs:{d:function(i){var r=l.outerRadius(a.getHighlightRadius(e,t,i.data.highlightRatio));return r(i)}},styles:{"stroke-dasharray":function(r){return a.drawStrokeForDonutChart(e,i,r,t,r.data.highlightRatio)}}},zeroShapeLayout:{attrs:{d:function(e){return c(e)}},styles:{"stroke-dasharray":function(r){return a.drawStrokeForDonutChart(e,i,r,t,s)}}}}},a.getHighlightRadius=function(e,t,i){var r=e*t;return r+i*e*(a.InnerArcRadiusRatio-t)},a.cullDataByViewport=function(e,t,i){for(var r,n=Math.min(i.width,i.height)/2,o=this.invisibleArcLengthInPixels/(n*a.twoPi),s=o*t,l=[],u=0,c=e;u<c.length;u++){var d=c[u];d.measure>=s&&(d.strokeWidth=r===d.color?1:0,r=d.color,l.push(d))}return l},a.ClassName="donutChart",a.InteractiveLegendClassName="donutLegend",a.InteractiveLegendArrowClassName="donutLegendArrow",a.OuterArcRadiusRatio=.9,a.InnerArcRadiusRatio=.8,a.OpaqueOpacity=1,a.SemiTransparentOpacity=.6,a.defaultSliceWidthRatio=.48,a.invisibleArcLengthInPixels=3,a.sliceClass=i("slice"),a.sliceHighlightClass=i("slice-highlight"),a.twoPi=2*Math.PI,a.InteractiveLegendContainerHeight=70,a.EffectiveZeroValue=1e-9,a.PolylineOpacity=.5,a})();t.DonutChart=r;var n,o=(function(){function e(e,t,i,a,r){this.legendContainerParent=t,this.colors=i,this.donutChart=e,this.visualInitOptions=a,this.legendItemsPositions=[],this.legendTransitionAnimationDuration=r&&r.legendTransitionAnimationDuration?r.legendTransitionAnimationDuration:0}return e.prototype.drawLegend=function(i){var a=this;this.data=i,this.currentNumberOfLegendItems=i.length,this.currentIndex=0,this.leftMostIndex=0,this.rightMostIndex=i.length-1,this.legendContainerParent.select(e.LegendContainerSelector).empty()&&(this.legendContainer=this.legendContainerParent.append("div").classed(e.LegendContainerClassName,!0));var r=this.legendContainer.selectAll(e.LegendItemSelector).data(i),n=this.legendContainerWidth=this.legendContainer.node().getBoundingClientRect().width,o=n/2-.4*n/2+e.ItemMargin,s=o;this.currentXOffset=o;var l=function(i,r){i.attr("data-legend-index",r.index).css({position:"absolute",left:s});var n=t.valueFormatter.format(r.label),o=t.valueFormatter.format(r.originalMeasure,r.measureFormat),l=t.valueFormatter.format(r.percentage,"0.00 %;-0.00 %;0.00 %"),u=r.color,c=e.createBasicLegendItemSpan(e.LegendItemValueClassName,o,11),d=e.createBasicLegendItemSpan(e.LegendItemCategoryClassName,n,11),p=e.createBasicLegendItemSpan(e.LegendItemPercentageClassName,l,20),h=e.spanWidth(c),g=e.spanWidth(d),f=e.spanWidth(p),m=e.legendBoxSize(h,g,f);i.css("width",m);var y=function(e){return m-e>0?(m-e)/2:0},v=y(h),w=y(g),b=y(f);e.createLegendItemSpan(d,w),e.createLegendItemSpan(c,v),e.createLegendItemSpan(p,b).css("color",u),i.append(d),i.append(p),i.append(c),a.legendItemsPositions.push({startX:s,boxWidth:m}),s+=m+e.ItemMargin};r.enter().insert("div").classed(e.LegendItemClassName,!0).each((function(e){l($(this),e)})),r.exit().remove(),this.assignInteractions()},e.prototype.updateLegend=function(e){var i=this,a=this.legendContainerWidth;this.currentIndex=e,this.updateLabelBlocks(e);var r=this.legendTransitionAnimationDuration,n=(this.legendItemsPositions[e].startX+this.legendItemsPositions[e].boxWidth/2-a/2)*-1;this.legendContainer.transition().styleTween("-webkit-transform",(function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(n,0))})).styleTween("transform",(function(e,a,r){return d3.interpolate(t.SVGUtil.translateWithPixels(i.currentXOffset,0),t.SVGUtil.translateWithPixels(n,0))})).duration(r).ease("bounce").each("end",(function(){i.currentXOffset=n})),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.visualInitOptions)},e.prototype.assignInteractions=function(){var t=this,i=0,a=!1,r=function(){i=0,a=!1},n=function(){if(i+=d3.event.dx,!(a||Math.abs(i)<e.MinimumSwipeDX)){var r=i<0;t.dragLegend(r),a=!0}},o=d3.behavior.drag().origin(Object).on("drag",n).on("dragstart",r);this.legendContainer.style({"touch-action":"none",cursor:"pointer"}).call(o)},e.prototype.dragLegend=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled-1?this.currentIndex=this.getCyclingCurrentIndex(t):this.shouldChangeIndexInNonCycling(t)&&(t?this.currentIndex++:this.currentIndex--),this.donutChart.setInteractiveChosenSlice(this.currentIndex)},e.prototype.shouldChangeIndexInNonCycling=function(e){return!(0===this.currentIndex&&!e||this.currentIndex===this.currentNumberOfLegendItems-1&&e)},e.prototype.getCyclingCurrentIndex=function(e){var t=this.data.length,i=e?1:-1,a=(this.currentIndex+i)%(t||1);return a<0?a+t:a},e.prototype.updateLegendItemsBlocks=function(t,i){var a=$(this.legendContainer[0]);if(t){var r=a.find("[data-legend-index="+this.leftMostIndex+"]");r.remove().insertAfter(a.find("[data-legend-index="+this.rightMostIndex+"]"));var n=this.legendItemsPositions[this.rightMostIndex].startX+this.legendItemsPositions[this.rightMostIndex].boxWidth+e.ItemMargin;this.legendItemsPositions[this.leftMostIndex].startX=n,r.css("left",n),this.rightMostIndex=this.leftMostIndex,this.leftMostIndex=(this.leftMostIndex+1)%this.data.length}else{var o=a.find("[data-legend-index="+this.rightMostIndex+"]");o.remove().insertBefore(a.find("[data-legend-index="+this.leftMostIndex+"]"));var n=this.legendItemsPositions[this.leftMostIndex].startX-this.legendItemsPositions[this.rightMostIndex].boxWidth-e.ItemMargin;this.legendItemsPositions[this.rightMostIndex].startX=n,o.css("left",n),this.leftMostIndex=this.rightMostIndex,this.rightMostIndex=this.rightMostIndex-1===-1?this.legendItemsPositions.length-1:this.rightMostIndex-1}i-1!==0&&this.updateLegendItemsBlocks(t,i-1)},e.prototype.updateLabelBlocks=function(t){this.currentNumberOfLegendItems>e.MinimumItemsInLegendForCycled?(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,2),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,2),(this.rightMostIndex===t+1||0===this.rightMostIndex&&t===this.currentNumberOfLegendItems-1)&&this.updateLegendItemsBlocks(!0,1),(this.leftMostIndex===t-1||this.leftMostIndex===this.currentNumberOfLegendItems-1&&0===t)&&this.updateLegendItemsBlocks(!1,1)):this.currentNumberOfLegendItems===e.MinimumItemsInLegendForCycled&&(this.rightMostIndex===t&&this.updateLegendItemsBlocks(!0,1),this.leftMostIndex===t&&this.updateLegendItemsBlocks(!1,1))},e.createBasicLegendItemSpan=function(e,t,i){return $("<span/>").addClass(e).css({"white-space":"nowrap","font-size":i+"px"}).text(t)},e.createLegendItemSpan=function(e,t){return e.css({overflow:"hidden","text-overflow":"ellipsis",display:"inline-block",width:"100%","margin-left":t}),e},e.legendBoxSize=function(t,i,a){var r=t>i?t:i;return r=r>a?r:a,r=r>e.MaxLegendItemBoxSize?e.MaxLegendItemBoxSize:r+2},e.spanWidth=function(e){return this.FakeElementSpan||(this.FakeElementSpan=$("<span>").hide().appendTo(document.body)),this.FakeElementSpan.empty(),this.FakeElementSpan.append(e),this.FakeElementSpan.width()},e.LegendContainerClassName="legend-container",e.LegendContainerSelector=".legend-container",e.LegendItemClassName="legend-item",e.LegendItemSelector=".legend-item",e.LegendItemCategoryClassName="category",e.LegendItemPercentageClassName="percentage",e.LegendItemValueClassName="value",e.MaxLegendItemBoxSize=160,e.ItemMargin=30,e.MinimumSwipeDX=15,e.MinimumItemsInLegendForCycled=3,e})();!(function(i){var a=(function(){function i(a,r,n,o){void 0===o&&(o=!0);var s=this.reader=e.data.createIDataViewCategoricalReader(a),l=a.categorical;if(this.dataViewCategorical=l,this.dataViewMetadata=a.metadata,this.tooltipsEnabled=o,this.colorHelper=new t.ColorHelper(r,t.donutChartProps.dataPoint.fill,n),this.maxValue=0,this.hasNegativeValues=!1,this.allValuesAreNegative=!1,l.categories&&l.categories.length>0){var u=l.categories[0];this.categoryIdentities=u.identity,this.categoryValues=u.values,this.allCategoryObjects=u.objects,this.categoryColumnRef=u.identityFields,this.categoryFormatString=t.valueFormatter.getFormatString(u.source,t.donutChartProps.general.formatString)}if(this.isDynamicSeries=s.hasDynamicSeries(),this.highlightsOverflow=!1,this.total=0,this.highlightTotal=0,this.dataPoints=[],this.legendDataPoints=[],this.dataLabelsSettings=null,s.hasValues("Y")){var c=this.seriesCount=s.getSeriesCount("Y");this.hasHighlights=s.hasHighlights("Y");var d=s.getCategoryCount()||1;this.allValuesAreNegative=void 0;for(var p=0;p<d;p++)for(var h=0;h<c;h++){var g=s.getValue("Y",p,h),f=void 0;this.hasHighlights&&(f=s.getHighlight("Y",p,h),null==f&&(f=0)),void 0===this.allValuesAreNegative?this.allValuesAreNegative=(!this.hasHighlights||f<=0)&&g<=0:this.allValuesAreNegative=this.allValuesAreNegative&&(!this.hasHighlights||f<=0)&&g<=0,this.hasNegativeValues||(this.hasNegativeValues=g<0||!!this.hasHighlights&&f<0)}this.allValuesAreNegative=!!this.allValuesAreNegative;for(var p=0;p<d;p++)for(var h=0;h<c;h++){var g=s.getValue("Y",p,h);if(g=i.normalizedValue(g,this.allValuesAreNegative),this.total+=g,this.hasHighlights){var f=s.getHighlight("Y",p,h);f=i.normalizedValue(f,this.allValuesAreNegative),this.highlightTotal+=f,!this.highlightsOverflow&&e.Double.greaterWithPrecision(f,g,e.Double.getPrecision(Math.min(f,g)))&&(this.highlightsOverflow=!0)}}}}return i.normalizedValue=function(e,t){return null==e||isNaN(e)?0:e===Number.POSITIVE_INFINITY?Number.MAX_VALUE:e===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t?Math.abs(e):e<0?0:e},i.prototype.convert=function(){var e,a=this.reader;e=0!==this.total?this.categoryValues?this.convertCategoricalWithSlicing():this.isDynamicSeries?this.convertSeries():this.convertMeasures():[],this.dataLabelsSettings=this.convertDataLabelSettings();var n=this.dataViewMetadata;if(n){var o=n.objects;o&&(this.legendObjectProperties=o.legend)}var s=_.isEmpty(this.dataViewCategorical.categories)?null:this.dataViewCategorical.categories[0];this.dataPoints=[];for(var l,u=t.donutChartProps.general.formatString,c=t.valueFormatter.getLocalizedString("Percentage"),d=0,p=e.length;d<p;d++){var h=e[d],g=h.measure,f=i.normalizedValue(h.measure,this.allValuesAreNegative),m=h.highlightMeasure,y=i.normalizedValue(h.highlightMeasure,this.allValuesAreNegative),v=this.total>0?f/this.total:0,w=void 0,b=void 0;f>this.maxValue&&(this.maxValue=f),y>this.maxValue&&(this.maxValue=y),this.hasHighlights&&(this.highlightsOverflow?(g=m,f=y,v=this.highlightTotal>0?y/this.highlightTotal:0,w=1):w=0!==f?y/f:0,w||(w=r.EffectiveZeroValue),b=v*w);var C=h.categoryLabel,S=this.dataViewCategorical,x=void 0;x=null!=h.seriesIndex?h.seriesIndex:d;var P=a.getValueMetadataColumn("Y",x),D=this.hasHighlights&&this.highlightsOverflow?m:g,T=this.hasHighlights&&!this.highlightsOverflow?m:void 0,V=t.valueFormatter.getFormatString(P,u),L=t.valueFormatter.format(v,c),M=void 0;null!=D&&null!=L&&(M=t.valueFormatter.format(D,V)+" ("+L+")");var N=void 0;if(null!=T&&null!=b){var I=t.valueFormatter.format(b,c);N=t.valueFormatter.format(T,V)+" ("+I+")"}var A=void 0;this.tooltipsEnabled&&(A=[],s&&A.push({displayName:s.source.displayName,value:C}),this.isDynamicSeries&&(s&&s.source===S.values.source||A.push({displayName:S.values.source.displayName,value:h.label})),null!=M&&A.push({displayName:P.displayName,value:M}),null!=N&&A.push({displayName:t.ToolTipComponent.localizationOptions.highlightedValueDisplayName,value:N}),t.TooltipBuilder.addTooltipMeasures(a,A,this.categoryValues?h.categoryIndex:0,this.isDynamicSeries?h.seriesIndex:void 0));var O=l===h.color&&v&&v>0?1:0;l=v&&v>0?h.color:l,this.dataPoints.push({identity:h.identity,measure:f,originalMeasure:g,measureFormat:h.measureFormat,percentage:v,index:h.index,label:h.label,highlightRatio:w,highlightValue:this.hasHighlights&&!this.highlightsOverflow?y:void 0,originalHighlightValue:this.hasHighlights&&!this.highlightsOverflow?m:void 0,selected:!1,tooltipInfo:A,color:h.color,strokeWidth:O,labelFormatString:P.format})}this.legendData=this.convertLegendData()},i.prototype.getLegendTitle=function(){if(0!==this.total){var e=this.dataViewCategorical.values&&this.dataViewCategorical.values.source?this.dataViewCategorical.values.source.displayName:"",t=this.dataViewCategorical.categories&&this.dataViewCategorical.categories.length>0&&this.dataViewCategorical.categories[0].source?this.dataViewCategorical.categories[0].source.displayName:"";return this.categoryValues?t:e}return""},i.prototype.convertCategoricalWithSlicing=function(){for(var e=this.reader,i=this.dataViewCategorical,a=t.donutChartProps.general.formatString,r=[],n=0,o=this.categoryValues.length;n<o;n++){for(var s=this.categoryValues[n],l=this.allCategoryObjects?this.allCategoryObjects[n]:void 0,u=t.SelectionId.createWithId(this.categoryIdentities[n]),c=this.colorHelper.getColorForSeriesValue(l,this.categoryColumnRef,s),d=t.valueFormatter.format(s,this.categoryFormatString),p=0;p<this.seriesCount;p++){var h=e.getValue("Y",n,p),g=this.hasHighlights?e.getHighlight("Y",n,p):void 0;if(null!=h||null!=g){var f=e.getValueColumn("Y",p),m=d;(this.isDynamicSeries||e.getSeriesCount("Y")>1)&&(m=t.converterHelper.getFormattedLegendLabel(f.source,i.values,a));var y=f.source.queryName,v=t.SelectionIdBuilder.builder().withCategory(i.categories[0],n).withSeries(i.values,this.isDynamicSeries?f:void 0).withMeasure(y).createSelectionId(),w={identity:v,measureFormat:t.valueFormatter.getFormatString(f.source,a,!0),measure:h,highlightMeasure:g,index:r.length,label:m,categoryLabel:d,color:c,categoryIndex:n,seriesIndex:p};r.push(w)}}this.legendDataPoints.push({label:d,color:c,icon:t.LegendIcon.Box,identity:u,selected:!1})}return r},i.prototype.convertMeasures=function(){for(var e=this.reader,i=[],a=t.donutChartProps.general.formatString,r=0;r<this.seriesCount;r++){var n=e.getValue("Y",0,r),o=this.hasHighlights?e.getHighlight("Y",0,r):void 0,s=e.getValueColumn("Y",r),l=t.valueFormatter.getFormatString(s.source,a,!0),u=s.source.displayName,c=t.SelectionId.createWithMeasure(s.source.queryName),d=this.colorHelper.getColorForMeasure(s.source.objects,s.source.queryName),p={identity:c,measureFormat:l,measure:n,highlightMeasure:o,index:r,label:u,categoryLabel:u,color:d};i.push(p),this.legendDataPoints.push({label:p.label,color:p.color,icon:t.LegendIcon.Box,identity:p.identity,selected:!1})}return i},i.prototype.convertSeries=function(){for(var e=this.reader,i=this.dataViewCategorical,a=[],r=t.donutChartProps.general.formatString,n=0;n<this.seriesCount;n++){var o=e.getValue("Y",0,n),s=this.hasHighlights?e.getHighlight("Y",0,n):void 0,l=e.getValueColumn("Y",n),u=t.valueFormatter.getFormatString(l.source,r,!0),c=t.converterHelper.getFormattedLegendLabel(l.source,i.values,r),d=(new t.SelectionIdBuilder).withSeries(i.values,l).withMeasure(l.source.queryName).createSelectionId(),p=t.converterHelper.getSeriesName(l.source),h=e.getSeriesObjects(n),g=this.colorHelper.getColorForSeriesValue(h,i.values.identityFields,p),f={identity:d,measureFormat:u,measure:o,highlightMeasure:s,index:n,label:c,categoryLabel:c,color:g,seriesIndex:n};a.push(f),this.legendDataPoints.push({label:f.label,color:f.color,icon:t.LegendIcon.Box,identity:f.identity,selected:!1})}return a},i.prototype.convertDataLabelSettings=function(){var e=this.dataViewMetadata,i=t.dataLabelUtils.getDefaultDonutLabelSettings();if(e){var a=e.objects;if(a){var r=a.labels;r&&t.dataLabelUtils.updateLabelSettingsFromLabelsObject(r,i)}}return i},i.prototype.convertLegendData=function(){return{dataPoints:this.legendDataPoints,labelColor:t.LegendData.DefaultLegendLabelFillColor,title:this.getLegendTitle(),fontSize:t.SVGLegend.DefaultFontSizeInPt}},i})();i.DonutChartConverter=a})(n||(n={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=(function(){function i(e){this.viewModel={},e&&(this.isScrollable=!!e.isScrollable&&e.isScrollable,this.behavior=e.behavior)}return i.prototype.init=function(e){var a=this;this.options=e,this.colors=e.style.colorPalette.dataColors,this.colorHelper=new t.ColorHelper(this.colors,t.sunburstProps.dataPoint.fill),this.svg=d3.select(e.element.get(0)).append("svg").attr("class",i.SunburstClassName).style("position","absolute"),this.container=this.svg.append("g"),this.sunburstText=this.svg.append("text"),this.sunburstText.on("mousedown",(function(e){a.svg.selectAll("path").style("opacity",1),a.sunburstText.style("opacity",0)})),this.behavior&&(this.interactivityService=t.createInteractivityService(e.host)),this.hostService=e.host,this.tooltipService=t.createTooltipService(e.host),this.legend=t.createLegend(e.element,e.interactivity&&e.interactivity.isInteractiveLegend,this.interactivityService,this.isScrollable)},i.prototype.update=function(e){this.dataViews=e.dataViews,e.dataViews.length>0&&(this.data=i.converter(e.dataViews[0],this.colors),this.viewport=e.viewport,this.updateInternal())},i.prototype.updateInternal=function(){var e=this;this.options.interactivity&&this.options.interactivity.isInteractiveLegend||!this.data||this.renderLegend(),this.updateViewport(),this.viewModel.radius=Math.min(this.viewport.width,this.viewport.height)/2,this.viewModel.y=d3.scale.linear().range([0,this.viewModel.radius]),this.viewModel.x=d3.scale.linear().range([0,i.twoPI]),this.viewModel.arc=d3.svg.arc().startAngle((function(t){return Math.max(0,Math.min(i.twoPI,e.viewModel.x(t.x)))})).endAngle((function(t){return Math.max(0,Math.min(i.twoPI,e.viewModel.x(t.x+t.dx)))})).innerRadius((function(t){return Math.max(0,e.viewModel.y(t.y))})).outerRadius((function(t){return Math.max(0,e.viewModel.y(t.y+t.dy))})),this.svg.attr({height:this.viewport.height,width:this.viewport.width}),this.container.attr("transform",t.SVGUtil.translate(this.viewport.width/2,this.viewport.height/2));var a=d3.layout.partition().value((function(e){return e.value})),r=a.nodes(this.data.root),n=r.filter((function(t){return e.getChordLength(t)>i.minChordLength})),o=this.renderDefaultShapes(n);if(this.renderDefaultLabels(n),this.renderTooltip(o.filter((function(e){return e.color}))),this.interactivityService){var s={slices:o},l=r.filter((function(e){return!!e.identity}));this.interactivityService.bind(l,this.behavior,s)}this.setupSunburstText()},i.prototype.renderLegend=function(){var e=this.data.legendObjectProperties;if(e){var i=this.data.legendData;t.LegendData.update(i,e);var a=e[t.legendProps.position];a&&this.legend.changeOrientation(t.LegendPosition[a]),this.legend.drawLegend(i,this.viewport)}else this.legend.changeOrientation(t.LegendPosition.Top),this.legend.drawLegend({dataPoints:[]},this.viewport)},i.prototype.renderDefaultShapes=function(e){var t=this,a=this.container.selectAll("path").data(e);return a.enter().append("path").style("stroke","#fff"),a.attr("display",(function(e){return 0!==e.depth?null:"none"})).attr("d",this.viewModel.arc).style("fill",(function(e){return e.color?e.color:null})).style("fill-opacity",(function(e){return e.color?null:i.zeroOpacity})).on("mousedown",(function(e){e.hasHighlight=!0,t.highlightPath(e);var i=0===t.data.root.total?0:(100*e.total/t.data.root.total).toPrecision(3);t.sunburstText.text(e?i+"%":""),t.sunburstText.style("fill",e.color),t.setupSunburstText()})),a.exit().remove(),a},i.prototype.renderDefaultLabels=function(t){var a=this,r=this.container.selectAll("."+i.LabelClassName).data(t);r.enter().append("text").attr("class",i.LabelClassName).attr("x",0).attr("text-anchor","middle"),r.text((function(e){return a.data.dataLabelsSettings.showCategory&&a.data.dataLabelsSettings.show?e.name+" "+a.getDataLabel(e):a.data.dataLabelsSettings.showCategory?e.name:a.data.dataLabelsSettings.show?a.getDataLabel(e):null})).style("font-size",this.data.dataLabelsSettings.fontSize).style("fill",(function(e){return e.color?a.data.dataLabelsSettings.labelColor:"#fff"})).attr("transform",(function(e){if(e.depth>0){var t=180/Math.PI*(a.viewModel.arc.startAngle()(e)+a.viewModel.arc.endAngle()(e))/2-90,i=t>90?t-180:t;return"translate("+a.viewModel.arc.centroid(e)+")rotate("+i+")"}})),r.exit().remove();var n=this;return r.each((function(t){var i=d3.select(this),a=n.getChordLength(t),r=n.viewModel.y(t.dy);e.TextMeasurementService.wordBreak(i.node(),r,a)})),r.each((function(e){var t=d3.select(this);n.normalizeLabels(t,e)})),r},i.prototype.getDataLabel=function(e){var i=t.dataLabelUtils.createColumnFormatterCacheManager(),a=i.getOrCreate(e.labelFormatString,this.data.dataLabelsSettings),r=t.dataLabelUtils.getLabelFormattedText({label:e.value,formatter:a});return r},i.prototype.normalizeLabels=function(t,i){var a=this.getChordLength(i),r={text:i.name,fontFamily:this.data.dataLabelsSettings.labelStyle,fontSize:this.data.dataLabelsSettings.fontSize.toString()+"px"},n=e.TextMeasurementService.measureSvgTextHeight(r),o=t.selectAll("tspan"),s=o.size();if(n*s>a)return void t.remove();var l=d3.select(o.node());1===s||2===s?l.attr("dy",0):s>2&&l.attr("dy",-n)},i.prototype.getChordLength=function(t){var i={text:t.name,fontFamily:this.data.dataLabelsSettings.labelStyle,fontSize:this.data.dataLabelsSettings.fontSize.toString()+"px"},a=e.TextMeasurementService.measureSvgTextHeight(i),r=this.viewModel.x(t.dx);return r>Math.PI?3*a:2*this.viewModel.y(t.y)*Math.sin(Math.abs(r/2))},i.prototype.onClearSelection=function(){this.interactivityService&&this.interactivityService.clearSelection()},i.prototype.enumerateObjectInstances=function(e){var i=this.data;if(i){var a=e.objectName,r=new t.ObjectEnumerationBuilder,n=this.data.dataLabelsSettings?this.data.dataLabelsSettings:t.dataLabelUtils.getDefaultSunburstLabelSettings();switch(a){case"dataPoint":var o=this.dataViews&&this.dataViews.length>0&&this.dataViews[0]&&this.dataViews[0].categorical,s=t.GradientUtils.hasGradientRole(o);s||this.enumerateDataPoints(r,i.root);break;case"legend":return this.enumerateLegend(i);case"labels":var l={enumeration:r,dataLabelsSettings:n,show:!0,displayUnits:!0,precision:!0};t.dataLabelUtils.enumerateDataLabels(l);break;case"categoryLabels":t.dataLabelUtils.enumerateCategoryLabels(r,n,!1,!0)}return r.complete()}},i.prototype.enumerateDataPoints=function(e,i){var a=i.children;if(!_.isEmpty(a))for(var r=0,n=a;r<n.length;r++){var o=n[r];o.color&&e.pushInstance({displayName:o.name,selector:t.ColorHelper.normalizeSelector(o.identity.getSelector()),properties:{fill:{solid:{color:o.color}}},objectName:"dataPoint"})}},i.prototype.enumerateLegend=function(i){var a={legend:i.legendObjectProperties},r=e.DataViewObjects.getValue(a,t.treemapProps.legend.show,this.legend.isVisible()),n=e.DataViewObjects.getValue(a,t.treemapProps.legend.showTitle,!0),o=e.DataViewObjects.getValue(a,t.treemapProps.legend.titleText,this.data.legendData.title),s=e.DataViewObject.getValue(a,t.legendProps.labelColor,this.data.legendData?this.data.legendData.labelColor:t.LegendData.DefaultLegendLabelFillColor),l=e.DataViewObject.getValue(a,t.legendProps.fontSize,this.data.legendData&&this.data.legendData.fontSize?this.data.legendData.fontSize:t.SVGLegend.DefaultFontSizeInPt),u=e.DataViewObjects.getValue(a,t.treemapProps.legend.position,t.legendPosition.top);return[{selector:null,objectName:"legend",properties:{show:r,position:u,showTitle:n,titleText:o,labelColor:s,fontSize:l}}]},i.getTreePath=function(e){for(var t=[],i=e;i.parent;)t.unshift(i),i=i.parent;return t},i.prototype.setupSunburstText=function(){this.sunburstText.style("opacity",i.maxOpacity),this.sunburstText.attr("y",this.viewport.height/2),this.sunburstText.attr("x",this.viewport.width/2-this.sunburstText.node().clientWidth/2)},i.prototype.onResizing=function(e){this.viewport=e,this.updateInternal()},i.prototype.highlightPath=function(e){var t=e?i.getTreePath(e):[],a=this.svg.selectAll("path");a.each((function(t){t.identity!==e.identity&&t.color&&(d3.select(this).style("opacity",i.minOpacity),t.hasHighlight=!1)})),a.filter((function(e){return _.contains(t,e)})).each((function(e){e.color&&(d3.select(this).style("opacity",1),e.hasHighlight=!0)}))},i.prototype.renderTooltip=function(e){this.tooltipService.addTooltip(e,(function(e){return e.data.tooltipInfo}),(function(e){return e.data.identity}))},i.getTooltipData=function(e,i,a){return[{displayName:e,value:t.valueFormatter.format(i,a)}]},i.converter=function(a,r){var n=t.valueFormatter.getFormatString(a.matrix.valueSources[0],t.sunburstProps.general.formatString),o=t.dataLabelUtils.getDefaultSunburstLabelSettings(),s=null;if(a&&a.metadata&&a.metadata.objects){var l=a.metadata.objects.labels;t.dataLabelUtils.updateLabelSettingsFromLabelsObject(l,o),o.showCategory=e.DataViewObjects.getValue(a.metadata.objects,t.sunburstProps.categoryLabels.show,o.showCategory),s=a.metadata.objects.legend}var u="";a.matrix.rows.levels[0]&&a.matrix.rows.levels[0].sources[0]&&(u=a.matrix.rows.levels[0].sources[0].displayName);var c=[],d=i.convertRootNode(a.matrix.rows.root,n,r,c);return{root:d,dataLabelsSettings:o,legendData:{title:u,dataPoints:c,fontSize:t.SVGLegend.DefaultFontSizeInPt},legendObjectProperties:s}},i.createSunburstNode=function(e,i,a){var r;e.identity&&(i=i.concat([e.identity]),r={data:i});var n=i&&0===i.length?null:new t.SelectionId(r,(!1)),o=e.values?e.values[0].value:0,s={name:e.value,value:Math.max(o,0),identity:n,total:o,selected:!1,hasHighlight:!0,labelFormatString:a};return s},i.convertRootNode=function(e,a,r,n){var o=new t.ColorHelper(r,t.sunburstProps.dataPoint.fill),s=[],l=i.createSunburstNode(e,s,a);if(e.children&&e.children.length>0){l.children=[];for(var u=0,c=e.children;u<c.length;u++){var d=c[u],p=o.getColorForSeriesValue(d.objects,d.childIdentityFields,d.value),h=i.convertChildNodes(d,l,s,p,a);h.parent=l,l.total+=h.total,l.children.push(h),n.push({label:h.name,color:p,icon:t.LegendIcon.Box,identity:h.identity,selected:!1})}}return l},i.appendParentTooltipToChildren=function(e,t){for(var i=0,a=e.children;i<a.length;i++){var r=a[i];null!=r.tooltipInfo&&(n=r.tooltipInfo).push.apply(n,t),this.appendParentTooltipToChildren(r,t)}var n},i.convertChildNodes=function(e,t,a,r,n){var o=i.createSunburstNode(e,a,n);if(e.value&&(o.color=r),o.children=[],e.children&&e.children.length>0){for(var s=0,l=e.children;s<l.length;s++){var u=l[s],c=i.convertChildNodes(u,o,a,r,n);o.children.push(c),o.total+=c.total}o.tooltipInfo=i.getTooltipData(e.value,o.total,n),this.appendParentTooltipToChildren(o,o.tooltipInfo)}else e.values&&e.values[0].value&&(o.tooltipInfo=i.getTooltipData(e.value,e.values[0].value,n));return o.parent=t,o},i.getFillOpacity=function(e,t,a){return e.color?a?i.maxOpacity.toString():!t||e.selected?null:e.depth>1&&e.parent.selected?null:i.maxOpacity.toString():i.zeroOpacity.toString()},i.prototype.calculateSunburstSize=function(){var e=this.legend.getMargins();return{height:this.viewport.height-e.height,width:this.viewport.width-e.width}},i.prototype.updateViewport=function(){this.viewport=this.calculateSunburstSize(),t.Legend.positionChartArea(this.svg,this.legend),t.SVGUtil.flushAllD3TransitionsIfNeeded(this.options)},i.maxOpacity=1,i.minOpacity=.2,i.zeroOpacity=0,i.minChordLength=5,i.twoPI=2*Math.PI,i.SunburstClassName="sunburst",i.LabelClassName="label",i})();t.Sunburst=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.init=function(t){this.currentViewport=t.viewport;var i=$(e.baseTemplate);this.newsList=i.find("ul.newsList"),this.loadingPlaceholder=i.find(".loadingPlaceholder"),this.loadingPlaceholderText=i.find(".loadingPlaceholderText"),this.loadingPlaceholder.height(t.viewport.height),this.loadingPlaceholder.width(t.viewport.width),this.getLocalizedString=t.host.getLocalizedString,this.loadingPlaceholderText.text(this.getLocalizedString("Tile_LoadingText")),t.element.append(i),this.data=[]},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(t.length>0){var i=t[0].bingNews;this.data!==i&&(this.data=i,this.data.length>0?(this.loadingPlaceholder.hide(),this.updateInternal()):this.loadingPlaceholderText.text(this.getLocalizedString("BingNewsTile_NoResults")))}},e.prototype.onResizing=function(e){this.currentViewport.height===e.height&&this.currentViewport.width===e.width||(this.currentViewport=e,this.data.length>0?this.updateInternal():(this.loadingPlaceholder.height(e.height),this.loadingPlaceholder.width(e.width)))},e.prototype.updateInternal=function(){this.timerId&&(window.clearInterval(this.timerId),this.timerId=null),this.currentViewport.height<e.smallTileHeight?this.updateInternalForSmallTile():this.updateInternalForOtherTileSize()},e.prototype.updateInternalForSmallTile=function(){var t=this;this.isSmallTile=!0;var i=-1;this.data&&this.data.length>0&&(i=(i+1)%this.data.length,this.flipToItemAtIndex(i),this.timerId=window.setInterval((function(){var e=t.newsList.visible()&&"visible"===document.visibilityState;e&&(i=(i+1)%t.data.length,t.flipToItemAtIndex(i))}),e.flipTimeInMs))},e.prototype.updateInternalForOtherTileSize=function(){this.isSmallTile=!1,this.newsList.empty();for(var e=this.getNumberOfNews(),t=0;t<this.data.length&&t<e;t++){var i=this.createNewsItem(t);this.newsList.append(i)}},e.prototype.createNewsItem=function(t){var i=this.data[t];if(i){var a=moment(i.Date).fromNow(),r=$(e.listItemTemplate);return r.find(".headline").text(i.Title),r.find(".snippet").text(i.Description),r.find(".source").text(i.Source+" - "+a),r.find("a").attr("href",i.Url),r}},e.prototype.getNumberOfNews=function(){return this.currentViewport.height>e.mediumTileHeight?7:3;
},e.prototype.flipToItemAtIndex=function(e){var t=this,i=this.createNewsItem(e);this.newsList.velocity("transition.slideRightBigOut",(function(){t.isSmallTile&&(t.newsList.empty(),t.newsList.append(i))})).velocity("transition.slideLeftBigIn")},e.flipTimeInMs=1e4,e.smallTileHeight=100,e.mediumTileHeight=250,e.baseTemplate='<div class="bingNews"><div><div class="loadingPlaceholder"><div class="loadingPlaceholderText" ></div></div><ul class="newsList"></ul></div></div>',e.listItemTemplate='<li><a target="_blank"><div class="ms-font-m ms-font-color-neutralDark headline"></div><div class="ms-font-mi ms-font-color-neutralTertiary source"></div><div class="ms-font-mi ms-font-color-neutralSecondaryAlt snippet"></div></a></li>',e})();e.BingNews=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.init=function(t){this.currentViewport=t.viewport,this.$el=$(e.baseTemplate),this.newsList=this.$el.find(".bingSocialNewsList"),this.loadingPlaceholder=this.$el.find(".loadingPlaceholder"),this.loadingPlaceholderText=this.$el.find(".loadingPlaceholderText"),this.loadingPlaceholder.height(t.viewport.height),this.loadingPlaceholder.width(t.viewport.width),this.getLocalizedString=t.host.getLocalizedString,this.loadingPlaceholderText.text(this.getLocalizedString("Tile_LoadingText")),t.element.append(this.$el),this.data=[],this.addSizeClasses()},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(t.length>0){var i=t[0].bingSocial;this.data!==i&&(this.data=i,this.data.length>0?(this.loadingPlaceholder.hide(),this.updateInternal()):this.loadingPlaceholderText.text(this.getLocalizedString("BingSocialTile_NoResults")))}},e.prototype.onResizing=function(e){this.currentViewport.height===e.height&&this.currentViewport.width===e.width||(this.currentViewport=e,this.addSizeClasses(),this.data.length||this.loadingPlaceholder.height(e.height).width(e.width))},e.prototype.addSizeClasses=function(){this.addSizeClass("height"),this.addSizeClass("width")},e.prototype.addSizeClass=function(t){var i=e.tileDimensions[t];if(i){var a,r=this.currentViewport[t],n=i.length;for(a=2;a<=n;a++)this.$el.removeClass(t+a),this.$el.removeClass(t+a+"up");for(a=n;a>1;a--)if(r>=i[a-1]){this.$el.addClass(t+a);break}for(;a>1;)this.$el.addClass(t+a+"up"),a--}},e.prototype.updateInternal=function(){this.newsList.empty();for(var e=0,t=this.data;e<t.length;e++){var i=t[e],a=i.article?i.article:i.articles[0],r=this.fillInArticleTemplate(a);this.newsList.append(r)}},e.prototype.fillInArticleTemplate=function(t){var i=$(e.listItemTemplate),a=t.image&&t.image.thumbnail&&t.image.thumbnail.contentUrl;return a?(i.find(".js-storyLink").attr("href",t.url),i.find(".js-newsImage").css("background-image","url("+a+")"),i.find(".js-title").html(t.name),i.find(".js-description").html(t.description),i.find(".js-source").text(t.provider[0].name),i):null},e.tileDimensions={height:[100,280,460,640,820,1e3,1180].map((function(e){return e-90})),width:[230,490,750,1010,1270,1530,1790].map((function(e){return e-130}))},e.baseTemplate='<div class="bingSocialNews"><div><div class="bingSocialLoadingPlaceholder loadingPlaceholder"><div class="loadingPlaceholderText" ></div></div><ul class="bingSocialNewsList"></ul></div></div>',e.listItemTemplate='<li><div class="article"><div class="contentRight"><a class="storyLink js-storyLink" target="_blank"><div class="newsImage js-newsImage"></div><span class="title js-title"></span></a><p class="description js-description"></p></div><div class="source js-source"></div></div></li>',e})();e.BingSocialNews=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.init=function(t){this.currentViewport=t.viewport,this.$el=$(e.baseTemplate),this.tweetsList=this.$el.find(".bingSocialTweetsList"),this.loadingPlaceholder=this.$el.find(".loadingPlaceholder"),this.loadingPlaceholderText=this.$el.find(".loadingPlaceholderText"),this.loadingPlaceholder.height(t.viewport.height),this.loadingPlaceholder.width(t.viewport.width),this.getLocalizedString=t.host.getLocalizedString,this.loadingPlaceholderText.text(this.getLocalizedString("Tile_LoadingText")),t.element.append(this.$el),this.data=[],this.addSizeClasses()},e.prototype.onDataChanged=function(e){var t=e.dataViews;if(t.length>0){var i=t[0].bingSocial;this.data!==i&&(this.data=i,this.data.length>0?(this.loadingPlaceholder.hide(),this.updateInternal()):this.loadingPlaceholderText.text(this.getLocalizedString("BingSocialTile_NoResults")))}},e.prototype.onResizing=function(e){this.currentViewport.height===e.height&&this.currentViewport.width===e.width||(this.currentViewport=e,this.addSizeClasses(),this.data.length||this.loadingPlaceholder.height(e.height).width(e.width))},e.prototype.addSizeClasses=function(){this.addSizeClass("height"),this.addSizeClass("width")},e.prototype.addSizeClass=function(t){var i=e.tileDimensions[t];if(i){var a,r=this.currentViewport[t],n=i.length;for(a=2;a<=n;a++)this.$el.removeClass(t+a),this.$el.removeClass(t+a+"up");for(a=n;a>1;a--)if(r>=i[a-1]){this.$el.addClass(t+a);break}for(;a>1;)this.$el.addClass(t+a+"up"),a--}},e.prototype.updateInternal=function(){this.tweetsList.empty();for(var e=0,t=this.data;e<t.length;e++){var i=t[e],a=this.fillInTweetTemplate(i);this.tweetsList.append(a)}},e.prototype.fillInTweetTemplate=function(t){var i=$(e.listItemTemplate),a="https://www.twitter.com/",r=t.User,n=encodeURIComponent(t.IdStr),o=encodeURIComponent(r.ScreenName);return i.find(".js-nameLink").attr("href",a+o),i.find(".js-avatar").attr("src",r.ProfileImageUrlHttps),i.find(".js-name").text(r.Name),i.find(".js-screenName").text("@"+r.ScreenName),i.find(".js-createdAt").attr("href",a+o+"/status/"+n),i.find(".js-createdAt").text(moment(t.CreatedAt).fromNow()),i.find(".js-reply").attr("href",a+"intent/tweet?in_reply_to="+n),i.find(".js-retweet").attr("href",a+"intent/retweet?tweet_id="+n),i.find(".js-favorite").attr("href",a+"intent/favorite?tweet_id="+n),i.find(".js-retweetCount").text(t.RetweetCount+" Retweets"),e.augmentLinks(i.find(".js-text"),t),i},e.augmentLinks=function(t,i){var a=i.Entities,r=[i.Text];if(a){var n=a.Hashtags.map((function(e){return e.Text}));this.replaceTokens(r,n,e.hashtagRegexConstructor,(function(t){return e.createAnchorTag("#"+t,"https://www.twitter.com/hashtag/"+encodeURIComponent(t))}));var o=a.UserMentions.map((function(e){return e.ScreenName}));this.replaceTokens(r,o,e.userMentionRegexConstructor,(function(t){return e.createAnchorTag("@"+t,"https://www.twitter.com/"+encodeURIComponent(t))}));var s=a.Urls.map((function(e){return e.Url})),l=a.Media.map((function(e){return e.Url}));this.replaceTokens(r,s.concat(l),e.urlRegexConstructor,(function(t){return e.createAnchorTag(t,t)}))}for(var u=0,c=r;u<c.length;u++){var d=c[u];if("string"==typeof d){var p=$("<p></p>");p.html(d),t.append(p)}else t.append(d)}},e.createAnchorTag=function(e,t){var i=$('<a target="_blank"></a>');return i.text(e),i.attr("href",t),i},e.replaceTokens=function(t,i,a,r){if(i.length){for(var n=i.pop(),o=0;o<t.length;o++){var s=t[o];if("string"==typeof s){var l=_.escapeRegExp(n),u=a(l),c=s.split(u),d=[],p=c[0];if("undefined"!=typeof p){""!==p&&d.push(p);for(var h=1;h<c.length;h++)h%2===1?d.push(r(c[h])):d.push(c[h]);Array.prototype.splice.apply(t,[o,1].concat(d)),o+=d.length-1}}}return e.replaceTokens(t,i,a,r)}},e.hashtagRegexConstructor=function(e){return new RegExp("\\B#("+e+")\\b","ig")},e.userMentionRegexConstructor=function(e){return new RegExp("\\B@("+e+")\\b","ig")},e.urlRegexConstructor=function(e){return new RegExp("\\b("+e+")\\b","g")},e.tileDimensions={height:[100,280,460,640,820].map((function(e){return e-90})),width:[230,490,750,1010,1270].map((function(e){return e-130}))},e.baseTemplate='<div class="bingSocialTweets"><div class="bingSocialLoadingPlaceholder loadingPlaceholder"><div class="loadingPlaceholderText" ></div></div><ul class="bingSocialTweetsList"></ul></div>',e.listItemTemplate='<li><div class="tweet"><div class="contentRight"><div class="tweetHeader"><a class="nameLink js-nameLink" target="_blank"><img class="avatar js-avatar" /><span class="name js-name"></span><span class="screenName js-screenName"></span></a><a class="createdAt js-createdAt" target="_blank"></a></div><div class="text js-text"></div></div><div class="tweetFooter"><a class="tweetActionText tweetReply js-reply" target="_blank" title="Reply"></a><a class="tweetActionText tweetRetweet js-retweet" target="_blank" title="Retweet"></a><a class="tweetActionText tweetFavorite js-favorite" target="_blank" title="Favorite"></a><span class="retweetCount js-retweetCount"></span></div></div></li>',e})();e.BingSocialTweets=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.init=function(e){this.element=e.element},e.prototype.enumerateObjectInstances=function(e){return[]},e.prototype.update=function(e){var t=e.dataViews;if(t&&0!==t.length){var i=t[0];if(i&&i.metadata){var a=null;i.scriptResult&&i.scriptResult.payloadBase64&&(a="data:image/png;base64,"+i.scriptResult.payloadBase64),this.ensureHtmlElement();var r=this.ensureImageElement();a?r.attr("src",a):r.removeAttr("src"),this.onResizing(e.viewport,e.resizeMode||2)}}},e.prototype.onResizing=function(e,t){var i=this.ensureHtmlElement();i.css({height:e.height,width:e.width})},e.prototype.ensureHtmlElement=function(){var e=this.imageBackgroundElement;return e||(e=$("<div class='autoScaleImageContainer'/>"),this.imageBackgroundElement=e,this.imageBackgroundElement.appendTo(this.element)),e},e.prototype.ensureImageElement=function(){var e=this.imageElement;return e||(e=$("<img class='autoScaleImage'/>"),this.imageElement=e,this.imageElement.appendTo(this.imageBackgroundElement)),e},e})();e.ScriptVisual=t})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){t.animatedNumber={name:"animatedNumber",capabilities:e.capabilities.animatedNumber,create:function(){return new e.AnimatedNumber}},t.areaChart={name:"areaChart",watermarkKey:"area",capabilities:e.capabilities.areaChart,create:function(){return new e.CartesianChart({chartType:1})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.LineChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.barChart={name:"barChart",watermarkKey:"bar",capabilities:e.capabilities.barChart,create:function(){return new e.CartesianChart({chartType:6})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.basicShape={name:"basicShape",capabilities:e.basicShapeCapabilities,create:function(){return new e.BasicShapeVisual}},t.card={name:"card",watermarkKey:"card",capabilities:e.capabilities.card,create:function(){return new e.Card}},t.multiRowCard={name:"multiRowCard",watermarkKey:"multiRowCard",capabilities:e.capabilities.multiRowCard,create:function(){return new e.MultiRowCard},getSortableRoles:function(t){return e.MultiRowCard.getSortableRoles(t)}},t.clusteredBarChart={name:"clusteredBarChart",watermarkKey:"clusteredBar",capabilities:e.capabilities.clusteredBarChart,create:function(){return new e.CartesianChart({chartType:5})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.clusteredColumnChart={name:"clusteredColumnChart",watermarkKey:"clusteredColumn",capabilities:e.capabilities.clusteredColumnChart,create:function(){return new e.CartesianChart({chartType:3})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.columnChart={name:"columnChart",watermarkKey:"column",capabilities:e.capabilities.columnChart,create:function(){return new e.CartesianChart({chartType:4})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.comboChart={name:"comboChart",watermarkKey:"combo",capabilities:e.capabilities.comboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:10})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotChart={name:"dataDotChart",capabilities:e.capabilities.dataDotChart,create:function(){return new e.CartesianChart({chartType:11})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotClusteredColumnComboChart={name:"dataDotClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.dataDotClusteredColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:15})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.dataDotStackedColumnComboChart={name:"dataDotStackedColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.dataDotStackedColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:16})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.donutChart={name:"donutChart",watermarkKey:"donut",capabilities:e.capabilities.donutChart,create:function(){return new e.DonutChart}},t.funnel={name:"funnel",watermarkKey:"funnel",capabilities:e.capabilities.funnel,create:function(){return new e.FunnelChart}},t.gauge={name:"gauge",watermarkKey:"gauge",capabilities:e.capabilities.gauge,create:function(){return new e.Gauge}},t.hundredPercentStackedBarChart={name:"hundredPercentStackedBarChart",watermarkKey:"100stackedbar",capabilities:e.capabilities.hundredPercentStackedBarChart,create:function(){return new e.CartesianChart({chartType:7})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.hundredPercentStackedColumnChart={name:"hundredPercentStackedColumnChart",watermarkKey:"100stackedcolumn",capabilities:e.capabilities.hundredPercentStackedColumnChart,create:function(){return new e.CartesianChart({chartType:8})},customizeQuery:e.ColumnChart.customizeQuery,getSortableRoles:function(t){return e.ColumnChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.image={name:"image",capabilities:e.capabilities.image,create:function(){return new e.ImageVisual}},t.lineChart={name:"lineChart",watermarkKey:"line",capabilities:e.capabilities.lineChart,create:function(){return new e.CartesianChart({chartType:0})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.LineChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.lineStackedColumnComboChart={name:"lineStackedColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.lineStackedColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:14})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.lineClusteredColumnComboChart={name:"lineClusteredColumnComboChart",watermarkKey:"combo",capabilities:e.capabilities.lineClusteredColumnComboChart,customizeQuery:e.ComboChart.customizeQuery,create:function(){return new e.CartesianChart({chartType:13})},getSortableRoles:function(t){return e.ComboChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.map={name:"map",watermarkKey:"map",capabilities:e.capabilities.map,create:function(){return new e.Map({filledMap:!1})}},t.filledMap={name:"filledMap",watermarkKey:"filledMap",capabilities:e.capabilities.filledMap,create:function(){return new e.Map({filledMap:!0})}},t.shapeMap={name:"shapeMap",watermarkKey:"shapeMap",capabilities:e.capabilities.shapeMap,create:function(){return new e.ShapeMap}},t.treemap={name:"treemap",watermarkKey:"tree",capabilities:e.capabilities.treemap,create:function(){return new e.Treemap}},t.sunburst={name:"sunburst",watermarkKey:"defaultWatermark",capabilities:e.capabilities.sunburst,create:function(){return new e.Sunburst}},t.pieChart={name:"pieChart",watermarkKey:"pie",capabilities:e.capabilities.donutChart,create:function(){return new e.DonutChart({sliceWidthRatio:0})}},t.realTimeLineChart={name:"realTimeLineChart",watermarkKey:"line",capabilities:e.capabilities.realTimeLineChart,create:function(){return new e.CartesianChart({chartType:17})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.scatterChart={name:"scatterChart",watermarkKey:"scatterplot",capabilities:e.capabilities.scatterChart,create:function(){return new e.CartesianChart({chartType:9})},getAdditionalTelemetry:function(t){return e.ScatterChart.getAdditionalTelemetry(t)}},t.stackedAreaChart={name:"stackedAreaChart",watermarkKey:"stackedarea",capabilities:e.capabilities.stackedAreaChart,create:function(){return new e.CartesianChart({chartType:2})},customizeQuery:e.LineChart.customizeQuery,getSortableRoles:function(t){return e.LineChart.getSortableRoles(t)},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.table={name:"table",watermarkKey:"table",capabilities:e.capabilities.table,create:function(){return new e.Table},customizeQuery:e.Table.customizeQuery,getSortableRoles:function(t){return e.Table.getSortableRoles()}},t.matrix={name:"matrix",watermarkKey:"matrix",capabilities:e.capabilities.matrix,create:function(){return new e.Matrix},customizeQuery:e.Matrix.customizeQuery,getSortableRoles:function(t){return e.Matrix.getSortableRoles()}},t.slicer={name:"slicer",watermarkKey:"slicer",capabilities:e.capabilities.slicer,create:function(){return new e.Slicer},customizeQuery:e.Slicer.customizeQuery,getSortableRoles:e.Slicer.getSortableRoles,isCrossFilteredByDefault:e.Slicer.isCrossFilteredByDefault},t.textbox={name:"textbox",capabilities:e.capabilities.textbox,create:function(){return new e.Textbox}},t.waterfallChart={name:"waterfallChart",watermarkKey:"waterfall",capabilities:e.capabilities.waterfallChart,create:function(){return new e.CartesianChart({chartType:12})},getAdditionalTelemetry:function(t){return e.CartesianChart.getAdditionalTelemetry(t)}},t.cheerMeter={name:"cheerMeter",capabilities:e.CheerMeter.capabilities,create:function(){return new e.CheerMeter}},t.consoleWriter={name:"consoleWriter",capabilities:e.samples.consoleWriterCapabilities,create:function(){return new e.samples.ConsoleWriter}},t.helloIVisual={name:"helloIVisual",capabilities:e.samples.HelloIVisual.capabilities,create:function(){return new e.samples.HelloIVisual}},t.scriptVisual={name:"scriptVisual",watermarkKey:"scriptvisual",capabilities:e.capabilities.scriptVisual,create:function(){return new e.ScriptVisual}},t.kpi={name:"kpi",watermarkKey:"kpi",capabilities:e.capabilities.kpi,create:function(){return new e.KPIStatusWithHistory}}})(t=e.plugins||(e.plugins={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){t.bingNews={name:"bingNews",capabilities:e.capabilities.bingNews,create:function(){return new e.BingNews}},t.bingSocialTweets={name:"bingSocialTweets",capabilities:e.bingSocialTweetsCapabilities,create:function(){return new e.BingSocialTweets}},t.bingSocialNews={name:"bingSocialNews",capabilities:e.bingSocialNewsCapabilities,create:function(){return new e.BingSocialNews}},t.heatMap={name:"heatMap",capabilities:e.capabilities.map,create:function(){return new e.Map({filledMap:!1})}}})(t=e.plugins||(e.plugins={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(){return"#FFFFFF"}function i(){return{color:t()}}e.getDefaultColor=t,e.getDefaultValues=i})(t=e.CanvasBackgroundHelper||(e.CanvasBackgroundHelper={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=100,i=(function(){function e(e,i,a,r){this.scale=d3.time.scale().domain([e,i]).range([0,t]),this.value={min:a||e,max:r||i},this.setValue(this.value)}return e.prototype.getScaledValue=function(){return this.scaledValue},e.prototype.setValue=function(e){this.value=e,this.scaledValue={min:this.scale(e.min),max:this.scale(e.max)}},e.prototype.getValue=function(){return this.value},e.prototype.setScaledValue=function(e){this.scaledValue=e,this.value={min:this.scale.invert(e.min),max:this.scale.invert(e.max)}},e})();e.DateRange=i})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(e,t){var i,a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value;switch(e){case s.None:return{outlineColor:n.PropGridOutlineColor.defaultValue,gridColor:n.PropGridVerticalColor.defaultValue,gridVerticalEnabledTable:n.PropGridVertical.defaultValue,gridVerticalEnabledMatrix:n.PropGridVertical.defaultValue,gridHorizontalEnabledTable:n.PropGridHorizontalTable.defaultValue,gridHorizontalEnabledMatrix:n.PropGridHorizontalMatrix.defaultValue,rowPadding:n.PropGridRowPadding.defaultValue,fontColorHeaders:n.PropColumnsFontColor.defaultValue,backColorHeaders:n.PropColumnsBackColor.defaultValue,fontColorValues1:n.PropValuesFontColorPrimary.defaultValue,backColorValues1:n.PropValuesBackColorPrimary.defaultValue,fontColorValues2:n.PropValuesFontColorSecondary.defaultValue,backColorValues2:n.PropValuesBackColorSecondary.defaultValue,fontColorTotals:n.PropTotalFontColor.defaultValue,backColorTotals:n.PropTotalBackColor.defaultValue};case s.Minimal:return i=o.hexBlend(l,.12,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!0,gridHorizontalEnabledMatrix:!0,rowPadding:r.rowPaddingNormal,fontColorHeaders:l,backColorHeaders:a,fontColorValues1:l,backColorValues1:a,fontColorValues2:l,backColorValues2:a,fontColorTotals:l,backColorTotals:a};case s.BoldHeader:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=o.hexBlend(l,.12,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!0,gridHorizontalEnabledMatrix:!0,rowPadding:r.rowPaddingNormal,backColorHeaders:l,fontColorHeaders:a,fontColorValues1:l,backColorValues1:a,fontColorValues2:l,backColorValues2:a,fontColorTotals:l,backColorTotals:a};case s.AlternatingRows:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=o.hexBlend(l,.12,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!0,gridHorizontalEnabledMatrix:!0,rowPadding:r.rowPaddingNormal,fontColorHeaders:a,backColorHeaders:l,fontColorValues1:l,backColorValues1:a,fontColorValues2:l,backColorValues2:o.hexBlend(l,.08,a),fontColorTotals:a,backColorTotals:l};case s.ContrastAlternatingRows:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=o.hexBlend(l,.12,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!0,gridHorizontalEnabledMatrix:!0,rowPadding:r.rowPaddingNormal,fontColorHeaders:a,backColorHeaders:l,fontColorValues1:a,backColorValues1:o.hexBlend(l,.75,a),fontColorValues2:l,backColorValues2:o.hexBlend(l,.25,a),fontColorTotals:a,backColorTotals:l};case s.FlashyRows:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=a,{outlineColor:l,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!1,gridHorizontalEnabledMatrix:!1,rowPadding:r.rowPaddingNormal,fontColorHeaders:l,backColorHeaders:a,fontColorValues1:l,backColorValues1:o.hexBlend(u,.4,a),fontColorValues2:l,backColorValues2:o.hexBlend(u,.8,a),fontColorTotals:l,backColorTotals:a};case s.BoldHeaderFlashyRows:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=a,{outlineColor:a,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!1,gridHorizontalEnabledMatrix:!1,rowPadding:r.rowPaddingNormal,fontColorHeaders:a,backColorHeaders:l,fontColorValues1:l,backColorValues1:o.hexBlend(u,.4,a),fontColorValues2:l,backColorValues2:o.hexBlend(u,.8,a),fontColorTotals:a,backColorTotals:l};case s.Sparse:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=o.hexBlend(l,.2,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!1,gridVerticalEnabledMatrix:!1,gridHorizontalEnabledTable:!1,gridHorizontalEnabledMatrix:!1,rowPadding:r.rowPaddingSparse,fontColorHeaders:a,backColorHeaders:l,fontColorValues1:l,backColorValues1:a,fontColorValues2:l,backColorValues2:a,fontColorTotals:a,backColorTotals:l};case s.Condensed:return a=t.colorPalette.background.value,l=t.colorPalette.foreground.value,u=t.colorPalette.tableAccent.value,i=o.hexBlend(l,.2,a),{outlineColor:u,gridColor:i,gridVerticalEnabledTable:!0,gridVerticalEnabledMatrix:!0,gridHorizontalEnabledTable:!0,gridHorizontalEnabledMatrix:!0,rowPadding:r.rowPaddingCondensed,fontColorHeaders:a,backColorHeaders:l,fontColorValues1:l,backColorValues1:a,fontColorValues2:l,backColorValues2:a,fontColorTotals:a,backColorTotals:l};default:return}}var r,n=e.controls.internal.TablixObjects,o=a.Color;!(function(e){e.outlineWeight=n.PropGridOutlineWeight.defaultValue,e.columnsOutline=n.PropColumnsOutline.defaultValue,e.rowsOutline=n.PropRowsOutline.defaultValue,e.valuesOutline=n.PropValuesOutline.defaultValue,e.tableTotalOutline=n.PropTotalOutline.defaultValue,e.gridHorizontalWeight=n.PropGridHorizontalWeight.defaultValue,e.gridlineVerticalWeight=n.PropGridVerticalWeight.defaultValue,e.rowPaddingCondensed=0,e.rowPaddingNormal=3,e.rowPaddingSparse=6})(r=t.TablixStylePresetDefaults||(t.TablixStylePresetDefaults={}));var s;!(function(e){e.None="None",e.Minimal="Minimal",e.BoldHeader="BoldHeader",e.AlternatingRows="AlternatingRows",e.ContrastAlternatingRows="ContrastAlternatingRows",e.FlashyRows="FlashyRows",e.BoldHeaderFlashyRows="BoldHeaderFlashyRows",e.Sparse="Sparse",e.Condensed="Condensed"})(s=t.TablixStylePresetsName||(t.TablixStylePresetsName={})),t.getTablixStylePresetElements=i})(t=e.stylePresets||(e.stylePresets={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(e,i){var a=t.getTablixStylePresetElements(e,i);return a?{grid:[{properties:{outlineColor:s(a.outlineColor),outlineWeight:n.integer(o.valueOrDefault(a.outlineWeight,t.TablixStylePresetDefaults.outlineWeight)),gridVertical:n.boolean(a.gridVerticalEnabledTable),gridVerticalColor:s(a.gridColor),gridVerticalWeight:n.integer(o.valueOrDefault(a.gridVerticalWeight,t.TablixStylePresetDefaults.gridlineVerticalWeight)),gridHorizontal:n.boolean(a.gridHorizontalEnabledTable),gridHorizontalColor:s(a.gridColor),gridHorizontalWeight:n.integer(o.valueOrDefault(a.gridHorizontalWeight,t.TablixStylePresetDefaults.gridHorizontalWeight)),rowPadding:n.integer(a.rowPadding)}}],columnHeaders:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeColumnHeaders,t.TablixStylePresetDefaults.columnsOutline)),fontColor:s(a.fontColorHeaders),backColor:s(a.backColorHeaders)}}],values:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeValues,t.TablixStylePresetDefaults.valuesOutline)),fontColorPrimary:s(a.fontColorValues1),backColorPrimary:s(a.backColorValues1),fontColorSecondary:s(a.fontColorValues2),backColorSecondary:s(a.backColorValues2)}}],total:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeTotals,t.TablixStylePresetDefaults.tableTotalOutline)),fontColor:s(a.fontColorTotals),backColor:s(a.backColorTotals)}}]}:{}}function r(){return{sectionTitle:e.data.createDisplayNameGetter("Visual_Table_StylePreset_SectionTitle"),sliceTitle:e.data.createDisplayNameGetter("Visual_Table_StylePreset_SliceTitle"),defaultPresetName:t.TablixStylePresetsName.None,presets:(a={},a[t.TablixStylePresetsName.None]={name:t.TablixStylePresetsName.None,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_None"),evaluate:function(e){return i(t.TablixStylePresetsName.None,e)}},a[t.TablixStylePresetsName.Minimal]={name:t.TablixStylePresetsName.Minimal,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Minimal"),evaluate:function(e){return i(t.TablixStylePresetsName.Minimal,e)}},a[t.TablixStylePresetsName.BoldHeader]={name:t.TablixStylePresetsName.BoldHeader,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_BoldHeader"),evaluate:function(e){return i(t.TablixStylePresetsName.BoldHeader,e)}},a[t.TablixStylePresetsName.AlternatingRows]={name:t.TablixStylePresetsName.AlternatingRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_AlternatingRows"),evaluate:function(e){return i(t.TablixStylePresetsName.AlternatingRows,e)}},a[t.TablixStylePresetsName.ContrastAlternatingRows]={name:t.TablixStylePresetsName.ContrastAlternatingRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_ContrastAlternatingRows"),evaluate:function(e){return i(t.TablixStylePresetsName.ContrastAlternatingRows,e)}},a[t.TablixStylePresetsName.FlashyRows]={name:t.TablixStylePresetsName.FlashyRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_FlashyRows"),evaluate:function(e){return i(t.TablixStylePresetsName.FlashyRows,e)}},a[t.TablixStylePresetsName.BoldHeaderFlashyRows]={name:t.TablixStylePresetsName.BoldHeaderFlashyRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_BoldHeaderFlashyRows"),evaluate:function(e){return i(t.TablixStylePresetsName.BoldHeaderFlashyRows,e)}},a[t.TablixStylePresetsName.Sparse]={name:t.TablixStylePresetsName.Sparse,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Sparse"),evaluate:function(e){return i(t.TablixStylePresetsName.Sparse,e)}},a[t.TablixStylePresetsName.Condensed]={name:t.TablixStylePresetsName.Condensed,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Condensed"),evaluate:function(e){return i(t.TablixStylePresetsName.Condensed,e)}},a)};var a}var n=e.data.SQExprBuilder,o=a.Utility,s=e.fillDefinitionHelpers.createSolidFillDefinition;
t.tableStylePresets=r})(i=t.stylePresets||(t.stylePresets={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(e,i){var a=t.getTablixStylePresetElements(e,i);return a?{grid:[{properties:{outlineColor:s(a.outlineColor),outlineWeight:n.integer(o.valueOrDefault(a.outlineWeight,t.TablixStylePresetDefaults.outlineWeight)),gridVertical:n.boolean(a.gridVerticalEnabledMatrix),gridVerticalColor:s(a.gridColor),gridVerticalWeight:n.integer(o.valueOrDefault(a.gridVerticalWeight,t.TablixStylePresetDefaults.gridlineVerticalWeight)),gridHorizontal:n.boolean(a.gridHorizontalEnabledMatrix),gridHorizontalColor:s(a.gridColor),gridHorizontalWeight:n.integer(o.valueOrDefault(a.gridHorizontalWeight,t.TablixStylePresetDefaults.gridHorizontalWeight)),rowPadding:n.integer(a.rowPadding)}}],columnHeaders:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeColumnHeaders,t.TablixStylePresetDefaults.columnsOutline)),fontColor:s(a.fontColorHeaders),backColor:s(a.backColorHeaders)}}],rowHeaders:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeRowHeaders,t.TablixStylePresetDefaults.rowsOutline)),fontColor:s(a.fontColorHeaders),backColor:s(a.backColorHeaders)}}],values:[{properties:{outline:n.text(o.valueOrDefault(a.outlineModeValues,t.TablixStylePresetDefaults.valuesOutline)),fontColorPrimary:s(a.fontColorValues1),backColorPrimary:s(a.backColorValues1),fontColorSecondary:s(a.fontColorValues2),backColorSecondary:s(a.backColorValues2)}}],subTotals:[{properties:{fontColor:void 0,backColor:void 0}}],total:[{properties:{fontColor:s(a.fontColorTotals),backColor:s(a.backColorTotals),applyToHeaders:n.boolean(!1)}}]}:{}}function r(){return{sectionTitle:e.data.createDisplayNameGetter("Visual_Matrix_StylePreset_SectionTitle"),sliceTitle:e.data.createDisplayNameGetter("Visual_Table_StylePreset_SliceTitle"),defaultPresetName:t.TablixStylePresetsName.None,presets:(a={},a[t.TablixStylePresetsName.None]={name:t.TablixStylePresetsName.None,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_None"),evaluate:function(e){return i(t.TablixStylePresetsName.None,e)}},a[t.TablixStylePresetsName.Minimal]={name:t.TablixStylePresetsName.Minimal,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Minimal"),evaluate:function(e){return i(t.TablixStylePresetsName.Minimal,e)}},a[t.TablixStylePresetsName.BoldHeader]={name:t.TablixStylePresetsName.BoldHeader,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_BoldHeader"),evaluate:function(e){return i(t.TablixStylePresetsName.BoldHeader,e)}},a[t.TablixStylePresetsName.AlternatingRows]={name:t.TablixStylePresetsName.AlternatingRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_AlternatingRows"),evaluate:function(e){return i(t.TablixStylePresetsName.AlternatingRows,e)}},a[t.TablixStylePresetsName.ContrastAlternatingRows]={name:t.TablixStylePresetsName.ContrastAlternatingRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_ContrastAlternatingRows"),evaluate:function(e){return i(t.TablixStylePresetsName.ContrastAlternatingRows,e)}},a[t.TablixStylePresetsName.FlashyRows]={name:t.TablixStylePresetsName.FlashyRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_FlashyRows"),evaluate:function(e){return i(t.TablixStylePresetsName.FlashyRows,e)}},a[t.TablixStylePresetsName.BoldHeaderFlashyRows]={name:t.TablixStylePresetsName.BoldHeaderFlashyRows,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_BoldHeaderFlashyRows"),evaluate:function(e){return i(t.TablixStylePresetsName.BoldHeaderFlashyRows,e)}},a[t.TablixStylePresetsName.Sparse]={name:t.TablixStylePresetsName.Sparse,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Sparse"),evaluate:function(e){return i(t.TablixStylePresetsName.Sparse,e)}},a[t.TablixStylePresetsName.Condensed]={name:t.TablixStylePresetsName.Condensed,displayName:e.data.createDisplayNameGetter("Visual_Table_StylePreset_Condensed"),evaluate:function(e){return i(t.TablixStylePresetsName.Condensed,e)}},a)};var a}var n=e.data.SQExprBuilder,o=a.Utility,s=e.fillDefinitionHelpers.createSolidFillDefinition;t.matrixStylePresets=r})(i=t.stylePresets||(t.stylePresets={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){},function(e,t){var e;(e||{}).exports=window.renderjson=(function(){function e(c,d,p,h,g,f){var m=p?"":d,y=function(e,r,l,c,d){var p,g=o(c),f=function(){p||i(g.parentNode,p=a(d(),s(u.hide,"disclosure",(function(){p.style.display="none",g.style.display="inline"})))),p.style.display="inline",g.style.display="none"};i(g,s(u.show,"disclosure",f),t(c+" syntax",e),s(r,null,f),t(c+" syntax",l));var y=i(o(),n(m.slice(0,-1)),g);return h>0&&f(),y};return null===c?t(null,m,"keyword","null"):void 0===c?t(null,m,"keyword","undefined"):"string"==typeof c&&c.length>g?y('"',c.substr(0,g)+" ...",'"',"string",(function(){return i(o("string"),t(null,m,"string",JSON.stringify(c)))})):u.js_mode&&"function"==typeof c?y("function() {","...","}","function",(function(){var e=c.toString().match(/^([^{]*{)([\s\S]*)(})\s?$/),a=e&&e[1]?e[1]:"function() {",r=e&&e[2]?e[2]:"";return i(o("function"),t("function syntax",a,null,"\n"),t(null,d,"function",r),n("\n"),t(null,d,"function syntax","}"))})):"object"!=typeof c?t(null,m,typeof c,JSON.stringify(c)):c.constructor==Array?0==c.length?t(null,m,"array syntax","[]"):y("["," ... ","]","array",(function(){for(var a=i(o("array"),t("array syntax","[",null,"\n")),r=0;r<c.length;r++)i(a,e(c[r],d+"    ",!1,h-1,g,f),r!=c.length-1?t("syntax",","):[],n("\n"));return i(a,t(null,d,"array syntax","]")),a})):(u.js_mode&&(c=l(c)),r(c)?t(null,m,"object syntax","{}"):y("{","...","}","object",(function(){var a=i(o("object"),t("object syntax","{",null,"\n"));for(var r in c)var s=r;var l=Object.keys(c);f&&(l=l.sort());for(var u in l){var r=l[u];i(a,t(null,d+"    ","key",'"'+r+'"',"object syntax",": "),e(c[r],d+"    ",!0,h-1,g,f),r!=s?t("syntax",","):[],n("\n"))}return i(a,t(null,d,"object syntax","}")),a})))}var t=function(){for(var e=[];arguments.length;)e.push(i(o(Array.prototype.shift.call(arguments)),n(Array.prototype.shift.call(arguments))));return e},i=function(){for(var e=Array.prototype.shift.call(arguments),t=0;t<arguments.length;t++)arguments[t].constructor==Array?i.apply(this,[e].concat(arguments[t])):e.appendChild(arguments[t]);return e},a=function(e,t){return e.insertBefore(t,e.firstChild),e},r=function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0},n=function(e){return document.createTextNode(e)},o=function(e){var t=document.createElement("span");return e&&(t.className=e),t},s=function(e,t,i){var a=document.createElement("a");return t&&(a.className=t),a.appendChild(n(e)),a.href="#",a.onclick=function(e){return i(),e&&e.stopPropagation(),!1},a},l=function(e){for(var t={},i=e;null!=i;i=Object.getPrototypeOf(i))for(var a=Object.getOwnPropertyNames(i),r=0;r<a.length;r++){var n=a[r];"undefined"==typeof t[n]&&(t[n]=e[n])}return t},u=function t(a){var r=i(document.createElement("pre"),e(a,"",!1,t.show_to_level,t.max_string_length,t.sort_objects));return r.className="renderjson",r};return u.set_js_mode=function(e){return u.js_mode=e,u},u.set_icons=function(e,t){return u.show=e,u.hide=t,u},u.set_show_to_level=function(e){return u.show_to_level="string"==typeof e&&"all"===e.toLowerCase()?Number.MAX_VALUE:e,u},u.set_max_string_length=function(e){return u.max_string_length="string"==typeof e&&"none"===e.toLowerCase()?Number.MAX_VALUE:e,u},u.set_sort_objects=function(e){return u.sort_objects=e,u},u.set_show_by_default=function(e){return u.show_to_level=e?Number.MAX_VALUE:0,u},u.set_icons("",""),u.set_show_by_default(!1),u.set_sort_objects(!1),u.set_max_string_length("none"),u.set_js_mode(!1),u})(),!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(t){var i=(function(){function t(e){var t=this.container=$("<div>");t.addClass("jsonViewScrollPane"),$(e.element).append(t),renderjson.set_js_mode(!0)}return t.prototype.update=function(t){t.type&e.VisualUpdateType.Data&&this.container.empty().append(renderjson(t.dataViews))},t})();t.Visual=i})(i=t.dataViewer||(t.dataViewer={}))})(i=t.visual||(t.visual={}))})(t=e.extensibility||(e.extensibility={}))})(powerbi||(powerbi={})),!(function(e){var t;!(function(t){var i;!(function(t){t.dataViewer={name:"dataViewer",displayName:"data viewer",class:"Visual",version:"1.0.0",apiVersion:"1.0.0",create:function(t){return new e.extensibility.visual.dataViewer.Visual(t)},custom:!0}})(i=t.plugins||(t.plugins={}))})(t=e.visuals||(e.visuals={}))})(powerbi||(powerbi={}))},,,,,function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.Grouping=0]="Grouping",e[e.Measure=1]="Measure",e[e.GroupingOrMeasure=2]="GroupingOrMeasure"})(e.VisualDataRoleKind||(e.VisualDataRoleKind={}));e.VisualDataRoleKind;!(function(e){e[e.Create=0]="Create",e[e.Append=1]="Append"})(e.VisualDataChangeOperationKind||(e.VisualDataChangeOperationKind={}));e.VisualDataChangeOperationKind;!(function(e){e[e.Data=2]="Data",e[e.Resize=4]="Resize",e[e.ViewMode=8]="ViewMode",e[e.Style=16]="Style",e[e.ResizeEnd=32]="ResizeEnd",e[e.All=62]="All"})(e.VisualUpdateType||(e.VisualUpdateType={}));e.VisualUpdateType;!(function(e){})(e.VisualPermissions||(e.VisualPermissions={}));e.VisualPermissions})(i||(i={}))},,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,function(e,t){},function(e,t){},function(e,t){},,,,function(e,t){},,,function(e,t){},,,,function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;window.jsCommon=window.jsCommon||{},window.powerbi=window.powerbi||{},window.debug=window.debug||{},window.InJs=window.InJs||{},i(405)},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;i(406),i(407),i(408),i(409),i(410),i(411),i(412),i(413),i(414),i(415),i(416),i(417),i(418),i(76),i(419),i(77),i(420),i(78),i(79),i(421),i(422),i(423),i(424),i(425),i(426),i(427),i(428),i(429),i(430),i(431),i(432),i(433),i(80),i(81),i(434),i(435),i(82),i(436),i(428),i(437),i(438),i(439),i(440)},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.escKeyCode=27,e.enterKeyCode=13,e.tabKeyCode=9,e.upArrowKeyCode=38,e.downArrowKeyCode=40,e.leftArrowKeyCode=37,e.rightArrowKeyCode=39,e.homeKeyCode=36,e.endKeyCode=35,e.backSpaceKeyCode=8,e.deleteKeyCode=46,e.spaceKeyCode=32,e.shiftKeyCode=16,e.ctrlKeyCode=17,e.altKeyCode=18,e.aKeyCode=65,e.cKeyCode=67,e.sKeyCode=83,e.vKeyCode=86,e.wKeyCode=87,e.xKeyCode=88,e.yKeyCode=89,e.zKeyCode=90,e.DocumentBody="body",e.Anchor="a",e.EditableTextElements=":text, textarea",e.EditableNumericElements='[type="number"]',e.disabledAttributeOrValue="disabled",e.readonlyAttributeOrValue="readonly",e.idAttribute="id",e.styleAttribute="style",e.hrefAttribute="href",e.targetAttribute="target",e.blankValue="_blank",e.selfValue="_self",e.classAttribute="class",e.titleAttribute="title",e.srcAttribute="src",e.contextmenuEventName="contextmenu",e.blurEventName="blur",e.keyUpEventName="keyup",e.inputEventName="input",e.changeEventName="change",e.cutEventName="cut",e.keyDownEventName="keydown",e.mouseMoveEventName="mousemove",e.mouseDownEventName="mousedown",e.mouseEnterEventName="mouseenter",e.mouseLeaveEventName="mouseleave",e.mouseOverEventName="mouseover",e.mouseOutEventName="mouseout",e.mouseClickEventName="click",e.pasteEventName="paste",e.scrollEventName="scroll",e.dropEventName="drop",e.focusEventName="focus",e.focusInEventName="focusin",e.focusOutEventName="focusout",e.selectEventName="select",e.messageEventName="message",e.loadEventName="load",e.beforeUnload="beforeunload",e.inputAndSelectEventNames="input, select"})(t=e.DOMConstants||(e.DOMConstants={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){e.RS_AccessDeniedDueToRLSGroup="rsAccessDeniedDueToRLSGroup",e.RS_CannotRetrieveModel="rsCannotRetrieveModel",e.DMTS_NoGatewayWithAllDatasourcesToBindError="DMTS_NoGatewayWithAllDatasourcesToBindError",e.DM_GWPipeline_UnknownError="DM_GWPipeline_UnknownError",e.PBID_AccessDenied="pbidAccessDenied",(function(e){e[e.ResourceCodeReference=0]="ResourceCodeReference",e[e.EmbeddedString=1]="EmbeddedString"})(e.PowerBIErrorResourceType||(e.PowerBIErrorResourceType={}));var t=e.PowerBIErrorResourceType,i=(function(){function e(e){this.m_serviceError=e}return Object.defineProperty(e.prototype,"code",{get:function(){return e.codeName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.httpRequestId},set:function(e){this.httpRequestId=e},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t;return t=6===this.m_serviceError.statusCode?a.GetDetailsFromTransformError(e,this.m_serviceError):a.GetDetailsFromServerError(e,this.m_serviceError),a.addAdditionalInfo(t,this.m_serviceError.errorDetails,e),a.addDebugErrorInfo(t,this.code,this.m_serviceError.message||null,this.m_serviceError.stackTrace||null,this.httpRequestId),t},e.codeName="ServiceErrorToClientError",e})();e.ServiceErrorToClientError=i;var a=(function(){function i(){}return i.addAdditionalInfo=function(e,a,r){if(a)for(var n=0;n<a.length;n++){var o=a[n],s=r.getOptional(i.serverErrorPrefix+o.code),l={errorInfoKey:s?s:o.code,errorInfoValue:o.detail.type===t.ResourceCodeReference?r.get(i.serverErrorPrefix+o.detail.value):o.detail.value};e.displayableErrorInfo.push(l)}return e},i.addDebugErrorInfo=function(t,i,a,r,n){return t.debugErrorInfo=t.debugErrorInfo||[],n&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.HttpRequestId,errorInfoValue:n}),i&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.ClientErrorCode,errorInfoValue:i}),a&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.ErrorDetails,errorInfoValue:a}),r&&t.debugErrorInfo.push({errorInfoKey:e.ClientErrorStrings.StackTrace,errorInfoValue:r}),t},i.GetDetailsFromTransformError=function(e,t){var i=e.get("ServiceError_CannotLoadVisual"),a=e.get("ServiceError_CannotLoadVisual"),r=t.message,n=[];n.push({errorInfoKey:a,errorInfoValue:r});var o={message:i,displayableErrorInfo:n};return o},i.GetDetailsFromServerError=function(t,i){var a="",r="",n="",o=!1;switch(i.errorCode){case e.RS_AccessDeniedDueToRLSGroup:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelFetchingFailureKey"),n=t.get("DsrError_NoPermissionDueToRLSGroupMessage"),o=!0;break;case e.RS_CannotRetrieveModel:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelFetchingFailureKey"),n=t.get("DsrError_CanNotRetrieveModelMessage"),o=!0;break;case e.DMTS_NoGatewayWithAllDatasourcesToBindError:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelFetchingFailureKey"),n=t.get("ServerError_DM_GWPipeline_Gateway_DataSourceConnectionError"),o=!0;break;case e.DM_GWPipeline_UnknownError:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelFetchingFailureKey"),n=t.get("ServerError_DM_GWPipeline_Client_GatewayUnreachable"),o=!0;break;case e.PBID_AccessDenied:a=t.get("ServiceError_CannotLoadVisual"),r=t.get("ServiceError_AuthenticationErrorKey"),n=t.get("ServiceError_AuthenticationErrorValue"),o=!0}if(!o)switch(i.statusCode){case 2:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelConvertFailureKey"),n=t.get("ServiceError_ModelConvertFailureValue");break;case 3:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelCreationFailureKey"),n=t.get("ServiceError_ModelCreationFailureValue");break;case 1:a=t.get("ServiceError_ModelCannotLoad"),r=t.get("ServiceError_ModelFetchingFailureKey"),n=t.get("ServiceError_ModelFetchingFailureValue");break;case 4:a=t.get("ServiceError_CannotLoadVisual"),r=t.get("ServiceError_ExecuteSemanticQueryErrorKey"),n=t.get("ServiceError_ExecuteSemanticQueryErrorValue");break;case 5:a=t.get("ServiceError_CannotLoadVisual"),r=t.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatKey"),n=t.get("ServiceError_ExecuteSemanticQueryInvalidStreamFormatValue");break;case 0:default:a=t.get("ServiceError_GeneralError"),r=t.get("ServiceError_GeneralErrorKey"),n=t.get("ServiceError_GeneralErrorValue")}var s=[];s.push({errorInfoKey:r,errorInfoValue:n});var l={message:a,displayableErrorInfo:s};return l},i.serverErrorPrefix="ServerError_",i})();e.PowerBIErrorDetailHelper=a})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(e){return new a(e)}e.CategoryTypes={Address:"Address",City:"City",Continent:"Continent",CountryRegion:"Country",County:"County",Longitude:"Longitude",Latitude:"Latitude",Place:"Place",PostalCode:"PostalCode",StateOrProvince:"StateOrProvince"},e.createGeoTaggingAnalyzerService=t;var i={GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Longitude_Short2:"long",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories",GeotaggingString_VRMBackCompat_CountryRegion:"CountryRegion",GeotaggingString_VRMBackCompat_StateOrProvince:"StateOrProvince"},a=(function(){function t(e){this.GeotaggingString_VRMBackCompat_CountryRegion="CountryRegion",this.GeotaggingString_VRMBackCompat_StateOrProvince="StateOrProvince",this.GeotaggingString_Continent=e("GeotaggingString_Continent").toLowerCase(),this.GeotaggingString_Continents=e("GeotaggingString_Continents").toLowerCase(),this.GeotaggingString_Country=e("GeotaggingString_Country").toLowerCase(),this.GeotaggingString_Countries=e("GeotaggingString_Countries").toLowerCase(),this.GeotaggingString_State=e("GeotaggingString_State").toLowerCase(),this.GeotaggingString_States=e("GeotaggingString_States").toLowerCase(),this.GeotaggingString_City=e("GeotaggingString_City").toLowerCase(),this.GeotaggingString_Cities=e("GeotaggingString_Cities").toLowerCase(),this.GeotaggingString_Town=e("GeotaggingString_Town").toLowerCase(),this.GeotaggingString_Towns=e("GeotaggingString_Towns").toLowerCase(),this.GeotaggingString_Province=e("GeotaggingString_Province").toLowerCase(),this.GeotaggingString_Provinces=e("GeotaggingString_Provinces").toLowerCase(),this.GeotaggingString_County=e("GeotaggingString_County").toLowerCase(),this.GeotaggingString_Counties=e("GeotaggingString_Counties").toLowerCase(),this.GeotaggingString_Village=e("GeotaggingString_Village").toLowerCase(),this.GeotaggingString_Villages=e("GeotaggingString_Villages").toLowerCase(),this.GeotaggingString_Post=e("GeotaggingString_Post").toLowerCase(),this.GeotaggingString_Zip=e("GeotaggingString_Zip").toLowerCase(),this.GeotaggingString_Code=e("GeotaggingString_Code").toLowerCase(),this.GeotaggingString_Place=e("GeotaggingString_Place").toLowerCase(),this.GeotaggingString_Places=e("GeotaggingString_Places").toLowerCase(),this.GeotaggingString_Address=e("GeotaggingString_Address").toLowerCase(),this.GeotaggingString_Addresses=e("GeotaggingString_Addresses").toLowerCase(),this.GeotaggingString_Street=e("GeotaggingString_Street").toLowerCase(),this.GeotaggingString_Streets=e("GeotaggingString_Streets").toLowerCase(),this.GeotaggingString_Longitude=e("GeotaggingString_Longitude").toLowerCase(),this.GeotaggingString_Longitude_Short=e("GeotaggingString_Longitude_Short").toLowerCase(),this.GeotaggingString_Longitude_Short2=e("GeotaggingString_Longitude_Short2").toLowerCase(),this.GeotaggingString_Latitude=e("GeotaggingString_Latitude").toLowerCase(),this.GeotaggingString_Latitude_Short=e("GeotaggingString_Latitude_Short").toLowerCase(),this.GeotaggingString_PostalCode=e("GeotaggingString_PostalCode").toLowerCase(),this.GeotaggingString_PostalCodes=e("GeotaggingString_PostalCodes").toLowerCase(),this.GeotaggingString_ZipCode=e("GeotaggingString_ZipCode").toLowerCase(),this.GeotaggingString_ZipCodes=e("GeotaggingString_ZipCodes").toLowerCase(),this.GeotaggingString_Territory=e("GeotaggingString_Territory").toLowerCase(),this.GeotaggingString_Territories=e("GeotaggingString_Territories").toLowerCase()}return t.prototype.isLongitudeOrLatitude=function(e){return this.isLongitude(e)||this.isLatitude(e)},t.prototype.isGeographic=function(e){return this.isLongitudeOrLatitude(e)||this.isGeocodable(e)},t.prototype.isGeocodable=function(e){return this.isAddress(e)||this.isCity(e)||this.isContinent(e)||this.isCountry(e)||this.isCounty(e)||this.isStateOrProvince(e)||this.isPlace(e)||this.isPostalCode(e)||this.isTerritory(e)},t.prototype.isGeoshapable=function(e){return this.isCity(e)||this.isCountry(e)||this.isCounty(e)||this.isStateOrProvince(e)||this.isPostalCode(e)||this.isTerritory(e)||this.isGeoshapableEnglish(e)},t.prototype.isGeoshapableEnglish=function(e){return this.isEnglishCity(e)||this.isEnglishCountry(e)||this.isEnglishCounty(e)||this.isEnglishStateOrProvince(e)||this.isEnglishPostalCode(e)||this.isEnglishTerritory(e)},t.prototype.isAddress=function(e){return t.hasMatches(e,[this.GeotaggingString_Address,this.GeotaggingString_Addresses,this.GeotaggingString_Street,this.GeotaggingString_Streets])},t.prototype.isPlace=function(e){return t.hasMatches(e,[this.GeotaggingString_Place,this.GeotaggingString_Places])},t.prototype.isCity=function(e){return t.hasMatches(e,[this.GeotaggingString_City,this.GeotaggingString_Cities,this.GeotaggingString_Town,this.GeotaggingString_Towns,this.GeotaggingString_Village,this.GeotaggingString_Villages])},t.prototype.isStateOrProvince=function(e){return t.hasMatches(e,[this.GeotaggingString_State,this.GeotaggingString_States,this.GeotaggingString_Province,this.GeotaggingString_Provinces,this.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isCountry=function(e){return t.hasMatches(e,[this.GeotaggingString_Country,this.GeotaggingString_Countries,this.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isCounty=function(e){return t.hasMatches(e,[this.GeotaggingString_County,this.GeotaggingString_Counties])},t.prototype.isContinent=function(e){return t.hasMatches(e,[this.GeotaggingString_Continent,this.GeotaggingString_Continents])},t.prototype.isPostalCode=function(e){var i=t.hasMatches(e,[this.GeotaggingString_Post,this.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[this.GeotaggingString_PostalCode,this.GeotaggingString_PostalCodes,this.GeotaggingString_ZipCode,this.GeotaggingString_ZipCodes]);if(!i){var a=/\s+/,r=e.replace(a,"");i=t.hasMatches(r,[this.GeotaggingString_PostalCode.replace(a,""),this.GeotaggingString_PostalCodes.replace(a,""),this.GeotaggingString_ZipCode.replace(a,""),this.GeotaggingString_ZipCodes.replace(a,"")])}return i},t.prototype.isLongitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Longitude])||t.hasMatches(e,[this.GeotaggingString_Longitude_Short],!0)||t.hasMatches(e,[this.GeotaggingString_Longitude_Short2],!0)},t.prototype.isLatitude=function(e){return t.hasMatches(e,[this.GeotaggingString_Latitude])||t.hasMatches(e,[this.GeotaggingString_Latitude_Short],!0)},t.prototype.isTerritory=function(e){return t.hasMatches(e,[this.GeotaggingString_Territory,this.GeotaggingString_Territories])},t.hasMatches=function(e,t,i){for(var a=/\W/,r=e.toLowerCase(),n=0,o=t.length;n<o;n++){var s=t[n].toLowerCase();if(i){var l=r.indexOf(s);if(l>-1){var u=void 0,c=void 0;if(u=c=!0,l-1>0&&(c=a.test(r[l-1])),l+s.length<r.length&&(u=a.test(r[l+s.length])),c&&u)return!0}}else if(r.indexOf(s)>-1)return!0}return!1},t.prototype.getFieldType=function(t){if(null!=t)return this.isLatitude(t)?e.CategoryTypes.Latitude:this.isLongitude(t)?e.CategoryTypes.Longitude:this.isPostalCode(t)?e.CategoryTypes.PostalCode:this.isAddress(t)?e.CategoryTypes.Address:this.isPlace(t)?e.CategoryTypes.Place:this.isCity(t)?e.CategoryTypes.City:this.isCountry(t)?e.CategoryTypes.CountryRegion:this.isCounty(t)?e.CategoryTypes.County:this.isStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isContinent(t)?e.CategoryTypes.Continent:this.getEnglishFieldType(t)},t.prototype.getFieldTypeFromDescriptor=function(t){if(null!=t&&null!=t.geography){var i=t.geography;return i.latitude?e.CategoryTypes.Latitude:i.longitude?e.CategoryTypes.Longitude:i.postalCode?e.CategoryTypes.PostalCode:i.address?e.CategoryTypes.Address:i.place?e.CategoryTypes.Place:i.city?e.CategoryTypes.City:i.country?e.CategoryTypes.CountryRegion:i.county?e.CategoryTypes.County:i.stateOrProvince?e.CategoryTypes.StateOrProvince:i.continent?e.CategoryTypes.Continent:void 0}},t.prototype.isEnglishAddress=function(e){return t.hasMatches(e,[i.GeotaggingString_Address,i.GeotaggingString_Addresses,i.GeotaggingString_Street,i.GeotaggingString_Streets])},t.prototype.isEnglishPlace=function(e){return t.hasMatches(e,[i.GeotaggingString_Place,i.GeotaggingString_Places])},t.prototype.isEnglishCity=function(e){return t.hasMatches(e,[i.GeotaggingString_City,i.GeotaggingString_Cities,i.GeotaggingString_Town,i.GeotaggingString_Towns,i.GeotaggingString_Village,i.GeotaggingString_Villages])},t.prototype.isEnglishStateOrProvince=function(e){return t.hasMatches(e,[i.GeotaggingString_State,i.GeotaggingString_States,i.GeotaggingString_Province,i.GeotaggingString_Provinces,i.GeotaggingString_VRMBackCompat_StateOrProvince])},t.prototype.isEnglishCountry=function(e){return t.hasMatches(e,[i.GeotaggingString_Country,i.GeotaggingString_Countries,i.GeotaggingString_VRMBackCompat_CountryRegion])},t.prototype.isEnglishCounty=function(e){return t.hasMatches(e,[i.GeotaggingString_County,i.GeotaggingString_Counties])},t.prototype.isEnglishContinent=function(e){return t.hasMatches(e,[i.GeotaggingString_Continent,i.GeotaggingString_Continents])},t.prototype.isEnglishPostalCode=function(e){var a=t.hasMatches(e,[i.GeotaggingString_Post,i.GeotaggingString_Zip])&&t.hasMatches(e,[this.GeotaggingString_Code])||t.hasMatches(e,[i.GeotaggingString_PostalCode,i.GeotaggingString_PostalCodes,i.GeotaggingString_ZipCode,i.GeotaggingString_ZipCodes]);if(!a){var r=new RegExp("s");a=t.hasMatches(e,[i.GeotaggingString_PostalCode.replace(r,""),i.GeotaggingString_PostalCodes.replace(r,""),i.GeotaggingString_ZipCode.replace(r,""),i.GeotaggingString_ZipCodes.replace(r,"")])}return a},t.prototype.isEnglishLongitude=function(e){return t.hasMatches(e,[i.GeotaggingString_Longitude])||t.hasMatches(e,[i.GeotaggingString_Longitude_Short],!0)||t.hasMatches(e,[i.GeotaggingString_Longitude_Short2],!0)},t.prototype.isEnglishLatitude=function(e){return t.hasMatches(e,[i.GeotaggingString_Latitude])||t.hasMatches(e,[i.GeotaggingString_Latitude_Short],!0)},t.prototype.isEnglishTerritory=function(e){return t.hasMatches(e,[i.GeotaggingString_Territory,i.GeotaggingString_Territories])},t.prototype.getEnglishFieldType=function(t){if(null!=t)return this.isEnglishLatitude(t)?e.CategoryTypes.Latitude:this.isEnglishLongitude(t)?e.CategoryTypes.Longitude:this.isEnglishPostalCode(t)?e.CategoryTypes.PostalCode:this.isEnglishAddress(t)?e.CategoryTypes.Address:this.isEnglishPlace(t)?e.CategoryTypes.Place:this.isEnglishCity(t)?e.CategoryTypes.City:this.isEnglishCountry(t)?e.CategoryTypes.CountryRegion:this.isEnglishCounty(t)?e.CategoryTypes.County:this.isEnglishStateOrProvince(t)?e.CategoryTypes.StateOrProvince:this.isEnglishContinent(t)?e.CategoryTypes.Continent:void 0},t})();e.GeoTaggingAnalyzerService=a})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;"undefined"==typeof window.DEBUG&&(window.DEBUG=!0)},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.ClientErrorCode="Client Error Code",e.ErrorCode="Error Code",e.ErrorDetails="Error Details",e.HttpRequestId="HTTP Request Id",e.JobId="Job Id",e.ODataErrorMessage="OData Error Message",e.StackTrace="Stack Trace"})(t=e.ClientErrorStrings||(e.ClientErrorStrings={}));var i=(function(){function e(e){this.errorCode=e}return Object.defineProperty(e.prototype,"code",{get:function(){return this.errorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var i={message:e.get("ClientError_UnknownClientErrorValue"),displayableErrorInfo:[{errorInfoKey:e.get("ClientError_UnknownClientErrorKey"),errorInfoValue:e.get("ClientError_UnknownClientErrorValue")}],debugErrorInfo:[{errorInfoKey:t.ClientErrorCode,errorInfoValue:this.code}]};return i},e})();e.UnknownClientError=i;var a=(function(){function e(e,t){this.httpStatusCode=e,this.httpRequestId=t}return Object.defineProperty(e.prototype,"code",{get:function(){return"HttpClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestId",{get:function(){return this.httpRequestId},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var i={message:null,displayableErrorInfo:[{errorInfoKey:e.get("DsrError_Key"),errorInfoValue:e.get("DsrError_UnknownErrorValue")},{errorInfoKey:e.get("ClientError_HttpResponseStatusCodeKey"),errorInfoValue:this.httpStatusCode.toString()}],debugErrorInfo:[{errorInfoKey:t.HttpRequestId,errorInfoValue:this.httpRequestId},{errorInfoKey:t.ClientErrorCode,errorInfoValue:this.code}]};return i},e})();e.HttpClientError=a;var r=(function(){function e(){}return Object.defineProperty(e.prototype,"code",{get:function(){return"IgnorableClientError"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ignorable",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.getDetails=function(e){var t={message:"",displayableErrorInfo:[]};return t},e})();e.IgnorableClientError=r})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,
window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){for(var i=[],a=e.length-1;a>=0;--a)t.indexOf(e[a])!==-1&&i.push(e[a]);return i}function i(e,t){for(var i=[],a=e.length-1;a>=0;--a){var r=e[a];t.indexOf(r)===-1&&i.push(r)}return i}function a(e){for(var t=[],i=0,a=e.length;i<a;i++){var r=e[i];t.indexOf(r)===-1&&t.push(r)}return t}function r(e,t){for(var i=0,a=t.length;i<a;++i)n(e,t[i])}function n(e,t){e.indexOf(t)<0&&e.push(t)}function o(e,t,i){for(var a=[],r=t;r<=i;++r)a.push(e[r]);return a}function s(e,t){for(var i=[],a=0;a<t;++a)i.push(e[a]);return i}function l(e){return s(e,e.length)}function u(e,t,i){if(e||(e=null),t||(t=null),e===t)return!0;if(!!e!=!!t)return!1;var a=e.length;if(a!==t.length)return!1;for(var r=0;r<a&&i(e[r],t[r]);)++r;return r===a}function c(e){return e&&0===e.length?null:e}function d(e,t){for(var i=0,a=e.length;i<a;++i)if(t(e[i]))return i;return-1}function p(e,t){if(0===t)return e.slice();var i=e.slice(t);return Array.prototype.push.apply(i,e.slice(0,t)),i}function h(){return g([])}function g(e){var t=e;return t.withId=m,t}function f(e,t){for(var i=0,a=e.length;i<a;i++){var r=e[i];if(r.id===t)return r}}function m(t){return e.findWithId(this,t)}function y(){return v([])}function v(e){var t=e;return t.withName=x,t}function w(e,t){var i=b(e,t);if(i>=0)return e[i]}function b(e,t){for(var i=0,a=e.length;i<a;i++){var r=e[i];if(r.name===t)return i}return-1}function C(e,t){for(var i=e.length,a=i-1;a>=0;a--){var r=e[a]-t;if(0===r)return!1;if(!(r>0))return e.splice(a+1,0,t),!0}return e.unshift(t),!0}function S(e,t){var i=e.indexOf(t);return!(i<0)&&(e.splice(i,1),!0)}function x(e){var t=this;return w(t,e)}function P(e){if(e)for(;e.length>0;)e.pop()}function D(e){return!e||0===e.length}function T(e,t,i){var a=e[t];e[t]=e[i],e[i]=a}function V(e,t,i){return _.any(e,(function(e){return i(e,t)}))}function L(e){for(var t=e;null!=t;){if(_.isArray(t))return!0;t=Object.getPrototypeOf(t)}return!1}function M(e,t){var i=e.length;if(i>=2)for(var a=1;a<i;a++)if(t(e[a-1],e[a])>0)return!1;return!0}function N(e,t){var i=t?function(e,t){return t-e}:function(e,t){return e-t};return M(e,i)}function I(e){return _.isArray(e)?e:[e]}e.intersect=t,e.diff=i,e.distinct=a,e.union=r,e.unionSingle=n,e.range=o,e.take=s,e.copy=l,e.sequenceEqual=u,e.emptyToNull=c,e.indexOf=d,e.rotate=p,e.createWithId=h,e.extendWithId=g,e.findWithId=f,e.createWithName=y,e.extendWithName=v,e.findItemWithName=w,e.indexWithName=b,e.insertSorted=C,e.removeFirst=S,e.clear=P,e.isUndefinedOrEmpty=D,e.swap=T,e.isInArray=V,e.isArrayOrInheritedArray=L,e.isSorted=M,e.isSortedNumeric=N,e.ensureArray=I})(t=e.ArrayExtensions||(e.ArrayExtensions={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi,window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(){return $("<div/>")}function i(){return $("<span/>")}function a(){return $('<input type="checkbox"/>')}function r(){return $("<ul/>")}function n(){return $("<li/>")}function o(){return $('<input type="button"/>')}function s(){return $("<select/>")}function l(){return $('<input type="text"/>')}function u(){return $("<img/>")}function c(){return $("<iframe/>")}e.div=t,e.span=i,e.checkbox=a,e.ul=r,e.li=n,e.button=o,e.select=s,e.textBox=l,e.img=u,e.iframe=c})(t=e.DomFactory||(e.DomFactory={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(t){return t>=0?t<e.POSITIVE_POWERS.length?e.POSITIVE_POWERS[t]:1/0:(t=-t,t>0&&t<e.NEGATIVE_POWERS.length?e.NEGATIVE_POWERS[t]:0)}function i(t){if(t>1&&t<1e16)return t<1e8?t<1e4?t<100?t<10?0:1:t<1e3?2:3:t<1e6?t<1e5?4:5:t<1e7?6:7:t<1e12?t<1e10?t<1e9?8:9:t<1e11?10:11:t<1e14?t<1e13?12:13:t<1e15?14:15;if(t>1e-16&&t<1)return t<1e-8?t<1e-12?t<1e-14?t<1e-15?-16:-15:t<1e-13?-14:-13:t<1e-10?t<1e-11?-12:-11:t<1e-9?-10:-9:t<1e-4?t<1e-6?t<1e-7?-8:-7:t<1e-5?-6:-5:t<.01?t<.001?-4:-3:t<.1?-2:-1;var i=Math.log(t)/e.LOG_E_10;return e.floorWithPrecision(i)}function a(t,i){if(void 0===i&&(i=e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS),t&&isFinite(t)){var a=e.log10(Math.abs(t));if(a<e.MIN_EXP)return 0;var r=Math.max(a-i,-e.NEGATIVE_POWERS.length+1);return e.pow10(r)}}function r(e,t,i){return i=b(i,e,t),e===t||Math.abs(e-t)<i}function n(e,t,i){return i=b(i,e,t),e<t&&Math.abs(e-t)>i}function o(e,t,i){return i=b(i,e,t),e<t||Math.abs(e-t)<i}function s(e,t,i){return i=b(i,e,t),e>t&&Math.abs(e-t)>i}function l(e,t,i){return i=b(i,e,t),e>t||Math.abs(e-t)<i}function u(t,i){i=null!=i?i:e.DEFAULT_PRECISION;var a=Math.round(t);return Math.abs(t-a)<i?a:Math.floor(t)}function c(t,i){i=b(i,e.DEFAULT_PRECISION);var a=Math.round(t);return Math.abs(t-a)<i?a:Math.ceil(t)}function d(t,i){return i=b(i,e.DEFAULT_PRECISION),0===i||0===t?t:Math.floor(t/i)*i}function p(t,i){return i=b(i,e.DEFAULT_PRECISION),0===i||0===t?t:Math.ceil(t/i)*i}function h(t,i){if(i=b(i,e.DEFAULT_PRECISION),0===i||0===t)return t;var a=Math.round(t/i)*i,r=Math.round(e.log10(Math.abs(t))-e.log10(i))+1;return r>0&&r<16&&(a=parseFloat(a.toPrecision(r))),a}function g(e,t,i){return void 0===e||null===e?e:e<t?t:e>i?i:e}function f(e){return.5+e<<0}function m(e,t,i,a,r){if(0===i||0===r)return t<=e&&e<=t+i?a:NaN;var n=(e-t)/i,o=a+n*r;return o}function y(e){return h(e,a(e))}function v(e){return null!==e&&e%1===0}function w(e,t){return Math.round(e/t)*t}function b(t,i,a){if(void 0!==t)return t;var r;return r=a?i?e.getPrecision(Math.min(Math.abs(i),Math.abs(a))):e.getPrecision(a):e.getPrecision(i),r||e.DEFAULT_PRECISION}e.MIN_VALUE=-Number.MAX_VALUE,e.MAX_VALUE=Number.MAX_VALUE,e.MIN_EXP=-308,e.MAX_EXP=308,e.EPSILON=1e-323,e.DEFAULT_PRECISION=1e-4,e.DEFAULT_PRECISION_IN_DECIMAL_DIGITS=12,e.LOG_E_10=Math.log(10),e.POSITIVE_POWERS=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16,1e17,1e18,1e19,1e20,1e21,1e22,1e23,1e24,1e25,1e26,1e27,1e28,1e29,1e30,1e31,1e32,1e33,1e34,1e35,1e36,1e37,1e38,1e39,1e40,1e41,1e42,1e43,1e44,1e45,1e46,1e47,1e48,1e49,1e50,1e51,1e52,1e53,1e54,1e55,1e56,1e57,1e58,1e59,1e60,1e61,1e62,1e63,1e64,1e65,1e66,1e67,1e68,1e69,1e70,1e71,1e72,1e73,1e74,1e75,1e76,1e77,1e78,1e79,1e80,1e81,1e82,1e83,1e84,1e85,1e86,1e87,1e88,1e89,1e90,1e91,1e92,1e93,1e94,1e95,1e96,1e97,1e98,1e99,1e100,1e101,1e102,1e103,1e104,1e105,1e106,1e107,1e108,1e109,1e110,1e111,1e112,1e113,1e114,1e115,1e116,1e117,1e118,1e119,1e120,1e121,1e122,1e123,1e124,1e125,1e126,1e127,1e128,1e129,1e130,1e131,1e132,1e133,1e134,1e135,1e136,1e137,1e138,1e139,1e140,1e141,1e142,1e143,1e144,1e145,1e146,1e147,1e148,1e149,1e150,1e151,1e152,1e153,1e154,1e155,1e156,1e157,1e158,1e159,1e160,1e161,1e162,1e163,1e164,1e165,1e166,1e167,1e168,1e169,1e170,1e171,1e172,1e173,1e174,1e175,1e176,1e177,1e178,1e179,1e180,1e181,1e182,1e183,1e184,1e185,1e186,1e187,1e188,1e189,1e190,1e191,1e192,1e193,1e194,1e195,1e196,1e197,1e198,1e199,1e200,1e201,1e202,1e203,1e204,1e205,1e206,1e207,1e208,1e209,1e210,1e211,1e212,1e213,1e214,1e215,1e216,1e217,1e218,1e219,1e220,1e221,1e222,1e223,1e224,1e225,1e226,1e227,1e228,1e229,1e230,1e231,1e232,1e233,1e234,1e235,1e236,1e237,1e238,1e239,1e240,1e241,1e242,1e243,1e244,1e245,1e246,1e247,1e248,1e249,1e250,1e251,1e252,1e253,1e254,1e255,1e256,1e257,1e258,1e259,1e260,1e261,1e262,1e263,1e264,1e265,1e266,1e267,1e268,1e269,1e270,1e271,1e272,1e273,1e274,1e275,1e276,1e277,1e278,1e279,1e280,1e281,1e282,1e283,1e284,1e285,1e286,1e287,1e288,1e289,1e290,1e291,1e292,1e293,1e294,1e295,1e296,1e297,1e298,1e299,1e300,1e301,1e302,1e303,1e304,1e305,1e306,1e307,1e308],e.NEGATIVE_POWERS=[1,.1,.01,.001,1e-4,1e-5,1e-6,1e-7,1e-8,1e-9,1e-10,1e-11,1e-12,1e-13,1e-14,1e-15,1e-16,1e-17,1e-18,1e-19,1e-20,1e-21,1e-22,1e-23,1e-24,1e-25,1e-26,1e-27,1e-28,1e-29,1e-30,1e-31,1e-32,1e-33,1e-34,1e-35,1e-36,1e-37,1e-38,1e-39,1e-40,1e-41,1e-42,1e-43,1e-44,1e-45,1e-46,1e-47,1e-48,1e-49,1e-50,1e-51,1e-52,1e-53,1e-54,1e-55,1e-56,1e-57,1e-58,1e-59,1e-60,1e-61,1e-62,1e-63,1e-64,1e-65,1e-66,1e-67,1e-68,1e-69,1e-70,1e-71,1e-72,1e-73,1e-74,1e-75,1e-76,1e-77,1e-78,1e-79,1e-80,1e-81,1e-82,1e-83,1e-84,1e-85,1e-86,1e-87,1e-88,1e-89,1e-90,1e-91,1e-92,1e-93,1e-94,1e-95,1e-96,1e-97,1e-98,1e-99,1e-100,1e-101,1e-102,1e-103,1e-104,1e-105,1e-106,1e-107,1e-108,1e-109,1e-110,1e-111,1e-112,1e-113,1e-114,1e-115,1e-116,1e-117,1e-118,1e-119,1e-120,1e-121,1e-122,1e-123,1e-124,1e-125,1e-126,1e-127,1e-128,1e-129,1e-130,1e-131,1e-132,1e-133,1e-134,1e-135,1e-136,1e-137,1e-138,1e-139,1e-140,1e-141,1e-142,1e-143,1e-144,1e-145,1e-146,1e-147,1e-148,1e-149,1e-150,1e-151,1e-152,1e-153,1e-154,1e-155,1e-156,1e-157,1e-158,1e-159,1e-160,1e-161,1e-162,1e-163,1e-164,1e-165,1e-166,1e-167,1e-168,1e-169,1e-170,1e-171,1e-172,1e-173,1e-174,1e-175,1e-176,1e-177,1e-178,1e-179,1e-180,1e-181,1e-182,1e-183,1e-184,1e-185,1e-186,1e-187,1e-188,1e-189,1e-190,1e-191,1e-192,1e-193,1e-194,1e-195,1e-196,1e-197,1e-198,1e-199,1e-200,1e-201,1e-202,1e-203,1e-204,1e-205,1e-206,1e-207,1e-208,1e-209,1e-210,1e-211,1e-212,1e-213,1e-214,1e-215,1e-216,1e-217,1e-218,1e-219,1e-220,1e-221,1e-222,1e-223,1e-224,1e-225,1e-226,1e-227,1e-228,1e-229,1e-230,1e-231,1e-232,1e-233,1e-234,1e-235,1e-236,1e-237,1e-238,1e-239,1e-240,1e-241,1e-242,1e-243,1e-244,1e-245,1e-246,1e-247,1e-248,1e-249,1e-250,1e-251,1e-252,1e-253,1e-254,1e-255,1e-256,1e-257,1e-258,1e-259,1e-260,1e-261,1e-262,1e-263,1e-264,1e-265,1e-266,1e-267,1e-268,1e-269,1e-270,1e-271,1e-272,1e-273,1e-274,1e-275,1e-276,1e-277,1e-278,1e-279,1e-280,1e-281,1e-282,1e-283,1e-284,1e-285,1e-286,1e-287,1e-288,1e-289,1e-290,1e-291,1e-292,1e-293,1e-294,1e-295,1e-296,1e-297,1e-298,1e-299,1e-300,1e-301,1e-302,1e-303,1e-304,1e-305,1e-306,1e-307,1e-308,1e-309,1e-310,1e-311,1e-312,1e-313,1e-314,1e-315,1e-316,1e-317,1e-318,1e-319,1e-320,1e-321,1e-322,1e-323,0],e.pow10=t,e.log10=i,e.getPrecision=a,e.equalWithPrecision=r,e.lessWithPrecision=n,e.lessOrEqualWithPrecision=o,e.greaterWithPrecision=s,e.greaterOrEqualWithPrecision=l,e.floorWithPrecision=u,e.ceilWithPrecision=c,e.floorToPrecision=d,e.ceilToPrecision=p,e.roundToPrecision=h,e.ensureInRange=g,e.round=f,e.project=m,e.removeDecimalNoise=y,e.isInteger=v,e.toIncrement=w,e.detectPrecision=b})(t=e.Double||(e.Double={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon,a=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=a.Double;!(function(e){function t(e,t){if(0===t)return e;var i=r(e),a=n(i),l=s(a,t),u=o(l);return c(u)}function a(e){var t=r(e);return c(t)}function r(e){if(e.indexOf("#")>=0){if(7===e.length){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1],16),G:parseInt(t[2],16),B:parseInt(t[3],16)}}if(4===e.length){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1]+t[1],16),G:parseInt(t[2]+t[2],16),B:parseInt(t[3]+t[3],16)}}}else{if(e.indexOf("rgb(")>=0){var t=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/.exec(e);if(null==t||t.length<4)return;return{R:parseInt(t[1],10),G:parseInt(t[2],10),B:parseInt(t[3],10)}}if(e.indexOf("rgba(")>=0){var t=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d*(?:\.\d+)?)\)$/.exec(e);if(null==t||t.length<5)return;return{R:parseInt(t[1],10),G:parseInt(t[2],10),B:parseInt(t[3],10),A:parseFloat(t[4])}}}}function n(e){var t,i,a=e.R/255,r=e.G/255,n=e.B/255,o=Math.min(a,Math.min(r,n)),s=Math.max(a,Math.max(r,n)),l=s,u=s-o;return 0===s||0===u?(t=0,i=0):(t=u/s,i=a===s?(r-n)/u:r===s?2+(n-a)/u:4+(a-r)/u),i/=6,i<0&&(i+=1),{H:i,S:t,V:l}}function o(e){var t,i,a,r=e.H,n=e.S,o=e.V;if(0===n)t=o,i=o,a=o;else{var s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,p=void 0;switch(p=6*r,d=Math.floor(p),c=p-d,s=o*(1-n),l=o*(1-n*c),u=o*(1-n*(1-c)),d){case 0:t=o,i=u,a=s;break;case 1:t=l,i=o,a=s;break;case 2:t=s,i=o,a=u;break;case 3:t=s,i=l,a=o;break;case 4:t=u,i=s,a=o;break;case 5:t=o,i=s,a=l}}return{R:Math.floor(255*t),G:Math.floor(255*i),B:Math.floor(255*a)}}function s(e,t){var i=e.H+t;return{H:i>1?i-1:i,S:e.S,V:e.V}}function l(e,t){var i=Math.floor(t);return{R:Math.max(0,e.R-i),G:Math.max(0,e.G-i),B:Math.max(0,e.B-i)}}function u(e){return null==e.A?"rgb("+e.R+","+e.G+","+e.B+")":"rgba("+e.R+","+e.G+","+e.B+","+e.A+")"}function c(e){return"#"+f(e.R)+f(e.G)+f(e.B)}function d(e,t,i){return c(p(r(e),t,r(i)))}function p(e,t,a){return t=i.ensureInRange(t,0,1),{R:h(e.R,t,a.R),G:h(e.G,t,a.G),B:h(e.B,t,a.B)}}function h(e,t,a){return t=i.ensureInRange(t,0,1),e=i.ensureInRange(e,0,255),a=i.ensureInRange(a,0,255),Math.round(t*e+(1-t)*a)}function g(e,t,i){var a=n(e);return(t+i>1||t<=0||i<=0)&&(t=.8,i=.2),a.V<t?a.V=a.V+i:a.V=a.V-i,c(o(a))}function f(e){var t=i.ensureInRange(e,0,255),a=t.toString(16).toUpperCase();return 1===a.length?"0"+a:a}function m(t,i,a){var r=i.map((function(t){return e.parseColorString(t)}));return function(n){if(null==n&&(n=0),!isNaN(n)){if(a){if(n>=t[t.length-1])return i[i.length-1];if(n<=t[0])return i[0]}for(var o,s,l,u,c=1,d=t.length;c<d;c++){if(o=t[c-1],s=t[c],s===n)return i[c];if(n>=o&&n<=s){l=r[c-1],u=r[c];break}}var p={R:Math.round((n-o)*(u.R-l.R)/(s-o)+l.R),G:Math.round((n-o)*(u.G-l.G)/(s-o)+l.G),B:Math.round((n-o)*(u.B-l.B)/(s-o)+l.B)};return e.hexString(p)}}}function y(e,t){var i=parseInt(e.slice(1),16),a=t<0?0:255,r=t<0?t*-1:t,n=i>>16,o=i>>8&255,s=255&i,l="#"+(16777216+65536*(Math.round((a-n)*r)+n)+256*(Math.round((a-o)*r)+o)+(Math.round((a-s)*r)+s)).toString(16).slice(1);return l}e.rotate=t,e.normalizeToHexString=a,e.parseColorString=r,e.darken=l,e.rgbString=u,e.hexString=c,e.hexBlend=d,e.rgbBlend=p,e.channelBlend=h,e.calculateHighlightColor=g,e.createLinearColorScale=m,e.shadeColor=y})(t=e.Color||(e.Color={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){e!==!0&&r(t||"condition: "+e)}function i(e,t){null!==e&&void 0!==e||r(t||"condition: "+e)}function a(e,t){_.isEmpty(e)&&r(t||"condition: "+e)}function r(e){throw new Error("Contract check failed: "+e)}e.check=t,e.checkValue=i,e.checkNonEmpty=a,e.fail=r})(t=e.contract||(e.contract={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e){return{class:e,selector:"."+e}}e.createClassAndSelector=t,e.styleAttribute="style",e.pixelUnits="px",e.heightProperty="height",e.widthProperty="width",e.topProperty="top",e.bottomProperty="bottom",e.leftProperty="left",e.rightProperty="right",e.marginTopProperty="margin-top",e.marginLeftProperty="margin-left",e.displayProperty="display",e.backgroundProperty="background",e.backgroundColorProperty="background-color",e.backgroundRepeatProperty="background-repeat",e.backgroundSizeProperty="background-size",e.backgroundImageProperty="background-image",e.textShadowProperty="text-shadow",e.textAlignProperty="text-align",e.borderProperty="border",e.borderTopWidthProperty="border-top-width",e.borderBottomWidthProperty="border-bottom-width",e.borderLeftWidthProperty="border-left-width",e.borderRightWidthProperty="border-right-width",e.fontSizeProperty="font-size",e.fontWeightProperty="font-weight",e.colorProperty="color",e.opacityProperty="opacity",e.paddingLeftProperty="padding-left",e.paddingRightProperty="padding-right",e.positionProperty="position",e.maxWidthProperty="max-width",e.minWidthProperty="min-width",e.overflowProperty="overflow",e.overflowXProperty="overflow-x",e.overflowYProperty="overflow-y",e.transformProperty="transform",e.webkitTransformProperty="-webkit-transform",e.cursorProperty="cursor",e.visibilityProperty="visibility",e.absoluteValue="absolute",e.zeroPixelValue="0px",e.autoValue="auto",e.hiddenValue="hidden",e.noneValue="none",e.blockValue="block",e.inlineBlockValue="inline-block",e.transparentValue="transparent",e.boldValue="bold",e.visibleValue="visible",e.tableRowValue="table-row",e.coverValue="cover",e.pointerValue="pointer",e.scrollValue="scroll"})(t=e.CssConstants||(e.CssConstants={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.escape=window.escape,e.unescape=window.unescape})(t=e.Deprecated||(e.Deprecated={}))})(i||(i={}))},function(e,t){var i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;$.fn.multiline=function(e){return this.text(e),this.html(this.html().replace(/\n/g,"<br/>")),this},$.fn.togglePanelControl=function(){return this.each((function(){$(this).addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find(".accordionHeader").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover((function(){$(this).toggleClass("ui-state-hover")})).prepend('<span class="ui-icon ui-icon-triangle-1-e"></span>').click((function(){return $(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().slideToggle(),!1})).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide()}))};var i;!(function(e){var t;!(function(e){e.VisibleSelector=":visible"})(t=e.JQueryConstants||(e.JQueryConstants={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,i){switch(t){case"m":t="M";break;case"O":case"o":t="yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fff'0000'";break;case"R":case"r":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="ddd, dd MMM yyyy HH':'mm':'ss 'GMT'";break;case"s":t="S";break;case"u":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="yyyy'-'MM'-'dd HH':'mm':'ss'Z'";break;case"U":e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t="F";break;case"y":case"Y":switch(i){case"default":case"en":case"en-US":t="MMMM, yyyy";break;default:t="Y"}}return{value:e,format:t}}function i(e){if(e=e.replace(/%K/g,"zzz"),e=e.replace(/K/g,"zzz"),e=e.replace(/fffffff/g,"fff0000"),e=e.replace(/ffffff/g,"fff000"),e=e.replace(/fffff/g,"fff00"),e=e.replace(/ffff/g,"fff0"),e=e.replace(/yyyyy/g,"0yyyy"),e=e.replace(/(^y|^)yyy(^y|$)/g,"yyyy"),a||(a=["d","f","F","g","h","H","K","m","M","s","t","y","z",":","/"].map((function(e){return{r:new RegExp("%"+e+"(?!"+e+")","g"),s:e}}))),e.indexOf("%")!==-1&&e.length>2)for(var t=0;t<a.length;t++)e=e.replace(a[t].r,a[t].s);return e}var a;e.findDateFormat=t,e.fixDateTimeFormat=i})(t=e.Formatting||(e.Formatting={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(e,t){void 0===t&&(t=$.noop),i(e.cssFiles||[]);var r=e.javaScriptFilesWithCallback||[];if(e.javaScriptFiles)for(var n=0,o=e.javaScriptFiles.length;n<o;++n)r.push({javascriptFile:e.javaScriptFiles[n]});a(r,t)}function i(e){e.forEach((function(e){b.indexOf(e)===-1&&(b.push(e),r(e))}))}function a(e,t){function i(){--r||u(e,s)}function a(){--o||t()}var r=e.length,o=r,s=[];e.forEach((function(e,t){var r=e.javascriptFile;C.indexOf(r)===-1?r in S?S[r].push((function(){i(),a()})):(S[r]=[function(){a()}],d(r)?(s[t]=e,i()):n(r,(function(e){s[t]={javascriptFile:e},i()}))):(i(),a())}))}function r(e){var t=v.cloneNode();t.href=e,y?m.insertBefore(t,y):m.appendChild(t)}function n(e,t){c(e,(function(){t(this.responseText)}))}function o(e,t){if(void 0===t&&(t=$.noop),!e)return void t();var i=e.javascriptFile,a=t;if(e.onLoadCallback){var r=function(){e.onLoadCallback().then(t)};a=r}d(i)?l(i,a):s(i,a)}function s(e,t){void 0===t&&(t=$.noop);var i;e&&(i=w.cloneNode(),i.setAttribute("type","text/javascript"),i.innerHTML=e,m.appendChild(i)),setTimeout(t,0)}function l(e,t){var i;e&&(i=w.cloneNode(),i.setAttribute("src",e),i.setAttribute("charset","utf-8"),i.onload=t,m.appendChild(i))}function u(e,t){g(t,o,(function(){e.forEach((function(e){var t=e.javascriptFile,i=S[t];i&&i.forEach((function(e){e()})),delete S[t],C.indexOf(t)===-1&&C.push(t)}))}))}function c(e,t,i){var a=new XMLHttpRequest;try{a.open("GET",e,!0),a.onload=t,a.onerror=i,a.send(null)}catch(e){}}function d(e){var t=location.protocol+"//"+location.host+"/";return/^http[s]?:\/\/.+/i.test(e)&&0!==e.indexOf(t)}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]}function h(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(0!==e.length){for(var i=[],a=e.length;a--;)!(function(t){i[t]=function(){e[t](i[t+1]||p)}})(a);i[0]()}}function g(e,t,i){for(var a=[],r=0,n=e.length;r<n-1;r++)!(function(i){a[i]=function(a){t(e[i],a)}})(r);a[n-1]=function(a){t(e[n-1],i)},h.apply(null,a)}var f=document,m=f.head,y=m.getElementsByTagName("script")[0],v=f.createElement("link"),w=f.createElement("script"),b=[],C=[],S=[];v.setAttribute("rel","stylesheet"),e.requires=t})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(){return new i}e.createJQueryPromiseFactory=t;var i=(function(){function e(){}return e.prototype.defer=function(){return new a($.Deferred())},e.prototype.reject=function(e){var t=this.defer();return t.reject(e),t.promise},e.prototype.resolve=function(e){var t=this.defer();return t.resolve(e),t.promise},e.prototype.all=function(e){var t=jQuery.map(e,(function(e){return e&&e.promise?e.promise:e}));return new r($.when.apply($,t).then((function(){return Array.prototype.slice.call(arguments)})))},e.prototype.allSettled=function(e){var t=this.defer(),i=e.length;if(i>0)for(var a=0,r=[],n=function(n){e[n].then((function(e){r[n]={value:e,type:0}})).catch((function(e){r[n]={value:e,type:1}})).finally((function(){a++,a===i&&t.resolve(r)}))},o=0;o<i;o++)n(o);else t.resolve([]);return t.promise},e.prototype.when=function(e){var t=e&&e.promise?e.promise:e;return new r($.when(t))},e})(),a=(function(){function e(e){this.deferred=e,this.promise=new r(e.promise())}return e.prototype.resolve=function(e){this.deferred.resolve(e)},e.prototype.reject=function(e){this.deferred.reject(e)},e})(),r=(function(){function e(e){this.promise=e}return e.prototype.then=function(t,i){return new e(this.promise.then(e.wrapCallback(t),e.wrapCallback(i)))},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(t){return this.promise.always(e.wrapCallback(t)),this},e.wrapCallback=function(t){return t?function(){var i=t.apply(this,arguments);return i instanceof e?i.promise:i}:t},e})()})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function e(){}return e.prototype.getData=function(e){try{if(localStorage){var t=localStorage[e];if(t)return JSON.parse(t)}}catch(e){}return null},e.prototype.setData=function(e,t){try{localStorage&&(localStorage[e]=JSON.stringify(t))}catch(e){}},e})(),i=(function(){function e(t){this.cache={},this.clearCacheInterval=null!=t?t:e.defaultClearCacheInterval,this.clearCache()}return e.prototype.getData=function(e){return this.cache[e]},e.prototype.setData=function(e,t){var i=this;this.cache[e]=t,null==this.clearCacheTimerId&&(this.clearCacheTimerId=setTimeout((function(){return i.clearCache()}),this.clearCacheInterval))},e.prototype.clearCache=function(){this.cache={},this.clearCacheTimerId=void 0},e.defaultClearCacheInterval=864e5,e})();e.EphemeralStorageService=i,e.localStorageService=new t,e.ephemeralStorageService=new i})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function e(){this.handles={}}return e.prototype.scheduleTask=function(e,t){var i=this,a=setTimeout((function(){e(),i.remove(a)}),t);this.handles[a]=a},e.prototype.remove=function(e){delete this.handles[e]},e.prototype.clear=function(){for(var e in this.handles)clearTimeout(this.handles[e]);this.handles={}},e})();e.WorkScheduler=t})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,i){if(i){for(var r=e-1;r>-1;r--)if(a(t[r]))return r+1}else for(var r=e,n=t.length;r<n;r++)if(a(t[r]))return r;return i?0:t.length}function i(e,i){var a={start:0,end:0};return 0===i.length?a:(a.start=t(e,i,!0),a.end=t(e,i,!1),a)}function a(e){return p.lastIndex=0,p.test(e)}function r(e){var t=1;for(p.lastIndex=0,p.exec(e);0!==p.lastIndex;)t++,p.exec(e);return t}function n(e,t,i){for(var a=o(e),r=0,n=0,s=a;n<s.length;n++){var l=s[n];i.text=l,r=Math.max(r,t(i))}return r}function o(e){return e.split(p)}function s(e,t,i){return t.text=e,i(t)}function l(e,t,i,a){return t.text=e,i(t,a)}function u(e,t,i,a,r,n,u){r<1&&(r=Number.POSITIVE_INFINITY),n=n?n:function(e,t){return e.text};for(var p=s(d,t,i),h=new g,f=o(e),m=0,y=f;m<y.length;m++){var v=y[m],w=s(v,t,i),b=w,C=h.getLastLine().isEmpty();if(C||(b+=p),h.getLastLineWidth()+b<=a||h.count>=r)h.addWord(v,b);else if(C||h.newLine(),w<=a)h.addWord(v,w);else{var S=r-h.count;if(!u||S<=0)h.addWord(v,w);else for(var x=c(v,t,i,a,S+1),P=0,D=x.chunks.length;P<D;P++){var T=x.chunks[P];P<D-1?(h.addWord(T,a),h.newLine()):h.addWord(T,x.lastChunkWidth)}}}var V=_.map(h.getLines(),(function(e){return e.getWidth()>a?l(e.toString(),t,n,a):e.toString()}));return V}function c(e,t,i,a,r){var n={chunks:[],lastChunkWidth:0};if(r<1)return n;for(var o=e.length,l=n.chunks,u="",c=0;c<o;c++){var d=r-l.length,p=e.charAt(c),h=u+p,g=s(h,t,i);g<=a||_.isEmpty(u)||d<=1?(u=h,n.lastChunkWidth=g):(l.push(u),u=p,n.lastChunkWidth=s(p,t,i))}return _.isEmpty(u)||l.push(u),n}var d=" ",p=/[\s\n]+/g;e.find=i,e.hasBreakers=a,e.wordCount=r,e.getMaxWordWidth=n;var h=(function(){function e(){this.words=[],this.width=0}return e.prototype.getWidth=function(){return this.width},e.prototype.addWord=function(e,t){this.words.push(e),this.width+=t},e.prototype.toString=function(){return this.words.join(d)},e.prototype.isEmpty=function(){return _.isEmpty(this.words)},e})(),g=(function(){function e(){this.lastLine=new h,this.lines=[this.lastLine]}return e.prototype.newLine=function(){var e=this.lastLine;return this.lastLine=new h,this.lines.push(this.lastLine),e},Object.defineProperty(e.prototype,"count",{get:function(){return this.lines.length},enumerable:!0,configurable:!0}),e.prototype.getLastLine=function(){return this.lastLine},e.prototype.getLastLineWidth=function(){return this.getLastLine().getWidth()},e.prototype.addWord=function(e,t){this.lastLine.addWord(e,t)},e.prototype.getLines=function(){return this.lines},e})();e.splitByWidth=u,e.splitWordByWidth=c})(t=e.WordBreaker||(e.WordBreaker={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(){if(!b){b=$("<span/>"),$("body").append(b),C=d3.select($("body").get(0)).append("svg").style({height:"0px",width:"0px",position:"absolute"}).append("text"),S=$("<canvas/>").get(0).getContext("2d");var e=window.getComputedStyle(C.node());x=e?e.fontFamily:""}}function r(){return{width:0,height:0,x:0,y:0}}function n(){b&&b.remove&&b.remove(),b=null}function o(e,t){return i(),S.font=(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+" "+(e.fontFamily||x),S.measureText(t||e.text).width}function s(e,t){return i(),C.style(null),C.text(t||e.text).attr({visibility:"hidden","font-family":e.fontFamily||x,"font-variant":e.fontVariant,"font-size":e.fontSize,"font-weight":e.fontWeight,"font-style":e.fontStyle,"white-space":e.whiteSpace||"nowrap"}),C.node().getBBox()||r()}function l(e,t){var i=s(e,t);return i?i.height:0}function u(i){var a=i.fontFamily+i.fontSize,r=e.ephemeralStorageService.getData(a);if(null==r){var n={fontFamily:i.fontFamily,fontSize:i.fontSize,text:"M"};r=t.measureSvgTextRect(n),r.height>0&&e.ephemeralStorageService.setData(a,r)}return r}function c(e){var t=u(e);return t.y+t.height}function d(e,t){void 0===t&&(t=!1);var i=u(e).height;return t&&(i*=.7),i}function p(e){return o(g(e))}function h(e){return{text:e.val()||e.text(),fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontWeight:e.css("font-weight"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),whiteSpace:e.css("white-space")}}function g(e){var t=window.getComputedStyle(e,null);return t?{text:e.textContent,fontFamily:t.fontFamily,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontVariant:t.fontVariant,whiteSpace:t.whiteSpace}:{text:e.textContent,fontFamily:"",fontSize:"0"}}function f(e){var t=getComputedStyle(e[0]);return t?t.width:"0"}function m(t,a){i();var r=t.text.length;if(0===r)return t.text;var n=o(t);if(n<=a)return t.text;for(var s=e.Prototype.inherit(t),l=s.text=P+s.text,u=1,c=l.length,d=P.length;u<=c;)if(d=(u+c)/2|0,s.text=l.substr(0,d),n=o(s),a>n)u=d+1;else{if(!(a<n))break;c=d-1}return s.text=l.substr(0,d),n=o(s),n>a&&d--,l.substr(P.length,d-P.length)+P}function y(e,t){var i=g(e),a=i.text,r=m(i,t);a!==r&&(e.textContent=r)}function v(e,t,i,r){void 0===r&&(r=0);var n=g(e),s=d(n)+r,l=Math.max(1,Math.floor(i/s)),u=d3.select(e),c=u.attr("y"),p=e.textContent;e.textContent=null;for(var h=a.WordBreaker.splitByWidth(p,n,o,t,l),f=0,y=h.length;f<y;f++)n.text=h[f],u.append("tspan").attr({x:0,dy:0===f?c:s}).text(m(n,t))}function w(e,t,i,r){void 0===r&&(r=0);var n=g(e),s=d(n)+r,l=Math.max(1,Math.floor(i/s)),u=e.textContent;e.textContent=null;var c=a.WordBreaker.splitByWidth(u,n,o,t,l),p=d3.select(e).selectAll(D.selector).data(c,(function(e){return $.inArray(e,c)}));p.enter().append("span").classed(D.class,!0).text((function(e){return e})).style("width",a.PixelConverter.toString(t))}var b,C,S,x,P="",D=a.CssConstants.createClassAndSelector("overflowingText");t.removeSpanElement=n,t.measureSvgTextWidth=o,t.measureSvgTextRect=s,t.measureSvgTextHeight=l,t.estimateSvgTextBaselineDelta=c,t.estimateSvgTextHeight=d,t.measureSvgTextElementWidth=p,t.getMeasurementProperties=h,t.getSvgMeasurementProperties=g,t.getDivElementWidth=f,t.getTailoredTextOrDefault=m,t.svgEllipsis=y,t.wordBreak=v,t.wordBreakOverflowingText=w})(t=e.TextMeasurementService||(e.TextMeasurementService={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=e.DOMConstants;!(function(e){function t(e){return e===i.downArrowKeyCode||e===i.upArrowKeyCode||e===i.leftArrowKeyCode||e===i.rightArrowKeyCode}function a(e){return e===i.aKeyCode||e===i.cKeyCode||e===i.xKeyCode||e===i.vKeyCode||e===i.zKeyCode||e===i.yKeyCode}function r(e){return e===i.shiftKeyCode}function n(e){return e===i.deleteKeyCode}e.isArrowKey=t,e.isCtrlShortcutKey=a,e.isNudgeModifierKey=r,e.isDeleteKey=n})(t=e.KeyUtils||(e.KeyUtils={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(t){this.timerFactory=e.TimerPromiseFactory.instance,this.delay=0,t&&(this.delay=t)}return t.prototype.run=function(e){var t=this;this.fn?this.fn=e:(this.fn=e,this.timerFactory.create(this.delay).done((function(){return t.timerComplete(t.fn)})))},t.prototype.timerComplete=function(e){e(),this.fn=null},t})();e.ThrottleUtility=t})(i||(i={}))},function(e,t){
var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function e(){}return e.prototype.create=function(e){var t=$.Deferred();return window.setTimeout((function(){return t.resolve()}),e),t},e.instance=new e,e})();e.TimerPromiseFactory=t})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(){var e="touchstart";return window.PointerEvent&&(e="pointerdown"),e}function i(){var e="touchmove";return window.PointerEvent&&(e="pointermove"),e}function a(){var e="touchend";return window.PointerEvent&&(e="pointerup"),e}function r(){var e=t();return"pointerdown"===e||"MSPointerDown"===e}e.touchStartEventName=t,e.touchMoveEventName=i,e.touchEndEventName=a,e.usePointerEvents=r})(t=e.TouchUtils||(e.TouchUtils={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=e.Deprecated;!(function(t){function a(t){if(_.isEmpty(t))return!1;var i=e.RegExpExtensions.run(S,t);return!(!i||0!==i.index)}function r(e){return a(e)}function n(t){if(_.isEmpty(t))return[];for(var i,a=[],r=0;null!==(i=e.RegExpExtensions.run(S,t,r));){var n=i[0],o=i.index+n.length;a.push({start:i.index,end:o,text:n}),r=o}return a}function o(e){return e&&0===e.indexOf("data:")}function s(e){if(!o(e))throw new Error("Expected data uri");var t=";base64,",i=e.indexOf(t);if(i<0)throw new Error("Expected base 64 content in data url");var a=i+t.length;return e.substr(a,e.length-a)}function l(e,i){return"data:"+e+";base64,"+t.utoa(i)}function u(e){return l("application/json",e)}function c(e){return e?e.replace(/[^*+\-.\/0123456789@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();switch(t.length){case 1:return"%0"+t;case 2:return"%"+t;case 3:return"%u0"+t;default:return"%u"+t}})):e}function d(e){return e?e.replace(/%([0-9a-fA-F]{2})|%u([0-9a-fA-F]{4})/g,(function(e,t,i){return String.fromCharCode(parseInt(t||i,16))})):e}function p(e){return x(encodeURIComponent(e))}function h(e){return decodeURIComponent(P(e))}function g(e){return btoa(p(e))}function f(e){return h(atob(e))}function m(e){var t=b(e);if(t)return C(t)}function y(e,t,i){void 0===i&&(i=!1);var a=v(e),r=a.baseUrl;return i&&_.assign(t,a.queryParameters),_.isEmpty(t)?r:r+="?"+_.chain(t).pairs().map((function(e){return e.join("=")})).value().join("&")}function v(e){var t=b(e),i=t?e.slice(0,e.lastIndexOf(t)):e;return{baseUrl:i,queryParameters:C(t)}}function w(e){return e?e.replace(D,""):e}function b(e){var t=document.createElement("a");return t.href=e,t.search}function C(e){if(!e)return null;_.startsWith(e,"?")&&(e=e.substring(1));for(var t=e.split("&"),i={},a=0,r=t;a<r.length;a++){var n=r[a],o=n.split("=");i[o[0]]=decodeURIComponent(o[1])}return i}var S=/http[s]?:\/\/(\S)+/gi;t.isValidUrl=a,t.isValidImageUrl=r,t.findAllValidUrls=n,t.isDataUri=o,t.getBase64ContentFromDataUri=s,t.makeUTF8EncodedBase64DataUri=l,t.makeJsonDataUri=u,t.escapeSlow=c,t.unescapeSlow=d;var x=i.unescape||d,P=i.escape||c;t.encodeUTF8=p,t.decodeUTF8=h,t.utoa=g,t.atou=f,t.getQueryParameters=m,t.setQueryParameters=y,t.splitUrlAndQuery=v;var D=/https?:\/\/[^\/]+/i;t.getAbsolutePath=w})(t=e.UrlUtils||(e.UrlUtils={}))})(i||(i={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(){var e=window.navigator.vendor||"",t=window.navigator.userAgent.toLowerCase();return e.toLowerCase().indexOf("google")>-1&&t.indexOf("chrome")>-1&&t.indexOf("edge")===-1&&t.indexOf("opr")===-1}function i(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("msie")>-1||e.indexOf("trident")>-1||e.indexOf("edge")>-1}function a(){var e=0;if("Microsoft Internet Explorer"===navigator.appName||window.navigator.userAgent.indexOf("MSIE")>=0){var t=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),i=t.exec(window.navigator.userAgent);i&&(e=parseFloat(i[1]))}return e}function r(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1}e.isChrome=t,e.isInternetExplorerOrEdge=i,e.getInternetExplorerVersion=a,e.isFirefox=r})(t=e.BrowserUtils||(e.BrowserUtils={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){var t=e.get(0).style,i=t.transform||t.webkitTransform;if(i){var a=i.match(/rotate\((-?\d+(?:\.\d*)?)deg\)/);if(a)return parseFloat(a[1])}return 0}function i(e){var t=e.get(0).style,i=t.transform||t.webkitTransform,a={x:0,y:0};if(i&&i.length>0){var r=i.match(/translate\((-?\d+(?:\.\d*)?)px, (-?\d+(?:\.\d*)?)px\)/);r&&(a.x=parseFloat(r[1]),a.y=parseFloat(r[2]))}return a}function a(e){if(e)return{left:parseFloat(e.css("padding-left"))||0,right:parseFloat(e.css("padding-right"))||0,top:parseFloat(e.css("padding-top"))||0,bottom:parseFloat(e.css("padding-bottom"))||0}}e.getRotateAngleFromElement=t,e.getTranslateTransformFromElement=i,e.getPadding=a})(t=e.StyleUtils||(e.StyleUtils={}))})(t=e.utility||(e.utility={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t,i){var a,a=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(){}return t.prototype.logTrace=function(t){switch(t.type){case e.TraceType.Information:break;case e.TraceType.UnexpectedError:case e.TraceType.Error:case e.TraceType.Fatal:break;case e.TraceType.ExpectedError:case e.TraceType.Warning:break;case e.TraceType.Verbose:}},t})();e.ConsoleTracer=t;var i;!(function(i){function a(t,i){h(new e.TraceItem(t,e.TraceType.Warning,i))}function r(t,i,a){i&&(t=e.StringExtensions.format("{0}.\nStack:\n{1}",t,e.getStackTrace())),h(new e.TraceItem(t,e.TraceType.Error,a))}function n(t,i){h(new e.TraceItem(t,e.TraceType.Verbose,i))}function o(e){v.push(e)}function s(e){var t=v.indexOf(e);t>=0&&v.splice(t,1)}function l(){v=new Array(y)}function u(){m=-1}function c(){if(!(m<0)){for(var e=new Array(m+1),t=0;t<=m;t++)e[t]=f[t];return e}}function d(){s(y)}function p(){o(y)}function h(e){m+1>=g&&u(),f[++m]=e;for(var t=0,i=v.length;t<i;t++)v[t].logTrace(e)}var g=1e3,f=new Array(g),m=-1,y=new t,v=new Array(y);i.warning=a,i.error=r,i.verbose=n,i.addListener=o,i.removeListener=s,i.resetListeners=l,i.reset=u,i.getTraces=c,i.disableDefaultListener=d,i.enableDefaultListener=p})(i=e.Trace||(e.Trace={}))})(a||(a={}))},function(e,t){var i,i=window.jsCommon;window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.Information=0]="Information",e[e.Verbose=1]="Verbose",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.ExpectedError=4]="ExpectedError",e[e.UnexpectedError=5]="UnexpectedError",e[e.Fatal=6]="Fatal"})(e.TraceType||(e.TraceType={}));e.TraceType})(i||(i={}))},function(e,t){var i,i=window.jsCommon,a=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(t,i,n){t=e.UrlUtils.setQueryParameters(t,{onscriptload:"globalMapControlLoaded"},!0);var o={javaScriptFilesWithCallback:[{javascriptFile:t,onLoadCallback:r}]},s=a.Prototype.inherit(o),l=e.UrlUtils.getQueryParameters(t),u=l.c||l.culture||i;if(!_.isEmpty(u)){var c=u.split("-",2),d={mkt:i||u,ur:c.length>1?c[1]:u,c:u},p=e.UrlUtils.setQueryParameters(t,d,!0);s.javaScriptFilesWithCallback[0].javascriptFile=p}e.requires(s,n)}function i(){n=!0,o&&(o.resolve(),o=void 0)}function r(){var e;return n?(e=$.Deferred(),e.resolve()):e=o=$.Deferred(),e.promise()}var n=!1,o=null;e.ensureMap=t,e.mapControlLoaded=i,e.waitForMapControlLoaded=r})(i||(i={})),window.globalMapControlLoaded=function(){i.mapControlLoaded()}},function(e,t){var i,i=(window.jsCommon,window.powerbi,window.powerbitests,window.InJs);window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.information=0]="information",e[e.verbose=1]="verbose",e[e.warning=2]="warning",e[e.error=3]="error",e[e.expectedError=4]="expectedError",e[e.unexpectedError=5]="unexpectedError",e[e.fatal=6]="fatal"})(e.TraceType||(e.TraceType={}));e.TraceType})(i||(i={}))},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;window.jsCommon=window.jsCommon||{},window.powerbi=window.powerbi||{},window.debug=window.debug||{},window.InJs=window.InJs||{},i(442),i(444),i(362),i(363),i(445),i(364),i(446),i(447),i(365),i(367),i(448),i(368),i(449),i(369),i(370),i(371),i(372),i(450),i(373),i(374),i(451),i(452),i(375),i(376),i(377),i(378),i(379),i(380),i(381),i(382),i(383),i(366),i(384),i(385),i(391),i(453),i(454),i(455),i(386),i(387),i(456),i(457),i(388),i(458),i(459),i(460),i(461),i(462),i(463),i(397),i(392),i(393),i(400)},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;i(443),i(360)},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;window.jsCommon=window.jsCommon||{},window.powerbi=window.powerbi||{},window.debug=window.debug||{},window.InJs=window.InJs||{},i(465)},function(e,t,i){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;i(466),i(83),i(467),i(468),i(469),i(470),i(471),i(472),i(473),i(474),i(84),i(475),i(476),i(477),i(478),i(85),i(479),i(480),i(481),i(482),i(483),i(484),i(485),i(486),i(487),i(488),i(489),i(490),i(491),i(492),i(493),i(494),i(495),i(496),i(497),i(498),i(499),i(500),i(501),i(502),i(503),i(504),i(505),i(506),i(507),i(508),i(509),i(510),i(511),i(512),i(513),i(514),i(86),i(515),i(516),i(517),i(518),i(519),i(87),i(520),i(521),i(522),i(523),i(524),i(525),i(526),i(527),i(528),i(529),i(530),i(531),i(532),i(89),i(533),i(534),i(535),i(536),i(537),i(538),i(539),i(88),i(540),i(541),i(542),i(90),i(543),i(544),i(545),i(546),i(547),i(548),i(91),i(549),i(550),i(551),i(92),i(552),i(553),i(554),i(555)},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){function t(e){return new i(e)}e.createEnumType=t;var i=(function(){function e(e){this.allMembers=e}return e.prototype.members=function(e){var t=this.allMembers;if(!e)return t;for(var i=[],a=0,r=t;a<r.length;a++){var n=r[a];_.contains(e,n.value)&&i.push(n)}return i},e})()})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(t){if(t)return{solid:{color:e.data.SQExprBuilder.text(t)}}}function a(t){return i(t)||e.data.SQExprBuilder.nullConstant()}t.createSolidFillDefinition=i,t.createSolidFillSQExpr=a})(t=e.fillDefinitionHelpers||(e.fillDefinitionHelpers={}));var i;!(function(e){function t(e){if(e===!0)return!1;var t=e;return!!t.nullable}e.nullable=t})(i=e.FillSolidColorTypeDescriptor||(e.FillSolidColorTypeDescriptor={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.asZero="asZero",t.noColor="noColor",t.specificColor="specificColor",t.type=e.createEnumType([{value:t.asZero,displayName:function(e){return e.get("ConditionalFormattingDialog_FormatNull_AsZero")}},{value:t.noColor,displayName:function(e){return e.get("ConditionalFormattingDialog_FormatNull_NoFormat")}},{value:t.specificColor,displayName:function(e){return e.get("ConditionalFormattingDialog_FormatNull_SpecificColor")}}])})(t=e.NullStrategy||(e.NullStrategy={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.shared="shared",e.packaged="packaged"})(t=e.GeoJsonTypes||(e.GeoJsonTypes={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){e.urlType={misc:{imageUrl:!0}}})(t=e.ImageDefinition||(e.ImageDefinition={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e){return!!(e.fill||e.fillRule||e.filter||e.expression||e.image||e.paragraphs||e.geoJson||e.queryTransform)}e.isValid=t})(t=e.StructuralTypeDescriptor||(e.StructuralTypeDescriptor={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){if(e){var t;return e.top&&(t={Top:{}},e.top.count&&(t.Top.Count=e.top.count)),e.bottom&&(t={Bottom:{}},e.bottom.count&&(t.Bottom.Count=e.bottom.count)),e.sample&&(t={Sample:{}},e.sample.count&&(t.Sample.Count=e.sample.count)),e.window&&(t={Window:{}},e.window.count&&(t.Window.Count=e.window.count)),t}}e.createFrom=t})(t=e.DataShapeBindingDataReduction||(e.DataShapeBindingDataReduction={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.schemas=e.schemas,e.links&&(this.links=e.links)}return e.prototype.schema=function(e){return this.schemas[e]},e})();e.FederatedConceptualSchema=t})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.ArrayExtensions;!(function(i){function a(t,i){if(!_.isEmpty(t)){var a=n(t);return _.isEmpty(a)?void 0:e.DataViewScopeIdentity.filterFromExprs(a,i)}}function n(e){if(!_.isEmpty(e)){for(var i=[],a=0,r=e.length;a<r;a++){var n=e[a],o=n.data,s=void 0;if(o&&o.length)for(var l=0,u=o.length;l<u;l++)s=t.SQExprBuilder.and(s,n.data[l].expr);s&&i.push(s)}return i}}function o(i,a){var r=i.data;if(r.length!==a.length)return!1;for(var n=0,o=r.length;n<o;n++){var s=i.data[n],l=s;if(l.expr){if(!e.DataViewScopeIdentity.equals(l,a[n]))return!1}else if(!t.DataViewScopeWildcard.matches(s,a[n]))return!1}return!0}function s(e,i){var a=e.data,r=a.length;if(r!==i.length)return!1;for(var n=0;n<r;n++){var o=e.data[n],s=void 0;if(o.expr)s=t.ScopeIdentityExtractor.getKeys(o.expr);else{if(!o.exprs)return!1;s=o.exprs}if(s&&!t.SQExprUtils.sequenceEqual(i[n],s))return!1}return!0}function l(e,t){return e=e||null,t=t||null,e===t||!e==!t&&(e.id===t.id&&(e.metadata===t.metadata&&!!u(e.data,t.data)))}function u(e,t){if(e=e||null,t=t||null,e===t)return!0;if(!e!=!t)return!1;if(e.length!==t.length)return!1;for(var i=0,a=e.length;i<a;i++)if(!c(e[i],t[i]))return!1;return!0}function c(i,a){var r=i,n=a;return r.expr&&n.expr?e.DataViewScopeIdentity.equals(r,n):r.exprs&&n.exprs?t.DataViewScopeWildcard.equals(r,n):!(!r.roles||!n.roles)&&t.DataViewRoleWildcard.equals(r,n)}function d(e){var t={};if(e.data){for(var i=[],a=0,r=e.data.length;a<r;a++)i.push(e.data[a].key);t.data=i}return e.metadata&&(t.metadata=e.metadata),e.id&&(t.id=e.id),JSON.stringify(t)}function p(e){var t=e.data;if(!t)return!1;for(var i=0,a=t;i<a.length;i++){var r=a[i],n=r;if(n.exprs||n.roles)return!0}return!1}function h(e){var t=e.data;if(_.isEmpty(t))return!1;for(var i=0,a=t;i<a.length;i++){var r=a[i];if(g(r))return!0}return!1}function g(e){return!_.isEmpty(e.roles)}function f(e){if(!e)return e;var t=[];for(var i in e.dataMap)for(var a=r.ensureArray(e.dataMap[i]),n=0,o=a;n<o.length;n++){var s=o[n];t.push(s)}var l={};return t.length>0&&(l.data=t),e.metadata&&(l.metadata=e.metadata),e.id&&(l.id=e.id),l}function m(e){return _.filter(e,(function(e){return!t.SQExprUtils.detectTransformExpr(e.expr)}))}i.filterFromSelector=a,i.filterExprsFromSelectors=n,i.matchesData=o,i.matchesKeys=s,i.equals=l,i.getKey=d,i.containsWildcard=p,i.hasRoleWildcard=h,i.isRoleWildcard=g,i.convertSelectorsByColumnToSelector=f,i.filterTransformSelectorsForSelection=m})(i=t.Selector||(t.Selector={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(e,t,i){this.items=e,this._activeProjectionRefs=t,this._showAll=i}return e.prototype.all=function(){return this.items},Object.defineProperty(e.prototype,"activeProjectionRefs",{get:function(){return this._activeProjectionRefs},set:function(e){if(!_.isEmpty(e)){for(var t=this.items.map((function(e){return e.queryRef})),i=0,a=e;i<a.length;i++){var r=a[i];if(!_.contains(t,r))return}this._activeProjectionRefs=e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAll",{get:function(){return this._showAll},set:function(e){this._showAll=e},enumerable:!0,configurable:!0}),e.prototype.addActiveQueryReference=function(e){this._activeProjectionRefs?this._activeProjectionRefs.push(e):this._activeProjectionRefs=[e]},e.prototype.getLastActiveQueryReference=function(){if(!_.isEmpty(this._activeProjectionRefs))return this._activeProjectionRefs[this._activeProjectionRefs.length-1]},e.prototype.replaceQueryRef=function(e,t){for(var i=0,a=this.items;i<a.length;i++){var r=a[i];r.queryRef===e&&(r.queryRef=t)}},e.prototype.clone=function(){return new e(_.cloneDeep(this.items),_.clone(this._activeProjectionRefs),this._showAll)},e})();e.QueryProjectionCollection=t;var i;!(function(e){function t(e){if(!e)return e;var t={};for(var i in e)t[i]=e[i].clone();return t}function i(e,t){if(e)return e[t]}e.clone=t,e.getRole=i})(i=e.QueryProjectionsByRole||(e.QueryProjectionsByRole={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.Default=0]="Default",e[e.Verbose=1]="Verbose",e[e.WholeUnits=2]="WholeUnits",e[e.DataLabels=3]="DataLabels"})(e.DisplayUnitSystemType||(e.DisplayUnitSystemType={}));e.DisplayUnitSystemType})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(e){this.unit=e,this.sequence=[],this.min=new Date("9999-12-31T23:59:59.999"),this.max=new Date("0001-01-01T00:00:00.000")}return t.prototype.add=function(e){e<this.min&&(this.min=e),e>this.max&&(this.max=e),this.sequence.push(e)},t.prototype.extendToCover=function(e,i){for(var a=this.min;e<a;)a=t.addInterval(a,-this.interval,this.unit),this.sequence.splice(0,0,a);for(this.min=a,a=this.max;a<i;)a=t.addInterval(a,this.interval,this.unit),this.sequence.push(a);this.max=a},t.prototype.moveToCover=function(e,i){var a=t.getDelta(e,i,this.unit),r=Math.floor(a/this.interval);for(this.min=t.addInterval(this.min,r*this.interval,this.unit),this.sequence=[],this.sequence.push(this.min),this.max=this.min;this.max<i;)this.max=t.addInterval(this.max,this.interval,this.unit),this.sequence.push(this.max)},t.calculate=function(i,a,r,n){switch(n||(n=t.getIntervalUnit(i,a,r)),n){case e.DateTimeUnit.Year:return t.calculateYears(i,a,r);case e.DateTimeUnit.Month:return t.calculateMonths(i,a,r);case e.DateTimeUnit.Week:return t.calculateWeeks(i,a,r);case e.DateTimeUnit.Day:return t.calculateDays(i,a,r);case e.DateTimeUnit.Hour:return t.calculateHours(i,a,r);case e.DateTimeUnit.Minute:return t.calculateMinutes(i,a,r);case e.DateTimeUnit.Second:return t.calculateSeconds(i,a,r);case e.DateTimeUnit.Millisecond:return t.calculateMilliseconds(i,a,r)}},t.calculateYears=function(i,a,r){var n=e.NumericSequenceRange.calculateDataRange(i.getFullYear(),a.getFullYear(),!1),o=e.NumericSequence.calculate(e.NumericSequenceRange.calculate(0,n.max-n.min),r,0,null,null,[1,2,5]),s=Math.floor(n.min/o.interval)*o.interval,l=new Date(s,0,1),u=t.fromNumericSequence(l,o,e.DateTimeUnit.Year);return u},t.calculateMonths=function(i,a,r){var n=i.getFullYear(),o=a.getFullYear(),s=i.getMonth(),l=12*(o-n)+a.getMonth(),u=new Date(n,0,1),c=e.NumericSequence.calculateUnits(s,l,r,[1,2,3,6,12]),d=t.fromNumericSequence(u,c,e.DateTimeUnit.Month);return d},t.calculateWeeks=function(i,a,r){var n=0,o=i.getDay(),s=(o-n+7)%7,l=i.getDate()-s,u=new Date(i.getFullYear(),i.getMonth(),l),c=0,d=e.Double.ceilWithPrecision(t.getDelta(u,a,e.DateTimeUnit.Week)),p=e.NumericSequence.calculateUnits(c,d,r,[1,2,4,8]),h=t.fromNumericSequence(u,p,e.DateTimeUnit.Week);return h},t.calculateDays=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=0,s=e.Double.ceilWithPrecision(t.getDelta(i,a,e.DateTimeUnit.Day)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,7,14]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Day);return u},t.calculateHours=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Hour)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Hour)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,3,6,12,24]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Hour);return u},t.calculateMinutes=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Minute)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Minute)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,5,10,15,30,60,120,180,360,720,1440]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Minute);return u},t.calculateSeconds=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes()),o=e.Double.floorWithPrecision(t.getDelta(n,i,e.DateTimeUnit.Second)),s=e.Double.ceilWithPrecision(t.getDelta(n,a,e.DateTimeUnit.Second)),l=e.NumericSequence.calculateUnits(o,s,r,[1,2,5,10,15,30,60,120,300,600,900,1800,3600]),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Second);return u},t.calculateMilliseconds=function(i,a,r){var n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()),o=t.getDelta(n,i,e.DateTimeUnit.Millisecond),s=t.getDelta(n,a,e.DateTimeUnit.Millisecond),l=e.NumericSequence.calculate(e.NumericSequenceRange.calculate(o,s),r,0),u=t.fromNumericSequence(n,l,e.DateTimeUnit.Millisecond);return u},t.addInterval=function(t,a,r){switch(a=Math.round(a),r){case e.DateTimeUnit.Year:return i.addYears(t,a);case e.DateTimeUnit.Month:return i.addMonths(t,a);case e.DateTimeUnit.Week:return i.addWeeks(t,a);case e.DateTimeUnit.Day:return i.addDays(t,a);case e.DateTimeUnit.Hour:return i.addHours(t,a);case e.DateTimeUnit.Minute:return i.addMinutes(t,a);case e.DateTimeUnit.Second:return i.addSeconds(t,a);case e.DateTimeUnit.Millisecond:return i.addMilliseconds(t,a)}},t.fromNumericSequence=function(e,i,a){for(var r=new t(a),n=0;n<i.sequence.length;n++){var o=i.sequence[n],s=t.addInterval(e,o,a);r.add(s)}return r.interval=i.interval,r.intervalOffset=i.intervalOffset,r},t.getDelta=function(t,i,a){var r=0;switch(a){case e.DateTimeUnit.Year:r=i.getFullYear()-t.getFullYear();break;case e.DateTimeUnit.Month:r=12*(i.getFullYear()-t.getFullYear())+i.getMonth()-t.getMonth();break;case e.DateTimeUnit.Week:r=(i.getTime()-t.getTime())/6048e5;break;case e.DateTimeUnit.Day:r=(i.getTime()-t.getTime())/864e5;break;case e.DateTimeUnit.Hour:r=(i.getTime()-t.getTime())/36e5;break;case e.DateTimeUnit.Minute:r=(i.getTime()-t.getTime())/6e4;break;case e.DateTimeUnit.Second:r=(i.getTime()-t.getTime())/1e3;break;case e.DateTimeUnit.Millisecond:r=i.getTime()-t.getTime()}return r},t.getIntervalUnit=function(i,a,r){r=Math.max(r,2);var n=t.getDelta(i,a,e.DateTimeUnit.Day);if(n>356&&n>=180*r)return e.DateTimeUnit.Year;if(n>60&&n>7*r)return e.DateTimeUnit.Month;if(n>14&&n>2*r)return e.DateTimeUnit.Week;var o=t.getDelta(i,a,e.DateTimeUnit.Hour);if(n>2&&o>12*r)return e.DateTimeUnit.Day;if(o>=24&&o>=r)return e.DateTimeUnit.Hour;var s=t.getDelta(i,a,e.DateTimeUnit.Minute);if(s>2&&s>=r)return e.DateTimeUnit.Minute;var l=t.getDelta(i,a,e.DateTimeUnit.Second);if(l>2&&l>=.8*r)return e.DateTimeUnit.Second;var u=t.getDelta(i,a,e.DateTimeUnit.Millisecond);if(u>0)return e.DateTimeUnit.Millisecond;var c=i;return 0!==c.getMilliseconds()?e.DateTimeUnit.Millisecond:0!==c.getSeconds()?e.DateTimeUnit.Second:0!==c.getMinutes()?e.DateTimeUnit.Minute:0!==c.getHours()?e.DateTimeUnit.Hour:1!==c.getDate()?e.DateTimeUnit.Day:0!==c.getMonth()?e.DateTimeUnit.Month:e.DateTimeUnit.Year},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t})();e.DateTimeSequence=t;var i;!(function(e){function t(e){return e%4===0&&e%100!==0||e%400===0}function i(e,i){return t(e)?p[i]:d[i]}function a(e,i){var a=e.getFullYear(),r=e.getMonth(),n=e.getDate(),o=2===r&&29===n,s=new Date(e.getTime());return a+=i,o&&!t(a)&&(n=28),s.setFullYear(a,r,n),s}function r(e,t){var a=e.getFullYear(),r=e.getMonth(),n=e.getDate(),o=new Date(e.getTime());return a+=(t-t%12)/12,r+=t%12,r>11&&(r%=12,a++),n=Math.min(n,i(a,r)),o.setFullYear(a,r,n),o}function n(e,t){return o(e,7*t)}function o(e,t){var i=e.getFullYear(),a=e.getMonth(),r=e.getDate(),n=new Date(e.getTime());return n.setFullYear(i,a,r+t),n}function s(e,t){return new Date(e.getTime()+36e5*t)}function l(e,t){return new Date(e.getTime()+6e4*t)}function u(e,t){return new Date(e.getTime()+1e3*t)}function c(e,t){return new Date(e.getTime()+t)}var d=[31,28,31,30,31,30,31,31,30,31,30,31],p=[31,29,31,30,31,30,31,31,30,31,30,31];e.addYears=a,e.addMonths=r,e.addWeeks=n,e.addDays=o,e.addHours=s,e.addMinutes=l,e.addSeconds=u,e.addMilliseconds=c})(i=e.DateUtils||(e.DateUtils={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){function t(t,a){for(var n=[],o=3;o<r;o++){var s=t(o);s&&i(n,e.Double.pow10(o),s.title,s.format,a)}return n}function i(e,t,i,a,r){if(i||a){var n=t;if(e.length>0){var o=e[e.length-1];r&&(n=r(t,o.value,n)),o.applicableRangeMax=n}var s=new d;s.value=t,s.applicableRangeMin=n,s.applicableRangeMax=1e3*n,s.title=i,s.labelFormat=a,e.push(s)}}var r=24,n=1e15,o=1e-4,s="%",l="E+0",u="0.##"+l,c=/^([0\#,]*\.[0\#]+|[0\#,]+|g)$/i,d=(function(){function t(){}return t.prototype.project=function(t){return this.value?e.Double.removeDecimalNoise(t/this.value):t},t.prototype.reverseProject=function(e){return this.value?e*this.value:e},t.prototype.isApplicableTo=function(t){t=Math.abs(t);var i=e.Double.getPrecision(t,3);return e.Double.greaterOrEqualWithPrecision(t,this.applicableRangeMin,i)&&e.Double.lessWithPrecision(t,this.applicableRangeMax,i)},t.prototype.isScaling=function(){return this.value>1},t})();e.DisplayUnit=d;var p=(function(){function t(e){this.units=e?e:[]}return Object.defineProperty(t.prototype,"title",{get:function(){return this.displayUnit?this.displayUnit.title:void 0},enumerable:!0,configurable:!0}),t.prototype.update=function(e){void 0!==e&&(this.unitBaseValue=e,this.displayUnit=this.findApplicableDisplayUnit(e))},t.prototype.findApplicableDisplayUnit=function(e){for(var t=0,i=this.units;t<i.length;t++){var a=i[t];if(a.isApplicableTo(e))return a}},t.prototype.format=function(e,t,i,a){i=this.getNumberOfDecimalsForFormatting(t,i);var r="";return this.isFormatSupported(t)&&!this.hasScientitifcFormat(t)&&this.isScalingUnit()&&this.shouldRespectScalingUnit(t)&&(e=this.displayUnit.project(e),r=this.displayUnit.labelFormat),this.formatHelper(e,r,t,i,a)},t.prototype.isFormatSupported=function(e){return!t.UNSUPPORTED_FORMATS.test(e)},t.prototype.isPercentageFormat=function(e){return e&&e.indexOf(s)>=0},t.prototype.shouldRespectScalingUnit=function(e){return!0},t.prototype.getNumberOfDecimalsForFormatting=function(e,t){return t},t.prototype.isScalingUnit=function(){return this.displayUnit&&this.displayUnit.isScaling()},t.prototype.formatHelper=function(t,i,a,r,n){if("g"!==a&&"G"!==a||null==r||(a=e.visuals.valueFormatter.DefaultNumericFormat),a=e.NumberFormat.addDecimalsToFormat(a,r,n),a&&!e.formattingService.isStandardNumberFormat(a))return e.formattingService.formatNumberWithCustomOverride(t,a,i);a||(a="G"),i||(i="{0}");var o=e.formattingService.formatValue(t,a);return e.formattingService.format(i,[o])},t.prototype.formatSingleValue=function(t,i,a,r){return this.update(this.shouldUseValuePrecision(t)?e.Double.getPrecision(t,8):t),this.format(t,i,a,r)},t.prototype.shouldUseValuePrecision=function(e){if(0===this.units.length)return!0;for(var t=0,i=0;i<this.units.length;i++)if(this.units[i].isScaling()){t=this.units[i].applicableRangeMin;break}return Math.abs(e)<t},t.prototype.isScientific=function(e){return e<-n||e>n||-o<e&&e<o&&0!==e},t.prototype.hasScientitifcFormat=function(e){return e&&e.toUpperCase().indexOf("E")!==-1},t.prototype.supportsScientificFormat=function(e){return!e||c.test(e)},t.prototype.shouldFallbackToScientific=function(e,t){return!this.hasScientitifcFormat(t)&&this.supportsScientificFormat(t)&&this.isScientific(e)},t.prototype.getScientificFormat=function(t,i,a,r){if(this.isFormatSupported(i)&&this.shouldFallbackToScientific(t,i)){var n=e.NumberFormat.getNumericFormat(t,i);return a&&(n=e.NumberFormat.addDecimalsToFormat(n?n:"0",Math.abs(a),r)),n?n+l:u}return i},t.UNSUPPORTED_FORMATS=/^(p\d*)|(e\d*)$/i,t})();e.DisplayUnitSystem=p;var h=(function(e){function t(){e.call(this,[])}return a(t,e),t})(p);e.NoDisplayUnitSystem=h;var g=(function(e){function i(t){e.call(this,i.getUnits(t))}return a(i,e),i.prototype.format=function(t,i,a,r){return i=this.getScientificFormat(t,i,a,r),e.prototype.format.call(this,t,i,a,r)},i.reset=function(){i.units=null},i.getUnits=function(e){return i.units||(i.units=t(e,(function(e,t,i){return e-t>=1e3?e/10:i})),i.units[i.units.length-1].applicableRangeMax=1/0),i.units},i})(p);e.DefaultDisplayUnitSystem=g;var f=(function(e){function i(t){e.call(this,i.getUnits(t))}return a(i,e),i.reset=function(){i.units=null},i.getUnits=function(e){return i.units||(i.units=t(e),i.units[i.units.length-1].applicableRangeMax=1/0),i.units},i.prototype.format=function(t,i,a,r){return i=this.getScientificFormat(t,i,a,r),e.prototype.format.call(this,t,i,a,r)},i})(p);e.WholeUnitsDisplayUnitSystem=f;var m=(function(e){function r(t){e.call(this,r.getUnits(t))}return a(r,e),r.prototype.isFormatSupported=function(e){return!r.UNSUPPORTED_FORMATS.test(e)},r.getUnits=function(e){if(!r.units){var a=[],n=function(e,t,i){return e===-1&&e-t>=1e3?e/10:i},o=e(-1);i(a,r.AUTO_DISPLAYUNIT_VALUE,o.title,o.format,n),o=e(0),i(a,r.NONE_DISPLAYUNIT_VALUE,o.title,o.format,n),r.units=a.concat(t(e,n)),r.units[r.units.length-1].applicableRangeMax=1/0}return r.units},r.prototype.format=function(t,i,a,r){
return i=this.getScientificFormat(t,i,a,r),e.prototype.format.call(this,t,i,a,r)},r.AUTO_DISPLAYUNIT_VALUE=0,r.NONE_DISPLAYUNIT_VALUE=1,r.UNSUPPORTED_FORMATS=/^(e\d*)$/i,r})(p);e.DataLabelsDisplayUnitSystem=m})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(){}return t.calculate=function(i,a,r,n,o,s){var l=new t;if(a=void 0===a?10:e.Double.ensureInRange(a,t.MIN_COUNT,t.MAX_COUNT),void 0===n&&(n=e.Double.MIN_EXP),void 0===o&&(o=!1),void 0===r&&(r=1),void 0===s&&(s=[1,2,5]),i.forcedSingleStop)return l.interval=i.getSize(),l.intervalOffset=l.interval-(i.forcedSingleStop-i.min),l.min=i.min,l.max=i.max,l.sequence=[i.forcedSingleStop],l;var u=0,c=0,d=9,p=r>0&&!i.hasFixedMin,h=r>0&&!i.hasFixedMax,g=i.getSize(),f=e.Double.log10(g),m=e.Double.log10(s[0]);f-=m;var y=e.Double.log10(a);f-=y,f=Math.max(f,n-m+1);var v=void 0;if(0!==u){var w=e.Double.pow10(f),b=e.Double.floorToPrecision(i.min,w),C=e.Double.ceilToPrecision(i.max,w),S=e.NumericSequenceRange.calculateFixedRange(b,C);S.shrinkByStep(i,u),c=S.min,d=S.max,v=Math.floor(S.getSize()/u)}else{var x=void 0;for(x=0;x<3;x++){for(var P=f+x,w=e.Double.pow10(P),b=e.Double.floorToPrecision(i.min,w),C=e.Double.ceilToPrecision(i.max,w),D=s.length,T=e.Double.pow10(P-1),V=0;V<D;V++){var _=s[V]*T,S=e.NumericSequenceRange.calculateFixedRange(b,C,o);if(S.shrinkByStep(i,_),p&&i.min===S.min&&r>=1&&(S.min-=_),h&&i.max===S.max&&r>=1&&(S.max+=_),v=e.Double.ceilWithPrecision(S.getSize()/_,e.Double.DEFAULT_PRECISION),v<=a||2===x&&V===D-1||1===a&&2===v&&(_>i.getSize()||i.min<0&&i.max>0&&2*_>=i.getSize())){u=_,c=S.min,d=S.max;break}}if(0!==u)break}}(v>32*a||v>t.MAX_COUNT)&&(v=Math.min(32*a,t.MAX_COUNT),u=(d-c)/v),l.min=c,l.max=d,l.interval=u,l.intervalOffset=c-i.min,l.maxAllowedMargin=r,l.canExtendMin=p,l.canExtendMax=h;var L=e.Double.getPrecision(u,0);l.precision=L;var M=[],N=e.Double.roundToPrecision(c,L);M.push(N);for(var V=0;V<v;V++)N=e.Double.roundToPrecision(N+u,L),M.push(N);return l.sequence=M,l.trimMinMax(i.min,i.max),l},t.calculateUnits=function(i,a,r,n){r=e.Double.ensureInRange(r,t.MIN_COUNT,t.MAX_COUNT),i===a&&(a=i+1);for(var o=0,s=0,l=0;l<n.length;l++){s=n[l];var u=e.Double.ceilWithPrecision(a/s),c=e.Double.floorWithPrecision(i/s);if(o=u-c,o<=r)break}var d=-i;d%=s;var p=new t;p.sequence=[];for(var h=i+d;p.sequence.push(h),!(h>=a);h+=s);return p.interval=s,p.intervalOffset=d,p.min=p.sequence[0],p.max=p.sequence[p.sequence.length-1],p},t.prototype.trimMinMax=function(e,t){var i=(e-this.min)/this.interval,a=(this.max-t)/this.interval,r=.001;(!this.canExtendMin||i>this.maxAllowedMargin&&i>r)&&(this.min=e),(!this.canExtendMax||a>this.maxAllowedMargin&&a>r)&&(this.max=t)},t.MIN_COUNT=1,t.MAX_COUNT=1e3,t})();e.NumericSequence=t})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t=(function(){function t(){}return t.prototype._ensureIncludeZero=function(){this.includeZero&&(this.min>0&&!this.hasFixedMin&&(this.min=0),this.max<0&&!this.hasFixedMax&&(this.max=0))},t.prototype._ensureNotEmpty=function(){if(this.min===this.max)if(this.min){var i=this.min,a=e.Double.log10(Math.abs(i)),r=void 0;a>=0&&a<4?(r=.5,this.forcedSingleStop=i):(r=e.Double.pow10(a)/2,this.forcedSingleStop=null),this.min=i-r,this.max=i+r}else this.min=0,this.max=t.DEFAULT_MAX,this.hasFixedMin=!0,this.hasFixedMax=!0},t.prototype._ensureDirection=function(){if(this.min>this.max){var e=this.min;this.min=this.max,this.max=e}},t.prototype.getSize=function(){return this.max-this.min},t.prototype.shrinkByStep=function(e,t){var i=this.min/t,a=e.min/t,r=Math.floor(a-i);this.min+=r*t,i=this.max/t,a=e.max/t,r=Math.ceil(a-i),this.max+=r*t},t.calculate=function(a,r,n,o,s){var l=new t;return l.includeZero=!!s,l.hasDataRange=i.hasValue(a)&&i.hasValue(r),l.hasFixedMin=i.hasValue(n),l.hasFixedMax=i.hasValue(o),a=e.Double.ensureInRange(a,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),r=e.Double.ensureInRange(r,t.MIN_SUPPORTED_DOUBLE,t.MAX_SUPPORTED_DOUBLE),l.hasFixedMin&&l.hasFixedMax?(l.min=n,l.max=o):l.hasFixedMin?(l.min=n,l.max=r>n?r:n):l.hasFixedMax?(l.min=a<o?a:o,l.max=o):l.hasDataRange?(l.min=a,l.max=r):(l.min=0,l.max=0),l._ensureIncludeZero(),l._ensureNotEmpty(),l._ensureDirection(),0===l.min?l.hasFixedMin=!0:0===l.max&&(l.hasFixedMax=!0),l},t.calculateDataRange=function(e,a,r){return i.hasValue(e)&&i.hasValue(a)?t.calculate(e,a,null,null,r):t.calculateFixedRange(0,t.DEFAULT_MAX)},t.calculateFixedRange=function(e,i,a){var r=new t;return r.hasDataRange=!1,r.includeZero=a,r.min=e,r.max=i,r._ensureIncludeZero(),r._ensureNotEmpty(),r._ensureDirection(),r.hasFixedMin=!0,r.hasFixedMax=!0,r},t.DEFAULT_MAX=10,t.MIN_SUPPORTED_DOUBLE=-1e307,t.MAX_SUPPORTED_DOUBLE=1e307,t})();e.NumericSequenceRange=t;var i;!(function(e){function t(e){return void 0!==e&&null!==e}e.hasValue=t})(i=e.ValueUtil||(e.ValueUtil={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(e){var t=x[e];return t?P[t]||e:e}function r(e){var t=e===-1?"Auto":e.toString(),i=P["DisplayUnitSystem_E"+t+"_Title"],a=e<=0?"{0}":P["DisplayUnitSystem_E"+t+"_LabelFormat"];if(i||a)return{title:i,format:a}}function n(e){return P[e]}function o(t){return e.NumberFormat.getCustomFormatMetadata(t)}function s(t){D=t,e.DefaultDisplayUnitSystem.reset(),e.WholeUnitsDisplayUnitSystem.reset()}function l(e,t){void 0===t&&(t=!1);var i=t?D.beautify(e):e;return{format:function(e){return null==e?D.null:w(e,i)}}}function u(t){var i=t.allowFormatBeautification?D.beautify(t.format):t.format;if(h(t)){var a=p(t.displayUnitSystemType),r=!!t.formatSingleValues;a.update(Math.max(Math.abs(t.value||0),Math.abs(t.value2||0)));var n,o=null!=t.precision;return o?n=-t.precision:a.displayUnit&&a.displayUnit.value>1&&(n=-T),{format:function(t){var s=b(t,!0);return S.isNullOrUndefinedOrWhiteSpaceString(s)?(t&&!a.isScalingUnit()&&Math.abs(t)<V&&!o&&(t=e.Double.roundToPrecision(t)),r?a.formatSingleValue(t,i,n,o):a.format(t,i,n,o)):s},displayUnit:a.displayUnit,options:t}}if(g(t.value,t.value2,t.tickCount)){var s=e.DateTimeSequence.getIntervalUnit(t.value,t.value2,t.tickCount);return{format:function(t){if(null==t)return D.null;var i=e.formattingService.dateFormatString(s);return w(t,i)},options:t}}return l(i)}function c(e,t,i){return null==e?D.null:w(e,i?D.beautify(t):t)}function d(e,t,i,a){if(!(t&&t.type&&t.type.dateTime)&&e instanceof Date){var r=f(M,null,!1);return w(e,r,a)}return w(e,f(t,i),a)}function p(t){if(null==t)return new e.DefaultDisplayUnitSystem(D.describe);switch(t){case e.DisplayUnitSystemType.Default:return new e.DefaultDisplayUnitSystem(D.describe);case e.DisplayUnitSystemType.WholeUnits:return new e.WholeUnitsDisplayUnitSystem(D.describe);case e.DisplayUnitSystemType.Verbose:return new e.NoDisplayUnitSystem;case e.DisplayUnitSystemType.DataLabels:return new e.DataLabelsDisplayUnitSystem(D.describe);default:return new e.DefaultDisplayUnitSystem(D.describe)}}function h(t){var i=t.value,a=t.value2,r=t.format;if(t.formatSingleValues&&r&&Math.abs(i)<_){var n=!e.NumberFormat.isStandardFormat(r);if(n){var o=e.NumberFormat.getCustomFormatMetadata(r,!0).precision;if(o<L)return!1}else if(e.Double.isInteger(i))return!1}if("number"==typeof i||"number"==typeof a)return!0}function g(e,t,i){return e instanceof Date&&t instanceof Date&&void 0!==i&&null!==i}function f(i,a,r){if(i){if(a){var n=e.DataViewObjects.getValue(i.objects,a);if(n)return n}if(!r){var o=i.type;if(o){if(o.dateTime)return t.DefaultDateFormat;if(o.integer)return o.temporal&&o.temporal.year?"0":t.DefaultIntegerFormat;if(o.numeric)return t.DefaultNumericFormat}}}}function m(e,t){var i;if(!e)return null;var a=e.length;if(a>0){i=e[0];for(var r=a-1,n=1,o=r;n<o;n++){var s=e[n];i=S.format(D.restatementComma,i,s)}if(a>1){var s=e[r];i=S.format(t,i,s)}}else i=null;return i}function y(e){return m(e,D.restatementCompoundAnd)}function v(e){return m(e,D.restatementCompoundOr)}function w(t,i,a){var r=b(t,!!a&&a);return S.isNullOrUndefinedOrWhiteSpaceString(r)?e.formattingService.formatValue(t,i):r}function b(e,t){return null==e&&t?D.null:e===!0?D.true:e===!1?D.false:"number"==typeof e&&isNaN(e)?D.NaN:e===Number.NEGATIVE_INFINITY?D.negativeInfinity:e===Number.POSITIVE_INFINITY?D.infinity:""}function C(e){var t=p(e);return t.units}var S=a.StringExtensions,x={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"};t.DefaultIntegerFormat="g",t.DefaultNumericFormat="#,0.00",t.DefaultDateFormat="d";var P={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",RestatementComma:"{0}, {1}",RestatementCompoundAnd:"{0} and {1}",RestatementCompoundOr:"{0} or {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",Funnel_PercentOfFirst:"Percent of first",Funnel_PercentOfPrevious:"Percent of previous",Funnel_PercentOfFirst_Highlight:"Percent of first (highlighted)",Funnel_PercentOfPrevious_Highlight:"Percent of previous (highlighted)",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Longitude_Short2:"long",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories"};t.getLocalizedString=n;var D={null:P.NullValue,true:P.BooleanTrue,false:P.BooleanFalse,NaN:P.NaNValue,infinity:P.InfinityValue,negativeInfinity:P.NegativeInfinityValue,beautify:function(e){return i(e)},describe:function(e){return r(e)},restatementComma:P.RestatementComma,restatementCompoundAnd:P.RestatementCompoundAnd,restatementCompoundOr:P.RestatementCompoundOr},T=2,V=1e3,_=1e4,L=2,M={displayName:"",type:e.ValueType.fromPrimitiveTypeAndCategory(7)};t.getFormatMetadata=o,t.setLocaleOptions=s,t.createDefaultFormatter=l,t.create=u,t.format=c,t.formatVariantMeasureValue=d,t.createDisplayUnitSystem=p,t.getFormatString=f,t.formatListAnd=y,t.formatListOr=v,t.getDisplayUnits=C})(i=t.valueFormatter||(t.valueFormatter={}))})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){!(function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Week=2]="Week",e[e.Day=3]="Day",e[e.Hour=4]="Hour",e[e.Minute=5]="Minute",e[e.Second=6]="Second",e[e.Millisecond=7]="Millisecond"})(e.DateTimeUnit||(e.DateTimeUnit={}));e.DateTimeUnit})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.Prototype.inheritSingle;!(function(e){function t(e){return!_.isEmpty(e)&&e[0].objects}function i(e,t){if(!_.isEmpty(e)){var i=a(e),r=i[0]=a(i[0]);return r.objects=t,i}}function r(e){var t=_.isEmpty(e.categories)?_.isEmpty(e.values)?0:e.values[0].values.length:e.categories[0].values.length;return t}e.getCategoriesDataViewObjects=t,e.setCategoriesDataViewObjects=i,e.getRowCount=r})(i=t.DataViewCategoricalUtils||(t.DataViewCategoricalUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=e.Prototype.inherit,n=e.Prototype.inheritSingle,o=a.ArrayExtensions;!(function(e){function i(e){return _.isEmpty(e.children)}function a(e,t){if(e)if(u(e))for(var i=0,a=e;i<a.length;i++){var r=a[i];r&&s(r,[],t)}else s(e,[],t)}function s(e,t,i){t.push(e);var a=i(e,t),r=null!=a&&0!==a;if(1===a){var n=e.children;if(!_.isEmpty(n))for(var o=0,l=n;o<l.length;o++){var u=l[o];if(u&&(r=s(u,t,i),!r))break}}return t.pop(),r}function l(e,t){var r=0;a(e,(function(e,a){return i(e)&&(t(e,r,a),r++),1}))}function u(e){return o.isArrayOrInheritedArray(e)}function c(e,t,i){if(e.level===t)return void i(e);var a=e.children;if(a&&a.length>0)for(var r=0,n=a.length;r<n;r++)c(a[r],t,i)}function d(e,t,i){var a=e,o=void 0===e.level,s=o||e.level<=t;if(s){var l=i?n:r,u=l(e),c=o||e.level<t;if(c&&!_.isEmpty(e.children)){u.children=l(e.children);for(var p=0,h=u.children.length;p<h;p++)u.children[p]=d(u.children[p],t,i)}a=u}return a}function p(e){var t=!1;if(e)if(y(e))t=p(e.rows)||p(e.columns);else{var i=e.levels;if(!_.isEmpty(i))for(var a=0,r=i;a<r.length;a++){var n=r[a];if(n.sources&&n.sources.length>=2){var o=n.sources[0].isMeasure;if(!o){t=!0;break}}}}return t}function h(e){var t=e.rows&&e.rows.levels,i=e.columns&&e.columns.levels,a=e.valueSources,r={primaryAxis:!_.isEmpty(t)&&g(t),secondaryAxis:!_.isEmpty(i)&&g(i),intersection:!_.isEmpty(a)&&_.map(a,(function(e){return e.index}))};return r}function g(e){return _.map(e,(function(e){var t=e.sources,i={selectIndices:_.map(t,(function(e){return e.index}))};return i}))}function f(e){return e&&e.rows&&!_.isEmpty(e.rows.levels)?e.rows.levels.length:0}function m(e){return e&&e.columns&&!_.isEmpty(e.columns.levels)?e.columns.levels.length-(t.DataViewMatrixMeasureHeaders.hasMeasureHeadersLevel(e.columns.levels)?1:0):0}function y(e){return"rows"in e&&"columns"in e&&"valueSources"in e}function v(e){if(e&&!_.isEmpty(e.children)){var t=[];return l(e,(function(e,i,a){t.push(e)})),t}}e.isLeafNode=i,e.forEachNodeDepthFirst=a,e.forEachLeafNode=l,e.forEachNodeAtLevel=c,e.inheritMatrixNodeHierarchy=d,e.containsCompositeGroup=p,e.extractSelectIndices=h,e.getRowGroupingLevelsCount=f,e.getColumnGroupingLevelsCount=m,e.getLeafNodes=v})(i=t.DataViewMatrixUtils||(t.DataViewMatrixUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){var i=e.roles;return!!i&&!!i[t]}function i(e,t){var i=e.roles;return!!i&&_.any(t,(function(e){return i[e]}))}function a(e,t){if(!e)return!1;if(!e[t])return!1;if(_.size(e)>=2)for(var i in e)if(i!==t&&e[i])return!1;return!0}function r(e,t,a){var r=[];if(!_.isEmpty(e))for(var o=n(t),s=0,l=e.length;s<l;s++){var u=e[s];if(!a||i(u,a)){var c=o[u.index];if(_.isEmpty(c)){var d={metadataColumn:u,sourceIndex:s,projectionOrderIndex:void 0};r.push(d)}else for(var p=0,h=c;p<h.length;p++){var g=h[p],d={metadataColumn:u,sourceIndex:s,projectionOrderIndex:g};r.push(d)}}}return r}function n(e){for(var t={},i=0,a=e.length;i<a;i++){var r=e[i],n=t[r];n||(n=t[r]=[]),n.push(i)}return t}e.isForRole=t,e.isForAnyRole=i,e.isExactMatchRole=a,e.leftJoinMetadataColumnsAndProjectionOrder=r})(t=e.DataViewMetadataColumnUtils||(e.DataViewMetadataColumnUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){t.scalarKeyMinPropertyIdentifier={objectName:"scalarKey",propertyName:"min"};var i;!(function(t){function i(t,i){var a;if(t&&(a=t.objects),!_.isEmpty(a)){for(var r=void 0,n=a.length,o=0;o<n;o++){var s=a[o],l=e.DataViewObjects.getValue(s,i);if(void 0!==l){r||(r={values:new Array(n)});var u={min:l};r.values[o]=u}}return r}}t.getScalarKeys=i})(i=t.ScalarKeyUtils||(t.ScalarKeyUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){var a=e.categorical;a&&i(a,t);var r=e.table;r&&n(r,t);var s=e.matrix;s&&o(s,t);var l=e.tree;l&&p(l,t);var u=e.single;u&&S(u,t)}function i(e,t){a(e.categories,t);var i=e.values;r(i,t),b(i,t)}function a(e,t){e&&(f(e,t),m(e,t),v(e,t),C(e,t))}function r(e,t){if(e){f(e,t,0),m(e,t,0),v(e,t,0);var i=e.group;if(i)for(var a=0,r=i.select;a<r.length;a++){var n=r[a];f(n,t,1),m(n,t,1)}}}function n(e,t){var i=e.rows;f(i,t),m(i,t),v(i,t),C(i,t)}function o(e,t){s(e.rows,t),l(e.columns,t),u(e.values,t)}function s(e,t){c(e,t)}function l(e,t){d(e,t)}function u(e,t){d(e,t)}function c(e,t){e&&(m(e,t),w(e,t),C(e,t))}function d(e,t){e&&(m(e,t),v(e,t),C(e,t))}function p(e,t){h(e.nodes,t),g(e.values,t)}function h(e,t){e&&(m(e,t),C(e,t))}function g(e,t){e&&m(e,t)}function f(e,t,i){var a=e.bind;a&&(null!=i?t.visitRole(a.to,i):t.visitRole(a.to))}function m(e,t,i){var a=e.for;a&&(null!=i?t.visitRole(a.in,i):t.visitRole(a.in))}function y(e,t,i){var a=e.composite;if(a){t.enterComposite&&t.enterComposite();for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i)}t.exitComposite&&t.exitComposite()}}function v(e,t,i){var a=e.select;if(a)for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i)}}function w(e,t,i){var a=e.select;if(a)for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i),y(o,t,i)}}function b(e,t){if(e){var i=e.group;i&&(t.visitRole(i.by),C(i,t))}}function C(e,t){if(t.visitReduction){var i=e.dataReductionAlgorithm;i&&t.visitReduction(i)}}function S(e,t){t.visitRole(e.role)}e.visitMapping=t,e.visitCategoricalCategories=a,e.visitCategoricalValues=r,e.visitTable=n,e.visitMatrixRows=s,e.visitMatrixColumns=l,e.visitMatrixValues=u,e.visitTreeNodes=h,e.visitTreeValues=g,e.visitGrouped=b})(t=e.CompiledDataViewMapping||(e.CompiledDataViewMapping={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){if(!_.isEmpty(e)){var i=e[0];if(i.values&&i.values.length>0)for(var r=0,n=i.values.length;r<n;++r){var o=i.values[r];if(o&&o.source&&a(o.source,t))return r}}return-1}function i(e,t){if(!_.isEmpty(e))for(var i=0,r=e.length;i<r;i++)if(a(e[i].source,t))return i;return-1}function a(e,t){var i=e.roles;return i&&i[t]}function r(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&_.any(e.metadata.columns,(function(e){return e.roles&&void 0!==e.roles[t]}))}function n(e,t){return e&&e.source&&e.source.roles&&e.source.roles[t]===!0}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=i,e.hasRole=a,e.hasRoleInDataView=r,e.hasRoleInValueColumn=n})(t=e.DataRoleHelper||(e.DataRoleHelper={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.StringExtensions,n=e.Prototype.inheritSingle;!(function(i){function a(e,i){var a=e.categorical;if(!a||_.isEmpty(a.categories))return e;var r=a.categories,s=t.ScalarKeyUtils.getScalarKeys(r[0],t.scalarKeyMinPropertyIdentifier);if(!s||_.isEmpty(s.values))return e;for(var l,u,c,d,p=[],h=0,g=r.length;h<g;h++)for(var f=r[h],m=f.source.type,y=f.values,v=void 0,w=void 0,b=0,C=_.size(y);b<C;b++){var S=y[b],x=s.values[b];if(null==S&&null!=x){l||(l=n(e),u=l.categorical=n(a),c=u.categories=n(r)),v||(v=c[h]=n(f),w=v.values=n(y));var P=o(x.min,m,i);w[b]=P,p[b]||(d||(d=b),p[b]=[]),p[b][h]=t.SQExprBuilder.typedConstant(P,m)}}for(var h=0,g=_.size(c);h<g;h++)for(var f=c[h],D=d,T=_.size(f.identity);D<T;D++){var V=p[D];V&&(f.identity[D]=t.createDataViewScopeIdentity(t.SQExprUtils.getDataViewScopeIdentityComparisonExpr(f.identityFields,V)))}return l||e}function o(e,t,i){if(!_.isDate(e)||!t||!t.temporal)return null;var a=e;return t.temporal.year?s(a):t.temporal.quarter?l(a,i):t.temporal.month?u(a):t.temporal.day?c(a):void 0}function s(e){return e.getFullYear()}function l(e,t){var i=3,a=Math.floor((e.getMonth()+i)/i);return r.format(t,a.toLocaleString())}function u(t){return e.formattingService.formatValue(t,"MMMM")}function c(e){return e.getDate()}i.apply=a})(i=t.DataViewHierarchyLevelBackfill||(t.DataViewHierarchyLevelBackfill={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){return new r(e)}var a=e.data.DataRoleHelper;t.createIDataViewCategoricalReader=i;var r=(function(){function e(e){this.dataView=e;var t;e&&(t=e.categorical);var i;t&&(i=this.categories=t.categories),this.hasValidCategories=!_.isEmpty(i);var a;if(t&&(a=t.values),this.hasAnyValidValues=!1,null!=a){var r=e.categorical.values.grouped();if(r.length>0){this.hasAnyValidValues=!0,this.grouped=r;for(var n={},o=r[0].values,s=0,l=o.length;s<l;s++){var u=o[s].source.roles;for(var c in u)u[c]&&(n[c]||(n[c]=[]),n[c].push(s))}this.valueRoleIndexMapping=n}}this.hasAnyValidValues&&(this.dataHasDynamicSeries=!!this.dataView.categorical.values.source)}return e.prototype.hasCategories=function(){return this.hasValidCategories},e.prototype.getCategoryCount=function(){return this.hasValidCategories?this.categories[0].values.length:0},e.prototype.getCategoryValues=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.values:void 0}},e.prototype.getCategoryValue=function(e,t){if(this.hasValidCategories){var i=this.getCategoryFromRole(e);return i?i.values[t]:void 0}},e.prototype.getCategoryColumn=function(e){if(this.hasValidCategories)return this.getCategoryFromRole(e)},e.prototype.getCategoryMetadataColumn=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.source:void 0}},e.prototype.getCategoryColumnIdentityFields=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.identityFields:void 0}},e.prototype.getCategoryDisplayName=function(e){if(this.hasValidCategories){var t=this.getCategoryColumn(e);if(t&&t.source)return t.source.displayName}},e.prototype.hasCompositeCategories=function(){if(this.hasValidCategories)return this.categories.length>1},e.prototype.hasCategoryWithRole=function(e){return a.getCategoryIndexOfRole(this.categories,e)!==-1},e.prototype.getCategoryObjects=function(e,t){if(this.hasValidCategories){var i=this.getCategoryFromRole(e);if(i&&i.objects)return i.objects[t]}},e.prototype.getCategoryFromRole=function(e){var t=this.categories;return t[a.getCategoryIndexOfRole(t,e)]},e.prototype.hasValues=function(e){return this.valueRoleIndexMapping&&!_.isEmpty(this.valueRoleIndexMapping[e])},e.prototype.hasHighlights=function(e){return!!this.hasValues(e)&&!_.isEmpty(this.grouped[0].values[this.valueRoleIndexMapping[e][0]].highlights)},e.prototype.getValue=function(e,t,i){if(void 0===i&&(i=0),this.hasValues(e))return this.dataHasDynamicSeries?this.getValueInternal(e,t,i,0,!1):this.getValueInternal(e,t,0,i,!1)},e.prototype.getHighlight=function(e,t,i){if(void 0===i&&(i=0),this.hasValues(e))return this.dataHasDynamicSeries?this.getValueInternal(e,t,i,0,!0):this.getValueInternal(e,t,0,i,!0)},e.prototype.getAllValuesForRole=function(e,t,i){if(void 0===i&&(i=0),this.hasValues(e)){for(var a=[],r=0,n=this.valueRoleIndexMapping[e].length;r<n;r++)a.push(this.getValueInternal(e,t,i,r,!1));return a}},e.prototype.getAllHighlightsForRole=function(e,t,i){if(void 0===i&&(i=0),this.hasValues(e)){for(var a=[],r=0,n=this.valueRoleIndexMapping[e].length;r<n;r++)a.push(this.getValueInternal(e,t,i,r,!0));return a}},e.prototype.getValueInternal=function(e,t,i,a,r){if(this.hasValues(e)){var n=this.valueRoleIndexMapping[e][a],o=this.grouped[i].values[n];return r?o.highlights[t]:o.values[t]}},e.prototype.getFirstNonNullValueForCategory=function(e,t){if(this.hasValues(e)){if(!this.dataHasDynamicSeries)return this.getValue(e,t);for(var i=0,a=this.grouped.length;i<a;i++){var r=this.getValue(e,t,i);if(null!=r)return r}}},e.prototype.getMeasureQueryName=function(e){if(this.hasValues(e))return this.grouped[0].values[this.valueRoleIndexMapping[e][0]].source.queryName},e.prototype.getValueColumn=function(e,t){if(void 0===t&&(t=0),this.hasValues(e))return this.dataHasDynamicSeries?this.grouped[t].values[this.valueRoleIndexMapping[e][0]]:this.grouped[0].values[this.valueRoleIndexMapping[e][t]]},e.prototype.getValueMetadataColumn=function(e,t){void 0===t&&(t=0);var i=this.getValueColumn(e,t);if(i)return i.source},e.prototype.getAllValueMetadataColumnsForRole=function(e,t){if(void 0===t&&(t=0),this.hasValues(e)){for(var i=[],a=0,r=this.valueRoleIndexMapping[e].length;a<r;a++){var n=this.grouped[t].values[this.valueRoleIndexMapping[e][a]].source;i.push(n)}return i}},e.prototype.getValueDisplayName=function(e,t){if(this.hasValues(e)){var i=this.getValueColumn(e,t);if(i&&i.source)return i.source.displayName}},e.prototype.hasDynamicSeries=function(){return this.dataHasDynamicSeries},e.prototype.getSeriesCount=function(e){if(this.hasAnyValidValues){if(this.dataHasDynamicSeries)return this.grouped.length;var t=e&&this.valueRoleIndexMapping[e];return t?t.length:1}},e.prototype.getSeriesObjects=function(e){if(this.hasAnyValidValues)return this.grouped[e].objects},e.prototype.getSeriesValueColumns=function(){if(this.hasAnyValidValues)return this.dataView.categorical.values},e.prototype.getSeriesValueColumnGroup=function(e){if(this.hasAnyValidValues)return this.grouped[e]},e.prototype.getSeriesMetadataColumn=function(){if(this.hasAnyValidValues)return this.dataView.categorical.values.source},e.prototype.getSeriesColumnIdentityFields=function(){if(this.hasAnyValidValues)return this.dataView.categorical.values.identityFields},e.prototype.getSeriesName=function(e){if(this.hasAnyValidValues)return this.grouped[e].name},e.prototype.getSeriesDisplayName=function(){if(this.hasAnyValidValues&&this.dataHasDynamicSeries)return this.dataView.categorical.values.source.displayName},e.prototype.getStaticObjects=function(){if(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects)return this.dataView.metadata.objects},e.prototype.getMetadataColumns=function(e){var t=[];return this.dataView&&this.dataView.metadata&&this.dataView.metadata.columns&&(t=_.filter(this.dataView.metadata.columns,(function(t){return null!=t.roles&&null!=t.roles[e]}))),t},e})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.Prototype.inherit,r=e.Prototype.inheritSingle,n=e.visuals.valueFormatter;!(function(i){function o(e,t,i,a,r){var n=e,o=e.categorical;if(o){var s=u(o,i),c=l(e.metadata);if(s&&(s.categories.length>=2||c)){var d=_.chain(r&&r[s.roleName]).filter((function(e){return e.suppressConcat})).map((function(e){return e.queryRef})).value();n=p(e,t,s.roleName,s.categories,d,c)}}return n}function s(e,t,i,r){var n;if(!_.isEmpty(r.categories)&&r.categories.length>=2){var o=a(e.columns),s=a(e,(function(e){e.columns=o})),l={metadata:s,categorical:r};n=p(l,t,i,r.categories,[])}else n={metadata:e,categorical:r};return n}function l(e){var i=_.find(e.columns,(function(e){return e.expr instanceof t.SQHierarchyLevelExpr}));if(i){var a=i.expr,r=a.arg;if(r instanceof t.SQHierarchyExpr){var n=r.arg;if(n instanceof t.SQPropertyVariationSourceExpr)return n.property}}}function u(t,i){var a,r=_.chain(i).filter((function(t){return!e.DataViewMapping.getRegressionUsage(t)})).map((function(e){return e.categorical})).value(),n=!_.isEmpty(r)&&_.every(r,(function(e){return!!e}));if(n){var o=c(r);if(o&&d(o,i)){var s=_.filter(t.categories,(function(e){return e.source.roles&&!!e.source.roles[o]}));if(!_.isEmpty(s)){var l=_.every(s,(function(e){return e.values.length===s[0].values.length}));l&&(a={roleName:o,categories:s})}}}return a}function c(t){var i=e.DataViewMapping.getRolesIfSameInAllCategoricalMappings(t,e.DataViewMapping.getAllRolesInCategories);if(1===_.size(i))return _.first(i)}function d(e,t){var i=_.every(t,(function(t){return!_.isEmpty(t.conditions)&&_.every(t.conditions,(function(t){return t[e]&&1===t[e].max}))}));return i}function p(i,a,n,o,s,l){var u,c,d=_.filter(o,(function(e){return!_.contains(s,e.source.queryName)}));if(1===o.length)u=d[0].values,c=d[0].source.type;else{var p=t.DataViewObjectDescriptors.findFormatString(a);u=g(d,p),c=e.ValueType.fromDescriptor({text:!0})}var h=_.map(d,(function(e){return e.source})),v=f(n,h,c,l),w=r(i);m(w,v);var b=i.categorical,C=t.DataViewCategoricalUtils.getCategoriesDataViewObjects(b.categories),S=y(d,v,u,C),x=_.last(o),P=_.findIndex(b.categories,(function(e){return e===x})),D=r(b.categories);D.splice(P,0,S);for(var T=function(e){_.find(o,(function(t){return t===D[e]}))&&D.splice(e,1)},V=D.length-1;V>=0;V--)T(V);var L=r(b);return L.categories=D,w.categorical=L,w}function h(e,t){return e+" "+t}function g(e,t){for(var i=[],a=0,r=e;a<r.length;a++)for(var o=r[a],s=n.getFormatString(o.source,t),l=0,u=o.values.length;l<u;l++){var c=o.values&&o.values[l],d=n.format(c,s);i[l]=void 0===i[l]?d:i[l]+" "+d}return i}function f(e,t,i,a){var r;if(a){var n=_.last(t).displayName;r=h(a,n)}else for(var o=0,s=t;o<s.length;o++){var l=s[o];r=null==r?l.displayName:r+" "+l.displayName}var u={};u[e]=!0;var c={displayName:r,roles:u,type:i},d=_.last(t);return void 0!==d.isMeasure&&(c.isMeasure=d.isMeasure),c.queryName=d.queryName,c}function m(e,t){var i=r(e.metadata.columns);i.push(t);var a=r(e.metadata);a.columns=i,e.metadata=a}function y(e,t,i,a){var r={source:t,values:i},n=e[0];return n.identity&&(r.identity=n.identity),n.identityFields&&(r.identityFields=n.identityFields),a&&(r.objects=a),r}i.detectAndApply=o,i.applyToPlayChartCategorical=s})(i=t.DataViewConcatenateCategoricalColumns||(t.DataViewConcatenateCategoricalColumns={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=a.ArrayExtensions;!(function(e){function t(e){var t=e&&e.usage&&e.usage.regression;return t||void 0}function a(e,t){var i=[];if(e){var a={visitRole:function(e){i.push(e)}};t(e,a)}return i}function r(e){var t=e&&e.usage&&e.usage.forecast;return!!t}function n(e,t){if(0!==_.size(e)){var a=_.map(e,(function(e){return t(e)})),r=a[0];if(!(a.length>=2)||_.every(a,(function(e){return i.sequenceEqual(e,r,(function(e,t){return e===t}))})))return r}}function o(t){if(!t.categories)return[];var i=[];return e.visitCategoricalCategories(t.categories,{visitRole:function(e){i.push(e)}}),i}e.getRegressionUsage=t,e.getRoles=a,e.isForecastDefined=r,e.getRolesIfSameInAllCategoricalMappings=n,e.getAllRolesInCategories=o})(t=e.DataViewMapping||(e.DataViewMapping={}));
})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){var a=e.categorical;a&&i(a,t);var r=e.table;r&&n(r,t);var s=e.matrix;s&&o(s,t);var l=e.tree;l&&p(l,t);var u=e.single;u&&S(u,t)}function i(e,t){a(e.categories,t);var i=e.values;r(i,t),b(i,t)}function a(e,t){e&&(f(e,t),m(e,t),v(e,t),C(e,t))}function r(e,t){if(e){f(e,t,0),m(e,t,0),v(e,t,0);var i=e.group;if(i)for(var a=0,r=i.select;a<r.length;a++){var n=r[a];f(n,t,1),m(n,t,1)}}}function n(e,t){var i=e.rows;f(i,t),m(i,t),v(i,t),C(i,t)}function o(e,t){s(e.rows,t),l(e.columns,t),u(e.values,t)}function s(e,t){c(e,t)}function l(e,t){d(e,t)}function u(e,t){d(e,t)}function c(e,t){e&&(m(e,t),w(e,t),C(e,t))}function d(e,t){e&&(m(e,t),v(e,t),C(e,t))}function p(e,t){h(e.nodes,t),g(e.values,t)}function h(e,t){e&&(m(e,t),C(e,t))}function g(e,t){e&&m(e,t)}function f(e,t,i){var a=e.bind;a&&(null!=i?t.visitRole(a.to,i):t.visitRole(a.to))}function m(e,t,i){var a=e.for;a&&(null!=i?t.visitRole(a.in,i):t.visitRole(a.in))}function y(e,t,i){var a=e.composite;if(a){t.enterComposite&&t.enterComposite();for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i)}t.exitComposite&&t.exitComposite()}}function v(e,t,i){var a=e.select;if(a)for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i)}}function w(e,t,i){var a=e.select;if(a)for(var r=0,n=a;r<n.length;r++){var o=n[r];f(o,t,i),m(o,t,i),y(o,t,i)}}function b(e,t){if(e){var i=e.group;i&&(t.visitRole(i.by),C(i,t))}}function C(e,t){if(t.visitReduction){var i=e.dataReductionAlgorithm;i&&t.visitReduction(i)}}function S(e,t){t.visitRole(e.role)}e.visitMapping=t,e.visitCategorical=i,e.visitCategoricalCategories=a,e.visitCategoricalValues=r,e.visitTable=n,e.visitMatrixRows=s,e.visitMatrixColumns=l,e.visitMatrixValues=u,e.visitTreeNodes=h,e.visitTreeValues=g,e.visitGrouped=b})(t=e.DataViewMapping||(e.DataViewMapping={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.Prototype.inheritSingle;!(function(t){function i(e){var t=_.filter(e.dataRoles,(function(e){return!_.isEmpty(e.requiredTypes)}));r(e.dataview,e.dataViewMappings,t)}function r(e,t,i){if(!_.isEmpty(t)&&!_.isEmpty(i)){for(var a=n(e.metadata.columns,i),r=o(e.metadata.columns,i),s={},l=0,h=t;l<h.length;l++){var f=h[l];for(var m in f)null!=e[m]&&(s[m]=!0)}s.categorical&&u(e.categorical,a,r),s.table&&c(e.table,a,r),s.tree&&d(e.tree.root,a,r),s.matrix&&p(e.matrix,a,r),s.single&&g(e,t,i,r)}}function n(e,t){if(!e||!t)return function(){return!1};for(var i={},a=0,r=e;a<r.length;a++){var n=r[a],o=n.roles;if(o)for(var s=0,l=t;s<l.length;s++){var u=l[s];if(o[u.name]){i[n.index]=!0;break}}}return function(e){return!isNaN(e)&&!!i[e]}}function o(e,t){if(!e||!t)return function(){return!0};for(var i=[],a=0,r=e;a<r.length;a++){var n=r[a],o=s(n,t);o&&(i[n.index]=o)}return function(e,t){return!i[e]||i[e](t)}}function s(e,t){var i=l(e,t);if(!_.isEmpty(i))return function(e){return m(e,i)}}function l(t,i){var a=[],r=t&&t.roles;if(!r)return a;for(var n=0,o=i;n<o.length;n++){var s=o[n];if(r[s.name])for(var l=0,u=s.requiredTypes;l<u.length;l++){var c=u[l],d=e.ValueType.fromDescriptor(c);a.push(d)}}return a}function u(e,t,i){var a=e&&e.values;if(a){var r=a.grouped();if(r)for(var n=0,o=r;n<o.length;n++)for(var s=o[n],l=s.values,u=0,c=l;u<c.length;u++){var d=c[u],p=d.source.index;if(t(p))for(var h=0,g=d.values.length;h<g;h++)d.values=f(d.values,h,p,i)}}}function c(e,t,i){var a=e&&e.columns;if(a){for(var r=[],n=0,o=a;n<o.length;n++){var s=o[n];t(s.index)&&r.push(s.index)}for(var l=e.rows,u=0,c=l.length;u<c;u++)for(var d=0,p=r;d<p.length;d++){var h=p[d];l[u]=f(l[u],h,h,i)}}}function d(e,t,i){if(e.values)for(var a in e.values)t(a)&&("object"==typeof e.values[a]&&"value"in e.values[a]?e.values[a]=f(e.values[a],"value",a,i):e.values=f(e.values,a,a,i));else if(e.children)for(var r=0,n=e.children;r<n.length;r++){var o=n[r];d(o,t,i)}}function p(e,t,i){var a=e&&e.rows&&e.rows.root;a&&h(e,a,t,i)}function h(e,t,i,a){if(t.values)for(var r in t.values){var n=t.values[r],o=n.valueSourceIndex||0,s=e.valueSources[o].index;_.isNumber(s)&&i(s)&&(t.values[r]=f(n,"value",s,a))}else if(t.children)for(var l=0,u=t.children;l<u.length;l++){var c=u[l];h(e,c,i,a)}}function g(e,t,i,a){if(e.single){for(var r=[],n=0,o=i;n<o.length;n++){var s=o[n];s.name&&r.push(s.name)}for(var l=e.metadata.columns,u=0,c=t;u<c.length;u++){var d=c[u],p=d.single.role;if(r.indexOf(p)!==-1){var h=y(l,p);return void(h&&(e.single=f(e.single,"value",h.index,a)))}}}}function f(e,t,i,r){if(e){var n=e[t];return null===n||r(i,n)||(e=a(e),e[t]=null),e}}function m(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(r.numeric||r.integer)return"number"==typeof e}return!1}function y(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i],n=r&&r.roles;if(n&&n[t])return r}}t.apply=i,t.filterVariantMeasures=r,t.generateMetadataColumnFilter=n,t.generateValueFilter=o,t.getColumnRequiredTypes=l,t.normalizeVariant=f})(i=t.DataViewNormalizeValues||(t.DataViewNormalizeValues={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,a){if(!e)return a;var r=e[t.objectName];return i.getValue(r,t.propertyName,a)}function a(e,t,i){if(e&&e[t]){var a=e[t];return a}return i}function r(e,t){var i=a(e,t);if(i)return i.$instances}function n(e,i,a){var r=t(e,i);return r&&r.solid?r.solid.color:a}e.getValue=t,e.getObject=a,e.getUserDefinedObjects=r,e.getFillColor=n})(t=e.DataViewObjects||(e.DataViewObjects={}));var i;!(function(e){function t(e,t,i){if(!e)return i;var a=e[t];return void 0===a?i:a}function i(e,i,a){var r=t(e,i);return r&&r.solid?r.solid.color:a}e.getValue=t,e.getFillColorByPropertyName=i})(i=e.DataViewObject||(e.DataViewObject={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t,i=a.JsonComparer;!(function(t){function a(t,i,a){var r=t[i];r||(t[i]=r=[]);for(var n=0,o=r.length;n<o;n++){var s=r[n];if(e.Selector.equals(s.selector,a))return s}var l={selector:a,properties:{}};return r.push(l),l}function n(t,i,a,r){var n=_.find(t[i],(function(t){return e.Selector.equals(t.selector,a)}));n&&(n.selector=r)}function o(t,i,a){var r=t[i];if(!r)return!1;var n=_.remove(r,(function(t){return e.Selector.equals(t.selector,a)})).length>0;return _.isEmpty(r)&&delete t[i],n}function s(e,t){if(e&&t)for(var i in t)for(var a=t[i],r=0,n=a;r<n.length;r++){var o=n[r];for(var s in o.properties)d(e,i,o.selector,s)}}function l(e,t){if(e&&t)for(var i in t){var a=t[i];if(a){var r=e[i];r||(r=e[i]=[]),u(r,a)}}}function u(t,i){for(var a,r=0,n=i;r<n.length;r++){var o=n[r];a=!1;for(var s=0,l=t;s<l.length;s++){var u=l[s];if(e.Selector.equals(u.selector,o.selector)){c(u.properties,o.properties),a=!0;break}}if(!a){var d={selector:o.selector,properties:{}};c(d.properties,o.properties),t.push(d)}}}function c(e,t){for(var i in t){var a=t[i];if(a){var r=e[i];r||(e[i]=a)}}}function d(e,t,i,a){var n=f(e,t,i);n&&r.deleteSingleProperty(n,a)}function p(e,t,i,r){a(e,t.objectName,i).properties[t.propertyName]=r}function h(e,t,i){var a=g(e,t,i);if(a)return a[t.propertyName]}function g(e,t,i){var a=f(e,t.objectName,i);if(a)return a.properties}function f(t,i,a){if(t){var r=t[i];if(r)for(var n=0,o=r.length;n<o;n++){var s=r[n];if(e.Selector.equals(s.selector,a))return s}}}function m(t,a){return t instanceof e.SemanticFilter&&a instanceof e.SemanticFilter?e.SemanticFilter.isSameFilter(t,a):i.equals(t,a)}function y(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var i in e)if(!m(e[i],t[i]))return!1;return!0}function v(t,i){if(i.bool)return"boolean"!=typeof t&&(t=!1),e.SQExprBuilder.boolean(t);if(i.text||i.scripting&&i.scripting.source)return e.SQExprBuilder.text(t);if(i.numeric){if($.isNumeric(t))return e.SQExprBuilder.double(+t)}else if(i.integer){if($.isNumeric(t))return e.SQExprBuilder.integer(Math.floor(+t))}else if(i.fill){if(t)return{solid:{color:e.SQExprBuilder.text(t)}}}else{if(i.formatting)return i.formatting.labelDisplayUnits?e.SQExprBuilder.double(+t):e.SQExprBuilder.text(t);if(i.enumeration)return $.isNumeric(t)?e.SQExprBuilder.double(+t):e.SQExprBuilder.text(t);if(i.misc)t=t?e.SQExprBuilder.text(t):null;else if(i.dateTime)t=t?e.SQExprBuilder.dateTime(t):null;else if(i.image){if(t){var a=t,r={name:e.SQExprBuilder.text(a.name),url:e.SQExprBuilder.text(a.url)};return a.scaling&&(r.scaling=e.SQExprBuilder.text(a.scaling)),r}}else if(i.geoJson&&t){var n=t,o={type:e.SQExprBuilder.text(n.type),name:e.SQExprBuilder.text(n.name),content:n.content?e.SQExprBuilder.text(n.content):e.SQExprBuilder.nullConstant()};return o}}return t}function w(e){var t={};for(var i in e){var a=e[i];if(!_.isEmpty(a)){for(var r=[],n=0,o=a;n<o.length;n++){var s=o[n];r.push({properties:b(s.properties),selector:s.selector})}t[i]=r}}return t}function b(e){return _.clone(e)}t.ensure=a,t.updateSelector=n,t.deleteObjectDefinition=o,t.deleteProperties=s,t.extend=l,t.deleteProperty=d,t.setValue=p,t.getValue=h,t.getPropertyContainer=g,t.getObjectDefinition=f,t.propertiesAreEqual=m,t.allPropertiesAreEqual=y,t.encodePropertyValue=v,t.clone=w})(t=e.DataViewObjectDefinitions||(e.DataViewObjectDefinitions={}));var r;!(function(e){function t(e,t){delete e.properties[t]}function i(e){return!a.StringExtensions.startsWith(e,"$")}e.deleteSingleProperty=t,e.isValidPropertyName=i})(r=e.DataViewObjectDefinition||(e.DataViewObjectDefinition={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(t){return l(t,(function(t){var i=e.ValueType.fromDescriptor(t.type).formatting;return i&&i.formatString}))}function a(e){return l(e,(function(e){var t=e.type;return t&&t.filter&&!t.filter.selfFilter}))}function r(e){return l(e,n)}function n(e){var t=e&&e.type;return t&&t.filter&&t.filter.selfFilter}function o(e){return l(e,(function(e){var t=e.type;return t&&t.operations&&t.operations.searchEnabled}))}function s(e){return l(e,(function(e){var t=e.type;return t&&!!t.expression&&t.expression.defaultValue}))}function l(e,t){if(e)for(var i in e){var a=e[i].properties;for(var r in a)if(t(a[r]))return{objectName:i,propertyName:r}}}t.findFormatString=i,t.findFilterOutput=a,t.findSelfFilter=r,t.isSelfFilter=n,t.findSelfFilterEnabled=o,t.findDefaultValue=s})(i=t.DataViewObjectDescriptors||(t.DataViewObjectDescriptors={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i,a){for(var r,n=0,o=a.length;n<o;n++){var s=a[n],l=s.name,u=e.DataViewObjectEvaluator.run(t,i[l],s.properties);u&&(r||(r={}),r[l]=u)}return r}function a(e){var t={data:[]};if(e)for(var i in e)for(var a=e[i],n=0,o=a.length;n<o;n++){var s=a[n];r(t,s.selector).objects.push({name:i,properties:s.properties})}return t}function r(t,i){var a;i&&i.data?a=t.data:i&&i.metadata?(t.metadata||(t.metadata=[]),a=t.metadata):(t.metadataOnce||(t.metadataOnce=[]),a=t.metadataOnce);for(var r=0,n=a;r<n.length;r++){var o=n[r];if(e.Selector.equals(i,o.selector))return o}var s={selector:i,objects:[]};return a.push(s),s}function n(e,t,i,a){a&&(o(e,t,i,a),s(e,t,i,a))}function o(t,i,a,r){var n=e.DataViewObjectDescriptors.findFormatString(i);if(n)for(var o=0,s=r.length;o<s;o++){var c=r[o];c&&u(t,n,c.queryName,c.format||l(a,o))}}function s(t,i,a,r){var n=e.DataViewObjectDescriptors.findDefaultValue(i);if(n)for(var o=0,s=r;o<s.length;o++){var l=s[o];l&&c(t,n,l.queryName,l.defaultValue)}}function l(e,t){for(var i=0,a=e.length;i<a;i++){var r=e[i];if(r&&r.index===t)return r.format}}function u(t,i,a,r){r&&d(t,i,{metadata:a},e.SQExprBuilder.text(r))}function c(e,t,i,a){a&&d(e,t,{metadata:i},a)}function d(e,t,i,a){var r;if(i){var n=e.metadata;n||(n=e.metadata=[]),r=n}else{var o=e.metadataOnce;o||(o=e.metadataOnce=[{selector:i,objects:[]}]),r=o}var s,l=p(r,i);if(l){var u=l.objects;if(s=h(u,t.objectName)){if(s.properties[t.propertyName])return}else s={name:t.objectName,properties:{}},u.push(s)}else s={name:t.objectName,properties:{}},r.push({selector:i,objects:[s]});s.properties[t.propertyName]=a}function p(t,i){for(var a=0,r=t.length;a<r;a++){var n=t[a];if(e.Selector.equals(n.selector,i))return n}}function h(e,t){for(var i=0,a=e.length;i<a;i++){var r=e[i];if(r.name===t)return r}}t.evaluateDataViewObjects=i,t.groupObjectsBySelector=a,t.addImplicitObjects=n})(t=e.DataViewObjectEvaluationUtils||(e.DataViewObjectEvaluationUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i,n=a.Color;!(function(i){function a(e,t,i){if(t){var a,r=t.properties;for(var n in i){var s=i[n],l=r[n];if(l){var u=o(e,l,s);void 0!==u&&(a||(a={}),a[n]=u)}}return a}}function o(i,a,r){var n=a.type;if(n&&n.expression)return r;var o=v(i,r,e.ValueType.fromDescriptor(a.type));return void 0!==o||r instanceof t.RuleEvaluation?o:s(i,r,n)||l(i,r,n)||p(i,r,n)||h(i,r,n)||m(i,r,n)||r}function s(t,i,a){var r=a.fill;if(r)return r&&r.solid&&r.solid.color&&i.solid?{solid:{color:v(t,i.solid.color,e.ValueType.fromExtendedType(19664897))}}:void 0}function l(e,t,i){if(i.fillRule){var a;if(t.linearGradient2){var r=t.linearGradient2;a={linearGradient2:{min:u(e,r.min),max:u(e,r.max)}};var n=d(e,r.nullColoringStrategy);n&&(a.linearGradient2.nullColoringStrategy=n)}else if(t.linearGradient3){var r=t.linearGradient3;a={linearGradient3:{min:u(e,r.min),mid:u(e,r.mid),max:u(e,r.max)}};var n=d(e,r.nullColoringStrategy);n&&(a.linearGradient3.nullColoringStrategy=n)}return a}}function u(e,t){var i={color:c(e,t.color)},a=v(e,t.value,b);return null!=a&&(i.value=a),i}function c(e,t){return v(e,t,w)}function d(e,t){if(t){var i={strategy:v(e,t.strategy,S)};return t.color&&(i.color=c(e,t.color)),i}}function p(t,i,a){if(a.image&&i){var r={name:v(t,i.name,C),url:v(t,i.url,e.ValueType.fromDescriptor(e.ImageDefinition.urlType))};return i.scaling&&(r.scaling=v(t,i.scaling,C)),r}}function h(e,t,i){if(i.paragraphs&&t)return y(e,t,g)}function g(e,t){var i,a=t.textRuns,r=y(e,a,f);return a!==r&&(i=_.clone(t),i.textRuns=r),i||t}function f(e,t){var i,a=t.value,r=v(e,a,C);return void 0!==r&&(i=_.clone(t),i.value=r),i||t}function m(e,t,i){if(i.geoJson&&t){var a={name:v(e,t.name,C),type:v(e,t.type,C),content:v(e,t.content,C)};return a}}function y(e,t,i){for(var a,r=0,n=t.length;r<n;r++){var o=t[r],s=i(e,o);a||o===s||(a=_.take(t,r)),a&&a.push(s)}return a||t}function v(e,i,a){return i instanceof t.SQExpr?x.evaluate(i,e):i instanceof t.RuleEvaluation?i.evaluate(e):void 0}var w=e.ValueType.fromDescriptor({formatting:{color:!0}}),b=e.ValueType.fromDescriptor({numeric:!0}),C=e.ValueType.fromDescriptor({text:!0}),S=e.ValueType.fromDescriptor({enumeration:e.NullStrategy.type});i.run=a,i.evaluateProperty=o,i.evaluateFillRule=l,i.evaluateValue=v;var x=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.evaluate=function(e,i){if(null!=e)return e.accept(t.instance,i)},t.prototype.visitColumnRef=function(e,t){return t.getExprValue(e)},t.prototype.visitConstant=function(e,t){return e.value},t.prototype.visitMeasureRef=function(e,t){return t.getExprValue(e)},t.prototype.visitAggr=function(e,t){return t.getExprValue(e)},t.prototype.visitFillRule=function(e,t){var i=e.input.accept(this,t);if(void 0!==i){var a=t.getColorAllocator(e);if(a)return a.color(i)}},t.prototype.visitPercentile=function(e,t){return t.getExprValue(e)},t.prototype.visitSelectRef=function(e,t){return t.getExprValue(e)},t.prototype.visitThemeColor=function(e,t){var i=t.getThemeColor(e.color);if(i)return n.shadeColor(i,e.percent)},t.instance=new t,t})(t.DefaultSQExprVisitorWithArg)})(i=t.DataViewObjectEvaluator||(t.DataViewObjectEvaluator={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.Prototype.inheritSingle;!(function(e){function i(e){var i=e.values;if(i){var r,n=!!i.source;if(n){r=a(i.grouped());var o=0===t.DataViewCategoricalUtils.getRowCount(e),s=i.length>=1&&(o||void 0!==_.first(i).identity);if(!_.isEmpty(i)&&s)for(var l=0,u=void 0,c=0,d=i.length;c<d;c++){var p=i[c];if(!u||p.identity!==u.identity){var h=r[l];u=h?a(h):h=r[l]={values:null},r[l]=u,u.values=[],l++}u.values.push(p)}else for(var c=0,d=r.length;c<d;c++){var g=r[c];_.isEmpty(g.values)||(r[c]=g=a(g),g.values=[])}}else r=[{values:i}];i.grouped=function(){return r},e.values=i}}e.apply=i})(i=t.DataViewCategoricalEvalGrouped||(t.DataViewCategoricalEvalGrouped={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.ArrayExtensions,n=e.Prototype.inheritSingle;!(function(i){function a(e,t,i,a){var r=e;return i&&(r=s(r,t,i,a),r=d(r,t,i)),r}function s(i,a,r,s){if(!r)return i;var d=e.DataViewMapping.getRoles(a.values,e.DataViewMapping.visitMatrixValues);if(_.isEmpty(d))return i;var p=i.valueSources,h=l(r,d);if(_.isEmpty(p)||u(i.valueSources,h))return i;var g=t.DataViewMetadataColumnUtils.leftJoinMetadataColumnsAndProjectionOrder(p,h,d),f=_.chain(g).filter((function(e){return void 0!==e.projectionOrderIndex})).sortBy((function(e){return e.projectionOrderIndex})).value(),m=n(i);m.rows=c(m.rows,m.valueSources,f);var y=_.map(f,(function(e){return e.metadataColumn}));return m.valueSources=y,m.columns=o.update(m.columns,y.slice()),s.hierarchyTreesRewritten=!0,m}function l(e,t){for(var i=[],a=0,r=t;a<r.length;a++){var n=r[a],o=e[n];_.isEmpty(o)||i.push.apply(i,o)}return i}function u(e,t){var i=_.map(e,(function(e){return e.index}));return r.sequenceEqual(i,t,(function(e,t){return e===t}))}function c(e,i,a){var r,o=i.length,s=a.length,l=n(e);return l.root=t.DataViewPivotMatrix.cloneTreeExecuteOnLeaf(l.root,(function(e){var t=e.values;if(t)if(void 0===r&&(r=Object.keys(e.values).length/o),s>0){for(var i={},l=0;l<r;l++)for(var u=l*o,c=l*s,d=0;d<s;d++){var p=a[d].sourceIndex,h=t[u+p];d!==(h.valueSourceIndex||0)&&(h=n(h),h.valueSourceIndex=d||void 0),i[c+d]=h}e.values=i}else e.values=void 0})),l}function d(t,i,a){var r,o=e.DataViewMapping.getRoles(i.rows,e.DataViewMapping.visitMatrixRows),s=l(a,o),u=p(t.rows,s),c=e.DataViewMapping.getRoles(i.columns,e.DataViewMapping.visitMatrixColumns),d=l(a,c),h=p(t.columns,d);return(u||h)&&(r=n(t),r.rows=u||r.rows,r.columns=h||r.columns),r||t}function p(e,i){var a,r=e.levels,s=_.chain(r).map((function(e,t){return t})).filter((function(e){var t=r[e];return _.size(t.sources)>=2&&!o.isMeasureHeadersLevel(t)})).value();if(!_.isEmpty(s)){for(var l=_.uniq(i),u=s.length-1;u>=0;u--){var c=s[u],d=e.levels[c],p=h(d,l);if(!_.isEmpty(p)){void 0===a&&(a=n(e),a.levels=n(e.levels),a.root=t.DataViewMatrixUtils.inheritMatrixNodeHierarchy(e.root,c,!0));var m=n(d);a.levels[c]=g(m,p),f(a.root,c,p)}}return a}}function h(e,i){var a,r=e.sources;if(r&&r.length>=2){var n=t.DataViewMetadataColumnUtils.leftJoinMetadataColumnsAndProjectionOrder(r,i),o=_.sortBy(n,(function(e){return e.projectionOrderIndex}));a=_.map(o,(function(e,t){var i={originalSourceIndex:e.sourceIndex,newSourceIndex:t};return i}))}return a}function g(e,t){var i=e.sources;e.sources=i.slice(0);for(var a=0,r=t;a<r.length;a++){var n=r[a];e.sources[n.newSourceIndex]=i[n.originalSourceIndex]}return e}function f(e,i,a){var r=_.reduce(a,(function(e,t){return e[t.originalSourceIndex]=t,e}),{});return t.DataViewMatrixUtils.forEachNodeAtLevel(e,i,(function(e){var t=e.levelValues;if(!_.isEmpty(t)){for(var i=_.sortBy(t,(function(e){var t=r[e.levelSourceIndex];return t&&t.newSourceIndex})),a=0,o=i.length;a<o;a++){var s=n(i[a]),l=r[s.levelSourceIndex];s.levelSourceIndex=l&&l.newSourceIndex,i[a]=s}e.levelValues=i;var u=_.last(i);e.value!==u.value&&(e.value=u.value),(e.levelSourceIndex||0)!==u.levelSourceIndex&&(e.levelSourceIndex=u.levelSourceIndex)}})),e}i.apply=a})(i=t.DataViewMatrixProjectionOrder||(t.DataViewMatrixProjectionOrder={}));var o;!(function(e){function i(e,t){var i,r=e.levels,n=a(r),u=n?_.size(r)>=2:_.size(r)>=1,c=u?t.length>=2:t.length>=1;return i=n?c?o(e,t):s(e):c?l(e,t):e}function a(e){return!_.isEmpty(e)&&r(_.last(e))}function r(e){return e&&_.every(e.sources,(function(e){return e.isMeasure}))}function o(e,i){var a=n(e),r=a.levels=n(a.levels),o=r.length-1,s=r[o]=n(r[o]);return s.sources=i,a.root=t.DataViewMatrixUtils.inheritMatrixNodeHierarchy(a.root,o,!0),t.DataViewMatrixUtils.forEachNodeDepthFirst(a.root,(function(e){return u(e,o)?(e.children=c(o,i.length,e.isSubtotal),2):1})),a}function s(e){var i=n(e),a=i.levels=n(i.levels),r=a.length-1;return a.splice(r,1),i.root=t.DataViewMatrixUtils.inheritMatrixNodeHierarchy(i.root,r,!0),t.DataViewMatrixUtils.forEachNodeDepthFirst(i.root,(function(e){return u(e,r)?(e.children=void 0,2):1})),i}function l(e,i){var a=n(e),r=a.levels=n(a.levels),o={sources:i};r.push(o);var s=r.length-1;return a.root=t.DataViewMatrixUtils.inheritMatrixNodeHierarchy(a.root,s,!0),t.DataViewMatrixUtils.forEachNodeDepthFirst(a.root,(function(e){return t.DataViewMatrixUtils.isLeafNode(e)?(e.children=c(s,i.length,e.isSubtotal),2):1})),a}function u(e,t){var i=e.children;return!_.isEmpty(i)&&i[0].level===t}function c(e,t,i){for(var a=[],r=0,n=t;r<n;r++){var o={level:e};r>0&&(o.levelSourceIndex=r),i&&(o.isSubtotal=!0),a.push(o)}return a}e.update=i,e.hasMeasureHeadersLevel=a,e.isMeasureHeadersLevel=r})(o=t.DataViewMatrixMeasureHeaders||(t.DataViewMatrixMeasureHeaders={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.Prototype.inherit;!(function(e){function i(e){var i=e.categorical;if(!i)return null;var r=i.categories;if(!r||1!==r.length)return null;var n=i.values;if(_.isEmpty(n)||n.source)return null;for(var o=r[0],s=o.identity,l=o.values,u=[],c=[],d=0,p=l.length;d<p;d++)for(var h=l[d],g=s[d],f=0,m=n.length;f<m;f++){var y=n[f],v=a(y.source);if(y.identity)return null;v.groupName=h;var w={source:v,values:[y.values[d]],identity:g,min:y.min,max:y.max,subtotal:y.subtotal},b=y.highlights;b&&(w.highlights=[b[d]]),u.push(v),c.push(w)}var C=a(e.metadata);return C.columns=u,n=t.DataViewTransform.createValueColumns(c,o.identityFields,o.source),{metadata:C,categorical:{values:n},matrix:e.matrix}}e.apply=i})(i=t.DataViewPivotCategorical||(t.DataViewPivotCategorical={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){function i(t,i){i.columnHierarchyRewritten||(t.columns=e.Prototype.inherit(t.columns));var o=t.columns;i.rowHierarchyRewritten||(t.rows=e.Prototype.inherit(t.rows));var s=t.rows;if(!(o.levels.length>1)){var l={level:0},u=o.root.children,c=u.length,d=s.levels.length;if(c>0){var p=0,h=function(e){if(e.values){l.values||(l.values={});for(var t=0;t<c;t++)l.values[p++]=e.values[t];e.values=void 0}if(c>1){e.children||(e.children=[]);for(var i=0;i<c;i++){var a={level:d},r=u[i];a.levelSourceIndex=r.levelSourceIndex,e.isSubtotal&&(a.isSubtotal=!0),e.children.push(a)}}};i.hierarchyTreesRewritten?a(s.root,h):t.columns.root=n(s.root,h)}else i.hierarchyTreesRewritten||(t.columns.root=r(s.root));if(c>1){var g={sources:o.levels[0].sources};s.levels.push(g),o.levels.length=0}if(i.hierarchyTreesRewritten)t.columns.root=s.root,t.rows.root={children:[l]};else{var f=e.Prototype.inherit(t.rows.root);f.children=[l],t.rows.root=f}t.columns.levels=s.levels,t.rows.levels=[]}}function a(e,t){var i=e.children;if(i&&i.length>0)for(var r=0,n=i.length;r<n;r++)a(i[r],t);else t(e)}function r(e){return n(e)}function n(t,i){var a=e.Prototype.inherit(t),r=t.children;if(r&&r.length>0){for(var o=[],s=0,l=r.length;s<l;s++){var u=n(r[s],i);o.push(u)}a.children=o}else i&&i(a);return a}t.apply=i,t.cloneTree=r,t.cloneTreeExecuteOnLeaf=n})(i=t.DataViewPivotMatrix||(t.DataViewPivotMatrix={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,i){for(var a=e.identity,r=e.values,n=[],o={},s=0,l=_.size(a);s<l;s++){var u=a[s],c=t.ScopeIdentityExtractor.getSubset(u.expr,i),d=c&&t.createDataViewScopeIdentity(c),p=d&&d.key,h=o[p],g=void 0;void 0===h?(g={identity:d,groupValue:r[s],groupIndex:n.length,valueRowIndices:[]},n.push(g),o[p]=g.groupIndex):g=n[h],g.valueRowIndices.push(s)}return n}function a(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=null;return t}function r(t,i,a){for(var r=e.Prototype.inherit(t),n=0,o=a;n<o.length;n++){var s=o[n];r[s]=i[s]}return r}var n;!(function(n){function o(e,t){if(e.categorical&&t){var i=e.categorical;if(!(_.isEmpty(i.categories)||i.values&&i.values.source)){var a=s(i,t);if(!_.isEmpty(a))return l(e.metadata,i,t,a)}}}function s(e,t){var i=t.source.identityExprs;return i?i:1===e.categories.length?t.identityFields:void 0}function l(i,a,r,n){var o=r.values,s=o.length;if(0!==s){var l=a.values?a.values.grouped()[0].values:[],c=u(r,s,l,n);if(c){var d=t.createCategoricalDataViewBuilder().withCategories(a.categories).withGroupedValues(c).build();return i=e.Prototype.inherit(i),i.columns=d.metadata.columns,{metadata:i,categorical:d.categorical}}}}function u(e,t,n,o){var s=a(t),l=i(e,o);if(!_.isEmpty(l)){var u=_.map(l,(function(e){var t=e.valueRowIndices,i=_.map(n,(function(e){var i={values:r(s,e.values,t)};return e.highlights&&(i.highlights=r(s,e.highlights,t)),i}));return i}));return{groupColumn:{source:e.source,identityFrom:{fields:o,identities:_.map(l,(function(e){return e.identity}))},values:_.map(l,(function(e){return e.groupValue}))},valueColumns:_.map(n,(function(e){return{source:e.source}})),data:u}}}n.apply=o})(n=t.DataViewSelfCrossJoin||(t.DataViewSelfCrossJoin={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.ArrayExtensions,n=e.data.DataShapeBindingDataReduction,o=e.Prototype.inheritSingle;!(function(i){function a(e,t,i,a){t&&1===t.length&&i.categorical&&i.categorical.dataReductionAlgorithm&&e&&l(e,i)&&(e.Primary.Groupings=[e.Secondary.Groupings[0],e.Primary.Groupings[0]],e.Secondary=void 0,e.DataReduction={Primary:n.createFrom(i.categorical.dataReductionAlgorithm),DataVolume:i.categorical.dataVolume||a})}function s(e){return e&&e.Groupings&&1===e.Groupings.length&&!_.isEmpty(e.Groupings[0].Projections)&&!e.Groupings[0].Subtotal&&_.isEmpty(e.Groupings[0].SuppressedProjections)}function l(e,t){return!!s(e.Primary)&&(!(!s(e.Secondary)||1!==e.Secondary.Groupings[0].Projections.length)&&(!e.DataReduction||!e.DataReduction.Primary&&!e.DataReduction.Secondary))}function u(e,i,a,n,o){if(!c(e,i,a,n,o))return e;var s={metadata:{columns:r.copy(e.metadata.columns)}};if(e.single&&(s.single=e.single),e.table&&(s.table=e.table),e.matrix){var l=d(e.matrix);if(!_.isEmpty(l.valueSources)){var u=t.DataViewMatrixUtils.containsCompositeGroup(l.columns);u||(s.categorical=p(l,s.metadata.columns))}}return s}function c(t,i,a,r,n){if(_.isEmpty(i)||!t||_.isEmpty(n))return!1;var o=_.filter(n,(function(t){return!e.DataViewMapping.getRegressionUsage(t)}));if(1!==o.length)return!1;var s=o[0].categorical;if(!s)return!1;var l=t.matrix;if(!l)return!1;if(!l.rows||!l.rows.levels||2!==l.rows.levels.length)return!1;var u=[],c=[],d=function(t,i){var n=r[t];if(n)for(var o=0,s=n.all();o<s.length;o++){var l=s[o];a[l.queryRef]===e.VisualDataRoleKind.Grouping&&i.push(l.queryRef)}};if(e.DataViewMapping.visitCategoricalCategories(s.categories,{visitRole:function(e){d(e,u)}}),e.DataViewMapping.visitGrouped(s.values,{visitRole:function(e){d(e,c)}}),e.DataViewMapping.visitCategoricalValues(s.values,{visitRole:function(e){d(e,c)}}),_.isEmpty(u)||_.isEmpty(c))return!1;for(var p=0,h=l.columns.levels;p<h.length;p++)for(var g=h[p],f=0,m=g.sources;f<m.length;f++){var y=m[f];if(!y.isMeasure)return!1}return!0}function d(e){var t=e.rows,i=t.root,a=i.children,r=[],n=t.levels[0],s=i.childIdentityFields,l={},u=[],c=t.levels[1],d=_.isEmpty(a)?void 0:a[0].childIdentityFields,p=e.valueSources.length,h=function(e){var t=l[e.key];return t};if(a)for(var g=function(e){var t=e.identity.key,i=l[t];void 0===i&&(i=u.length,l[t]=i,u.push(e))},f=0,m=a;f<m.length;f++){var y=m[f];r.push(y);for(var v=0,w=y.children;v<w.length;v++){var b=w[v];g(b)}}for(var C=new Array(u.length),S=0;S<r.length;++S)for(var y=a[S],x=0,P=y.children;x<P.length;x++){var b=P[x],D=h(b.identity);C[D]||(C[D]=new Array(r.length)),C[D][S]=b.values}var T={root:{children:_.map(r,(function(e){var t=o(e);return t.level=0,t.children=void 0,t.childIdentityFields=void 0,t})),childIdentityFields:s},levels:[n]};if(p>0){for(var V=_.map(e.columns.root.children,(function(e){var t={level:1};return e.levelSourceIndex&&(t.levelSourceIndex=e.levelSourceIndex),t})),D=0;D<T.root.children.length;++D)T.root.children[D].children=V;T.levels.push(e.columns.levels[0])}var L={root:{children:_.map(u,(function(e){var t=o(e);return t.level=0,t.children=void 0,t.childIdentityFields=void 0,t})),childIdentityFields:d},levels:[c]};if(p>0)for(var D=0;D<u.length;++D){for(var M=L.root.children[D],N={},S=0;S<r.length;++S)for(var I=C[D]&&C[D][S],A=0;A<p;++A){var O=S*p+A;N[O]=I?I[A]:0===A?{value:null}:{value:null,valueSourceIndex:A}}M.values=N}var R={rows:L,columns:T,valueSources:e.valueSources};return R}function p(e,t){for(var i=e.columns.root.children.length,a=e.valueSources,r=a.length,n=h(e),o=[],s=0;s<i;++s){var l=e.columns.root.children[s],u={values:[],identity:l.identity,name:null!=l.value?l.value:null};o.push(u);for(var c=0;c<r;++c){var d=a[c],p={};for(var g in d)p[g]=d[g];p.groupName=u.name,t.push(p);var f={source:p,values:[],identity:u.identity};u.values.push(f);for(var m=c+s*r,y=0,v=e.rows.root.children;y<v.length;y++){var w=v[y],b=w.values[m].value;f.values.push(b)}}}for(var C=[],S=0,x=o;S<x.length;S++)for(var u=x[S],c=0;c<r;++c)C.push(u.values[c]);C.grouped=function(){return o},C.identityFields=e.columns.root.childIdentityFields,C.source=e.columns.levels[0].sources[0];var P={categories:n,values:C};return P}function h(e){for(var t=_.map(e.rows.root.children,(function(e){return e.identity})),i=e.rows.root.childIdentityFields,a=e.rows.levels[0].sources,r=[],n=0,o=a.length;n<o;n++){var s=_.map(e.rows.root.children,(function(e){var t=e.levelValues;if(void 0!==t)return t[n].value}));r.push({source:a[n],values:s,identity:t,identityFields:i})}return r}i.pivotBinding=a,i.unpivotResult=u})(i=t.DataViewPivotCategoricalToPrimaryGroups||(t.DataViewPivotCategoricalToPrimaryGroups={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){function a(i,a,n,o,s,l,u){var c=l.selects,d=l.roles&&l.roles.activeItems,p=_.isEmpty(c)?{}:t.DataViewSelectTransform.createRoleKindFromMetadata(c,i),h=t.DataViewSelectTransform.projectionsFromSelects(c,d),g=e.DataViewAnalysis.chooseDataViewMappings(h,n,p,a,l.objects),f=g.supportedMappings,m={queryDataViewMetadata:i,objectDescriptors:a,
dataRoles:o,drillCapabilities:s,transforms:l,colorAllocatorFactory:u,selectTransforms:c,projectionOrdering:l.roles&&l.roles.ordering,projectionActiveItems:d,roleKindByQueryRef:p,queryProjectionsByRole:h,visualCapabilitiesRoleMappings:n,visualCapabilitiesDataViewKinds:r(n),applicableRoleMappings:f,applicableDataViewKinds:r(f)};return m}function r(e){if(!e)return 0;for(var t=0,i=0,a=e;i<a.length;i++){var r=a[i];r.categorical&&(t|=1),r.matrix&&(t|=2),r.single&&(t|=4),r.table&&(t|=8),r.tree&&(t|=16)}return t}i.create=a})(i=t.DataViewTransformContext||(t.DataViewTransformContext={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.ArrayExtensions,n=e.data.DataViewMetadataColumnUtils,o=e.Prototype.inheritSingle;!(function(i){function a(t,i,a,r,n){var s,u=_.chain(i).filter((function(t){return t.categorical&&!e.DataViewMapping.getRegressionUsage(t)})).map((function(e){return e.categorical})).value();if(t.categorical&&u.length>=1){var c=t.categorical,p=l(c,u,r,n);p=d(p||c,a,r,n),p&&(s=o(t),s.categorical=p)}return s||t}function s(e,t,i){if(t){var a=_.reduce(e,(function(e,a){var r=_.filter(t[a],(function(e){return!i||i[e]}));return e.push.apply(e,r),e}),[]);return a}}function l(t,i,a,r){if(!_.isEmpty(t.categories)){var n=e.DataViewMapping.getRolesIfSameInAllCategoricalMappings(i,e.DataViewMapping.getAllRolesInCategories);if(n){var o=s(n,a,r);if(o)return u(t,o,n)}}}function u(e,i,a){var r=e.categories;if(!_.isEmpty(r)&&!c(r,i)){var s=_.map(r,(function(e){return e.source})),l=n.leftJoinMetadataColumnsAndProjectionOrder(s,i,a),u=_.chain(l).filter((function(e){return void 0!==e.projectionOrderIndex})).sortBy((function(e){return e.projectionOrderIndex})).value(),d=_.map(u,(function(e){return r[e.sourceIndex]})),p=o(e);if(_.isEmpty(d))p.categories=void 0;else{var h=t.DataViewCategoricalUtils.getCategoriesDataViewObjects(r);h&&(d=t.DataViewCategoricalUtils.setCategoriesDataViewObjects(d,h)||d),p.categories=d}return p}}function c(e,t){return e.length===t.length&&_.every(t,(function(t,i){return e[i].source.index===t}))}function d(e,i,a,r){var n=e.values;if(n){var s=w(n),l=h(s,i,a,r),u=f(n,s,l);if(u=p(u||n,r)||u){var c=!!u.source,d=u.length>0,g=o(e);return c||d?(g.values=u,t.DataViewCategoricalEvalGrouped.apply(g)):g.values=void 0,g}}}function p(e,t){if(t&&e.source){var i=!t[e.source.index];if(i){var a=o(e);return a.source=void 0,a.identityFields=void 0,a}}}function h(e,t,i,a){if(!i)return g(e,a);var r=_.reduce(t,(function(e,t,i){var a=t.name;return void 0===e[a]&&(e[a]=i),e}),{}),n=e.dynamicSeriesMeasureSources||[],o=e.staticSeriesMeasureSources||[],s=n.concat(o),l=_.chain(s).filter((function(e){return!a||!!a[e.index]})).uniq((function(e){return e.index})).map((function(e){var t=e.roles;return t?_.filter(Object.keys(t),(function(e){return t[e]})):[]})).flatten().uniq().sortBy((function(e){return r[e]})).value(),u=_.chain(l).map((function(e){return i[e]||[]})).flatten().filter((function(e){return!a||!!a[e]})).uniq().value();return u}function g(e,t){var i=e.dynamicSeriesMeasureSources||[],a=e.staticSeriesMeasureSources||[],r=i.concat(a),n=_.chain(r).filter((function(e){return!t||!!t[e.index]})).map((function(e){return e.index})).uniq().value();return n}function f(e,t,i){var a=m(e,t,i),r=y(e,t,i);if(a||r){var n=o(e);if(a)if(r)n.splice(0,n.length),n.push.apply(n,a),n.push.apply(n,r);else{var s=t.dynamicSeriesMeasureSources.length,l=s*t.dynamicSeriesGroupCount;n.splice.apply(n,[0,l].concat(a))}else if(r){var u=t.staticSeriesMeasureSources.length;n.splice.apply(n,[t.staticSeriesMeasureStartingIndex,u].concat(r))}return n}}function m(e,t,i){if(t.dynamicSeriesGroupCount&&!_.isEmpty(t.dynamicSeriesMeasureSources)){var a=v(t.dynamicSeriesMeasureSources,i);if(a){var r=a.length;if(0===r)return[];for(var n=t.dynamicSeriesMeasureSources.length,o=t.dynamicSeriesGroupCount,s=[],l=0;l<o;l++)for(var u=l*n,c=0;c<r;c++){var d=a[c].sourceIndex,p=e[u+d];s.push(p)}return s}}}function y(e,t,i){if(!_.isEmpty(t.staticSeriesMeasureSources)){var a=v(t.staticSeriesMeasureSources,i);if(a){var r=a.length;if(0===r)return[];for(var n=t.staticSeriesMeasureStartingIndex,o=[],s=0;s<r;s++){var l=a[s].sourceIndex,u=e[n+l];o.push(u)}return o}}}function v(e,t){var i=n.leftJoinMetadataColumnsAndProjectionOrder(e,t);i=_.chain(i).filter((function(e){return void 0!==e.projectionOrderIndex})).sortBy((function(e){return e.projectionOrderIndex})).value();var a=r.sequenceEqual(e,i,(function(e,t){return e.index===t.metadataColumn.index}));if(!a)return i}function w(e){var t,i,a,r,n=e.source,o=e.grouped();if(n){i=b(o),t=o.length;var s=_.size(i),l=t*s,u=e.length-l;u>0&&(a=l,r=_.chain(e).takeRight(u).map((function(e){return e.source})).value())}else a=0,r=b(o);return{secondaryAxisSource:n,dynamicSeriesGroupCount:t,dynamicSeriesMeasureSources:i,staticSeriesMeasureStartingIndex:a,staticSeriesMeasureSources:r}}function b(e){if(!_.isEmpty(e)){var t=e[0];return _.map(t.values,(function(e){return e.source}))}}i.apply=a})(i=t.DataViewCategoricalProjectionOrder||(t.DataViewCategoricalProjectionOrder={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,r=a.ArrayExtensions,n=e.Prototype;!(function(i){function a(e,i,a,r){if(!_.isEmpty(i.splits))return e;var l=e.matrix;if(!l)return e;var u=_.chain(a).map((function(e){return o(e)})).filter((function(e){return!!e})).value();if(1!==u.length)return e;var d=t.DataViewMatrixUtils.extractSelectIndices(l);if(!s(d,i,r,u[0]))return e;var p=c(l),h=n.inheritSingle(e);return h.matrix=p,h}function o(t){var i=t.matrix;if(i&&i.rows&&!i.columns&&!i.values){var a=e.DataViewMapping.getRoles(i.rows,e.DataViewMapping.visitMatrixRows);if(r.sequenceEqual(a,p,(function(e,t){return e===t}))||r.sequenceEqual(a,h,(function(e,t){return e===t}))){var n={primaryAxisRoles:a.slice(1),secondaryAxisRole:a[0]};return n}}}function s(e,t,i,a){var r=e.primaryAxis,n=e.secondaryAxis;if(!_.isEmpty(e.intersection)||1!==_.size(r)||1!==_.size(n))return!1;var o=t.selects;return!!l(r[0].selectIndices,o,i,a.primaryAxisRoles)&&!!l(n[0].selectIndices,o,i,[a.secondaryAxisRole])}function l(e,t,i,a){for(var r=0,n=e.length,o=0,s=a;o<s.length;o++){var l=s[o];if(n<=r)return!1;var c=u(e,t,l);if(0===c)return!1;if(c>=2&&!_.contains(i,l))return!1;r+=c}return!(r<n)}function u(e,i,a){for(var r=0,n=0,o=e;n<o.length;n++){var s=o[n],l=i[s]&&i[s].roles;if(t.DataViewMetadataColumnUtils.isExactMatchRole(l,a))r++;else if(r>0)break}return r}function c(e){var t=n.inheritSingle(e),i=t.rows=n.inheritSingle(e.rows),a=t.columns=n.inheritSingle(e.columns),r=a.levels=n.inheritSingle(a.levels),o=r.splice(0,1)[0],s=i.levels=n.inheritSingle(i.levels);s.splice(0,0,o);var l=e.rows.root,u=i.root=n.inheritSingle(a.root);a.root={children:[]};var c=n.overrideArray(u.children,(function(e){var t=n.inheritSingle(e);return t.childIdentityFields=l.childIdentityFields,t.children=d(l.children),t}));return c&&(u.children=c),t}function d(e){if(!e)return e;var t=n.overrideArray(e,(function(e){var t=n.inherit(e);return t.level+=1,t}));return t||n.inherit(e)}var p=["Series","Category"],h=["Series","X","Y"];i.detectAndApply=a})(i=t.DataViewUpgradeFromCY16SU09Map||(t.DataViewUpgradeFromCY16SU09Map={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e){return function(t){return t.get(e)}}function i(e,t){return"function"==typeof e?e(t):"string"==typeof e?e:void 0}e.createDisplayNameGetter=t,e.getDisplayName=i})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(e){function t(e){var t=r.visit(e,h.instance);return t}function i(t){return e.aggregate(a(t),t.aggregate)}function a(t){return e.columnRef(s(t),t.name)}function n(t){return e.aggregate(e.groupRef(t.name,s(t),p(t.groupedColumns)),t.aggregate)}function o(t){return e.groupRef(t.name,s(t),p(t.groupedColumns))}function s(t){return e.entity(t.schema,t.entity,t.entityVar)}function l(t){return e.aggregate(s(t),t.aggregate)}function u(t){return e.aggregate(c(t),t.aggregate)}function c(t){return e.hierarchyLevel(d(t),t.level)}function d(t){return e.hierarchy(s(t),t.name)}function p(t){return _.map(t,(function(t){return e.fieldExpr(t)}))}e.fieldExpr=t,e.fromColumnAggr=i,e.fromColumn=a,e.fromGroupingColumnAggr=n,e.fromGroupingColumn=o,e.fromEntity=s,e.fromEntityAggr=l,e.fromHierarchyLevelAggr=u,e.fromHierarchyLevel=c,e.fromHierarchy=d;var h=(function(){function t(){}return t.prototype.visitColumn=function(e){return a(e)},t.prototype.visitColumnAggr=function(e){return i(e)},t.prototype.visitGroupingColumn=function(e){return o(e)},t.prototype.visitGroupingColumnAggr=function(e){return n(e)},t.prototype.visitColumnHierarchyLevelVariation=function(t){return e.propertyVariationSource(this.visitEntity(t.source),t.source.name,t.level.name)},t.prototype.visitEntity=function(e){return s(e)},t.prototype.visitEntityAggr=function(e){return l(e)},t.prototype.visitHierarchy=function(e){return d(e)},t.prototype.visitHierarchyLevel=function(e){return c(e)},t.prototype.visitHierarchyLevelAggr=function(e){return u(e)},t.prototype.visitMeasure=function(t){return e.measureRef(this.visitEntity(t),t.name)},t.prototype.visitPercentile=function(t){var i=e.fieldExpr(t.arg);return e.percentile(i,t.k,t.exclusive)},t.prototype.visitPercentOfGrandTotal=function(t){var i=e.fieldExpr(t.baseExpr);return e.arithmetic(i,e.scopedEval(i,[]),3)},t.prototype.visitSelectRef=function(t){return e.selectRef(t.expressionName)},t.prototype.visitTransformOutputRoleRef=function(t){return e.transformOutputRoleRef(t.expressionName)},t.instance=new t,t})()})(t=e.SQExprBuilder||(e.SQExprBuilder={}));var i;!(function(e){function t(e,t){return e.accept(new n(t))}e.asFieldPattern=t})(i=e.SQExprConverter||(e.SQExprConverter={}));var r,n=(function(i){function r(e){i.call(this),this.schema=e}return a(r,i),r.prototype.visitColumnRef=function(e){var t=e.source.accept(o.instance);if(t&&t.entity){var i=t.entity;return i.name=e.ref,{column:i}}},r.prototype.visitMeasureRef=function(e){var t=e.source.accept(o.instance);if(t&&t.entity){var i=t.entity;return i.name=e.ref,{measure:i}}},r.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),{entity:t}},r.prototype.visitAggr=function(e){var t=e.arg.accept(this);if(t){if(t.column){var i=t.column;return i.aggregate=e.func,{columnAggr:i}}if(t.columnAggr){var i=t.columnAggr;return i.aggregate=e.func,{columnAggr:i}}if(t.groupingColumn){var i=t.groupingColumn;return i.aggregate=e.func,{groupingColumnAggr:i}}if(t.groupingColumnAggr){var i=t.groupingColumnAggr;return i.aggregate=e.func,{groupingColumnAggr:i}}if(t.hierarchyLevel){var i=t.hierarchyLevel;return i.aggregate=e.func,{hierarchyLevelAggr:i}}}var a=e.arg.accept(o.instance);if(a&&a.entity){var i=a.entity;return i.aggregate=e.func,{entityAggr:i}}},r.prototype.visitPercentile=function(e){return{percentile:{arg:e.arg.accept(this),k:e.k,exclusive:e.exclusive}}},r.prototype.visitGroupRef=function(e){var t=e.source.accept(o.instance);if(t&&t.entity){var i=t.entity;i.name=e.ref,i.groupedColumns=[];for(var a=0,r=e.groupedExprs;a<r.length;a++){var n=r[a],s=n.accept(this);(s.column||s.groupingColumn||s.hierarchyLevel)&&i.groupedColumns.push(s)}return{groupingColumn:i}}},r.prototype.visitHierarchy=function(e){var t=e.arg.accept(o.instance);if(t&&t.entity){var i=t.entity;return i.name=e.hierarchy,{hierarchy:i}}},r.prototype.visitHierarchyLevel=function(e){var t=e.arg.accept(s.instance);if(t){var i;if(t.hierarchy&&(i={entity:t.hierarchy.entity,schema:t.hierarchy.schema,name:t.hierarchy.name,level:e.level}),t.variation){if(this.schema){var a=t.variation,r=this.schema.schema(t.variation.column.schema).findTargetEntityOfVariation(i.entity,a.column.name,a.variationName);r&&(i.entity=r.name)}return{columnHierarchyLevelVariation:{source:{entity:t.variation.column.entity,schema:t.variation.column.schema,name:t.variation.column.name},level:i,variationName:t.variation.variationName}}}return{hierarchyLevel:i}}},r.prototype.visitArithmetic=function(i){var a={percentOfGrandTotal:{baseExpr:i.left.accept(this)}};if(e.SQExpr.equals(i,t.fieldExpr(a)))return a},r.prototype.visitSelectRef=function(e){return{selectRef:{expressionName:e.expressionName}}},r.prototype.visitTransformOutputRoleRef=function(e){return{transformOutputRoleRef:{expressionName:e.role}}},r})(e.DefaultSQExprVisitor),o=(function(t){function i(){t.apply(this,arguments)}return a(i,t),i.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),{entity:t}},i.prototype.visitPropertyVariationSource=function(t){var i=t.arg;if(i instanceof e.SQEntityExpr){var a={schema:i.schema,entity:i.entity,name:t.property};return i.variable&&(a.entityVar=i.variable),{variation:{column:a,variationName:t.name}}}},i.instance=new i,i})(e.DefaultSQExprVisitor),s=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.visitHierarchy=function(e){var t,i,a=e.arg.accept(o.instance);return a.variation?(t={name:e.hierarchy,schema:a.variation.column.schema,entity:a.variation.column.entity},i=a.variation):t={name:e.hierarchy,schema:a.entity.schema,entity:a.entity.entity},{hierarchy:t,variation:i}},t.instance=new t,t})(e.DefaultSQExprVisitor);!(function(a){function r(t,a){var r=t instanceof e.SQExpr?i.asFieldPattern(t):t;return r.column?n(r.column,a):r.columnAggr?o(r.columnAggr,a):r.groupingColumn?s(r.groupingColumn,a):r.groupingColumnAggr?l(r.groupingColumnAggr,a):r.columnHierarchyLevelVariation?u(r.columnHierarchyLevelVariation,a):r.entity?c(r.entity,a):r.entityAggr?d(r.entityAggr,a):r.hierarchy?p(r.hierarchy,a):r.hierarchyLevel?h(r.hierarchyLevel,a):r.hierarchyLevelAggr?g(r.hierarchyLevelAggr,a):r.measure?f(r.measure,a):r.percentile?y(r.percentile,a):r.percentOfGrandTotal?v(r.percentOfGrandTotal,a):r.selectRef?m(r.selectRef,a):r.transformOutputRoleRef?w(r.transformOutputRoleRef,a):void 0}function n(e,t){return t.visitColumn(e)}function o(e,t){return t.visitColumnAggr(e)}function s(e,t){return t.visitGroupingColumn(e)}function l(e,t){return t.visitGroupingColumnAggr(e)}function u(e,t){return t.visitColumnHierarchyLevelVariation(e)}function c(e,t){return t.visitEntity(e)}function d(e,t){return t.visitEntityAggr(e)}function p(e,t){return t.visitHierarchy(e)}function h(e,t){return t.visitHierarchyLevel(e)}function g(e,t){return t.visitHierarchyLevelAggr(e)}function f(e,t){return t.visitMeasure(e)}function m(e,t){return t.visitSelectRef(e)}function y(e,t){return t.visitPercentile(e)}function v(e,t){return t.visitPercentOfGrandTotal(e)}function w(e,t){return t.visitTransformOutputRoleRef(e)}function b(e){return t.columnRef(t.entity(e.schema,e.entity,e.entityVar),e.name)}function C(e){return r(e,M.instance)}function S(e){return void 0!==(e.column||e.columnAggr||e.groupingColumn||e.groupingColumnAggr||e.measure)}function x(e){return a.visit(e,I.instance)}function P(e){var t=e.hierarchy;if(t)return t.name}function D(e){return e.columnHierarchyLevelVariation?e.columnHierarchyLevelVariation.source:e.column||e.groupingColumn||e.groupingColumnAggr||e.measure||e.columnAggr}function T(e){var t=x(e);return t?t:_(e).entity}function V(e){var t=a.toFieldExprEntityItemPattern(e);return t.schema}function _(e){return a.visit(e,N.instance)}function L(e){return a.visit(e,N.instance)}a.visit=r,a.toColumnRefSQExpr=b,a.getAggregate=C,a.hasFieldExprName=S,a.getPropertyName=x,a.getHierarchyName=P,a.getProperty=D,a.getFieldExprName=T,a.getSchema=V,a.toFieldExprEntityPattern=_,a.toFieldExprEntityItemPattern=L;var M=(function(){function i(){}return i.prototype.visitColumn=function(e){},i.prototype.visitColumnAggr=function(e){return e.aggregate},i.prototype.visitGroupingColumn=function(e){},i.prototype.visitGroupingColumnAggr=function(e){return e.aggregate},i.prototype.visitColumnHierarchyLevelVariation=function(e){},i.prototype.visitEntity=function(e){},i.prototype.visitEntityAggr=function(e){return e.aggregate},i.prototype.visitHierarchy=function(e){},i.prototype.visitHierarchyLevel=function(e){},i.prototype.visitHierarchyLevelAggr=function(e){return e.aggregate},i.prototype.visitMeasure=function(e){},i.prototype.visitSelectRef=function(e){},i.prototype.visitPercentile=function(e){},i.prototype.visitPercentOfGrandTotal=function(i){return e.SQExprInfo.getAggregate(t.fieldExpr(i.baseExpr))},i.prototype.visitTransformOutputRoleRef=function(e){},i.instance=new i,i})(),N=(function(){function e(){}return e.prototype.visitColumn=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitColumnAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitGroupingColumn=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitGroupingColumnAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitColumnHierarchyLevelVariation=function(t){return e.toEntityItemExprPattern(t.source)},e.prototype.visitEntity=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitEntityAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchy=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchyLevel=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitHierarchyLevelAggr=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitMeasure=function(t){return e.toEntityItemExprPattern(t)},e.prototype.visitSelectRef=function(e){},e.prototype.visitPercentile=function(e){return a.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return a.visit(e.baseExpr,this)},e.prototype.visitTransformOutputRoleRef=function(e){},e.toEntityItemExprPattern=function(e){var t={schema:e.schema,entity:e.entity};return e.entityVar&&(t.entityVar=e.entityVar),t},e.instance=new e,e})(),I=(function(){function e(){}return e.prototype.visitColumn=function(e){return e.name},e.prototype.visitColumnAggr=function(e){return e.name},e.prototype.visitGroupingColumn=function(e){return e.name},e.prototype.visitGroupingColumnAggr=function(e){return e.name},e.prototype.visitColumnHierarchyLevelVariation=function(e){},e.prototype.visitEntity=function(e){},e.prototype.visitEntityAggr=function(e){},e.prototype.visitHierarchy=function(e){},e.prototype.visitHierarchyLevel=function(e){},e.prototype.visitHierarchyLevelAggr=function(e){},e.prototype.visitMeasure=function(e){return e.name},e.prototype.visitSelectRef=function(e){},e.prototype.visitPercentile=function(e){return a.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return a.visit(e.baseExpr,this)},e.prototype.visitTransformOutputRoleRef=function(e){},e.instance=new e,e})()})(r=e.FieldExprPattern||(e.FieldExprPattern={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,t){if(!t||0===t.length)return{dataView:e,isValid:!0};if(e)for(var i=0,a=t;i<a.length;i++){var l=a[i];if(c(e,l))return{dataView:e,isValid:!0};if(l.categorical&&e.categorical)return r(e,l);if(l.tree&&e.tree)return o(e,l.tree);if(l.single&&e.single)return n(e,l.single);if(l.table&&e.table)return s(e,l.table)}return{isValid:!1}}function r(t,i){var a=i.categorical,r=t.categorical;if(!r)return{isValid:!1};var n;if(a.rowCount&&(n=a.rowCount.supported,n&&n.max)){var o=void 0,s=r.categories,l=n.max,u=void 0;if(s)for(var c=0,p=s.length;c<p;c++){var h=s[c];if(u=h.values.length,void 0!==l&&u>l){var g=T.range(h.values,0,l-1);o=o||{categories:[]},o.categories.push({source:h.source,values:g})}}if(r.values&&r.values.length>0&&l&&(u||(u=r.values[0].values.length),void 0!==l&&u>l)){o=o||{},o.values=e.data.DataViewTransform.createValueColumns();for(var c=0,p=r.values.length;c<p;c++){var f=r.values[c],m={source:f.source,values:T.range(f.values,0,l-1)};void 0!==f.min&&(m.min=f.min),void 0!==f.max&&(m.max=f.max),void 0!==f.subtotal&&(m.subtotal=f.subtotal),o.values.push(m)}}o&&(t={metadata:t.metadata,categorical:o})}return d(t,i)?{dataView:t,isValid:!0}:null}function n(e,t){return e.single?{dataView:e,isValid:!0}:{isValid:!1}}function o(e,t){var i=e.metadata;return null==m(l(i.columns),t.depth)?{dataView:e,isValid:!0}:{isValid:!1}}function s(e,t){return e.table?{dataView:e,isValid:!0}:{isValid:!1}}function l(e){for(var t=0,i=0,a=e.length;i<a;i++)e[i].isMeasure||++t;return t}function u(e){for(var t=0,i=0,a=e.length;i<a;i++)e[i].isMeasure&&++t;return t}function c(e,t,i){return!(!t||!e)&&(!(t.scriptResult&&!f(e.scriptResult,t.scriptResult))&&(!(t.categorical&&!d(e,t.categorical,i))&&(!(t.tree&&!h(e,t.tree))&&(!(t.single&&!p(e.single,t.single))&&!(t.table&&!g(e.table,t.table,i))))))}function d(e,t,i){var a=e.categorical;if(!a)return!1;if(t.rowCount){var r=t.rowCount.supported;if(i&&t.rowCount.preferred&&(r=t.rowCount.preferred),r){var n=0;if(a.values&&a.values.length?n=a.values[0].values.length:a.categories&&a.categories.length&&(n=a.categories[0].values.length),null!=m(n,r))return!1}}return!0}function p(e,t){return!!e}function h(e,t){var i=e.metadata;return null==m(l(i.columns),t.depth)}function g(e,t,i){if(!e)return!1;if(t.rowCount){var a=t.rowCount.supported;if(i&&t.rowCount.preferred&&(a=t.rowCount.preferred),a){var r=0;if(e.rows&&e.rows.length&&(r=e.rows.length),null!=m(r,a))return!1}}return!0}function f(e,t){return!!e&&!!e.payloadBase64}function m(e,t,i){if(t)return!i&&void 0!==t.min&&t.min>e?L.conditionRangeTooSmall:void 0!==t.max&&t.max<e?L.conditionRangeTooLarge:void 0}function y(t,i,a,r){if(t&&void 0!==t.kind){var n=t.kind,o=a[i];if(o)for(var s=o.all(),l=0,u=s;l<u.length;l++){var c=u[l];if(r[c.queryRef]!==n)switch(n){case e.VisualDataRoleKind.Measure:return L.conditionKindExpectedMeasure;case e.VisualDataRoleKind.Grouping:return L.conditionKindExpectedGrouping;case e.VisualDataRoleKind.GroupingOrMeasure:return L.conditionKindExpectedGroupingOrMeasure}}}}function v(e,t,i,a,r){var n=[],o=[];if(!_.isEmpty(t))for(var s=0,l=t.length;s<l;s++){var u=t[s],c=u.conditions,d=u.requiredProperties,p=b(d,a,r),h=[];if(_.isEmpty(c))h.push({});else for(var g=0,f=c.length;g<f;g++){var m=c[g],y=w(e,m,i);if(_.isEmpty(y))h.push(m);else for(var v=0,C=y;v<C.length;v++){var S=C[v];S.mappingIndex=s,S.conditionIndex=g,o.push(S)}}if(!_.isEmpty(h)&&p){var x=_.cloneDeep(u),P=_.filter(h,(function(e){return Object.keys(e).length>0}));_.isEmpty(P)||(x.conditions=P),n.push(x)}}return{supportedMappings:T.emptyToNull(n),mappingErrors:T.emptyToNull(o)}}function w(e,t,i,a){for(var r=Object.keys(t),n=[],o=0,s=r.length;o<s;o++){var l=r[o],u=e[l]&&!_.isEmpty(e[l].activeProjectionRefs),c=t[l],d=void 0!==a&&null!==a,p=d?a:u,h=C(l,e,p),g=m(h,c);null!=g&&n.push({code:g,roleName:l});var f=y(c,l,e,i);null!=f&&n.push({code:f,roleName:l})}return n}function b(t,i,a){if(_.isEmpty(t))return!0;if(!i||!a)return!1;var r=e.data.createStaticEvalContext();return _.every(t,(function(t){var n=null,o=a[t.objectName];if(!o)return!1;var s=i[t.objectName];s&&(n=s.properties[t.propertyName]);var l=V.getValue(a,t,o[0].selector);return!(!n||!l)&&e.data.DataViewObjectEvaluator.evaluateProperty(r,n,l)}))}function C(e,t,i){var a=t[e];return a?i?1:a.all().length:0}function S(t,i){if(t&&i&&t.categorical&&i.categorical){var a=t.categorical.categories,r=i.categorical.categories;if(a&&r&&a.length===r.length){for(var n=0,o=a.length;n<o;n++){var s=a[n].identity,l=r[n].identity,u=x(s);if(u!==x(l))return!1;for(var c=0;c<u;c++)if(!e.DataViewScopeIdentity.equals(s[c],l[c]))return!1}return!0}}return!1}function x(e){return e?e.length:0}function P(e,t){return!e&&!t||!(!e||!t)&&(e.displayName===t.displayName&&(e.queryName===t.queryName&&(e.isMeasure===t.isMeasure&&(e.type===t.type&&e.sort===t.sort))))}function D(e,i){if(!e&&!i)return!0;if(!e||!i)return!1;var a=e.columns.length,r=i.columns.length;if(a!==r)return!1;for(var n=0;n<r;n++)if(!t.areMetadataColumnsEquivalent(e.columns[n],i.columns[n]))return!1;return!0}var T=a.ArrayExtensions,V=e.data.DataViewObjectDefinitions;!(function(e){e[e.conditionRangeTooLarge=0]="conditionRangeTooLarge",e[e.conditionRangeTooSmall=1]="conditionRangeTooSmall",e[e.conditionKindExpectedMeasure=2]="conditionKindExpectedMeasure",e[e.conditionKindExpectedGrouping=3]="conditionKindExpectedGrouping",e[e.conditionKindExpectedGroupingOrMeasure=4]="conditionKindExpectedGroupingOrMeasure"})(t.DataViewMappingMatchErrorCode||(t.DataViewMappingMatchErrorCode={}));var L=t.DataViewMappingMatchErrorCode;t.validateAndReshape=i,t.countGroups=l,t.countMeasures=u,t.supports=c,t.validateRange=m,t.chooseDataViewMappings=v,t.checkForConditionErrors=w,t.getPropertyCount=C,t.hasSameCategoryIdentity=S,t.areMetadataColumnsEquivalent=P,t.isMetadataEquivalent=D})(t=e.DataViewAnalysis||(e.DataViewAnalysis={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t,i=a.ArrayExtensions,r=a.Lazy;!(function(e){function t(e){return new n(e)}function a(e,t){return e.key&&t.key&&e.key===t.key&&i.sequenceEqual(e.roles,t.roles,(function(e,t){return e===t}))}e.fromRoles=t,e.equals=a;var n=(function(){function e(e){var t=this;this._roles=e,this._key=new r(function(){return JSON.stringify(t.roles)})}return Object.defineProperty(e.prototype,"roles",{get:function(){return this._roles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),e})()})(t=e.DataViewRoleWildcard||(e.DataViewRoleWildcard={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t,i=a.Lazy;!(function(t){function a(t,i){var a=e.ScopeIdentityExtractor.getKeys(i.expr);return!!a&&e.SQExprUtils.sequenceEqual(t.exprs,a)}function r(t,i){return t.key===i.key&&e.SQExprUtils.sequenceEqual(t.exprs,i.exprs)}function n(e){return new o(e)}t.matches=a,t.equals=r,t.fromExprs=n;var o=(function(){function t(t){this._exprs=t,this._key=new i(function(){return e.SQExprShortSerializer.serializeArray(t)})}return Object.defineProperty(t.prototype,"exprs",{get:function(){return this._exprs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t})()})(t=e.DataViewScopeWildcard||(e.DataViewScopeWildcard={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(){return new i}e.createColorAllocatorCache=t;var i=(function(){function e(){this.cache=[]}return e.prototype.get=function(e){for(var t=0,i=this.cache;t<i.length;t++){var a=i[t];if(a.key===e)return a.allocator}},e.prototype.register=function(e,t){return this.cache.push({key:e,allocator:t}),this},e})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i,a=e.DataViewMapping;!(function(i){function r(e){var t=e.visualDataViews,i=e.dataRoles,r=e.objectDescriptors,o=e.objectDefinitions,s=e.colorAllocatorFactory,l=e.transformSelects,u=e.applicableDataViewMappings,c=e.roleKindByQueryRef,d=e.queryProjectionsByRole;if(!_.isEmpty(t)&&l){if(!c||!d||_.isEmpty(u)||!r||!o)return t;var p=_.find(u,(function(e){return!!a.getRegressionUsage(e)}));if(p){for(var h=[],g=0,f=t;g<f.length;g++){var m=f[g],y=n(m,i,p,r,o,s);y&&h.push(y)}_.isEmpty(h)||t.push.apply(t,h)}}return t}function n(t,i,r,n,u,c){if(t.categorical){var d=l(0,t.categorical,i),p=l(1,t.categorical,i);if(!_.isEmpty(d)&&!_.isEmpty(p)){var g=d[0].source,f=p[0].source,w=!0,b=a.getRegressionUsage(r);if(b&&t.metadata.objects){var C=b.combineSeries;C&&(w=e.DataViewObjects.getValue(t.metadata.objects,C,!0))}var S=m(d,p,w,!1),x=o(S);if(s(x)){var P,D=x.xMin,T=x.xMax,V=v(p)||v(d);if(V){var L=m(d,p,w,!0);P=o(L),s(P)?(D=_.min([D,P.xMin]),T=_.max([T,P.xMax])):V=!1}for(var M=[],N=0,I=x.lineDefs;N<I.length;N++){var A=I[N];M.push(h(A,+D,+T))}var O;if(V){O=[];for(var R=0,E=P.lineDefs;R<E.length;R++){var A=E[R];O.push(h(A,+D,+T))}}var F;if(w)F=["combinedRegressionSeries"];else if(t.categorical.values.source){var j=t.categorical.values.grouped();F=_.map(j,(function(e){return e.name}))}else F=_.map(p,(function(e){return e.source.queryName}));var H=y(g,f,F,[D,T],M,O,t,r,n,u,c);return H}}}}function o(e){for(var t,i,a=[],r=0,n=e;r<n.length;r++){var o=n[r],s=o.xValues,l=o.yValues;if(_.isEmpty(s)||_.isEmpty(l))a.push(null);else{var u=c(s),h=c(l);if(u&&h){var g=d(s,l);if(!g||_.isEmpty(g.xValues)||_.isEmpty(g.yValues))a.push(null);else{var f=g.xValues[0],m=g.xValues[g.xValues.length-1],y=p(g.xValues,g.yValues);t=_.min([t,f]),i=_.max([i,m]),a.push(y)}}else a.push(null)}}return{lineDefs:a,xMin:t,xMax:i}}function s(e){return e&&!_.isEmpty(e.lineDefs)&&_.some(e.lineDefs,(function(e){return e}))}function l(e,t,i){var a=u(e,t.values,i);if(!_.isEmpty(a))return a;var r=t.categories;if(!_.isEmpty(r)){var n=r[0];return a=u(e,[n],i),_.isEmpty(a)?void 0:a}}function u(e,t,i){if(!_.isEmpty(t))return _.filter(t,(function(t){var a=function(a){if(!t.source.roles[a])return"continue";var r=_.find(i,(function(e){return e.name===a}));return r&&r.cartesianKind===e?{value:!0}:void 0};for(var r in t.source.roles){var n=a(r);if("object"==typeof n)return n.value}return!1}))}function c(e){var t=_.find(e,(function(e){return null!=e}));if(null!=t){var i=typeof t;if(!_.some(e,(function(e){return null!=e&&typeof e!==i})))return i}}function d(e,t){var i=_.zip(e,t),a=_.chain(i).filter((function(e){return null!=e[0]&&null!=e[1]})).sortBy((function(e){return e[0]})).unzip().value(),r=a[0],n=a[1];return{xValues:r,yValues:n}}function p(e,t){var i=_.sum(e)/e.length,a=_.sum(t)/t.length,r=_.chain(e).map((function(e){return Math.pow(e-i,2)})).sum();if(0!==r){var n=_.chain(e).map((function(e,r){return(e-i)*(t[r]-a)})).sum(),o=n/r,s=a-i*o;return{slope:o,intercept:s}}}function h(e,t,i){return e?[t*e.slope+e.intercept,i*e.slope+e.intercept]:[null,null]}function g(i){return e.DataViewObjects.getValue(i,t.scalarKeyMinPropertyIdentifier)}function f(e,t){var i=_.head(e.objects);if(i&&g(i))return _.map(e.objects,(function(e){return g(e)}));if(t){var a=e;if(a.highlights)return a.highlights}return e.values}function m(e,t,i,a){for(var r=[],n=_.map(e,(function(e){return f(e,a)})),o=_.map(t,(function(e){return f(e,a)})),s=e.length>1,l=0;l<o.length;l++){var u=s?n[l]:n[0],c=o[l];i&&r.length>0?(r[0].xValues=r[0].xValues.concat(u),r[0].yValues=r[0].yValues.concat(c)):r.push({xValues:u,yValues:c})}return r}function y(e,a,r,n,o,s,l,u,c,d,p){var h,g,f=u.categorical.categories.for.in,m=u.categorical.values.group;if(m&&!_.isEmpty(m.select)&&(h=m.select[0].for?m.select[0].for.in:m.select[0].bind.to,g=m.by),h&&g){var y=(T={},T[f]=!0,T),v=(V={},V[h]=!0,V),C=(L={},L[g]=!0,L),S=[];for(var x in o){var P={values:o[x]};s&&(P.highlights=s[x]),S.push([P])}var D=t.createCategoricalDataViewBuilder().withCategory({source:{displayName:e.displayName,queryName:w,type:e.type,isMeasure:!1,roles:y},values:n,identityFrom:{fields:[t.SQExprBuilder.columnRef(t.SQExprBuilder.entity("s","RegressionEntity"),"RegressionCategories")]
}}).withGroupedValues({groupColumn:{source:{displayName:a.displayName+"Regression",queryName:b,type:a.type,isMeasure:a.isMeasure,roles:C},values:r,identityFrom:{fields:[t.SQExprBuilder.columnRef(t.SQExprBuilder.entity("s","RegressionEntity"),"RegressionSeries")]}},valueColumns:[{source:{displayName:a.displayName,queryName:i.regressionYQueryName,type:a.type,isMeasure:a.isMeasure,roles:v}}],data:S}).build();return t.DataViewTransform.transformObjects(D,1,c,d,[],p),D;var T,V,L}}function v(e){return _.any(e,(function(e){var t=e;return null!=t.highlights}))}var w="RegressionX",b="RegressionSeries";i.regressionYQueryName="RegressionY",i.run=r,i.linearRegressionTransform=n})(i=t.DataViewRegression||(t.DataViewRegression={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(i){function a(e,i){if(_.isEmpty(e))return{};for(var a={},r=0,n=e;r<n.length;r++){var o=n[r];if(o){var s=o.roles;if(s)for(var l in s)if(s[l]){var u=a[l];u||(u=a[l]=new t.QueryProjectionCollection([])),u.all().push({queryRef:o.queryName}),i&&i[l]&&(u.activeProjectionRefs=_.map(i[l],(function(e){return e.queryRef})))}}}return a}function r(t,i){for(var a={},r=0,n=i.columns;r<n.length;r++){var o=n[r];if(!(!o.index&&0!==o.index||o.index<0||o.index>=t.length)){var s=t[o.index];if(s){var l=s.queryName;l&&void 0===a[l]&&(a[l]=o.isMeasure?e.VisualDataRoleKind.Measure:e.VisualDataRoleKind.Grouping)}}}return a}i.projectionsFromSelects=a,i.createRoleKindFromMetadata=r})(i=t.DataViewSelectTransform||(t.DataViewSelectTransform={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,i){return new n(e,t,i)}function i(e,t){return a(e.values,t)||a(e.categories,t)}function a(e,t){if(e)for(var i=0,a=e;i<a.length;i++){var r=a[i],n=r.source.roles;if(n&&n[t])return r}}function r(e,t){if(e)for(var i=0,a=e;i<a.length;i++){var r=a[i];if(!r.identity&&r.source.index===t)return r}}e.createCategoricalEvalContext=t;var n=(function(){function t(e,t,i){this.colorAllocatorProvider=e,this.dataView=t,this.selectTransforms=i,this.columnsByRole={}}return t.prototype.getColorAllocator=function(e){return this.colorAllocatorProvider.get(e)},t.prototype.getExprValue=function(t){var i=this.index;if(_.isNumber(i)){var a=this.selectTransforms;if(a){var n=e.findSelectIndex(t,a);if(n!==-1){var o=this.dataView,s=r(o.values,n);if(s)return s.values[i]}}}},t.prototype.getRoleValue=function(e){var t=this.columnsByRole,a=t[e];if(a||(a=t[e]=i(this.dataView,e)),a){var r=this.index;return null!=r?a.values[this.index]:void 0}},t.prototype.setCurrentRowIndex=function(e){this.index=e},t})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t,a){return new i(e,t,a)}e.createTableEvalContext=t;var i=(function(){function t(e,t,i){this.colorAllocatorProvider=e,this.dataView=t,this.selectTransforms=i}return t.prototype.getColorAllocator=function(e){return this.colorAllocatorProvider.get(e)},t.prototype.getExprValue=function(t){var i=this.rowIdx;if(null!=i)return e.getExprValueFromTable(t,this.selectTransforms,this.dataView,i)},t.prototype.getRoleValue=function(e){},t.prototype.setCurrentRowIndex=function(e){this.rowIdx=e},t})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.evaluate=function(e){},e})();e.RuleEvaluation=t})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=(function(e){function t(t,i){e.call(this),this.inputRole=t,this.allocator=i}return a(t,e),t.prototype.evaluate=function(e){var t=e.getRoleValue(this.inputRole);if(void 0!==t)return this.allocator.color(t)},t})(e.RuleEvaluation);e.ColorRuleEvaluation=t})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.findProperty=function(e,t){var i=this.entities.withName(e);if(i&&!_.isEmpty(i.properties))return i.properties.withName(t)},e.prototype.findHierarchy=function(e,t){var i=this.entities.withName(e);if(i&&!_.isEmpty(i.hierarchies))return i.hierarchies.withName(t)},e.prototype.findHierarchyByVariation=function(e,t,i,a){var r=this.findTargetEntityOfVariation(e,t,i);if(r&&!_.isEmpty(r.hierarchies))return r.hierarchies.withName(a)},e.prototype.findTargetEntityOfVariation=function(e,t,i){var a=this.entities.withName(e);if(a&&!_.isEmpty(a.properties)){var r=a.properties.withName(t);if(r){var n=r.column;if(n&&!_.isEmpty(n.variations)){var o=n.variations.withName(i);return o?o.navigationProperty?o.navigationProperty.targetEntity:a:void 0}}}},e.prototype.findPropertyWithKpi=function(e,t){var i=this.entities.withName(e);if(i&&!_.isEmpty(i.properties))for(var a=0,r=i.properties;a<r.length;a++){var n=r[a];if(n&&n.measure&&n.measure.kpi&&(n.measure.kpi.status===t||n.measure.kpi.goal===t))return n}},e})();e.ConceptualSchema=t,(function(e){e[e.None=0]="None",e[e.Address=1]="Address",e[e.City=2]="City",e[e.Company=3]="Company",e[e.Continent=4]="Continent",e[e.Country=5]="Country",e[e.County=6]="County",e[e.Date=7]="Date",e[e.Image=8]="Image",e[e.ImageUrl=9]="ImageUrl",e[e.Latitude=10]="Latitude",e[e.Longitude=11]="Longitude",e[e.Organization=12]="Organization",e[e.Place=13]="Place",e[e.PostalCode=14]="PostalCode",e[e.Product=15]="Product",e[e.StateOrProvince=16]="StateOrProvince",e[e.WebUrl=17]="WebUrl"})(e.ConceptualDataCategory||(e.ConceptualDataCategory={}));e.ConceptualDataCategory})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,i=a.StringExtensions,r=e.data.FieldExprPattern;!(function(t){function a(e){if(e&&1===e.length&&e[0])return e[0].scriptResult}function n(e){var t=a(e);if(t){var i=e[0].metadata&&e[0].metadata.objects;return l(t,i)}}function o(t,i){if(i){var r=a(t);if(r&&r.script&&r.script.source&&r.script.provider){var n=e.data.DataViewObjectDefinitions.getValue(i,r.script.source,null),o=e.data.DataViewObjectDefinitions.getValue(i,r.script.provider,null),s=n?n.value:null,l=o?o.value:null;return d(s,l,r.script.scriptOutputType)}}}function s(e){return u(a(e))}function l(t,i){if(t&&t.script&&t.script.source&&t.script.provider&&i){var a=e.DataViewObjects.getValue(i,t.script.source),r=e.DataViewObjects.getValue(i,t.script.provider);return d(a,r,t.script.scriptOutputType)}}function u(e){return c(e&&e.script)}function c(e){if(e){var t=e.scriptSourceDefault,i=e.scriptProviderDefault,a=e.scriptOutputType;return d(t,i,a)}}function d(e,t,a){if(!i.isNullOrUndefinedOrWhiteSpaceString(e)&&!i.isNullOrUndefinedOrWhiteSpaceString(t))return{source:e,provider:t,outputType:a||m}}function p(e,t,i,a,r){if(a&&a.script)return h(e,t,i,a.script,r)}function h(e,t,a,n,o){var s=!!c(n),l={VariableName:"dataset",Columns:[],Parameters:[]};if(e&&t&&!_.isEmpty(t)){var u=[],d=[];for(var p in e)for(var h=0,f=e[p].all();h<f.length;h++){var m=f[h],v=t.withName(m.queryRef);if(v){var w={QueryName:v.name},b=r.visit(v.expr,new y(a));s&&(w.Role=p,b=p+"."+b),d.push(w),u.push(b)}}u=i.ensureUniqueNames(u);for(var C=0;C<u.length;C++){var w=d[C];w.Name=u[C]}l.Columns=d}return l.Parameters=g(n,o),l}function g(t,i){var a=[];if(i)for(var r in i){var n=e.DataViewObjects.getObject(i,r);if(n)for(var o in n){var s=f(t,n,r,o);if(s){var l={ObjectName:r,PropertyName:o,Value:s};a.push(l)}}}return a}function f(t,i,a,r){if(!(t&&t.source&&t.source.objectName===a&&t.source.propertyName===r||t&&t.provider&&t.provider.objectName===a&&t.provider.propertyName===r)){var n=e.DataViewObject.getFillColorByPropertyName(i,r);if(n)return e.data.PrimitiveValueEncoding.text(n);var o=e.DataViewObject.getValue(i,r);if(void 0!==o&&null!==o)switch(typeof o){case"string":return e.data.PrimitiveValueEncoding.text(o);case"number":var s=o;return e.Double.isInteger(s)?e.data.PrimitiveValueEncoding.integer(s):e.data.PrimitiveValueEncoding.double(s);case"boolean":return e.data.PrimitiveValueEncoding.boolean(o)}}}var m="png";t.findScriptResultMapping=a,t.extractScriptResult=n,t.extractScriptResultFromVisualConfig=o,t.extractScriptResultDefaultFromDataViewMappings=s,t.extractScriptResultDefaultFromDataViewMappingScriptDefinition=c,t.getScriptInput=p,t.getScriptInputFromScriptDefinition=h;var y=(function(){function e(e){this.federatedSchema=e}return e.prototype.visitColumn=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitColumnAggr=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitGroupingColumn=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitGroupingColumnAggr=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitColumnHierarchyLevelVariation=function(t){return e.getVariationLevelName(t,this.federatedSchema)},e.prototype.visitEntity=function(e){return e.entity},e.prototype.visitEntityAggr=function(e){return e.entity},e.prototype.visitHierarchy=function(t){return e.getNameForHierarchy(t,this.federatedSchema)},e.prototype.visitHierarchyLevel=function(e){},e.prototype.visitHierarchyLevelAggr=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitMeasure=function(t){return e.getNameForProperty(t,this.federatedSchema)},e.prototype.visitSelectRef=function(e){return r.visit(e,this)},e.prototype.visitPercentile=function(e){return r.visit(e.arg,this)},e.prototype.visitPercentOfGrandTotal=function(e){return r.visit(e.baseExpr,this)},e.prototype.visitTransformOutputRoleRef=function(e){return r.visit(e,this)},e.getNameForHierarchy=function(e,t){var i=t.schema(e.schema),a=i.findHierarchy(e.entity,e.name);if(a)return a.name},e.getNameForProperty=function(e,t){var i=t.schema(e.schema),a=i.findProperty(e.entity,e.name);if(a)return a.name},e.getVariationLevelName=function(e,t){var i=e.source,a=t.schema(i.schema).findProperty(i.entity,i.name);if(a)for(var r=a.column.variations,n=0,o=r;n<o.length;n++){var s=o[n];if(s.name===e.variationName)for(var l=0,u=s.defaultHierarchy.levels;l<u.length;l++){var c=u[l];if(c.name===e.level.level)return c.column.name}}},e})()})(t=e.ScriptResultUtil||(e.ScriptResultUtil={}))})(i||(i={}))},function(e,t){window.jsCommon,window.powerbi,window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(t){function i(t,i){!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,i.metadata),i.metadata.segment||delete t.metadata.segment,t.table&&i.table&&a(t.table,i.table),t.categorical&&i.categorical&&r(t.categorical,i.categorical),t.tree&&i.tree&&o(t.tree.root,i.tree.root,!0),t.matrix&&i.matrix&&o(t.matrix.rows.root,i.matrix.rows.root,!1)}function a(e,t){if(!_.isEmpty(t.rows)){var i=t.lastMergeIndex+1;n(e.rows,t.rows,i),t.identity&&n(e.identity,t.identity,i)}}function r(e,t){if(!_.isEmpty(e.categories)&&!_.isEmpty(t.categories)){for(var i=t.lastMergeIndex+1,a=t.categories.length,r=0;r<a;r++){var o=t.categories[r],s=e.categories[r];o.values&&n(s.values,o.values,i)}t.categories[0].identity&&n(e.categories[0].identity,t.categories[0].identity,i)}if(e.values&&t.values)for(var l=t.values.length,u=0;u<l;u++){var c=t.values[u],d=e.values[u];!d.values&&c.values&&(d.values=[]);var i=t.lastMergeIndex+1;c.values&&n(d.values,c.values,i),c.highlights&&n(d.highlights,c.highlights,i)}}function n(e,t,i){if(i>=t.length)return t;var a=[];return void 0!==i&&(a=t.splice(0,i)),Array.prototype.push.apply(e,t),a}function o(e,t,i){if(t.children&&0!==t.children.length){if(i&&(!e.children||0===e.children.length))return void(e.children=t.children);var a=s(t.children),r=e.children[e.children.length-1],l=n(e.children,t.children,a);l.length>0&&o(r,l[l.length-1],i)}}function s(e){if(0===e.length)return 0;for(var t=0;t<e.length;t++){var i=e[t];if(!i.isMerge)break}return t}t.mergeDataViews=i,t.mergeTables=a,t.mergeCategorical=r,t.mergeTreeNodes=o})(i=t.DataViewMerger||(t.DataViewMerger={}))})(i=t.segmentation||(t.segmentation={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function i(e){return e.accept(new r)}t.run=i;var r=(function(t){function i(){t.call(this)}return a(i,t),i.prototype.visitCompare=function(t){if(0!==t.comparison)return this.visitUnsupported(t);if(!this.isSupported(t.left)||!this.isSupported(t.right))return this.visitUnsupported(t);var i=this.isComparand(t.left),a=this.isComparand(t.right);if(i===a)return this.visitUnsupported(t);var r=i?t.left:t.right,n=i?t.right:t.left,o=this.current;return o?(o.add(r,n),t):e.SQExprBuilder.inValues([r],[[n]])},i.prototype.visitOr=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var t;return this.current||(t=this.current=new n),e.left.accept(this),e.right.accept(this),t?(this.current=null,t.complete()||e):e},i.prototype.visitAnd=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var i=this.current;return i?(i.cancel(),e):t.prototype.visitAnd.call(this,e)},i.prototype.visitUnsupported=function(e){var t=this.current;return t&&t.cancel(),e},i.prototype.isSupported=function(t){return t instanceof e.SQCompareExpr||t instanceof e.SQColumnRefExpr||t instanceof e.SQConstantExpr||t instanceof e.SQHierarchyLevelExpr||t instanceof e.SQOrExpr||t instanceof e.SQAndExpr},i.prototype.isComparand=function(t){return t instanceof e.SQColumnRefExpr||t instanceof e.SQHierarchyLevelExpr},i})(e.SQExprRewriter),n=(function(){function t(){}return t.prototype.add=function(t,i){if(!this.cancelled){if(this.operand&&!e.SQExpr.equals(t,this.operand))return void this.cancel();this.operand=t;var a=this.values;a||(a=this.values=[]),a.push(i)}},t.prototype.cancel=function(){this.cancelled=!0},t.prototype.complete=function(){if(!this.cancelled&&this.operand)return e.SQExprBuilder.inValues([this.operand],_.map(this.values,(function(e){return[e]})))},t})()})(t=e.EqualsToInRewriter||(e.EqualsToInRewriter={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function i(e){var t=new r;return e.accept(t),t.sawSubquery?3:t.filterKind}t.run=i;var r=(function(e){function t(){e.call(this),this.filterKind=0,this.sawSubquery=!1}return a(t,e),t.prototype.visitMeasureRef=function(e){this.filterKind=1},t.prototype.visitExists=function(e){this.filterKind=2},t.prototype.visitAggr=function(e){this.filterKind=1},t.prototype.visitSubqueryRef=function(e){this.sawSubquery=!0},t})(e.DefaultSQExprVisitorWithTraversal)})(t=e.FilterKindDetector||(e.FilterKindDetector={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i;!(function(e){function t(e,t){var i=e.conditions(),a=i[0];if(a){var r=new n(t);if(a.accept(r))return r.getResult()}}function i(e){var t=e.expr.accept(new o);if(t)return t.value}e.asScopeIdsContainer=t,e.getFirstComparandValue=i})(i=t.SQExprConverter||(t.SQExprConverter={}));var n=(function(i){function n(e){i.call(this),this.isRoot=!0,this.isNot=!1,this.keyExprsCount=null,this.valueExprs=[],this.fieldExprs=[];for(var a=0,r=e;a<r.length;a++){var n=r[a];this.fieldExprs.push(t.SQExprBuilder.removeEntityVariables(n))}}return r(n,i),n.prototype.getResult=function(){for(var t=this.valueExprs,i=[],r=this.keyExprsCount||1,o=0,s=r,l=t.length;o<l&&s<=l;){var u=t.slice(o,s),c=n.getScopeIdentity(this.fieldExprs,u);a.ArrayExtensions.isInArray(i,c,e.DataViewScopeIdentity.equals)||i.push(c),o+=r,s+=r}return{isNot:this.isNot,scopeIds:i}},n.getScopeIdentity=function(e,i){for(var a,r=0,n=e.length;r<n;r++){var o=t.SQExprBuilder.equal(e[r],i[r]);a=a?t.SQExprBuilder.and(a,o):o}return t.createDataViewScopeIdentity(a)},n.prototype.visitOr=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,e.left.accept(this)&&e.right.accept(this))},n.prototype.visitNot=function(e){return this.isRoot?(this.isNot=!0,e.arg.accept(this)):this.unsupportedSQExpr()},n.prototype.visitConstant=function(e){return this.isRoot&&0===e.type.primitiveType?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},n.prototype.visitCompare=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,0!==e.comparison?this.unsupportedSQExpr():e.left.accept(this)&&e.right.accept(this))},n.prototype.visitIn=function(e){if(!e.values)return!1;this.keyExprsCount=0;var t;this.isRoot=!1;for(var i=0,a=e.args;i<a.length;i++){var r=a[i];if(t=r.accept(this),!t)return this.unsupportedSQExpr();this.keyExprsCount++}if(this.keyExprsCount!==this.fieldExprs.length)return this.unsupportedSQExpr();for(var n=e.values,o=0,s=n;o<s.length;o++)for(var l=s[o],u=(l.length,0),c=l;u<c.length;u++){var d=c[u];if(t=d.accept(this),!t)return this.unsupportedSQExpr()}return t},n.prototype.visitColumnRef=function(e){if(this.isRoot)return this.unsupportedSQExpr();var i=t.SQExprBuilder.removeEntityVariables(e);return null!==this.keyExprsCount?t.SQExpr.equals(this.fieldExprs[this.keyExprsCount],i):t.SQExpr.equals(this.fieldExprs[0],i)},n.prototype.visitDefaultValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},n.prototype.visitAnyValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},n.prototype.visitDefault=function(e){return this.unsupportedSQExpr()},n.prototype.unsupportedSQExpr=function(){return!1},n})(t.DefaultSQExprVisitor),o=(function(e){function i(){e.apply(this,arguments)}return r(i,e),i.prototype.visitAnd=function(e){return e.left.accept(this)||e.right.accept(this)},i.prototype.visitCompare=function(e){if(0===e.comparison){if(e.right instanceof t.SQConstantExpr)return e.right;if(e.left instanceof t.SQConstantExpr)return e.left}},i})(t.DefaultSQExprVisitor)})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t,i=a.ArrayExtensions;!(function(t){function a(e){var t=new l;return e.accept(t),t.malformed?null:i.emptyToNull(t.keys)}function n(e){var t=new l;return e.accept(t),t.malformed?null:i.emptyToNull(t.values)}function o(t){var a=new l;if(t.accept(a),!a.malformed){var r=i.emptyToNull(a.keys),n=i.emptyToNull(a.values);return r&&n?e.SQExprBuilder.inValues(r,[n]):void 0}}function s(e,t){var i=new u(t);return e.accept(i),i.getResult()}t.getKeys=a,t.getValues=n,t.getInExpr=o,t.getSubset=s;var l=(function(e){function t(){e.apply(this,arguments),this.keys=[],this.values=[]}return r(t,e),t.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},t.prototype.visitCompare=function(e){return 0!==e.comparison?void this.visitDefault(e):(e.left.accept(this),void e.right.accept(this))},t.prototype.visitColumnRef=function(e){this.keys.push(e)},t.prototype.visitGroupRef=function(e){this.keys.push(e)},t.prototype.visitHierarchyLevel=function(e){this.keys.push(e)},t.prototype.visitConstant=function(e){this.values.push(e)},t.prototype.visitArithmetic=function(e){this.keys.push(e)},t.prototype.visitDefault=function(e){this.malformed=!0},t})(e.DefaultSQExprVisitor),u=(function(t){function i(e){t.call(this),this.identityFieldExprs=e,this.identityComparisonExprs=[],this.identityComparisonExprCount=0}return r(i,t),i.prototype.getResult=function(){if(!this.malformed&&this.identityComparisonExprCount===this.identityFieldExprs.length){for(var t,i=0,a=this.identityComparisonExprs;i<a.length;i++){var r=a[i];t=t?e.SQExprBuilder.and(t,r):r}return t}},i.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},i.prototype.visitCompare=function(t){if(0!==t.comparison)return void this.visitDefault(t);var i=_.findIndex(this.identityFieldExprs,(function(i){return e.SQExpr.equals(t.left,i)}));i>=0&&!this.identityComparisonExprs[i]&&(this.identityComparisonExprs[i]=t,this.identityComparisonExprCount++)},i.prototype.visitDefault=function(e){this.malformed=!0},i})(e.DefaultSQExprVisitor)})(t=e.ScopeIdentityExtractor||(e.ScopeIdentityExtractor={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function a(t,i){if(t){if(t instanceof e.SemanticFilter){var a=t.conditions();return o(t.from(),a[0])}return o(i,t.condition)}}function n(t){var i=s(t),a=new e.SQFromSubquerySource(i),r=new e.SQFrom,n=r.ensureSource(a,"subquery"),o=e.SQExprBuilder.inTable([t.fieldBeingFiltered],e.SQExprBuilder.subqueryRef(n.name));return e.SemanticFilter.fromSQFromAndSQExpr(r,o)}function o(t,a){var n=new r;if(n.visitCondition(a)){var o=t.sources(),s=o&&o[n.subqueryName];if(s&&e.isSQFromSubquerySource(s)){var l=s.subquery.orderBy();if(!l||1!==l.length)return;var u=l[0],c=i.run(u);if(!c)return;return{fieldBeingFiltered:n.fieldBeingFiltered,isTop:2===u.direction,itemCount:s.subquery.top(),orderByField:c}}}}function s(t){var i=new e.SQFrom,a=e.SQExprRewriterWithSourceRenames.rewrite(t.fieldBeingFiltered,null,i),r=e.SQExprRewriterWithSourceRenames.rewrite(t.orderByField,null,i),n=t.isTop?2:1,o=e.SemanticQuery.createWith({from:i,orderBy:[{expr:r,direction:n}],select:[{name:"field",expr:a}],top:t.itemCount});return o}t.extractParametersFromFilter=a,t.buildFilterFromParameters=n,t.extractParametersFromCondition=o})(t=e.TopNFilterPattern||(e.TopNFilterPattern={}));var i,r=(function(e){function t(){e.call(this),this.fieldBeingFiltered=null,this.subqueryName=null}return a(t,e),t.prototype.visitCondition=function(e){return e.accept(this,0)},t.prototype.visitIn=function(e,t){return 0===t&&(!(!e.args||1!==e.args.length||!e.args[0].accept(this,1))&&!(!e.table||!e.table.accept(this,2)))},t.prototype.visitColumnRef=function(e,t){return 1===t&&(this.fieldBeingFiltered=e,!0)},t.prototype.visitSubqueryRef=function(e,t){return 2===t&&(this.subqueryName=e.variable,!0)},t})(e.DefaultSQExprVisitorWithArg);!(function(t){function i(e){var t=new r;if(t.visitOrderBy(e.expr))return t.orderByField}t.run=i;var r=(function(e){function t(){e.call(this),this.orderByField=null}return a(t,e),t.prototype.visitOrderBy=function(e){return e.accept(this,0)},t.prototype.visitAggr=function(e,t){return 0===t&&(this.orderByField=e,!0)},t.prototype.visitMeasureRef=function(e,t){return 0===t&&(this.orderByField=e,!0)},t})(e.DefaultSQExprVisitorWithArg)})(i||(i={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi),a=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t;!(function(t){function a(t,a){if(!a||!t)return t;var r=a.conditions();if(!r||1!==r.length)return t;var n=new i;if(!n.visitCondition(r[0]))return t;for(var o,s=n.fieldsBeingFiltered,l=t.from(),u=t.where(),c=function(t,i){var a=u[t],r=e.TopNFilterPattern.extractParametersFromFilter(a,l);r&&_.find(s,(function(t){return e.SQExpr.equals(r.fieldBeingFiltered,t)}))?o||(o=_.take(u,t)):o&&o.push(a)},d=0,p=u.length;d<p;d++)c(d,p);return o?e.SemanticFilter.fromSQFromAndSQFilters(l,o):t}t.removeUnnecessaryTopNFilters=a})(t=e.TopNFilterPruner||(e.TopNFilterPruner={}));var i=(function(e){function t(){e.call(this),this.fieldsBeingFiltered=[]}return a(t,e),t.prototype.visitCondition=function(e){return e.accept(this,0)},t.prototype.visitIn=function(e,t){if(0!==t)return!1;if(!e.args)return!1;for(var i=0,a=e.args;i<a.length;i++){var r=a[i];if(!r.accept(this,1))return!1}return!!e.values&&!e.table},t.prototype.visitColumnRef=function(e,t){return 1===t&&(this.fieldsBeingFiltered.push(e),!0)},t})(e.DefaultSQExprVisitorWithArg)})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function a(t){var a=_.filter(t.where(),(function(t){return 0===e.FilterKindDetector.run(t.condition)}));if(_.isEmpty(a))return t;var r=t.from(),n=i.ensureFiltersInSubqueries(r,a,r);return r===n?t:e.SemanticFilter.fromSQFromAndSQFilters(n,t.where())}function r(t,a){var r=t.from(),n=i.ensureFiltersInSubqueries(r,a.where(),a.from());return r===n?t:e.SemanticFilter.fromSQFromAndSQFilters(n,t.where())}function n(t,a){var r=_.filter(_.map(a.select(),(function(e){return e.expr})),(function(t){return!e.SQExprUtils.isMeasure(t)}));if(_.isEmpty(r))return t;var n=_.map(r,(function(t){return{condition:e.SQExprBuilder.equal(t,e.SQExprBuilder.anyValue(!0))}})),o=t.from(),s=i.ensureFiltersInSubqueries(o,n,o);return o===s?t:e.SemanticFilter.fromSQFromAndSQFilters(s,t.where())}t.makeSubqueriesLowerPrecedenceThanColumnFilters=a,t.makeSubqueriesLowerPrecedenceThanSpecificFilters=r,t.rewriteSubqueriesForContainingQuery=n})(t=e.SubqueryRewriter||(e.SubqueryRewriter={}));var i=(function(){function t(e,t){this.filtersToEnsure=e,this.filtersToEnsureFrom=t,this.modifiedSubquery=!1}return t.ensureFiltersInSubqueries=function(i,a,r){var n=new t(a,r),o=e.SemanticQueryRewriter.rewriteFrom(i,n);return o},t.prototype.visitEntity=function(e,t){return e},t.prototype.visitSubquery=function(t,i){for(var a=t.subquery.where(),r=[],n=function(t){_.find(a,(function(i){return e.SQFilter.equals(t,i)}))||r.push(t)},o=0,s=this.filtersToEnsure;o<s.length;o++){var l=s[o];n(l)}return 0===r.length?t:(this.modifiedSubquery=!0,new e.SQFromSubquerySource(t.subquery.addWhere(r,this.filtersToEnsureFrom)))},t})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e){return new s(e)}function a(e,i){var a=t.SQExprBuilder.removeAggregate(e).getMetadata(i);return a||(a=e.getMetadata(i)),a}function r(e,i){var a=t.SQExprConverter.asFieldPattern(e),r=t.FieldExprPattern.toFieldExprEntityItemPattern(a),n=i.schema(r.schema);return n.capabilities}function n(t,i){return t.integer||t.numeric?0:(t.dateTime||t.text)&&(_.isEmpty(i)||e.ValueType.isCompatibleTo(t,i))?3:2}function o(e){switch(e){case 6:return 1;case 3:return 5;case 7:return 2;case 5:return 4;case 4:return 3;case 2:return 0}}t.createSQAggregationOperations=i;var s=(function(){function i(e){this.options=e}return i.prototype.getSupportedAggregates=function(i,n,o,s){var l=a(i,n);if(!l)return[];var u=l.type,c=l.kind,d=l.idOnEntityKey;if(!u)return[];if(1===c)return[];if(u.numeric||u.integer){var p=[0,1,3,4,2,5,7,8];return r(i,n).supportsMedian&&p.push(6),p}var h=[];((s||this.options.datetimeMinMaxSupported)&&u.dateTime||(s||this.options.stringMinMax)&&u.text&&r(i,n).supportsStringMinMax)&&(_.isEmpty(o)||e.ValueType.isCompatibleTo(u,o))&&(h.push(3),h.push(4));var g=2===t.SQExprInfo.getAggregate(i);return d&&!g||h.push(2),h.push(5),h},i.prototype.isSupportedAggregate=function(e,t,i,a,r){var n=this.getSupportedAggregates(e,t,a,r);return _.contains(n,i)},i.prototype.createExprWithAggregate=function(e,i,a,r,n){var o;return o=null!=n&&this.isSupportedAggregate(e,i,n,r)?n:this.defaultAggregate(e,i,a,r),void 0!==o&&(e=t.SQExprBuilder.aggregate(e,o)),e},i.prototype.defaultAggregate=function(e,t,i,a){void 0===i&&(i=!1);var s=e.getConceptualProperty(t,!0);if(s){var l;if(s&&0===s.kind){var u=s.column?s.column.defaultAggregate:null;(s.type.integer||s.type.numeric||s.type.dateTime&&this.options.datetimeMinMaxSupported||s.type.text&&this.options.stringMinMax&&r(e,t).supportsStringMinMax)&&1!==u&&(l=o(u),void 0===l&&(l=n(s.type,a))),void 0===l&&i&&(l=5)}return l}},i})();t.defaultAggregateForDataType=n,t.defaultAggregateToQueryAggregateFunction=o})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function n(e,i){var a=f(i);if(a)return t.getConceptualHierarchyLevel(e,a.schema,a.entity,a.name,a.level)}function o(e,t,i,a,r){var n=e.schema(t),o=n.findHierarchy(i,a);if(o)return o.levels.withName(r)}function s(t,i){if(t instanceof e.SQHierarchyExpr){var a=t;if(t.arg instanceof e.SQEntityExpr){var r=t.arg;return i.schema(r.schema).findHierarchy(r.entity,a.hierarchy)}if(t.arg instanceof e.SQPropertyVariationSourceExpr){var n=t.arg,o=n.arg;return i.schema(o.schema).findHierarchyByVariation(o.entity,n.property,n.name,a.hierarchy)}}}function l(e,t,n){return i.convert(t,e)||r.expand(t,e)||!n&&a.expand(t,e)||t}function u(t,i){if(i instanceof e.SQHierarchyExpr||i instanceof e.SQHierarchyLevelExpr)return!0;var a=i.getConceptualProperty(t);if(a){var r=a.column;if(r&&r.variations&&r.variations.length>0)return!0}return!1}function c(t){var i=e.SQExprConverter.asFieldPattern(t);if(i.columnHierarchyLevelVariation){var a=e.SQExprBuilder.entity(i.columnHierarchyLevelVariation.source.schema,i.columnHierarchyLevelVariation.source.entity);return e.SQExprBuilder.columnRef(a,i.columnHierarchyLevelVariation.source.name)}}function d(t){var i=e.SQExprConverter.asFieldPattern(t),a=i.hierarchyLevel;if(a){var r=e.SQExprBuilder.entity(a.schema,a.entity,a.entityVar);return e.SQExprBuilder.hierarchy(r,a.name)}}function p(t){if(t.arg instanceof e.SQHierarchyExpr){var i=t.arg;return i.arg instanceof e.SQPropertyVariationSourceExpr?i.arg:void 0}}function h(t,i,a){if(!(i instanceof e.SQHierarchyLevelExpr&&a instanceof e.SQHierarchyLevelExpr))return!1;var r=i,n=a;if(!e.SQExpr.equals(r.arg,n.arg))return!1;var o=e.SQExprUtils.indexOfExpr(t,r),s=e.SQExprUtils.indexOfExpr(t,n);return o!==-1&&s!==-1&&o<s}function g(e,t,i){
for(var a=0;a<t.length&&h(e,t[a],i);)a++;return a}function f(e){return e.hierarchyLevel||e.hierarchyLevelAggr||e.columnHierarchyLevelVariation&&e.columnHierarchyLevelVariation.level}t.getConceptualHierarchyLevelFromExpr=n,t.getConceptualHierarchyLevel=o,t.getConceptualHierarchy=s,t.expandExpr=l,t.isHierarchyOrVariation=u,t.getSourceVariationExpr=c,t.getSourceHierarchy=d,t.getHierarchySourceAsVariationSource=p,t.areHierarchyLevelsOrdered=h,t.getInsertionIndex=g})(t=e.SQHierarchyExprUtils||(e.SQHierarchyExprUtils={}));var i;!(function(i){function a(i,a){if(i instanceof e.SQHierarchyExpr){var r=i,n=t.getConceptualHierarchy(r,a);if(n)return _.map(n.levels,(function(t){return e.SQExprBuilder.hierarchyLevel(i,t.name)}))}}i.convert=a})(i=e.SQExprHierarchyToHierarchyLevelConverter||(e.SQExprHierarchyToHierarchyLevelConverter={}));var a;!(function(t){function i(t,i){var a=[];if(t instanceof e.SQHierarchyLevelExpr){var r=e.SQExprConverter.asFieldPattern(t);if(r.hierarchyLevel){var n=e.FieldExprPattern.toFieldExprEntityItemPattern(r),o=i.schema(n.schema).findHierarchy(n.entity,r.hierarchyLevel.name);if(o)for(var s=o.levels,l=0,u=s;l<u.length;l++){var c=u[l];if(c.name===r.hierarchyLevel.level){a.push(t);break}a.push(e.SQExprBuilder.hierarchyLevel(e.SQExprBuilder.hierarchy(e.SQExprBuilder.entity(n.schema,n.entity,n.entityVar),o.name),c.name))}}}if(!_.isEmpty(a))return a}t.expand=i})(a||(a={}));var r;!(function(t){function i(t,i){var a,r=t.getConceptualProperty(i);if(r){var n=r.column;if(n&&n.variations&&n.variations.length>0){var o=n.variations,s=o[0],l=e.SQExprConverter.asFieldPattern(t),u=e.FieldExprPattern.toFieldExprEntityItemPattern(l);if(a=[],s.defaultHierarchy)for(var c=e.SQExprBuilder.hierarchy(e.SQExprBuilder.propertyVariationSource(e.SQExprBuilder.entity(u.schema,u.entity,u.entityVar),s.name,r.name),s.defaultHierarchy.name),d=0,p=s.defaultHierarchy.levels;d<p.length;d++){var h=p[d];a.push(e.SQExprBuilder.hierarchyLevel(c,h.name))}}}return a}t.expand=i})(r||(r={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t;!(function(t){function i(t,i){for(var r=[],n=0,o=i.length;n<o;n++){var s=i[n];s instanceof e.SQHierarchyLevelExpr?a(t,r,s,n):r.push({expr:s,children:null,selectQueryIndex:n})}return r}function a(t,i,a,r){var n=!0,o=e.SQHierarchyExprUtils.getSourceVariationExpr(a)||e.SQHierarchyExprUtils.getSourceHierarchy(a),s=_.last(i);if(s&&s.children&&e.SQExpr.equals(s.expr,o)){var l=e.SQHierarchyExprUtils.expandExpr(t,a.arg);if(l instanceof Array){var u=l;n=!e.SQHierarchyExprUtils.areHierarchyLevelsOrdered(u,_.last(s.children),a)}}n?i.push({expr:o,children:[a],selectQueryIndex:r}):s.children.push(a)}t.groupExprs=i})(t=e.SQExprGroupUtils||(e.SQExprGroupUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(t){var i,n=a.ArrayExtensions,o=a.StringExtensions;!(function(i){function a(e,t,i){var a=t.getMetadata(i),r=a&&a.type;return!(!a||!r)&&(2===e||3===e?r.numeric:r.numeric||r.dateTime||r.duration)}function s(e,i){for(var a=0,r=e.length;a<r;a++)if(t.SQExpr.equals(e[a],i))return a;return-1}function l(e,i){for(var a=0,r=e.length;a<r;a++){var n=e[a];if(n&&t.SQExpr.equals(n.expr,i))return a}return-1}function u(e,i){var a=e.length;if(a!==i.length)return!1;for(var r=0;r<a;r++)if(!t.SQExpr.equals(e[r],i[r]))return!1;return!0}function c(e,t,i){for(var a={},r=0,n=e.length;r<n;r++)a[e[r].name]=!0;return o.findUniqueName(a,i||d(t))}function d(e,t){return void 0===t&&(t="select"),e?e.accept(R.instance,t):t}function p(e){return e.accept(E.instance)}function h(e){return e.accept(j.instance)}function g(e){return e.accept(F.instance)}function f(e,t){var i=y(e,t);return i&&i.discourageQueryAggregateUsage}function m(e,t){var i=x(e,t);if(i)return i.aggregateBehavior}function y(e,i){var a=t.SQExprConverter.asFieldPattern(e);if(a){var r=t.FieldExprPattern.toFieldExprEntityItemPattern(a),n=i.schema(r.schema);return n?n.capabilities:void 0}}function v(e,t){var i=b(e,t);if(i)return i.kpiValue.measure.kpi.statusMetadata;var a=C(e,t);return a?a.kpiValue.measure.kpi.trendMetadata:void 0}function w(e,t){var i=t.schema(e.schema).entities.withName(e.entity);return i}function b(e,t){var i=e.getConceptualProperty(t);if(i){var a=i.kpiValue;return a&&a.measure.kpi.status===i?i:void 0}}function C(e,t){var i=e.getConceptualProperty(t);if(i){var a=i.kpiValue;return a&&a.measure.kpi.trend===i?i:void 0}}function S(e,t){var i=x(e,t);if(i)return i.defaultValue}function x(e,i){if(e&&i){var a=t.SQExprConverter.asFieldPattern(e);if(a){var r=a.column||a.groupingColumn;if(r){if(i.schema(r.schema)&&r.name){var n=i.schema(r.schema).findProperty(r.entity,r.name);if(n)return n.column}}else{var o=a.hierarchyLevel;if(o){var s=t.FieldExprPattern.toFieldExprEntityItemPattern(a),l=s.schema;if(i.schema(l)){var u=i.schema(l).findHierarchy(s.entity,o.name);if(u){var c=u.levels.withName(o.level);if(c&&c.column)return c.column.column}}}}}}}function P(e,t){if(!_.isEmpty(e)&&t){for(var i=[],a=0,r=e;a<r.length;a++){var n=r[a],o=S(n,t);o&&i.push(o)}return i}}function D(e,i){for(var a=[],r=0;r<e.length;r++)a.push(t.SQExprBuilder.compare(0,e[r],i[r]));if(!_.isEmpty(a)){for(var n,o=0,s=a;o<s.length;o++){var l=s[o];n=t.SQExprBuilder.and(n,l)}return n}}function T(e){var i=[],a=new t.SQFromEntitiesVisitor;if(e){var r=e.from();if(void 0!==r)for(var n=0,o=r.keys();n<o.length;n++){var s=o[n];r.source(s).accept(a,null)}}return i=_.map(a.entities,(function(e){return e.entity}))}function V(e,t,i){return M(e,t,i,0,2)||M(e,i,t,2,0)}function L(e,t,i){return M(e,t,i,2,0)||M(e,i,t,0,2)}function M(e,t,a,r,n){var o=i.getConceptualEntity(t,e);if(_.isEmpty(o.navigationProperties))return!1;var s=i.getConceptualEntity(a,e),l=[];for(l.push(o);!_.isEmpty(l);){var u=l.shift(),c=u.navigationProperties;if(!_.isEmpty(c))for(var d=0,p=c;d<p.length;d++){var h=p[d];if(h.isActive&&h.targetMultiplicity===n&&h.sourceMultiplicity===r){if(h.targetEntity===s)return!0;l.push(h.targetEntity)}}}return!1}function N(e,t,a){var r=i.getConceptualEntity(t,e),n=i.getConceptualEntity(a,e),o=r.navigationProperties,s=n.navigationProperties;return(!_.isEmpty(o)||!_.isEmpty(s))&&(I(o,n)||I(s,r))}function I(e,t){if(_.isEmpty(e))return!1;for(var i=0,a=e;i<a.length;i++){var r=a[i];if(r.isActive&&r.targetEntity===t&&0===r.sourceMultiplicity&&0===r.targetMultiplicity)return!0}return!1}function A(e,t){for(var i=n.copy(e),a=0,r=t;a<r.length;a++){var o=r[a];s(i,o)===-1&&i.push(o)}return i}function O(e){var t=new H;return e.accept(t),t.sawTransformOutputRoleRef}i.supportsArithmetic=a,i.indexOfExpr=s,i.indexOfNamedExpr=l,i.sequenceEqual=u,i.uniqueName=c,i.defaultName=d,i.isMeasure=p,i.isAnyValue=h,i.isDefaultValue=g,i.discourageAggregation=f,i.getAggregateBehavior=m,i.getSchemaCapabilities=y,i.getKpiMetadata=v,i.getConceptualEntity=w,i.getDefaultValue=S,i.getDefaultValues=P,i.getDataViewScopeIdentityComparisonExpr=D,i.getActiveTablesNames=T,i.isRelatedToMany=V,i.isRelatedToOne=L,i.isRelatedOneToOne=N,i.concatUnique=A,i.detectTransformExpr=O;var R=(function(i){function a(){i.apply(this,arguments)}return r(a,i),a.prototype.visitEntity=function(e){return e.entity},a.prototype.visitColumnRef=function(e){return e.source.accept(this)+"."+e.ref},a.prototype.visitGroupRef=function(e){return e.source.accept(this)+"."+e.ref},a.prototype.visitMeasureRef=function(e){return e.source.accept(this)+"."+e.ref},a.prototype.visitHierarchy=function(e){return e.arg.accept(this)+"."+e.hierarchy},a.prototype.visitHierarchyLevel=function(e){return e.arg.accept(this)+"."+e.level},a.prototype.visitPropertyVariationSource=function(e){return e.arg.accept(this)+"."+e.property+"."+e.name},a.prototype.visitAggr=function(e){return t.aggregateFunctionName(e.func)+"("+e.arg.accept(this)+")"},a.prototype.visitPercentile=function(e){var t=e.exclusive?"Percentile.Exc(":"Percentile.Inc(";return t+e.arg.accept(this)+", "+e.k+")"},a.prototype.visitArithmetic=function(t){return e.data.getArithmeticOperatorName(t.operator)+"("+t.left.accept(this)+", "+t.right.accept(this)+")"},a.prototype.visitConstant=function(e){return"const"},a.prototype.visitTransformOutputRoleRef=function(e){var t=e.role;return e.transform&&(t+="."+e.transform),t},a.prototype.visitScopedEval=function(e){var t=this;return"ScopedEval("+e.expression.accept(this)+", ["+_.map(e.scope,(function(e){return e.accept(t)})).join(", ")+"])"},a.prototype.visitDefault=function(e,t){return t||"expr"},a.instance=new a,a})(t.DefaultSQExprVisitorWithArg),E=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitMeasureRef=function(e){return!0},t.prototype.visitAggr=function(e){return!0},t.prototype.visitArithmetic=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t})(t.DefaultSQExprVisitor),F=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitCompare=function(e){return 0===e.comparison&&e.right.accept(this)},t.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},t.prototype.visitDefaultValue=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t})(t.DefaultSQExprVisitor),j=(function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.visitCompare=function(e){return 0===e.comparison&&e.right.accept(this)},t.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},t.prototype.visitAnyValue=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t})(t.DefaultSQExprVisitor),H=(function(e){function t(){e.call(this),this.sawTransformOutputRoleRef=!1}return r(t,e),t.prototype.visitTransformOutputRoleRef=function(e){this.sawTransformOutputRoleRef=!0},t})(t.DefaultSQExprVisitorWithTraversal)})(i=t.SQExprUtils||(t.SQExprUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=(function(){function t(e){this.exprRewriter=e}return t.rewriteFrom=function(t,i){for(var a,r=t,n=r.keys(),o=0,s=n.length;o<s;o++){var l=n[o],u=r.source(l),c=u.accept(i,l);(u!==c||a)&&(a||(a=_.pick(r.sources(),n.slice(0,o))),a[l]=c)}return a?new e.SQFrom(a):r},t.prototype.rewriteFrom=function(i){return t.rewriteFrom(i,new e.SQFromSourceRewriter(this.exprRewriter))},t.prototype.rewriteSelect=function(e,t){return this.rewriteNamedSQExpressions(e,t)},t.prototype.rewriteGroupBy=function(e,t){if(!_.isEmpty(e))return this.rewriteNamedSQExpressions(e,t)},t.prototype.rewriteNamedSQExpressions=function(t,i){var a=this;return _.map(t,(function(t){return{name:t.name,expr:e.SQExprRewriterWithSourceRenames.rewrite(t.expr.accept(a.exprRewriter),i,i)}}))},t.prototype.rewriteOrderBy=function(t,i){if(!_.isEmpty(t)){for(var a=[],r=0,n=t.length;r<n;r++){var o=t[r],s=e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),i,i);a.push({direction:o.direction,expr:s})}return a}},t.prototype.rewriteWhere=function(t,i){var a=this;if(!_.isEmpty(t)){for(var r=[],n=0,o=t.length;n<o;n++){var s=t[n],l={condition:e.SQExprRewriterWithSourceRenames.rewrite(s.condition.accept(this.exprRewriter),i,i)};s.target&&(l.target=_.map(s.target,(function(t){return e.SQExprRewriterWithSourceRenames.rewrite(t.accept(a.exprRewriter),i,i)}))),r.push(l)}return r}},t.prototype.rewriteTransform=function(t,i){var a=this;if(!_.isEmpty(t)){for(var r=[],n=0,o=t;n<o.length;n++){var s=o[n],l=void 0;s.input.table&&!_.isEmpty(s.input.table.columns)&&(l=_.map(s.input.table.columns,(function(t){return{role:t.role,expression:{name:t.expression.name,expr:e.SQExprRewriterWithSourceRenames.rewrite(t.expression.expr.accept(a.exprRewriter),i,i)}}})));var u={name:s.name,algorithm:s.algorithm,input:{parameters:s.input.parameters},output:s.output};s.input.table&&(u.input.table={name:s.input.table.name,columns:l}),r.push(u)}return r}},t})();e.SemanticQueryRewriter=t})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){function t(e,t){if(e&&t){if(i(e)&&i(t))return e.equals(t);if(r(e)&&r(t))return e.equals(t)}return e===t}function i(e){return null!=e.entity}function r(e){return null!=e.subquery}var n=a.ArrayExtensions,o=a.StringExtensions,s=(function(){function e(e,t){this.schema=e,this.entity=t}return e.prototype.accept=function(e,t){return e.visitEntity(this,t)},e.prototype.equals=function(e){return e&&this.entity===e.entity&&this.schema===e.schema},e})();e.SQFromEntitySource=s;var l=(function(){function t(e){this.subquery=e}return t.prototype.accept=function(e,t){return e.visitSubquery(this,t)},t.prototype.equals=function(t){return t&&e.SemanticQuery.equals(this.subquery,t.subquery)},t})();e.SQFromSubquerySource=l;var u=(function(){function e(e){this.items=e||{}}return e.prototype.keys=function(){return Object.keys(this.items)},e.prototype.source=function(e){return this.items[e]},e.prototype.sources=function(){return this.items},e.prototype.ensureSource=function(e,t){var i=this.getSourceKeyFromItems(e);if(i)return{name:i};var a=this.addSource(e,t);return{name:a,new:!0}},e.prototype.remove=function(e){delete this.items[e]},e.prototype.getSourceKeyFromItems=function(e){var t=this.keys();for(var a in t){var n=t[a],o=this.items[n];if(i(o)&&i(e)&&o.equals(e))return n;if(r(o)&&r(e)&&o.equals(e))return n}},e.prototype.addSource=function(e,t){for(var i=t||e.accept(new c,null),a=i,r={},n=0,s=this.keys();n<s.length;n++){var l=s[n];r[l]=!0}return a=o.findUniqueName(r,a),this.items[a]=e,a},e.prototype.clone=function(){var t=new e;return $.extend(t.items,this.items),t},e.prototype.equals=function(e){var i=this;if(!e)return!1;var a=this.keys(),r=e.keys();return a.length===r.length&&n.sequenceEqual(a,r,(function(a,r){return t(i.source(a),e.source(r))}))},e.prototype.renameSources=function(t){for(var i,a=this.items,r=Object.keys(a),n=0,s=r.length;n<s;n++){var l=r[n],u=l;if(t[l]&&(u=o.findUniqueName(t,l),!i)){i={};for(var c=0;c<n;c++){var d=r[c];i[d]=a[d]}}t[u]=!0,i&&(i[u]=a[l])}return i?new e(i):this},e})();e.SQFrom=u,e.equals=t,e.isSQFromEntitySource=i,e.isSQFromSubquerySource=r;var c=(function(){function e(){}return e.prototype.visitEntity=function(e){var t=e.entity,i=t.lastIndexOf(".");return i>=0&&i!==t.length-1&&(t=t.substr(i+1)),t.substring(0,1).toLowerCase()},e.prototype.visitSubquery=function(e){return"q"},e})();e.SQFromSourceCandidateNameVisitor=c;var d=(function(){function t(){this.entities=[]}return t.prototype.visitEntity=function(t,i){this.entities.push(new e.SQEntityExpr(t.schema,t.entity,i))},t.prototype.visitSubquery=function(e,t){},t})();e.SQFromEntitiesVisitor=d;var p=(function(){function t(e){this.exprRewriter=e}return t.prototype.visitEntity=function(t,i){var a=e.SQExprBuilder.entity(t.schema,t.entity,i),r=a.accept(this.exprRewriter);return new s(r.schema,r.entity)},t.prototype.visitSubquery=function(e,t){var i=e.subquery,a=i.rewrite(this.exprRewriter);return new l(a)},t})();e.SQFromSourceRewriter=p})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi,r=(window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft,this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});!(function(e){var t;!(function(e){var t=a.ArrayExtensions,i=(function(){function i(e,t,i,a,r,n,o){this.fromValue=e,this.whereItems=t,this.orderByItems=i,this.selectItems=a,this.groupByItems=r,this.transformItems=n,null!=o&&(this.topValue=o)}return i.create=function(){return i.empty||(i.empty=new i(new e.SQFrom,null,null,[],null,null,null)),i.empty},i.createWith=function(e,t){return t||(e=i.normalize(e)),new i(e.from,e.where,e.orderBy,e.select,e.groupBy,e.transforms,e.top)},i.prototype.createModified=function(e){return i.createWith({from:void 0!==e.from?e.from:this.fromValue,where:void 0!==e.where?e.where:this.whereItems,transforms:void 0!==e.transforms?e.transforms:this.transformItems,orderBy:void 0!==e.orderBy?e.orderBy:this.orderByItems,select:void 0!==e.select?e.select:this.selectItems,groupBy:void 0!==e.groupBy?e.groupBy:this.groupByItems,top:void 0!==e.top?e.top:this.topValue})},i.normalize=function(e){var t={clauses:{from:e.from,where:e.where,orderBy:e.orderBy,select:e.select,groupBy:e.groupBy,transforms:e.transforms,top:e.top},usedSourceNames:{}};return i.removeUnreferencedKeys(t),i.renameSources(t),i.renameSourcesInSubqueries(t),t.clauses},i.removeUnreferencedKeys=function(e){var t=e.clauses,i=t.from,a=t.where,r=t.orderBy,n=t.select,o=t.groupBy,l=t.transforms,u=new s(i.keys());if(a)for(var c=0,d=a.length;c<d;c++){var p=a[c];p.condition.accept(u);var h=p.target;if(h)for(var g=0,f=h.length;g<f;g++)h[g]&&h[g].accept(u)}if(l)for(var c=0,d=l.length;c<d;c++){var m=l[c].input.table;if(m&&!_.isEmpty(m.columns))for(var y=0,v=m.columns;y<v.length;y++){var w=v[y];w.expression.expr.accept(u)}}if(r)for(var c=0,d=r.length;c<d;c++)r[c].expr.accept(u);for(var c=0,d=n.length;c<d;c++)n[c].expr.accept(u);if(o)for(var c=0,d=o.length;c<d;c++)o[c].expr.accept(u);var b=u.result();if(b){for(var C=i.clone(),S=0,x=b;S<x.length;S++){var P=x[S];C.remove(P)}e.clauses.from=C}},i.renameSources=function(e){var t=e.clauses.from,a=t.renameSources(e.usedSourceNames);a!==t&&(e.clauses.from=a,i.rewriteClauses(e.clauses,new o(t,a)))},i.renameSourcesInSubqueries=function(e){e.clauses.from=l.renameSources(i.renameSourcesInQuery,e.clauses.from,e.usedSourceNames)},i.renameSourcesInQuery=function(e,t){var a={clauses:e.getClauses(),usedSourceNames:t},r=a.clauses.from;return i.renameSources(a),a.clauses.from===r?e:i.createWith(a.clauses)},i.prototype.from=function(e){return e?this.createModified({from:e}):this.fromValue.clone()},i.prototype.select=function(e){return _.isEmpty(arguments)?this.getSelect():this.setSelect(e)},i.prototype.getSelect=function(){return i.createNamedExpressionArray(this.selectItems)},i.createNamedExpressionArray=function(e){return t.extendWithName(_.map(e,(function(e){return{name:e.name,expr:e.expr}})))},i.prototype.setSelect=function(e){var t=this.fromValue.clone(),a=i.rewriteExpressionsWithSourceRenames(e,t);return this.createModified({from:t,select:a})},i.rewriteExpressionsWithSourceRenames=function(e,t){for(var i=[],a=0,r=e.length;a<r;a++){var n=e[a];i.push({name:n.name,expr:o.rewrite(n.expr,null,t)})}return i},i.prototype.removeSelect=function(t){for(var i=this.selectItems,a=[],r=0,n=i.length;r<n;r++){var o=i[r];e.SQExpr.equals(o.expr,t)||a.push(o)}return this.createModified({select:a})},i.prototype.removeOrderBy=function(t){for(var i=this.orderBy(),a=i.length-1;a>=0;a--)e.SQExpr.equals(i[a].expr,t)&&i.splice(a,1);return this.createModified({orderBy:i})},i.prototype.removeTransform=function(e){for(var t=this.transforms(),i=0,a=t.length;i<a;i++)if(t[i].name===e.name){t.splice(i,1);break}return this.createModified({transforms:t})},i.prototype.selectNameOf=function(t){var i=e.SQExprUtils.indexOfNamedExpr(this.selectItems,t);if(i>=0)return this.selectItems[i].name},i.prototype.setSelectAt=function(e,t){if(!(e>=this.selectItems.length)){var i=this.select(),a=this.fromValue.clone(),r=i[e].name;return i[e]={name:r,expr:o.rewrite(t,null,a)},this.createModified({from:a,select:i})}},i.prototype.addSelect=function(e,t){var i=this.select(),a=this.fromValue.clone();return i.push(this.createNamedExpr(i,a,e,t)),this.createModified({from:a,select:i})},i.prototype.createNamedExpr=function(t,i,a,r){return{name:e.SQExprUtils.uniqueName(t,a,r),expr:o.rewrite(a,null,i)}},i.prototype.groupBy=function(e){return _.isEmpty(arguments)?this.getGroupBy():this.setGroupBy(e)},i.prototype.getGroupBy=function(){return i.createNamedExpressionArray(this.groupByItems)},i.prototype.setGroupBy=function(e){var t=this.fromValue.clone(),a=i.rewriteExpressionsWithSourceRenames(e,t);return this.createModified({from:t,groupBy:a})},i.prototype.addGroupBy=function(e){var t=this.groupBy(),i=this.fromValue.clone();return t.push(this.createNamedExpr(t,i,e)),this.createModified({from:i,groupBy:t})},i.prototype.orderBy=function(e){return _.isEmpty(arguments)?this.getOrderBy():this.setOrderBy(e)},i.prototype.getOrderBy=function(){var e=[],t=this.orderByItems;if(t)for(var i=0,a=t.length;i<a;i++){var r=t[i];e.push({expr:r.expr,direction:r.direction})}return e},i.prototype.setOrderBy=function(e){for(var t=[],i=this.fromValue.clone(),a=0,r=e.length;a<r;a++){var n=e[a];t.push({expr:o.rewrite(n.expr,null,i),direction:n.direction})}return this.createModified({from:i,orderBy:t})},i.prototype.where=function(e,t){return _.isEmpty(arguments)?this.getWhere():this.setWhere([],e,t)},i.prototype.getWhere=function(){var e=[],t=this.whereItems;if(t)for(var i=0,a=t.length;i<a;i++)e.push(t[i]);return e},i.prototype.setWhere=function(e,t,i){for(var a=_.clone(e),r=this.fromValue.clone(),n=0,s=t;n<s.length;n++){var l=s[n],u={condition:o.rewrite(l.condition,i,r)};l.target&&(u.target=_.map(l.target,(function(e){return o.rewrite(e,i,r)}))),a.push(u)}return this.createModified({from:r,where:a})},i.prototype.addWhere=function(e,t){return this.setWhere(this.where(),e,t)},i.prototype.addSemanticFilter=function(e){return this.setWhere(this.where(),e.where(),e.from())},i.prototype.transforms=function(e){return _.isEmpty(arguments)?this.getTransforms():this.setTransforms(e)},i.prototype.getTransforms=function(){var e=[];if(!_.isEmpty(this.transformItems))for(var t=0,i=this.transformItems;t<i.length;t++){var a=i[t];e.push(a)}return e},i.prototype.setTransforms=function(e){for(var i=this,a=this.fromValue.clone(),r=[],n=0,o=e;n<o.length;n++){var s=o[n],l=void 0;s.input.table&&!_.isEmpty(s.input.table.columns)&&(l=_.map(s.input.table.columns,(function(e){return{role:e.role,expression:i.createNamedExpr(t.extendWithName([]),a,e.expression.expr,e.expression.name)}})));var u={name:s.name,algorithm:s.algorithm,input:{parameters:s.input.parameters},output:s.output};s.input.table&&(u.input.table={name:s.input.table.name,columns:l}),r.push(u)}return this.createModified({from:a,transforms:e})},i.prototype.top=function(e){return _.isEmpty(arguments)?this.topValue:this.setTop(e)},i.prototype.setTop=function(e){return this.createModified({top:e})},i.prototype.rewrite=function(e){var t=this.getClauses();return i.rewriteClauses(t,e),this.createModified(t)},i.prototype.getClauses=function(){return{from:this.fromValue,where:this.whereItems,orderBy:this.orderByItems,select:this.selectItems,groupBy:this.groupByItems,transforms:this.transformItems,top:this.topValue}},i.rewriteClauses=function(t,i){var a=new e.SemanticQueryRewriter(i);t.from=a.rewriteFrom(t.from),t.where=a.rewriteWhere(t.where,t.from),t.orderBy=a.rewriteOrderBy(t.orderBy,t.from),t.select=a.rewriteSelect(t.select,t.from),t.groupBy=a.rewriteGroupBy(t.groupBy,t.from),t.transforms=a.rewriteTransform(t.transforms,t.from)},i.equals=function(i,a){return i.from().equals(a.from())&&t.sequenceEqual(i.where(),a.where(),e.SQFilter.equals)&&t.sequenceEqual(i.orderBy(),a.orderBy(),e.SQUtils.sqSortDefinitionEquals)&&t.sequenceEqual(i.select(),a.select(),e.SQUtils.namedSQExprEquals)&&t.sequenceEqual(i.groupBy(),a.groupBy(),e.SQUtils.namedSQExprEquals)&&t.sequenceEqual(i.transforms(),a.transforms(),e.SQUtils.sqTransformEquals)&&i.top()===a.top()},i})();e.SemanticQuery=i;var n=(function(){function i(e,t){this.fromValue=e,this.whereItems=t}return i.fromSQExpr=function(t){return i.fromSQFromAndSQExpr(new e.SQFrom,t)},i.fromSQFromAndSQExpr=function(e,t){var a=o.rewrite(t,e,e),r=[{condition:a}];return new i(e,r)},i.fromSQFromAndSQFilters=function(e,t){return new i(e,t)},i.getDefaultValueFilter=function(t){return i.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.defaultValue())},i.getAnyValueFilter=function(t){return i.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.anyValue())},i.getDataViewScopeIdentityComparisonFilters=function(t,a){if(t instanceof Array){var r=Array.apply(null,Array(t.length)).map((function(){return a}));return i.fromSQExpr(e.SQExprUtils.getDataViewScopeIdentityComparisonExpr(t,r))}return i.fromSQExpr(e.SQExprBuilder.equal(t,a))},i.prototype.from=function(){return this.fromValue.clone()},i.prototype.conditions=function(){for(var e=[],t=this.whereItems,i=0,a=t.length;i<a;i++){var r=t[i];e.push(r.condition)}return e},i.prototype.where=function(){for(var e=[],t=this.whereItems,i=0,a=t.length;i<a;i++)e.push(t[i]);return e},i.prototype.rewrite=function(t){var a=new e.SemanticQueryRewriter(t),r=a.rewriteFrom(this.fromValue),n=a.rewriteWhere(this.whereItems,r);return new i(r,n)},i.prototype.validate=function(t,i,a){var r=new e.SQExprValidationVisitor(t,i,a);return this.rewrite(r),r.errors},i.merge=function(e){if(_.isEmpty(e))return null;if(1===e.length)return e[0];for(var a=e[0],r=a.from(),n=t.take(a.whereItems,a.whereItems.length),o=1,s=e.length;o<s;o++)i.applyFilter(e[o],r,n);return new i(r,n)},i.isDefaultFilter=function(t){return!(!t||1!==t.where().length)&&e.SQExprUtils.isDefaultValue(t.where()[0].condition)},i.isAnyFilter=function(t){return!(!t||1!==t.where().length)&&e.SQExprUtils.isAnyValue(t.where()[0].condition)},i.isSameFilter=function(e,t){return!!a.JsonComparer.equals(e,t)&&!(i.isDefaultFilter(e)&&i.isAnyFilter(t)||i.isAnyFilter(e)&&i.isDefaultFilter(t))},i.applyFilter=function(e,t,i){for(var a=e.whereItems,r=0;r<a.length;r++){var n=a[r],s={condition:o.rewrite(n.condition,e.fromValue,t)};n.target&&(s.target=_.map(n.target,(function(i){return o.rewrite(i,e.fromValue,t)}))),i.push(s)}},i})();e.SemanticFilter=n;var o=(function(t){function a(e,i){t.call(this),this.sourceFrom=e,this.destinationFrom=i}return r(a,t),a.prototype.visitEntity=function(t){var i=this.destinationFrom.source(t.variable);if(i&&e.isSQFromEntitySource(i)&&i.schema===t.schema&&i.entity===t.entity)return t;var a=this.destinationFrom.ensureSource(new e.SQFromEntitySource(t.schema,t.entity),t.variable);return a.name!==t.variable?new e.SQEntityExpr(t.schema,t.entity,a.name):t},a.prototype.visitSubqueryRef=function(t){if(!this.sourceFrom)return t;var a=this.sourceFrom.source(t.variable),r=this.destinationFrom.source(t.variable);if(r&&e.isSQFromSubquerySource(r)&&i.equals(a.subquery,r.subquery))return t;var n=this.destinationFrom.ensureSource(new e.SQFromSubquerySource(a.subquery),t.variable);return n.name!==t.variable?new e.SQSubqueryRefExpr(n.name):t},a.rewrite=function(e,t,i){var r=new a(t,i);return e.accept(r)},a})(e.SQExprRewriter);e.SQExprRewriterWithSourceRenames=o;var s=(function(e){function t(t){e.call(this),this.keys=t}return r(t,e),t.prototype.visitEntity=function(e){this.removeKey(e.variable)},t.prototype.visitSubqueryRef=function(e){this.removeKey(e.variable)},t.prototype.removeKey=function(e){var t=this.keys.indexOf(e);t>=0&&this.keys.splice(t,1)},t.prototype.result=function(){return this.keys},t})(e.DefaultSQExprVisitorWithTraversal),l=(function(){function t(e,t,i){this.renameSources=e,this.from=t,this.usedSourceNames=i}return t.renameSources=function(i,a,r){var n=new t(i,a,r);return e.SemanticQueryRewriter.rewriteFrom(a,n)},t.prototype.visitEntity=function(e,t){return e},t.prototype.visitSubquery=function(t,i){var a=t.subquery,r=this.renameSources(a,this.usedSourceNames);return r===a?t:new e.SQFromSubquerySource(r)},t})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t,i=a.ArrayExtensions;!(function(t){function a(t,i){return t||(t=null),i||(i=null),t===i||!!t==!!i&&(!!r(t,i)&&e.SQExpr.equals(t.condition,i.condition))}function r(t,a){return i.sequenceEqual(t.target,a.target,e.SQExpr.equals)}function n(e,t){return!_.isEmpty(e)&&_.any(e,(function(e){return a(e,t)}))}t.equals=a,t.targetsEqual=r,t.contains=n})(t=e.SQFilter||(e.SQFilter={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t,i=a.ArrayExtensions;!(function(t){function a(t,i){return!t&&!i||!(!t||!i)&&(t.direction===i.direction&&e.SQExpr.equals(t.expr,i.expr))}function r(t,i){return!t&&!i||!(!t||!i)&&e.SQExpr.equals(t.expr,i.expr)}function n(e,t){return!e&&!t||!(!e||!t)&&(e.role===t.role&&r(e.expression,t.expression))}function o(e,t){return!e&&!t||!(!e||!t)&&i.sequenceEqual(e.columns,t.columns,(function(e,t){return n(e,t)}))}function s(e,t){return!e&&!t||!(!e||!t)&&(i.sequenceEqual(e.parameters,t.parameters,(function(e,t){return r(e,t)}))&&o(e.table,t.table))}function l(e,t){return!e&&!t||!(!e||!t)&&o(e.table,t.table)}function u(e,t){return!e&&!t||!(!e||!t)&&(e.algorithm===t.algorithm&&s(e.input,t.input)&&l(e.output,t.output))}t.sqSortDefinitionEquals=a,t.namedSQExprEquals=r,t.sqTransformTableColumnsEquals=n,t.sqTransformTableEquals=o,t.sqTransformInputEquals=s,t.sqTransformOutputEquals=l,t.sqTransformEquals=u})(t=e.SQUtils||(e.SQUtils={}))})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,i,a,r){return new u(e||t.createColorAllocatorCache(),r,i||{metadata:{columns:[]}},a)}function a(e,t,i,a){var r=i.rows;if(!(_.isEmpty(r)||r.length<=a)){var o=i.columns,s=n(e,t);if(!(s<0))for(var l=0,u=o.length;l<u;l++)if(s===o[l].index)return r[a][l]}}function r(e,t,i){var a=n(e.arg,t);if(!(a<0))for(var r=0,s=i.length;r<s;r++){var l=i[r],u=l.aggregates;if(a===l.index&&u){var c=o(u,e);if(void 0!==c)return c}}}function n(e,t){var i;l.isSelectRef(e)&&(i=e.expressionName);for(var a=0,r=t.length;a<r;a++){var n=t[a];if(n&&(!i||n.queryName))if(i){if(n.queryName===i)return a}else if(l.equals(n.expr,e))return a}return-1}function o(e,t){if(l.isPercentile(t)){var i=_.find(e.percentiles,(function(e){if(e.k===t.k){var i=!!e.exclusive;return t.exclusive===i}}));if(i)return i.value}else if(l.isAggregation(t))switch(t.func){case 3:return s(e.min,e.minLocal);case 4:return s(e.max,e.maxLocal);case 6:return e.median;case 1:return e.average}}function s(e,t){return void 0!==e?e:t}var l=e.data.SQExpr;t.createStaticEvalContext=i;var u=(function(){function e(e,t,i,a){this.colorAllocatorCache=e,this.dataView=i,this.selectTransforms=a,this.themeColors=t}return e.prototype.getColorAllocator=function(e){return this.colorAllocatorCache.get(e)},e.prototype.getThemeColor=function(e){var t=this.themeColors;if(t)return t.get(e)},e.prototype.getExprValue=function(e){var t=this.dataView,i=this.selectTransforms;if(t&&i){if(l.isAggregation(e)||l.isPercentile(e)){var n=r(e,i,t.metadata.columns);if(void 0!==n)return n}return t.table?a(e,i,t.table,0):void 0}},e.prototype.getRoleValue=function(e){},e})();t.getExprValueFromTable=a,t.findSelectIndex=n})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,t){return new r(e,t)}var a=e.data.SQExpr;t.createMatrixEvalContext=i;var r=(function(){function e(e,t){this.colorAllocatorProvider=e,this.dataView=t}return e.prototype.getColorAllocator=function(e){return this.colorAllocatorProvider.get(e)},e.prototype.getExprValue=function(e){if(a.isSelectRef(e))return this.valueNode?this.evaluateValue(e):this.rowNode?this.evaluateRowHeader(e):this.columnNode?this.evaluateColumnHeader(e):void 0},e.prototype.evaluateValue=function(e){var t=this.dataView.valueSources[this.valueNode.valueSourceIndex||0].queryName,i=e.expressionName;
if(i===t)return this.valueNode.value},e.prototype.evaluateRowHeader=function(e){},e.prototype.evaluateColumnHeader=function(e){},e.prototype.getRoleValue=function(e){},e.prototype.setCurrentContext=function(e,t,i){this.valueNode=e,this.columnNode=i,this.rowNode=t},e})()})(t=e.data||(e.data={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t,r=a.StringExtensions,n=a.Formatting,o=a.RegExpExtensions;!(function(e){function t(e){return n.lastIndex=0,e.replace(n,"")}function i(e,t){for(n.lastIndex=0;;){var i=n.exec(e);if(!i)break;var a=i[0],r=n.lastIndex-a.length,o=String.fromCharCode(57600+t.length);t.push(a),e=e.substr(0,r)+o+e.substr(n.lastIndex),n.lastIndex=r+1}return e}function a(e,t,i){void 0===i&&(i=!0);for(var a=t.length,r=0;r<a;r++){var n=String.fromCharCode(57600+r),o=t[r];if(!i){var s=o[0];o="\\"===s||1===o.length||o[o.length-1]!==s?o.substring(1):o.substring(1,o.length-1)}e=e.replace(n,o)}return e}var r=["'[^']*'",'"[^"]*"',"\\\\.","'[^']*$",'"[^"]*$',"\\\\$"],n=new RegExp(r.join("|"),"g");e.removeLiterals=t,e.preserveLiterals=i,e.restoreLiterals=a})(t||(t={}));var s,l=/({{)|(}})|{(\d+[^}]*)}/g,u="0",c="#",d="E",p=[u,c],h=new RegExp(p.join("|"),"g"),g=(function(){function e(){}return e.prototype.formatValue=function(e,t,i){if(void 0===e||null===e)return"";var a=this.getCulture(i);return s.canFormat(e)?s.format(e,t,a):f.canFormat(e)?f.format(e,t,a):e.toString()},e.prototype.format=function(e,t,i){var a=this;if(!e)return"";var r=e.replace(l,(function(e,r,n,o){if(r)return"{";if(n)return"}";var s=o.split(":"),l=parseInt(s[0],10),u=s[1];return a.formatValue(t[l],u,i)}));return r},e.prototype.isStandardNumberFormat=function(e){return f.isStandardFormat(e)},e.prototype.formatNumberWithCustomOverride=function(e,t,i,a){var r=this.getCulture(a);return f.formatWithCustomOverride(e,t,i,r)},e.prototype.dateFormatString=function(e){return this._dateTimeScaleFormatInfo||this.initialize(),this._dateTimeScaleFormatInfo.getFormatString(e)},e.prototype.setCurrentCulture=function(e){this._currentCultureSelector!==e&&(this._currentCulture=this.getCulture(e),this._currentCultureSelector=e,this._dateTimeScaleFormatInfo=new m(this._currentCulture))},e.prototype.getCulture=function(e){if(null==e)return null==this._currentCulture&&this.initialize(),this._currentCulture;var t=Globalize.findClosestCulture(e);return t||(t=Globalize.culture("en-US")),t},e.prototype.parseFloat=function(e){return Globalize.parseFloat(e,this.getCulture())},e.prototype.initialize=function(){var e=this.getCurrentCulture();this.setCurrentCulture(e);var t=this.getUrlParam("calendar");if(t){var i=this._currentCulture,a=i.calendars[t];a&&(i.calendar=a)}},e.prototype.getCurrentCulture=function(){var e=this.getUrlParam("language");return e?e:i&&i.common&&i.common.cultureInfo?i.common.cultureInfo:window.navigator.userLanguage||window.navigator.language||Globalize.culture().name},e.prototype.getUrlParam=function(e){var t=window.location.search.match(RegExp("[?&]"+e+"=([^&]*)"));return t?t[1]:void 0},e})();!(function(e){function i(e){var t=e instanceof Date;return t}function a(e,t,i){t=t||"G";var a=1===t.length;try{return a?o(e,t,i):s(e,t,i)}catch(t){return o(e,"G",i)}}function o(e,t,i){var a=i.calendar.patterns;c(i.calendar);var r=n.findDateFormat(e,t,i.name);return t=1===r.format.length?a[r.format]:r.format,i=Globalize.culture("en-US"),Globalize.format(r.value,t,i)}function s(e,i,a){var n,o=[];if(i=t.preserveLiterals(i,o),i.indexOf("F")>-1){i=r.replaceAll(i,"FFFF","FFF");var s=e.getMilliseconds();if(s%10>=1&&(i=r.replaceAll(i,"FFF","fff")),i=r.replaceAll(i,"FFF","FF"),s%100/10>=1&&(i=r.replaceAll(i,"FF","ff")),i=r.replaceAll(i,"FF","F"),s%1e3/100>=1&&(i=r.replaceAll(i,"F","f")),i=r.replaceAll(i,"F",""),""===i||"%"===i)return""}return i=l(i),n=Globalize.format(e,i,a),n=u(n,a.calendar),n=t.restoreLiterals(n,o,!1)}function l(e){return e===d?p:(d=e,e=n.fixDateTimeFormat(e),p=e,e)}function u(e,t){var i=t[":"];if(":"===i)return e;for(var a="",r=e.length,n=0;n<r;n++){var o=e.charAt(n);switch(o){case":":a+=i;break;default:a+=o}}return a}function c(e){var t=e.patterns;void 0===t.g&&(t.g=t.f.replace(t.D,t.d),t.G=t.F.replace(t.D,t.d))}var d,p;e.canFormat=i,e.format=a})(s||(s={}));var f;!(function(i){function a(e,t){if(!t||void 0===e)return e;var i="{0:"+t+"}";return e.replace("{0}",i)}function n(e,t){if(null==t)return t;if(g(t)){var a=i.getComponents(t),r=a.positive,n=a.negative,o=a.zero;return e>0?s(e,r):0===e?s(e,o):s(e,n)}return s(e,t)}function s(e,t){var i=o.run(k,t);return i?i[0]:t}function l(e,t,a){if(null==t)return e;if(null==e&&(e=u),g(e)){for(var r=i.getComponents(e),n=r.positive,o=r.negative,s=r.zero,l=[n,o,s],c=0;c<l.length;c++)l[c]=p(l[c],t,a);return l.join(i.NumberFormatComponentsDelimeter)}return p(e,t,a)}function p(e,i,a){if(i=Math.abs(i),i>=0){var n=[];e=t.preserveLiterals(e,n);var s=a?u:c,l=r.repeat(s,Math.abs(i)),d=o.run(G,e);if(d){var p=e.substr(0,d.index),h=e.substr(d.index+1,d[1].length),g=e.substr(d.index+d[0].length);if(a)h=l;else{var f=l.length-h.length;f>0?h+=l.slice(-f):f<0&&(h=h.slice(0,f))}h.length>0&&(h=U+h),e=p+h+g}else l.length>0&&(e=e.replace(z,"$1"+U+l));0!==n.length&&(e=t.restoreLiterals(e,n))}return e}function g(e){return t.removeLiterals(e).indexOf(i.NumberFormatComponentsDelimeter)!==-1}function f(e){var a={hasNegative:!1,positive:e,negative:e,zero:e},r=[];e=t.preserveLiterals(e,r);var n=e.split(i.NumberFormatComponentsDelimeter),o=n.length;return o>1&&(0!==r.length&&(n=_.map(n,(function(e){return t.restoreLiterals(e,r)}))),a.hasNegative=!0,a.positive=a.zero=n[0],a.negative=n[1],o>2&&(a.zero=n[2])),a}function m(e){var t="number"==typeof e;return t}function y(e){return j.test(e)}function v(e){if(e&&!y(e)){var t=D(e);if(!t.hasDots)return l(e,2,!0)}return e}function w(e,t,i){t=t||"G";try{return y(t)?C(e,t,i):S(e,t,i)}catch(t){return Globalize.format(e,void 0,i)}}function b(e,t,i,a){return S(e,t,a,i)}function C(e,t,i){var a,n=t.length>1?parseInt(t.substr(1,t.length-1),10):void 0,o=i.numberFormat,s=t.charAt(0);switch(s){case"e":case"E":void 0===n&&(n=6);var l=r.repeat("0",n);t="0."+l+s+"+000",a=S(e,t,i);break;case"f":case"F":a=void 0!==n?e.toFixed(n):e.toFixed(o.decimals),a=R(a,o);break;case"g":case"G":var u=Math.abs(e);if(0===u||1e-4<=u&&u<1e15)a=void 0!==n?e.toPrecision(n):e.toString();else{if("number"!=typeof e)return String(e);a=void 0!==n?e.toExponential(n):e.toExponential(),a=a.replace("e","E")}a=R(a,o);break;case"r":case"R":a=e.toString(),a=R(a,o);break;case"x":case"X":if(a=e.toString(16),"X"===s&&(a=a.toUpperCase()),void 0!==n){var c=a.length,d=e<0;d&&c--;var p=n-c,h=void 0;p>0&&(h=r.repeat("0",p)),a=d?"-"+h+a.substr(1):h+a}a=R(a,o);break;default:a=Globalize.format(e,t,i)}return a}function S(r,n,s,l){var u,c=s.numberFormat;if(!isFinite(r))return Globalize.format(r,void 0);var d=f(n);n=r>0?d.positive:0===r?d.zero:d.negative,d.hasNegative&&(r=Math.abs(r));var p=D(n,!0),h=[];if(p.hasLiterals&&(n=t.preserveLiterals(n,h)),p.hasE&&!l){var g=o.run(F,n);if(g){var m=n.substr(0,g.index),y=n.substr(g.index+2),v=T(m,p),w=N(m,p);if(1!==w&&(r*=w),"number"!=typeof r)return String(r);var b=r.toExponential(v),C=b.indexOf("e"),S=b.substr(0,C),_=b.substr(C+1),L=I(S,m,c),M=I(_,y,c);"+"===M.charAt(0)&&"+"!==g[0].charAt(1)&&(M=M.substr(1));var A=g[0].charAt(0);u=L+A+M}}if(void 0===u){var O=void 0,R=!1,v=T(n,p),w=N(n,p);if(1!==w&&(r*=w),r=parseFloat(P(r,v)),!isFinite(r))return Globalize.format(r,void 0);if(l){var E=i.getNumericFormat(r,n);l=a(l,E),O=e.formattingService.format(l,[r],s.name),R=!0}else O=P(r,v),O=x(r,O,v,V(n,p));u=I(O,n,c,l,R)}return p.hasLiterals&&(u=t.restoreLiterals(u,h,!1)),B=p,u}function x(e,t,i,a){if(0===a)return t;var r=t.indexOf(".");if(r===-1)return t;for(var n=r+1,o=n+(i-a),s=o;s<t.length;++s){var l=t[s];if("0"===l||"9"===l){var u=P(e,s-n);if(parseFloat(u)===e)return u}}return t}function P(t,i){var a="",n=0;i>16&&(n=i-16,i=16);var o=e.Double.log10(Math.abs(t));if(o<16){if(o>0){var s=16-o;i>s&&(n+=i-s,i=s)}a=t.toFixed(i)}else if(16===o)a=t.toFixed(0),n+=i,n>0&&(a+=".");else{if("number"!=typeof t)return String(t);a=t.toExponential(15);var l=a.indexOf("e");if(l>0){var u=a.indexOf("."),c=a.substr(0,l),d=a.substr(l+1),p=parseInt(d,10)-(c.length-u-1);a=c.replace(".","")+r.repeat("0",p),i>0&&(a=a+"."+r.repeat("0",i))}}return n>0&&(a+=r.repeat("0",n)),a}function D(e,i,a,r){if(void 0!==B&&e===B.format)return B;for(var n=[],o=t.preserveLiterals(e,n),s={format:e,hasLiterals:0!==n.length,hasE:!1,hasCommas:!1,hasDots:!1,hasPercent:!1,hasPermile:!1,precision:void 0,optionalPrecision:void 0,scale:void 0,partsPerScale:void 0},l=0,u=o.length;l<u;l++){var c=o.charAt(l);switch(c){case"e":case"E":s.hasE=!0;break;case",":s.hasCommas=!0;break;case".":s.hasDots=!0;break;case"%":s.hasPercent=!0;break;case"":s.hasPermile=!0}}var d=f(e);return i&&(s.precision=T(d.positive,s)),r&&(s.partsPerScale=M(d.positive,s)),a&&(s.scale=N(d.positive,s)),s}function T(e,t){return L(e,t),t.precision}function V(e,t){return L(e,t),t.optionalPrecision}function L(e,i){if(!(i.precision>-1)){var a=0,r=0;if(i.hasDots){i.hasLiterals&&(e=t.removeLiterals(e));var n=e.indexOf(".");if(n>-1){for(var o=e.length,s=n;s<o;s++){var l=e.charAt(s);if(l.match(h)&&++a,l===c?++r:r=0,l===d)break}if(a>19){var u=a-19;r=Math.max(0,r-u),a=19}}}i.precision=a,i.optionalPrecision=r}}function M(e,t){if(null!=t.partsPerScale)return t.partsPerScale;var i=1;return t.hasPercent&&e.indexOf("%")>-1&&(i=100*i),t.hasPermile&&e.indexOf("")>-1&&(i=1e3*i),t.partsPerScale=i,i}function N(e,t){if(t.scale>-1)return t.scale;var i=M(e,t);if(t.hasCommas){var a=e.indexOf(".");a===-1&&(a=e.length);for(var r=a-1;r>-1;r--){var n=e.charAt(r);if(","!==n)break;i/=1e3}}return t.scale=i,i}function I(e,t,i,a,r){var n=!!a,o=t.split(".",2);if(2===o.length){var s=o[0],l=o[1],u="";a&&(u=a.replace(E,""),e=e.replace(u,""));var c=i["."],d=r?c:".",p=e.split(d,2),h=1===p.length?p[0]+u:p[0],g=2===p.length?p[1]+u:"";g=g.replace(H,"");var f=A(h,s,i,n),m=O(g,l,n);return m.fmtOnly||""===m.value?f+m.value:f+c+m.value}return A(e,t,i,n)}function A(e,t,i,a){var r=t.indexOf(","),n=r>-1&&r<Math.max(t.lastIndexOf("0"),t.lastIndexOf("#"))&&i[","],o=0,s=0,l=i.groupSizes||[3],d=l[0],p=i[","],h="",g=e.charAt(0);"+"!==g&&"-"!==g||(h=i[g],e=e.substr(1));for(var f="0"===e,m="",y="",v=e.length-1,w=!0,b=t.length-1;b>-1;b--){var C=t.charAt(b);switch(C){case u:case c:w=!1,""!==y&&(m=y+m,y=""),a||((v>-1||C===u)&&n&&(o===d?(m=p+m,s++,s<l.length&&(d=l[s]),o=1):o++),v>-1?(f&&C===c||(m=e.charAt(v)+m),v--):C!==c&&(m=C+m));break;case",":break;default:y=C+y}}if(!a){if(v>-1&&""!==m)if(n)for(;v>-1;)o===d?(m=p+m,s++,s<l.length&&(d=l[s]),o=1):o++,m=e.charAt(v)+m,v--;else m=e.substr(0,v+1)+m;return h+y+m}return w?h+y+m:h+y+e+m}function O(e,t,i){var a=0,r=t.length,n=e.length;if(i){var o=t.charAt(r-1);return o.match(h)?{value:e,fmtOnly:""===e}:{value:e+o,fmtOnly:""===e}}for(var s="",l=!0,d=0;d<r;d++){var p=t.charAt(d);if(a<n)switch(p){case u:case c:s+=e[a++],l=!1;break;default:s+=p}else p!==c&&(s+=p,l=l&&p!==u)}return{value:s,fmtOnly:l}}function R(e,t){var i=t["+"],a=t["-"],r=t["."],n=t[","];if("+"===i&&"-"===a&&"."===r&&","===n)return e;for(var o=e.length,s="",l=0;l<o;l++){var u=e.charAt(l);switch(u){case"+":s+=i;break;case"-":s+=a;break;case".":s+=r;break;case",":s+=n;break;default:s+=u}}return s}var E=/\{.+\}/,F=/e[+-]*[0#]+/i,j=/^[a-z]\d{0,2}$/i,H=/0+$/,G=/\.([0#]*)/g,k=/[0#,\.]+[0,#]*/g,z=/([0#])(?=[^0#]*$)/,U=".";i.NumberFormatComponentsDelimeter=";",i.getNumericFormat=n,i.addDecimalsToFormat=l,i.hasFormatComponents=g,i.getComponents=f;var B;i.canFormat=m,i.isStandardFormat=y,i.getFormatForWholeNumberAverage=v,i.format=w,i.formatWithCustomOverride=b,i.getCustomFormatMetadata=D})(f=e.NumberFormat||(e.NumberFormat={}));var m=(function(){function t(e){var t=e.calendar,i=t.patterns,a=t.months.namesAbbr,r=a&&a[0],n=i.Y,o=i.M,s=i.f,l=i.T,u=i.t,c=s.indexOf(",")>-1?", ":" ",d=0===n.indexOf("yyyy'")&&n.length>6&&"'"===n[6];this.YearPattern=d?n.substr(0,7):"yyyy";var p=s.indexOf("yy"),h=s.indexOf("MMMM");this.MonthPattern=r&&h>-1?p>h?"MMM yyyy":"yyyy MMM":n,this.DayPattern=r?o.replace("MMMM","MMM"):o;var g=s.indexOf("mm"),f=s.indexOf("tt"),m=f>-1?u.replace(":mm ",""):u;switch(this.HourPattern=p<g?this.DayPattern+c+m:m+c+this.DayPattern,this.MinutePattern=u,this.SecondPattern=l,this.MillisecondPattern=l.replace("ss","ss.fff"),e.name){case"fi-FI":this.DayPattern=this.DayPattern.replace("'ta'",""),this.HourPattern=this.HourPattern.replace("'ta'","")}}return t.prototype.getFormatString=function(t){switch(t){case e.DateTimeUnit.Year:return this.YearPattern;case e.DateTimeUnit.Month:return this.MonthPattern;case e.DateTimeUnit.Week:case e.DateTimeUnit.Day:return this.DayPattern;case e.DateTimeUnit.Hour:return this.HourPattern;case e.DateTimeUnit.Minute:return this.MinutePattern;case e.DateTimeUnit.Second:return this.SecondPattern;case e.DateTimeUnit.Millisecond:return this.MillisecondPattern}},t})();e.formattingService=new g})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){var i=e.data.Selector,a=(function(){function t(e,t,a){this.selector=e,this.highlight=t,this.key=JSON.stringify({selector:e?i.getKey(e):null,highlight:t}),this.keyWithoutHighlight=JSON.stringify({selector:e?i.getKey(e):null}),this.selectorsByColumn=a}return t.prototype.equals=function(e){return this.selector&&e.selector?this.highlight===e.highlight&&i.equals(this.selector,e.selector):!this.selector==!e.selector&&this.highlight===e.highlight},t.isEqual=function(e,t){return e===t||null!=e&&null!=t&&e.equals(t)},t.prototype.includes=function(t,i){void 0===i&&(i=!1);var a=this.selector,r=t.selector;if(!a||!r)return!1;var n=a.data,o=r.data;if(!n&&a.metadata&&a.metadata!==r.metadata)return!1;if(!i&&this.highlight!==t.highlight)return!1;if(n){if(!o)return!1;if(n.length>0)for(var s=0,l=n.length;s<l;s++){var u=n[s];if(!o.some((function(t){return e.DataViewScopeIdentity.equals(u,t)})))return!1}}return!0},t.prototype.getKey=function(){return this.key},t.prototype.getKeyWithoutHighlight=function(){return this.keyWithoutHighlight},t.prototype.hasIdentity=function(){return this.selector&&!!this.selector.data},t.prototype.getSelector=function(){return this.selector},t.prototype.getSelectorsByColumn=function(){return this.selectorsByColumn},t.createNull=function(e){return void 0===e&&(e=!1),new t(null,e)},t.createWithId=function(e,i){void 0===i&&(i=!1);var a=null;return e&&(a={data:[e]}),new t(a,i)},t.createWithMeasure=function(e,i){void 0===i&&(i=!1);var a={metadata:e},r=new t(a,i);return r.selectorsByColumn={metadata:e},r},t.createWithIdAndMeasure=function(e,i,a){void 0===a&&(a=!1);var r={};e&&(r.data=[e]),i&&(r.metadata=i),e||i||(r=null);var n=new t(r,a);return n},t.createWithIdAndMeasureAndCategory=function(e,t,i,a){void 0===a&&(a=!1);var r=this.createWithIdAndMeasure(e,t,a);return r.selector&&(r.selectorsByColumn={},e&&i&&(r.selectorsByColumn.dataMap={},r.selectorsByColumn.dataMap[i]=[e]),t&&(r.selectorsByColumn.metadata=t)),r},t.createWithIds=function(e,i,a){void 0===a&&(a=!1);var r=null,n=t.idArray(e,i);return n&&(r={data:n}),new t(r,a)},t.createWithIdsAndMeasure=function(e,i,a,r){void 0===r&&(r=!1);var n={},o=t.idArray(e,i);return o&&(n.data=o),a&&(n.metadata=a),e||i||a||(n=null),new t(n,r)},t.createWithSelectorForColumnAndMeasure=function(e,a,r){void 0===r&&(r=!1);var n={};_.isEmpty(e)||(n.dataMap=e),a&&(n.metadata=a),e||a||(n=null);var o=i.convertSelectorsByColumnToSelector(n);return new t(o,r,n)},t.createWithHighlight=function(e){var i=new t(e.getSelector(),(!0));return i.selectorsByColumn=e.selectorsByColumn,i},t.idArray=function(e,t){if(e||t){var i=[];return e&&i.push(e),t&&t!==e&&i.push(t),i}},t})();t.SelectionId=a;var r=(function(){function e(){}return e.builder=function(){return new e},e.prototype.withColumnIdentity=function(e,t){return this.addItemToDataMap(t,e),this},e.prototype.withCategoryIdentity=function(e,t){return e&&e.source&&e.source.queryName&&this.addItemToDataMap(e.source.queryName,t),this},e.prototype.withCategory=function(e,t){return e&&e.source&&e.source.queryName&&e.identity&&this.addItemToDataMap(e.source.queryName,e.identity[t]),this},e.prototype.withSeries=function(e,t){return e&&e.source&&e.source.queryName&&t&&this.addItemToDataMap(e.source.queryName,t.identity),this},e.prototype.withMeasure=function(e){return this.measure=e,this},e.prototype.createSelectionId=function(){return a.createWithSelectorForColumnAndMeasure(this.dataMap,this.measure)},e.prototype.addItemToDataMap=function(e,t){if(t){this.dataMap||(this.dataMap={});var i=this.dataMap,a=i[e];return null==a?void(i[e]=[t]):void a.push(t)}},e})();t.SelectionIdBuilder=r})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,i=(window.jsCommon,window.powerbi);window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(e,t){if(e){_.isEmpty(t)&&(t=e.defaultPresetName);var i=e.presets[t];return i||(i=e.presets[e.defaultPresetName]),i}}function a(t){var i=[];if(t){var a=t.presets;if(a)for(var r in a){var n=a[r];i.push({value:n.name,displayName:n.displayName})}}return e.createEnumType(i)}t.getStylePreset=i,t.getStylePresetsEnum=a})(t=e.VisualStylePresetHelpers||(e.VisualStylePresetHelpers={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(e){var t=a.ArrayExtensions,i=(function(){function e(e,t){this.basePickerColors=[{value:"#FFFFFF"},{value:"#000000"},{value:"#00B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C811"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"}],this.colors=e||n.getDefaultTheme(),this.sentimentColors=t||n.defaultSentimentColors,this.scales={}}return e.prototype.getColorScaleByKey=function(e){var t=this.scales[e];return void 0===t&&(t=this.createScale(),this.scales[e]=t),t},e.prototype.getNewColorScale=function(){return this.createScale()},e.prototype.getColorByIndex=function(e){return this.colors[e]},e.prototype.getSentimentColors=function(){return this.sentimentColors},e.prototype.getBasePickerColors=function(){return this.basePickerColors},e.prototype.getAllColors=function(){return this.colors},e.prototype.createScale=function(){return r.createFromColors(this.colors)},e})();e.DataColorPalette=i;var r=(function(){function e(e){this.scale=e}return e.prototype.getColor=function(e){return this.scale(e)},e.prototype.clearAndRotateScale=function(){var e=this.scale.domain().length,i=t.rotate(this.scale.range(),e);this.scale=d3.scale.ordinal().range(i)},e.prototype.clone=function(){return new e(this.scale.copy())},e.prototype.getDomain=function(){return this.scale.domain()},e.createFromColors=function(t){return new e(d3.scale.ordinal().range(t))},e})();e.D3ColorScale=r;var n=(function(){function e(){}return e.getDefaultTheme=function(){if(!e.defaultTheme){e.defaultTheme=[];for(var t=e.defaultBaseColors,i=0;i<e.colorSectorCount;++i)for(var r=0,n=t.length;r<n;++r)e.defaultTheme.push({value:a.Color.rotate(t[r].value,i/e.colorSectorCount)})}return e.defaultTheme},e.colorSectorCount=12,e.defaultBaseColors=[{value:"#01B8AA"},{value:"#374649"},{value:"#FD625E"},{value:"#F2C80F"},{value:"#5F6B6D"},{value:"#8AD4EB"},{value:"#FE9666"},{value:"#A66999"},{value:"#3599B8"},{value:"#DFBFBF"},{value:"#4AC5BB"},{value:"#5F6B6D"},{value:"#FB8281"},{value:"#F4D25A"},{value:"#7F898A"},{value:"#A4DDEE"},{value:"#FDAB89"},{value:"#B687AC"},{value:"#28738A"},{value:"#A78F8F"},{value:"#168980"},{value:"#293537"},{value:"#BB4A4A"},{value:"#B59525"},{value:"#475052"},{value:"#6A9FB0"},{value:"#BD7150"},{value:"#7B4F71"},{value:"#1B4D5C"},{value:"#706060"},{value:"#0F5C55"},{value:"#1C2325"},{value:"#7D3231"},{value:"#796419"},{value:"#303637"},{value:"#476A75"},{value:"#7E4B36"},{value:"#52354C"},{value:"#0D262E"},{value:"#544848"}],e.defaultSentimentColors=[{value:"#C0433A"},{value:"#E8D62E"},{value:"#79C75B"}],e})();e.ThemeManager=n})(t=e.visuals||(e.visuals={}))})(i||(i={}))},function(e,t){var i,a=window.jsCommon,i=window.powerbi;window.powerbitests,window.InJs,window.debug,window.jasmine,window.Microsoft;!(function(e){var t;!(function(t){function i(){return new s}function r(t){return t.strategy===e.NullStrategy.asZero}function n(t){switch(t.strategy){case e.NullStrategy.noColor:return;case e.NullStrategy.specificColor:return t.color;case e.NullStrategy.asZero:}}var o=a.Color;t.createColorAllocatorFactory=i;var s=(function(){function e(){}return e.prototype.linearGradient2=function(e){return new l(e)},e.prototype.linearGradient3=function(e,t){return t?new c(e):new u(e)},e})(),l=(function(){function e(e){this.options=e;var t=e.min,i=e.max;this.scale=o.createLinearColorScale([t.value,i.value],[t.color,i.color],!0)}return e.prototype.color=function(e){var t=this.options.nullColoringStrategy;if(null===e&&t){if(!r(t))return n(t);e=0}var i=this.options.min,a=this.options.max;return i.value===a.value?e>=a.value?a.color:i.color:this.scale(e)},e})(),u=(function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale=o.createLinearColorScale([t.value,i.value,a.value],[t.color,i.color,a.color],!0)}return e.prototype.color=function(e){var t=this.options.nullColoringStrategy;if(null===e&&t){if(!r(t))return n(t);e=0}var i=this.options.min,a=this.options.mid,o=this.options.max;return o.value===a.value||a.value===i.value||o.value===a.value&&o.value===i.value?e>=o.value?o.color:e>=a.value?a.color:i.color:this.scale(e)},e})(),c=(function(){function e(e){this.options=e;var t=e.min,i=e.mid,a=e.max;this.scale1=o.createLinearColorScale([t.value,i.value],[t.color,i.color],!0),this.scale2=o.createLinearColorScale([i.value,a.value],[i.color,a.color],!0)}return e.prototype.color=function(e){var t=this.options.nullColoringStrategy;if(null===e&&t){if(!r(t))return n(t);e=0}var i=this.options.min,a=this.options.mid,o=this.options.max;return o.value===a.value||a.value===i.value||o.value===a.value&&o.value===i.value?e>=o.value?o.color:e>=a.value?a.color:i.color:e<=a.value?this.scale1(e):this.scale2(e)},e})()})(t=e.visuals||(e.visuals={}))})(i||(i={}))}]);;"undefined"==typeof window.DEBUG&&(window.DEBUG=!0);var powerbi;!(function(e){var t=(function(){function t(r,o,i){var n=this;if(n.localyticsAppKey=r,i?(n.batchSize=i.batchSize,n.batchTimer=i.batchTimer):(n.batchSize=t.defaultBatchSize,n.batchTimer=new e.DefaultTimer),n.currentBatchCount=n.batchSize,o)n.localyticSDKinstance=o;else try{var a=window.LocalyticsGlobal;null==a&&(a="localytics"),n.localyticSDKinstance=window[a]}catch(e){}}return t.prototype.initialize=function(r){var o=this;this.hostData=r;var i;i="Embed"==r.sessionSource?r.embedUserId:"11111111-1111-1111-1111-11"+e.getHashCode(r.userId);var n=[];r.isInternalUser?n.push("MSFT"):n.push("External"),n.push(r.sessionSource);var a={sessionTimeout:1800,trackPageView:!1,customDimensions:n,installId:i,customerId:i,cacheOffline:!0,autoUpload:!1};this.localyticSDKinstance.enqueueCommand(t.initName,this.localyticsAppKey,a),this.batchTimeoutId=this.batchTimer.setTimeout((function(){o.uploadBatch()}),t.batchTimeoutMS,null)},t.prototype.getType=function(){return e.LoggerServiceType.Localytics},t.prototype.logEvent=function(r){var o=this,i=this.hostData,n=$.extend({},r.getFormattedInfoObject(),{client:i.client,version:i.build,cluster:i.cluster,activityId:r.id,hashedUuid:"Embed"==i.sessionSource?i.embedUserId:e.getHashCode(i.userId),isInternal:i.isInternalUser});n.duration&&"number"==typeof n.duration&&(n.duration=o.bucketTime(n.duration)),o.execute(o,(function(){o.localyticSDKinstance.enqueueCommand(t.tagEventName,r.name,n)})),this.uploadBatchIfAtSizeLimit()},t.prototype.startTimedEvent=function(e){},t.prototype.endTimedEvent=function(r){var o=this,i=this.hostData,n=$.extend({},r.getFormattedInfoObject(),{duration:o.bucketTime(Date.now()-r.time),client:i.client,version:i.build,cluster:i.cluster,activityId:r.id,hashedUuid:"Embed"==i.sessionSource?i.embedUserId:e.getHashCode(i.userId),isInternal:i.isInternalUser});o.execute(o,(function(){o.localyticSDKinstance.enqueueCommand(t.tagEventName,r.name,n)})),this.uploadBatchIfAtSizeLimit()},t.prototype.flush=function(){this.uploadBatch()},t.prototype.bucketTime=function(e){var t="1min+";return e<10?t="< 10ms":e<100?t=10*Math.floor(e/10)+"ms":e<1e3?t=100*Math.floor(e/100)+"ms":e<5e3?t=Math.floor(e/1e3)+"s":e<=1e4?t="5 - 10s":e<=6e4&&(t="10 - 60s"),t},t.prototype.execute=function(e,t){try{t()}catch(e){}},t.afterDequeue=function(e){setTimeout(e,t.afterDequeueTimeout)},t.prototype.uploadBatchIfAtSizeLimit=function(){this.currentBatchCount--,0>=this.currentBatchCount&&this.uploadBatch()},t.prototype.uploadBatch=function(){var e=this;this.batchTimer.clearTimeout(this.batchTimeoutId),this.batchTimeoutId=this.batchTimer.setTimeout((function(){e.uploadBatch()}),t.batchTimeoutMS,null),this.currentBatchCount=this.batchSize,this.execute(this,(function(){e.localyticSDKinstance.enqueueCommand(t.uploadName)}))},t.defaultBatchSize=10,t.batchTimeoutMS=2e3,t.afterDequeueTimeout=200,t.namespace="PowerBI",t.initName="init."+t.namespace,t.tagEventName="tagEvent."+t.namespace,t.uploadName="upload."+t.namespace,t})();e.LocalyticsService=t})(powerbi||(powerbi={}));var jsCommon;!(function(e){!(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.SecurityWarning=2]="SecurityWarning"})(e.ModalDialogNotificationType||(e.ModalDialogNotificationType={}));var t=e.ModalDialogNotificationType;e.PowerBIDefaultHelpPage="https://support.powerbi.com";var r=(function(){function r(t,o){var i=this;this.modalContainer=null,this.modalDialogElement=null,this.dialogTitle=null,this.dialogCloseButton=null,this.dialogContent=null,this.dialogContentMessage=null,this.dialogContentNotification=null,this.dialogContentNotificationText=null,this.dialogContentNotificationIcon=null,this.dialogActions=null,this.messageQueue=new Array,this.isReady=!1,this.messageCurrentlyShown=!1,$(document).ready((function(){i.modalContainer=$(r.ModalDialogHtml),i.modalDialogElement=i.modalContainer.find(r.modalDialogClassSelector),i.dialogTitle=i.modalContainer.find(r.dialogTitleClassSelector),i.dialogCloseButton=i.modalContainer.find(r.dialogCloseIconClassSelector),i.dialogContent=i.modalContainer.find(r.dialogContentClassSelector),i.dialogActions=i.modalContainer.find(r.dialogActionsClassSelector);var n=i;if(i.dialogCloseButton.on(e.DOMConstants.mouseClickEventName,(function(){return n.hideDialog()})),!t){var a=$(r.modalDialogContainerHostClassSelector);a&&a.length>0&&a.remove(),a=InJs.DomFactory.div().addClass(r.modalDialogContainerHostClassName),t=$(e.DOMConstants.DocumentBody).append(a),t=a}t.append(i.modalContainer),i.isReady=!0,i.isRTL=InJs.InfoNavUtility.isRTL(),i.messageQueue.length>0&&i.showDialogInternal(i.messageQueue.shift()),o&&(i.localizationMap=o)}))}return r.prototype.showMessage=function(t,r,o,i){var n=this;e.Utility.throwIfNullOrEmptyString(t,null,"ShowMessage","messageTitle"),e.Utility.throwIfNullOrEmptyString(r,null,"ShowMessage","messageText");var a=[],s="primary",l=null;if(o||(o=this.localizationMap?this.localizationMap.closePromptText:InJs.UnlocalizedStrings.dialogCloseActionLabel),i){var d=$('<a target="_blank"/>').text(i.label).attr("href",i.url);l=$("<div/>").text(r+" ").append(d),r=null}a[0]=this.createButton(o,(function(e,t){n.hideDialog()}),null,s),this.pushMessage(t,r,l,a,!0)},r.prototype.showPrompt=function(t,r,o,i){e.Utility.throwIfNullOrEmptyString(r,null,"ShowPrompt","promptText"),e.Utility.throwIfNullOrUndefined(o,null,"ShowPrompt","promptActions");for(var n=new Array,a=0;a<o.length;a++){var s=o[a],l=s.cssClass;0===a&&(l+=" primary"),n[a]=this.createButton(s.labelText,s.actionCallback,s.data,l,s.disabled)}this.pushMessage(t,r,null,n,i)},r.prototype.showError=function(t,r,o,i,n){this.showCustomError(InJs.UnlocalizedStrings.errorDialogTitle,t,r,r!==e.TraceType.Fatal,o,i,n)},r.prototype.showCustomError=function(t,r,o,i,n,a,s,l,d,c,u){var p=this;e.Utility.throwIfNullOrEmptyString(t,null,"ShowError","errorTitle"),e.Utility.throwIfNullOrEmptyString(r,null,"ShowError","errorText");var g=new Array;s?s.forEach((function(e,t,r){g.push(p.createButton(e.label,(function(t,r){p.hideDialog(),$.isFunction(a)&&a(e.resultValue)}),null,e.cssClass,e.disabled))})):o!==e.TraceType.Fatal?g[0]=this.createButton(this.localizationMap?this.localizationMap.closePromptText:InJs.UnlocalizedStrings.dialogCloseActionLabel,(function(e,t){p.hideDialog(),$.isFunction(a)&&a(0)})):g[0]=this.createButton(this.localizationMap?this.localizationMap.refreshPagePromptText:InJs.UnlocalizedStrings.dialogRefreshPageActionLabel,(function(e,t){window.location.reload()}),null,"primary");var f;if(f=c?$("<div/>").html(r):$("<div/>").text(r),n){var m=this.localizationMap&&this.localizationMap.errorDialogHelperText?this.localizationMap.errorDialogHelperText:InJs.UnlocalizedStrings.errorDialogHelperText;u&&(m=u),f.append($("<br/>")).append(m)}if(this.addAdditionalErrorInfo(f,n,this.localizationMap?this.localizationMap.showTechnicalDetailsText:InJs.UnlocalizedStrings.showDetailsText),l)if(l.url===e.PowerBIDefaultHelpPage||l.isGetHelpTextReplaced){var v=$('<a class="modalErrorHelpLink" target="_blank"/>').text(l.label).attr("href",l.url);f.append(v)}else g.unshift(this.createButton(l.label,(function(e,t){window.open(l.url)}),null,"primary"));this.pushMessage(t||InJs.UnlocalizedStrings.errorDialogTitle,null,f,g,i,d)},r.prototype.showCustomDialog=function(e,t,r,o,i,n,a,s,l,d,c,u,p,g,f){var m=[];f&&(m[0]=this.createCheckbox(f.labelText,f.actionCallback,f.data));for(var v=0;v<r.length;v++){var y=r[v],h=y.cssClass;u||0!==v||(h+=" primary");var C=f?v+1:v;m[C]=this.createButton(y.labelText,y.actionCallback,y.data,h,y.disabled)}return this.pushMessage(e,null,t,m,i,l,o,n,a,s,d,c,u,p,g),this.dialogContent},r.prototype.hideDialog=function(){var t=this;this.modalContainer.fadeTo(r.AnimationSpeedMs,0,(function(){if(t.modalContainer.css(e.CssConstants.displayProperty,e.CssConstants.noneValue),t.modalDialogElement.removeClass(t.modalDialogCustomClass),t.modalContainer.removeClass(t.modalContainerCustomClass),t.currentModalDialogMessage&&t.currentModalDialogMessage.onDialogClosed&&t.currentModalDialogMessage.onDialogClosed(),t.messageCurrentlyShown=!1,t.messageQueue.length){var r=t.messageQueue.shift();t.showDialogInternal(r)}}))},r.prototype.updatePosition=function(t){var o=(this.modalContainer.height()-this.modalDialogElement.height())/2,i=(this.modalContainer.width()-this.modalDialogElement.width())/2,n={top:o+e.CssConstants.pixelUnits,left:this.isRTL?null:i+e.CssConstants.pixelUnits,right:this.isRTL?i+e.CssConstants.pixelUnits:null};t?this.modalDialogElement.animate(n,r.AnimationSpeedMs):this.modalDialogElement.css(n)},r.prototype.addAdditionalErrorInfo=function(t,r,o){var i=this;if(r){for(var n=$("<p />"),a=0;a<r.length;a++)n.append(InJs.InfoNavUtility.constructErrorField(r[a].errorInfoKey,r[a].errorInfoValue));var s=InJs.InfoNavUtility.constructShowDetailsContainer(n,o);t.append($("<br />")),t.append(s),t.find(".showAdditionalDetailsLink").on(e.DOMConstants.mouseClickEventName,(function(e){i.updatePosition(!0)}))}},r.prototype.pushMessage=function(e,t,r,i,n,a,s,l,d,c,u,p,g,f,m){"undefined"==typeof n&&(n=!0),"undefined"==typeof d&&(d=""),"undefined"==typeof c&&(c="");var v=new o;v.titleText=e,v.messageText=t,v.dialogContent=r,v.dialogButtons=i,v.onDialogDisplayed=s,v.isDismissable=n,v.dialogCssClass=d,v.containerCssClass=c,v.onDialogClosed=a,v.notificationType=u,v.notificationText=p,v.htmlMessageText=f,this.messageQueue.push(v),!this.messageCurrentlyShown&&this.isReady&&this.showDialogInternal(this.messageQueue.shift(),l,g,m)},r.prototype.showDialogInternal=function(t,o,i,n){var a=this;if(this.currentModalDialogMessage=t,this.messageCurrentlyShown=!0,this.dialogContentNotification=$(r.notificationForModalDialogHtml),this.dialogContentNotificationIcon=this.dialogContentNotification.find(r.dialogNotificationIconClassSelector),this.dialogContentNotificationText=this.dialogContentNotification.find(r.dialogContentNotificationTextClassSelector),this.dialogTitle.empty(),this.dialogContent.empty(),this.dialogActions.empty(),this.dialogTitle.text(t.titleText).attr("title",t.titleText),n?(this.appendNotification(t.notificationType,t.notificationText),this.appendMessageText(t.dialogContent,t.messageText,t.htmlMessageText)):(this.appendMessageText(t.dialogContent,t.messageText,t.htmlMessageText),this.appendNotification(t.notificationType,t.notificationText)),t.isDismissable?this.dialogCloseButton.css(e.CssConstants.displayProperty,e.CssConstants.blockValue):this.dialogCloseButton.css(e.CssConstants.displayProperty,e.CssConstants.noneValue),t.dialogButtons.length>0){this.dialogActions.show();for(var s=0;s<t.dialogButtons.length;s++)this.dialogActions.append(t.dialogButtons[s])}else this.dialogActions.hide();t.dialogCssClass&&(this.modalDialogElement.addClass(t.dialogCssClass),this.modalDialogCustomClass=t.dialogCssClass),t.containerCssClass&&(this.modalContainer.addClass(t.containerCssClass),this.modalContainerCustomClass=t.containerCssClass);var l=this.modalContainer.css(e.CssConstants.displayProperty)===e.CssConstants.noneValue?this.modalContainer:this.modalDialogElement;l.fadeTo(0,0),this.updatePosition(!1),l.fadeTo(r.AnimationSpeedMs,1,(function(){0===a.modalDialogElement.find(":focus").length&&a.modalDialogElement.focus();var e=a.dialogActions.find("input");!i&&e.length>0&&e[0].focus(),t.onDialogDisplayed&&t.onDialogDisplayed(a.dialogContent),o&&a.dialogContent.parent().find(".infonav-dialogActions input[type=button]:first").focus()}))},r.prototype.appendMessageText=function(e,t,o){_.isEmpty(t)?this.dialogContent.append(e):this.dialogContent.text(t),_.isEmpty(o)||(this.dialogContentMessage=this.dialogContent.find(r.modalDialogHtmlMessageClassSelector),this.dialogContentMessage.html(o))},r.prototype.appendNotification=function(e,o){if(null!==e&&!_.isEmpty(o)){switch(e){case t.Info:this.dialogContentNotificationIcon.addClass(r.dialogInfoIconCssClass),this.dialogContentNotification.addClass(r.notificationInfoCssClass);break;case t.Warning:this.dialogContentNotificationIcon.addClass(r.dialogWarningIconCssClass),this.dialogContentNotification.addClass(r.notificationWarningCssClass);break;case t.SecurityWarning:this.dialogContentNotificationIcon.addClass(r.dialogSecurityWarningIconCssClass),this.dialogContentNotification.addClass(r.notificationSecurityWarningCssClass)}this.dialogContentNotificationText.html(o),this.dialogContent.append(this.dialogContentNotification)}},r.prototype.createButton=function(t,o,i,n,a){var s=this,l=$(r.NewButtonSelector);return l.attr("value",t),l.on(e.DOMConstants.mouseClickEventName,(function(e){o(l,s.dialogContent,i)})),n&&l.addClass(n),a&&l.prop("disabled",!0),l},r.prototype.createCheckbox=function(t,o,i){var n=this,a='<div class="'+r.dialogCheckboxCssClass+'">'+r.checkboxSelector+r.checkboxLabelSelectorOpen+t+r.checkboxLabelSelectorClose+"</div>",s=$(a),l=s.find("input");return l.on(e.DOMConstants.changeEventName,(function(e){o(l,n.dialogContent,i)})),s},r.AnimationSpeedMs=250,r.modalDialogCssClass="infonav-modalDialog",r.dialogTitleCssClass="infonav-dialogTitle",r.dialogCloseIconCssClass="infonav-dialogCloseIcon",r.dialogContentCssClass="infonav-dialogContent",r.dialogContentNotificaionCssClass="infonav-dialogContentNotification",r.dialogWarningIconCssClass="pbi-glyph-warning glyph-mini",r.dialogSecurityWarningIconCssClass="pbi-glyph-securityalert glyph-mini",r.dialogInfoIconCssClass="pbi-glyph-info glyph-mini",r.dialogNotificationIconCssClass="glyphicon",r.notificationWarningCssClass="typeWarning",r.notificationSecurityWarningCssClass="typeSecurityWarning",r.notificationInfoCssClass="typeInfo",r.dialogContentNotificationTextCssClass="infonav-dialogContentNotificationText",r.dialogActionsCssClass="infonav-dialogActions",r.dialogCheckboxCssClass="pbi-input checkbox",r.dialogCheckboxLabelCssClass="form-label",r.dialogHtmlMessageCssclass="dialogMessage",r.modalDialogClassSelector="."+r.modalDialogCssClass,r.dialogTitleClassSelector="."+r.dialogTitleCssClass,r.dialogCloseIconClassSelector="."+r.dialogCloseIconCssClass,r.dialogContentClassSelector="."+r.dialogContentCssClass,r.dialogActionsClassSelector="."+r.dialogActionsCssClass,r.dialogNotificationIconClassSelector="."+r.dialogNotificationIconCssClass,r.dialogContentNotificationTextClassSelector="."+r.dialogContentNotificationTextCssClass,r.modalDialogContainerHostClassName="infonav-modalContainerHost",r.modalDialogContainerHostClassSelector="."+r.modalDialogContainerHostClassName,r.modalDialogHtmlMessageClassSelector="."+r.dialogHtmlMessageCssclass,r.ModalDialogHtml='<div class="infonav-modalContainer'+(location.search.indexOf("renderAsModalDialog")!==-1?" small":"")+'"><div class="'+r.modalDialogCssClass+'" tabindex="-1"><div class="infonav-dialogLayout"><div class="'+r.dialogTitleCssClass+'"></div><div class="'+r.dialogCloseIconCssClass+'"></div><div class="'+r.dialogContentCssClass+'"></div><div class="'+r.dialogActionsCssClass+'"></div></div></div></div>',r.notificationForModalDialogHtml='<div class="'+r.dialogContentNotificaionCssClass+'"><span class="'+r.dialogNotificationIconCssClass+'"></span><span class= "'+r.dialogContentNotificationTextCssClass+'" > </span></div>',r.NewButtonSelector='<input type="button"></input>',r.checkboxSelector='<input type="checkbox"></input>',r.checkboxLabelSelectorOpen='<label class="'+r.dialogCheckboxLabelCssClass+'">',r.checkboxLabelSelectorClose="</label>",r})();e.ModalDialog=r;var o=(function(){function e(){this.titleText=null,this.messageText=null,this.dialogContent=null,this.dialogButtons=null,this.onDialogDisplayed=null,this.onDialogClosed=null,this.isDismissable=!0,this.dialogCssClass=null,this.containerCssClass=null,this.notificationType=null,this.notificationText=null,this.htmlMessageText=null}return e})()})(jsCommon||(jsCommon={}));var InJs;!(function(e){var t=(function(){function e(e,t,r,o,i){this.labelText=e,this.actionCallback=t,this.data=r,this.cssClass=o,this.disabled=!!i}return e})();e.ModalDialogAction=t})(InJs||(InJs={}));var jsCommon;!(function(e){var t,r=powerbi.Double;!(function(t){function o(e,r){return t.isMidnight(e)?e.toLocaleDateString(r):e.toLocaleString(r)}function i(e,r){if(t.isMomentPresent()){var i=r?moment(e).locale(r):moment(e);return i.fromNow()}return o(e,r)}function n(e){return e.getTime()%E===0}function a(e,t){var r=moment(e);return moment().diff(r,t)}function s(){return"undefined"!=typeof moment}function l(e){var t=d(e);if(t)return t;var r=moment(e);return r.isValid()?r.toDate():null}function d(e){if(e){var t=e.length;if(!(t<=18||t>26)&&"-"===e[4]&&"-"===e[7]&&"T"===e[10]&&":"===e[13]&&":"===e[16]){var o=c(e,0,4),i=c(e,5,2),n=c(e,8,2),a=c(e,11,2),s=c(e,14,2),l=c(e,17,2),d=0;if(t>19){if("."!==e[19])return;isNaN(+e.charAt(t-1))&&(e=e.slice(0,-1),t--);var u=c(e,20);if(isNaN(u))return;var p=t-20,g=r.pow10(3-p);d=u*g}if(!(isNaN(o)||isNaN(i)||isNaN(n)||isNaN(a)||isNaN(s)||isNaN(l)||isNaN(d)))return new Date(o,i-1,n,a,s,l,d)}}}function c(e,t,r){var o=e.substr(t,r),i=o.length;if(0===i)return NaN;for(var n=0;n<i;n++){var a=o.charCodeAt(n);if(a<48||a>57)return NaN}return parseInt(o,10)}function u(e){return moment.utc(e).toDate()}function p(e){return moment(e).fromNow()}function g(e){return I+e.getTime().toString()+b}function f(r){if(e.Utility.throwIfNullOrEmptyString(r,null,"deserializeDate","Cannot deserialize empty string"),e.Utility.throwIfNotTrue(0===r.indexOf(I)&&e.StringExtensions.endsWith(r,b),null,"deserializeDate","Cannot deserialize empty string"),t.isMomentPresent()){var o=moment(r);return e.Utility.throwIfNotTrue(o.isValid(),null,"deserializeDate","parsedValue.isValid must be true"),o.toDate()}var i=r.substring(I.length,r.length-b.length);e.Utility.throwIfNotTrue(/^\-?\d+$/.test(i),null,"deserializeDate","Cannot deserialize invalid date");var n=parseInt(i,10);return e.Utility.throwIfNotTrue(!isNaN(n),null,"deserializeDate","Cannot deserialize invalid date"),new Date(n)}function m(e){try{return f(e)}catch(e){}}function v(e,t,r,o){var i=moment().subtract(t,r);return o&&(i=i.startOf(t)),moment(e)>=i}function y(e,t){return moment(t).locale(e).format("LTS")}function h(r,o){return e.StringExtensions.format("{0} {1}",moment(o).locale(r).format("ddd"),t.GetTime(r,o))}function C(r,o){return e.StringExtensions.format("{0} {1}",moment(o).locale(r).format("ll"),t.GetTime(r,o))}var I="/Date(",b=")/";t.formatAbsolute=o,t.formatPretty=i;var S=36e5,E=24*S;t.isMidnight=n,t.elapsedToNow=a,t.isMomentPresent=s,t.parseIsoDate=l,t.parseIsoDateFast=d,t.parseUtcDate=u,t.fromNow=p,t.serializeDate=g,t.deserializeDate=f,t.tryDeserializeDate=m,t.isContainedInTimeFrame=v,t.GetTime=y,t.GetDayWithTime=h,t.GetFullDateWithTime=C})(t=e.DateExtensions||(e.DateExtensions={}))})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t=(function(){function e(e){this.segments=e}return e.prototype.getLeafSegment=function(){return this.segments[this.segments.length-1]},e.prototype.isExtensionOf=function(e){if(this.segments.length<=e.segments.length)return!1;for(var t=0,r=e.segments.length;t<r;++t)if(this.segments[t]!==e.segments[t])return!1;return!0},e.prototype.extend=function(t){return new e(this.segments.concat([t]))},e})();e.Path=t})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t=(function(){function e(){}return e.clearQueryString=function(t){var r=e.parseQueryString();return delete r[t],e.rebuildQueryString(r)},e.addOrUpdateQueryString=function(t,r){var o=e.parseQueryString();return o[t]=r,e.rebuildQueryString(o)},e.addOrUpdateQueryStringToUrl=function(t,r){for(var o=e.parseUrl(t),i=e.clearAllQueriesFromUrl(t),n=0,a=Object.keys(r);n<a.length;n++){var s=a[n];o[s]=r[s]}return i+e.rebuildQueryString(o)},e.getQueryStringValue=function(t){var r=e.parseQueryString();return r[t]},e.parseUrl=function(t){var r=t.indexOf("?"),o=r>=0?t.substr(r):null;return e.parseQueryString(o)},e.parseQueryString=function(e){void 0===e&&(e=window.location.search);var t={},r=e;if(r&&"?"===r.substr(0,1))for(var o=r.substr(1).split("&"),i=0;i<o.length;i++){var n=o[i].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t},e.rebuildQueryString=function(e){var t="",r=!0;for(var o in e)r||(t+="&"),t+=encodeURIComponent(o),e[o]&&(t+="="+encodeURIComponent(e[o])),r=!1;return r||(t="?"+t),t},e.clearAllQueriesFromUrl=function(e){var t=e.indexOf("?");return t>=0?e.substr(0,t):e},e.OriginClientActivityIdParameterName="caid",e.OriginRootActivityIdParameterName="raid",e.OriginActivityIdParameterName="aid",e})();e.QueryStringUtil=t})(jsCommon||(jsCommon={}));var powerbi;!(function(e){function t(e){return new o(e)}function r(e){return new o(e)}e.RejectablePromise2=t,e.RejectablePromise=r;var o=(function(){function e(e){var t=this;this.deferred=e,this.state=0,e.promise.then((function(){return t.state=1}),(function(){return t.state=2}))}return e.prototype.then=function(e,t){return this.deferred.promise.then(e,t)},e.prototype.catch=function(e){return this.deferred.promise.catch(e)},e.prototype.finally=function(e){return this.deferred.promise.finally(e)},e.prototype.resolved=function(){return 1===this.state},e.prototype.rejected=function(){return 2===this.state},e.prototype.pending=function(){return 0===this.state},e.prototype.reject=function(e){this.pending()&&(this.deferred.reject(e),this.state=2)},e})()})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=500,r=(function(){function r(e,r){this.maxCacheEntries=r?r:t,this.cache={},this.promiseFactory=e}return r.prototype.getEntryCount=function(){return Object.keys(this.cache).length},r.prototype.hasCacheEntry=function(e){return!!this.getCacheEntry(e)},r.prototype.createCacheEntry=function(t,r){var o=this,i=this.getCacheEntry(t);if(t&&!i){var n=this.promiseFactory,a=this.cache,s=n.defer(),l=e.RejectablePromise(s),d=n.defer(),c=e.RejectablePromise(d);return i={promise:c,refCount:0,context:r},this.appendCacheEntryInternal(t,i),this.getEntryCount()>this.maxCacheEntries&&this.removeCacheEntryInternal(this.firstKey),l.then((function(e){i.updateResult&&(e=i.updateResult(e)),i.result=e,d.resolve(e)}),(function(e){return d.reject(e)})).finally((function(){delete i.updateResult})),c.catch((function(e){return l.reject()})),c.finally((function(){a[t]&&(delete a[t].promise,c.rejected()&&o.removeCacheEntryInternal(t))})),{deferred:s,promise:l}}},r.prototype.clearEntry=function(e,t){var r=this.getCacheEntry(e);if(r){var o=r.promise;return t&&o?o.reject():this.removeCacheEntryInternal(e),!0}return!1},r.prototype.clearAllEntries=function(e){for(var t in this.cache)this.clearEntry(t,e)},r.prototype.bindCacheEntry=function(t,r){var o=this.getCacheEntry(t);if(void 0!==o){var i=this.promiseFactory.defer(),n=e.RejectablePromise(i);if(o.result){var a=r?r(o.result):o.result;return i.resolve(a),n}var s=o.promise;return s?(o.refCount++,n.finally((function(){o.refCount--,0===o.refCount&&s.pending()&&s.reject()})),s.then((function(e){var t=r?r(o.result):o.result;i.resolve(t)}),(function(e){return i.reject(e)})),n):(i.reject(null),n)}},r.prototype.getEntryContext=function(e){var t=this.getCacheEntry(e);if(t)return t.context},r.prototype.keys=function(){return Object.keys(this.cache)},r.prototype.rewriteAllEntries=function(e){var t=[],r=!!e.rewriteKey,o=!!e.rewriteResult,i=this.cache;for(var n in i){if(r){var a=e.rewriteKey(n);a!==n&&t.push({oldKey:n,newKey:a})}if(o){var s=i[n];s&&s.result?s.result=e.rewriteResult(s.result,n):s.updateResult=function(t){return e.rewriteResult(t,n)}}}for(var l=0,d=t.length;l<d;l++)this.changeCacheKey(t[l].oldKey,t[l].newKey)},r.prototype.putCacheResult=function(e,t){var r=this.getCacheEntry(e);r.result?r.result=t:r.updateResult=function(){return t}},r.prototype.appendCacheEntryInternal=function(e,t){if(this.firstKey){var r=this.cache[this.lastKey];r.nextKey=e,t.previousKey=this.lastKey,this.lastKey=e,t.nextKey=void 0}else this.firstKey=e,this.lastKey=e,t.nextKey=void 0,t.previousKey=void 0;this.cache[e]=t},r.prototype.removeCacheEntryInternal=function(e){var t=this.cache[e];if(t){var r=t.previousKey,o=t.nextKey;if(r){var i=this.cache[r];i.nextKey=o}else this.firstKey=o;if(o){var n=this.cache[o];n.previousKey=r}else this.lastKey=r;delete this.cache[e]}},r.prototype.changeCacheKey=function(e,t){if(!t)return this.clearEntry(e,!0);if(this.hasCacheEntry(t)||!this.hasCacheEntry(e))return!1;var r=this.getCacheEntry(e);return this.removeCacheEntryInternal(e),this.appendCacheEntryInternal(t,r),!0},r.prototype.getCacheEntry=function(e){var t;if(e&&(t=this.cache[e])&&(t.promise||t.result))return t},r})();e.RejectablePromiseCache=r})(powerbi||(powerbi={}));var powerbi;!(function(e){!(function(e){e[e.AngularCancelOrTimeout=0]="AngularCancelOrTimeout",e[e.OK=200]="OK",e[e.Accepted=202]="Accepted",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError"})(e.HttpStatusCode||(e.HttpStatusCode={}));e.HttpStatusCode;!(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.External=2]="External"})(e.ExceptionCulprit||(e.ExceptionCulprit={}));e.ExceptionCulprit})(powerbi||(powerbi={}));var jsCommon;!(function(e){var t=(function(){function e(e){this._parts=new Array,e&&this._parts.push(e)}return e.prototype.append=function(e){e&&(this._parts[this._parts.length]=e)},e.prototype.appendLine=function(e){e?this._parts[this._parts.length]=e+"\r\n":this._parts[this._parts.length]="\r\n"},e.prototype.clear=function(){this._parts=new Array},e.prototype.isEmpty=function(){return 0===this._parts.length||""===this.toString("")},e.prototype.toString=function(e){var t=this._parts.join(e||"");return t},e})();e.StringBuilder=t})(jsCommon||(jsCommon={}));var powerbi;!(function(e){var t;!(function(t){!(function(e){e[e.PowerBI=0]="PowerBI",e[e.External=1]="External",e[e.User=2]="User"})(t.ErrorSource||(t.ErrorSource={}));t.ErrorSource;!(function(e){e[e.Master=0]="Master",e[e.PhonePortrait=1]="PhonePortrait"})(t.CanvasLayout||(t.CanvasLayout={}));t.CanvasLayout;t.BaseEvent=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"BaseEvent",time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.BaseEventLoggers&&(u.loggers=e.telemetry.BaseEventLoggers),u},t.TimedEvent=function(t,r,o,i,n,a,s,l,d,c,u){void 0===i&&(i=!1),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===u&&(u=void 0);var p={start:t,end:r,parentId:o,isError:i,errorSource:n,errorCode:a,errorMessage:s,activityName:l,activityId:d,isDebug:c,isCancelled:u},g={name:"TimedEvent",time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={start:p.start,end:p.end,parentId:p.parentId,isError:p.isError};return"undefined"!=typeof p.errorSource&&(t.errorSource=e.telemetry.ErrorSource[p.errorSource]),"undefined"!=typeof p.errorCode&&(t.errorCode=p.errorCode),"undefined"!=typeof p.errorMessage&&(t.errorMessage=p.errorMessage),"undefined"!=typeof p.activityName&&(t.activityName=p.activityName),"undefined"!=typeof p.activityId&&(t.activityId=p.activityId),"undefined"!=typeof p.isDebug&&(t.isDebug=p.isDebug),"undefined"!=typeof p.isCancelled&&(t.isCancelled=p.isCancelled),t},info:p,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.TimedEventLoggers&&(g.loggers=e.telemetry.TimedEventLoggers),g},t.Verbose=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"Verbose",category:e.TelemetryCategory.Verbose,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VerboseLoggers&&(u.loggers=e.telemetry.VerboseLoggers),u},t.VerboseTimedEvent=function(t,r,o,i,n,a,s,l,d,c,u){void 0===i&&(i=!1),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===u&&(u=void 0);var p={start:t,end:r,parentId:o,isError:i,errorSource:n,errorCode:a,errorMessage:s,activityName:l,activityId:d,isDebug:c,isCancelled:u},g={name:"VerboseTimedEvent",category:e.TelemetryCategory.Verbose,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={start:p.start,end:p.end,parentId:p.parentId,isError:p.isError};return"undefined"!=typeof p.errorSource&&(t.errorSource=e.telemetry.ErrorSource[p.errorSource]),"undefined"!=typeof p.errorCode&&(t.errorCode=p.errorCode),"undefined"!=typeof p.errorMessage&&(t.errorMessage=p.errorMessage),"undefined"!=typeof p.activityName&&(t.activityName=p.activityName),"undefined"!=typeof p.activityId&&(t.activityId=p.activityId),"undefined"!=typeof p.isDebug&&(t.isDebug=p.isDebug),"undefined"!=typeof p.isCancelled&&(t.isCancelled=p.isCancelled),t},info:p,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VerboseTimedEventLoggers&&(g.loggers=e.telemetry.VerboseTimedEventLoggers),g},t.Trace=function(t,r){var o={type:t,message:r},i={name:"Trace",category:e.TelemetryCategory.Trace,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={type:o.type,message:o.message};return e},info:o,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.TraceLoggers&&(i.loggers=e.telemetry.TraceLoggers),i},t.Error=function(t){var r={message:t},o={name:"Error",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={message:r.message};return e},info:r,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.ErrorLoggers&&(o.loggers=e.telemetry.ErrorLoggers),o},t.ErrorWithStackTrace=function(t,r){var o={stack:t,message:r},i={name:"ErrorWithStackTrace",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={stack:o.stack,message:o.message};return e},info:o,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.ErrorWithStackTraceLoggers&&(i.loggers=e.telemetry.ErrorWithStackTraceLoggers),i},t.ErrorWithStackTraceAndSourceDetails=function(t,r,o,i,n){var a={source:t,lineNumber:r,columnNumber:o,stack:i,message:n},s={name:"ErrorWithStackTraceAndSourceDetails",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={source:a.source,
lineNumber:a.lineNumber,columnNumber:a.columnNumber,stack:a.stack,message:a.message};return e},info:a,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.ErrorWithStackTraceAndSourceDetailsLoggers&&(s.loggers=e.telemetry.ErrorWithStackTraceAndSourceDetailsLoggers),s},t.CustomerAction=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"CustomerAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.CustomerActionLoggers&&(u.loggers=e.telemetry.CustomerActionLoggers),u},t.SnapShotEmbedUserAction=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"SnapShotEmbedUserAction",category:e.TelemetryCategory.SnapShotEmbedUserAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.SnapShotEmbedUserActionLoggers&&(u.loggers=e.telemetry.SnapShotEmbedUserActionLoggers),u},t.DashboardRootSession=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.Dashboard.RootSession",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.DashboardRootSessionLoggers&&(u.loggers=e.telemetry.DashboardRootSessionLoggers),u},t.WFEInvitationSignUp=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.WFE.InvitationSignUp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.WFEInvitationSignUpLoggers&&(u.loggers=e.telemetry.WFEInvitationSignUpLoggers),u},t.WFEError=function(t,r,o,i,n,a,s,l,d,c,u){void 0===i&&(i=!1),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===u&&(u=void 0);var p={errorCode1:t,errorType:r,parentId:o,isError:i,errorSource:n,errorCode:a,errorMessage:s,activityName:l,activityId:d,isDebug:c,isCancelled:u},g={name:"PBI.WFE.Error",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={errorCode1:p.errorCode1,errorType:p.errorType,parentId:p.parentId,isError:p.isError};return"undefined"!=typeof p.errorSource&&(t.errorSource=e.telemetry.ErrorSource[p.errorSource]),"undefined"!=typeof p.errorCode&&(t.errorCode=p.errorCode),"undefined"!=typeof p.errorMessage&&(t.errorMessage=p.errorMessage),"undefined"!=typeof p.activityName&&(t.activityName=p.activityName),"undefined"!=typeof p.activityId&&(t.activityId=p.activityId),"undefined"!=typeof p.isDebug&&(t.isDebug=p.isDebug),"undefined"!=typeof p.isCancelled&&(t.isCancelled=p.isCancelled),t},info:p,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.WFEErrorLoggers&&(g.loggers=e.telemetry.WFEErrorLoggers),g},t.DashboardErrorDialog=function(t,r,o,i,n){void 0===i&&(i=void 0);var a={raid:t,caid:r,errorType:o,errorSource:i,message:n},s={name:"PBI.Dashboard.ErrorDialog",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={raid:a.raid,caid:a.caid,errorType:a.errorType,message:a.message};return"undefined"!=typeof a.errorSource&&(t.errorSource=e.telemetry.ErrorSource[a.errorSource]),t},info:a,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.DashboardErrorDialogLoggers&&(s.loggers=e.telemetry.DashboardErrorDialogLoggers),s},t.MobileLandingContinuedToWeb=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.MobileLanding.ContinuedToWeb",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.MobileLandingContinuedToWebLoggers&&(u.loggers=e.telemetry.MobileLandingContinuedToWebLoggers),u},t.MobileLandingDownloadApp=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.MobileLanding.DownloadApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.MobileLandingDownloadAppLoggers&&(u.loggers=e.telemetry.MobileLandingDownloadAppLoggers),u},t.DashboardUnhandledAngularException=function(t,r){var o={stack:t,message:r},i={name:"PBI.Dashboard.UnhandledAngularException",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={stack:o.stack,message:o.message};return e},info:o,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.DashboardUnhandledAngularExceptionLoggers&&(i.loggers=e.telemetry.DashboardUnhandledAngularExceptionLoggers),i},t.VisualException=function(t,r,o,i,n,a,s,l){var d={visualType:t,isCustom:r,apiVersion:o,source:i,lineNumber:n,columnNumber:a,stack:s,message:l},c={name:"PBI.Visual.Exception",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={visualType:d.visualType,isCustom:d.isCustom,apiVersion:d.apiVersion,source:d.source,lineNumber:d.lineNumber,columnNumber:d.columnNumber,stack:d.stack,message:d.message};return e},info:d,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VisualExceptionLoggers&&(c.loggers=e.telemetry.VisualExceptionLoggers),c},t.DashboardUnhandledException=function(t,r,o,i,n){var a={source:t,lineNumber:r,columnNumber:o,stack:i,message:n},s={name:"PBI.Dashboard.UnhandledException",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={source:a.source,lineNumber:a.lineNumber,columnNumber:a.columnNumber,stack:a.stack,message:a.message};return e},info:a,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.DashboardUnhandledExceptionLoggers&&(s.loggers=e.telemetry.DashboardUnhandledExceptionLoggers),s},t.DashboardUnhandledStacklessException=function(t,r,o,i){var n={source:t,lineNumber:r,columnNumber:o,message:i},a={name:"PBI.Dashboard.UnhandledStacklessException",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={source:n.source,lineNumber:n.lineNumber,columnNumber:n.columnNumber,message:n.message};return e},info:n,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.DashboardUnhandledStacklessExceptionLoggers&&(a.loggers=e.telemetry.DashboardUnhandledStacklessExceptionLoggers),a},t.WFEReopenUserAccount=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.WFE.ReopenUserAccount",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.WFEReopenUserAccountLoggers&&(u.loggers=e.telemetry.WFEReopenUserAccountLoggers),u},t.WFEAccountClosedPage=function(t,r,o,i,n,a,s,l,d){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0);var c={parentId:t,isError:r,errorSource:o,errorCode:i,errorMessage:n,activityName:a,activityId:s,isDebug:l,isCancelled:d},u={name:"PBI.WFE.AccountClosedPage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={parentId:c.parentId,isError:c.isError};return"undefined"!=typeof c.errorSource&&(t.errorSource=e.telemetry.ErrorSource[c.errorSource]),"undefined"!=typeof c.errorCode&&(t.errorCode=c.errorCode),"undefined"!=typeof c.errorMessage&&(t.errorMessage=c.errorMessage),"undefined"!=typeof c.activityName&&(t.activityName=c.activityName),"undefined"!=typeof c.activityId&&(t.activityId=c.activityId),"undefined"!=typeof c.isDebug&&(t.isDebug=c.isDebug),"undefined"!=typeof c.isCancelled&&(t.isCancelled=c.isCancelled),t},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.WFEAccountClosedPageLoggers&&(u.loggers=e.telemetry.WFEAccountClosedPageLoggers),u},t.VisualError=function(t,r,o){var i={errorCode:t,targetVisualType:r,message:o},n={name:"PBI.Visual.Error",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var e={errorCode:i.errorCode,targetVisualType:i.targetVisualType,message:i.message};return e},info:i,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VisualErrorLoggers&&(n.loggers=e.telemetry.VisualErrorLoggers),n},t.VisualWarning=function(t,r,o,i,n,a,s,l,d,c){void 0===o&&(o=!1),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===a&&(a=void 0),void 0===s&&(s=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0);var u={targetVisualType:t,parentId:r,isError:o,errorSource:i,errorCode:n,errorMessage:a,activityName:s,activityId:l,isDebug:d,isCancelled:c},p={name:"PBI.Visual.Warning",category:e.TelemetryCategory.Verbose,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={targetVisualType:u.targetVisualType,parentId:u.parentId,isError:u.isError};return"undefined"!=typeof u.errorSource&&(t.errorSource=e.telemetry.ErrorSource[u.errorSource]),"undefined"!=typeof u.errorCode&&(t.errorCode=u.errorCode),"undefined"!=typeof u.errorMessage&&(t.errorMessage=u.errorMessage),"undefined"!=typeof u.activityName&&(t.activityName=u.activityName),"undefined"!=typeof u.activityId&&(t.activityId=u.activityId),"undefined"!=typeof u.isDebug&&(t.isDebug=u.isDebug),"undefined"!=typeof u.isCancelled&&(t.isCancelled=u.isCancelled),t},info:u,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VisualWarningLoggers&&(p.loggers=e.telemetry.VisualWarningLoggers),p},t.VisualApiUsage=function(t,r,o,i,n,a,s,l,d,c,u,p,g,f,m){void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===u&&(u=void 0),void 0===p&&(p=void 0),void 0===g&&(g=void 0),void 0===f&&(f=void 0),void 0===m&&(m=void 0);var v={name:t,apiVersion:r,custom:o,visualVersion:i,start:n,end:a,parentId:s,isError:l,errorSource:d,errorCode:c,errorMessage:u,activityName:p,activityId:g,isDebug:f,isCancelled:m},y={name:"PBI.Visual.ApiUsage",category:e.TelemetryCategory.Verbose,time:Date.now(),id:jsCommon.Utility.generateGuid(),getFormattedInfoObject:function(){var t={name:v.name,apiVersion:v.apiVersion,custom:v.custom,visualVersion:v.visualVersion,start:v.start,end:v.end,parentId:v.parentId,isError:v.isError};return"undefined"!=typeof v.errorSource&&(t.errorSource=e.telemetry.ErrorSource[v.errorSource]),"undefined"!=typeof v.errorCode&&(t.errorCode=v.errorCode),"undefined"!=typeof v.errorMessage&&(t.errorMessage=v.errorMessage),"undefined"!=typeof v.activityName&&(t.activityName=v.activityName),"undefined"!=typeof v.activityId&&(t.activityId=v.activityId),"undefined"!=typeof v.isDebug&&(t.isDebug=v.isDebug),"undefined"!=typeof v.isCancelled&&(t.isCancelled=v.isCancelled),t},info:v,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.telemetry.VisualApiUsageLoggers&&(y.loggers=e.telemetry.VisualApiUsageLoggers),y}})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var appInsights,appInsightsConfig;appInsights=appInsights||{trackPageView:function(e,t){},trackEvent:function(e,t){},trackTrace:function(e,t){},flush:function(){}};var powerbi;!(function(e){function t(){if(!("undefined"!=typeof isTelemetryDisabled&&isTelemetryDisabled||"undefined"==typeof appInsightsV2InstrKey&&"undefined"==typeof appInsightsConfig)){var t="undefined"!=typeof appInsightsV2InstrKey?appInsightsV2InstrKey:"",r=appInsightsConfig||{instrumentationKey:t};appInsights=(function(t){function r(e){o[e]=function(){var t=arguments;o.queue.push((function(){o[e].apply(o,t)}))}}var o={config:t},i=document,n=window,a="script",s=i.createElement(a);s.src=t.url||e.build+"/scripts/ai.0.js",i.getElementsByTagName(a)[0].parentNode.appendChild(s),o.cookie=i.cookie,o.queue=[];for(var l=["Event","Exception","Metric","PageView","Trace"];l.length;)r("track"+l.pop());if(!t.disableExceptionTracking){var d="onerror";r("_"+d);var c=n[d];n[d]=function(e,t,r,i,n){var a=c&&c(e,t,r,i,n);return a!==!0&&o["_"+d](e,t,r,i,n),a}}return o})(r)}}var r=jsCommon.QueryStringUtil,o="PowerBIPageView",i=(function(){function t(e,r){this.hostData=null,this.appInsightsV2Service=e,this.appInsightsV2Service.trackPageView(o,t.scrubUrl(r||window.location.href))}return t.prototype.initialize=function(e){this.hostData=e},t.prototype.getType=function(){return e.LoggerServiceType.AppInsightDeprecated},t.prototype.getCategoryOfEvent=function(t){var r=t.category?t.category:e.TelemetryCategory.Verbose;return e.TelemetryCategory[r]},t.prototype.logEvent=function(t){t.category===e.TelemetryCategory.Trace?this.trackTraceInternal(t.getFormattedInfoObject(),this.hostData):this.endTimedEvent(t)},t.prototype.startTimedEvent=function(e){},t.prototype.endTimedEvent=function(e){var t=$.extend({},this.hostData,{id:e.id,start:new Date(e.time).toISOString(),end:(new Date).toISOString(),category:this.getCategoryOfEvent(e)},e.getFormattedInfoObject());this.trackEventInternal(e.name,t)},t.prototype.flush=function(){this.appInsightsV2Service.flush&&this.appInsightsV2Service.flush()},t.prototype.trackEventInternal=function(e,t){try{this.appInsightsV2Service.trackEvent(e,t)}catch(e){}},t.prototype.trackTraceInternal=function(e,t){try{this.appInsightsV2Service.trackTrace(e,t)}catch(e){}},t.scrubUrl=function(t){var o=r.clearAllQueriesFromUrl(t),i="",n=r.parseUrl(t);for(var a in n){i+=0===i.length?"?":"&";var s=n[a];i+=encodeURIComponent(a)+"=<pi>"+(s?e.getHashCode(s):"")+"</pi>"}return o+i},t})();e.AppInsightsV2Service=i,e.loadAppInsightsV2=t,t()})(powerbi||(powerbi={}));var powerbi;!(function(e){!(function(e){e[e.Open=0]="Open",e[e.CanBeClosed=1]="CanBeClosed"})(e.Status||(e.Status={}));var t=e.Status,r=(function(){function e(e){this.eventsInStorage=[],this.loggerService=e}return e.prototype.initialize=function(e){this.loggerService.initialize(e)},e.prototype.getType=function(){return this.loggerService.getType()},e.prototype.logEvent=function(e){this.loggerService.logEvent(e)},e.prototype.startTimedEvent=function(e){this.eventsInStorage.push({eventData:e,status:t.Open}),this.loggerService.startTimedEvent(e)},e.prototype.endTimedEvent=function(e){var r=this,o=this.getChildren(e.id);if(this.removeEventsWithId(e.id),0===o.length){this.loggerService.endTimedEvent(e);for(var i=e;i;){var n=this.eventsInStorage.filter((function(e){return i.info.parentId&&e.eventData.id===i.info.parentId&&e.status===t.CanBeClosed&&0===r.getChildren(e.eventData.id).length}));n.length>0?(this.loggerService.endTimedEvent(n[0].eventData),this.removeEventsWithId(n[0].eventData.id),i=n[0].eventData):i=null}}else this.eventsInStorage.push({eventData:e,status:t.CanBeClosed})},e.prototype.flush=function(){this.loggerService.flush()},e.prototype.getChildren=function(e){return this.eventsInStorage.filter((function(t){return void 0!==t.eventData.info.parentId&&t.eventData.info.parentId===e}))},e.prototype.removeEventsWithId=function(e){for(var t=this.eventsInStorage.length-1;t>=0;t--){var r=this.eventsInStorage[t].eventData;r.id===e&&this.eventsInStorage.splice(t,1)}},e})();e.AutoEndingWrapper=r})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=(function(){function t(){}return t.prototype.initialize=function(e){this.hostData=e},t.prototype.getType=function(){return e.LoggerServiceType.Etw},t.prototype.logEvent=function(e){},t.prototype.startTimedEvent=function(e){if(this.isProfilerAvailable()){var t=e,r=t.info.parentId?t.info.parentId:"",o=e.name+"_A:"+e.id+"_P:"+r+"_C:"+this.hostData.sessionId+":Begin";window.msWriteProfilerMark(o)}},t.prototype.endTimedEvent=function(e){if(this.isProfilerAvailable()){var t=e,r=t.info.parentId?t.info.parentId:"",o=e.name+"_A:"+e.id+"_P:"+r+"_C:"+this.hostData.sessionId+":End";window.msWriteProfilerMark(o)}},t.prototype.flush=function(){},t.prototype.isProfilerAvailable=function(){return null!=window.msWriteProfilerMark},t})();e.EtwPerfLoggerService=t})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(t){switch(t){case e.ExceptionCulprit.External:return i.External;case e.ExceptionCulprit.User:return i.User;case e.ExceptionCulprit.System:default:return i.PowerBI}}function o(t,o){if(t&&t.code){var n=t.code;return t["pbi.error"]&&null!=t["pbi.error"].exceptionCulprit?{errorCode:n,errorSource:r(t["pbi.error"].exceptionCulprit)}:null==o||o!==e.HttpStatusCode.Unauthorized&&o!==e.HttpStatusCode.Forbidden?{errorCode:n,errorSource:i.PowerBI}:{errorCode:n,errorSource:i.User}}if(null!=o)return{errorCode:"HttpStatusCode = "+o,errorSource:i.PowerBI}}var i=e.telemetry.ErrorSource;t.getTelemetryErrorDetails=o})(t=e.errorDetailsHelper||(e.errorDetailsHelper={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=(function(){function e(){}return e.prototype.setTimeout=function(e,t,r){return setTimeout(e,t,r)},e.prototype.setInterval=function(e,t,r){return setInterval(e,t,r)},e.prototype.clearTimeout=function(e){clearTimeout(e)},e.prototype.clearInterval=function(e){clearInterval(e)},e})();e.DefaultTimer=t;var r=(function(){function e(e,r,o){this.callbacks=[],this.isIdle=!1;var i=this;this.timer=void 0!==o?o:new t,this.pollingDelay=e,this.callbackDelay=r;var n=$(document);n.on("click",null,i,this.somethingJustHappenedCallback),n.on("dblclick",null,i,this.somethingJustHappenedCallback),n.on("input",null,i,this.somethingJustHappenedCallback),n.on("keydown",null,i,this.somethingJustHappenedCallback),n.on("mouseenter",null,i,this.somethingJustHappenedCallback),n.on("mousemove",null,i,this.somethingJustHappenedCallback),n.on("scroll",null,i,this.somethingJustHappenedCallback),this.somethingJustHappened(i)}return e.prototype.somethingJustHappenedCallback=function(e){e.data.somethingJustHappened(e.data)},e.prototype.somethingJustHappened=function(e){var t=(new Date).getTime();e.startedIdle=t,e.timer.clearTimeout(e.idleTimer),e.timer.clearInterval(e.callbackTimer),e.idleTimer=e.timer.setTimeout(e.idleTimerCallback,e.pollingDelay,e)},e.prototype.idleTimerCallback=function(e){e.callback(e),e.callbackTimer=e.timer.setInterval(e.callback,e.callbackDelay,e)},e.prototype.addCallback=function(e){this.removeCallback(e),this.callbacks.push(e)},e.prototype.removeCallback=function(e){for(var t=this.callbacks.length-1;t>=0;t--)this.callbacks[t]===e&&this.callbacks.splice(t,1)},e.prototype.callback=function(e){for(var t=0;t<e.callbacks.length;t++)e.callbacks[t]()},e})();e.IdleCallbackTimer=r})(powerbi||(powerbi={}));var jsCommon;!(function(e){var t;!(function(e){function t(e,t){if(!e&&!t)return!0;if(!!e!=!!t||e.length!==t.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!e[r].equals(t[r]))return!1;return!0}e.comparableSequenceEqual=t})(t=e.ArrayExtensions||(e.ArrayExtensions={}))})(jsCommon||(jsCommon={}));var powerbi;!(function(e){var t=(function(){function e(){}return e.prototype.shoudLog=function(e,t){return!0},e})();e.SendAllRule=t;var r=(function(){function e(){}return e.prototype.shoudLog=function(e,t){return!1},e})();e.SendNothingRule=r;var o=(function(){function t(e){this.shouldLogMap=[];for(var t=0;t<e.length;t++){var r=e[t],o=r.purpose;this.shouldLogMap[o]=r.sampleRate>=1-Math.random()}}return t.prototype.shoudLog=function(t,r){var o=t.loggers;if(o)return(o&r)===r;var i=t.category?e.TelemetryCategory[t.category]:e.TelemetryCategory[e.TelemetryCategory.Verbose];return void 0!==this.shouldLogMap[i]&&this.shouldLogMap[i]},t})();e.LoggerServiceRule=o})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=(function(){function e(e,t){this.loggerService=e,this.rule=t}return e.prototype.initialize=function(e){this.loggerService.initialize(e)},e.prototype.getType=function(){return this.loggerService.getType()},e.prototype.shouldLog=function(e){return!!this.rule.shoudLog(e,this.getType())},e.prototype.logEvent=function(e){this.shouldLog(e)&&this.loggerService.logEvent(e)},e.prototype.startTimedEvent=function(e){this.loggerService.startTimedEvent(e)},e.prototype.endTimedEvent=function(e){this.shouldLog(e)&&this.loggerService.endTimedEvent(e)},e.prototype.flush=function(){this.loggerService.flush()},e})();e.LoggerServiceWrapper=t})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){var t,r,o,i=0;if(0===e.length)return i;var n=e.toLowerCase();for(t=0,o=n.length;t<o;t++)r=n.charCodeAt(t),i=(i<<5)-i+r,i|=0;return i}e.getHashCode=t})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function r(){return"string"!=typeof window.sessionSource&&(window.sessionSource="PowerBI"),"string"!=typeof window.embedUserId&&(window.embedUserId=""),new o(e.telemetrySamplingRules,e.session.userInfo,e.build,clusterUri,e.telemetryConstants.pbiClientName,window.telemetrySessionId,window.sessionSource,window.embedUserId)}t.createTelemetryHostService=r,t.NullGuid="00000000-0000-0000-0000-000000000000";var o=(function(){function r(r,o,n,a,s,l,d,c){this.loggers=i.getDefaultLoggingCollection(r),this.hostData={sessionId:l||"",client:s||"",build:n||"",cluster:a||"",userId:o&&o.puid?o.puid:t.NullGuid,userObjectId:o&&o.uoid?o.uoid:t.NullGuid,tenantObjectId:"undefined"==typeof window.tenantId?t.NullGuid:window.tenantId,isInternalUser:e.session.UserInfoUtils.isInternalUser(),sessionSource:d,embedUserId:c}}return r.prototype.getLoggerServices=function(){return this.loggers},r.prototype.getHostData=function(){return this.hostData},r})(),i=(function(){function t(){}return t.getDefaultLoggingCollection=function(e){return"standard"===e?t.getStandardCollectionRules():"snapshotEmbed"===e?t.getSnapShotEmbedCollectionRules():"none"===e?t.getLogNothingCollectionRules():t.getLoggingCollection(e)},t.getLoggingCollection=function(t){var r=new Array,o="undefined"!=typeof window.localyticsInstrKey?window.localyticsInstrKey:"";return t&&(t.perf&&r.push(this.wrapLogger(t.perf,new e.AutoEndingWrapper(new e.EtwPerfLoggerService))),t.appInsights&&r.push(this.wrapLogger(t.appInsights,new e.AppInsightsV2Service(appInsights))),t.localytics&&r.push(this.wrapLogger(t.localytics,new e.LocalyticsService(o)))),r},t.getStandardCollectionRules=function(){var r=new Array,o="undefined"!=typeof window.localyticsInstrKey?window.localyticsInstrKey:"";return r.push(this.wrapLogger(t.EtwStandardLoggerConfig,new e.AutoEndingWrapper(new e.EtwPerfLoggerService))),r.push(this.wrapLogger(t.AppInsightStandardLoggerConfig,new e.AppInsightsV2Service(appInsights))),r.push(this.wrapLogger(t.LocalyticsStandardLoggerConfig,new e.LocalyticsService(o||""))),r},t.getSnapShotEmbedCollectionRules=function(){var r=new Array,o="undefined"!=typeof window.localyticsInstrKey?window.localyticsInstrKey:"";return r.push(this.wrapLogger(t.snapEmbededLoggerConfig,new e.AutoEndingWrapper(new e.EtwPerfLoggerService))),r.push(this.wrapLogger(t.snapEmbededLoggerConfig,new e.AppInsightsV2Service(appInsights))),r.push(this.wrapLogger(t.snapEmbededLoggerConfig,new e.LocalyticsService(o||""))),r},t.getLogNothingCollectionRules=function(){var e=new Array;return e},t.wrapLogger=function(t,r){var o=t?new e.LoggerServiceRule(t):new e.SendNothingRule,i=new e.LoggerServiceWrapper(r,o);return i},t.LocalyticsStandardLoggerConfig=[{purpose:"CriticalError",sampleRate:1},{purpose:"CustomerAction",sampleRate:1},{purpose:"Verbose",sampleRate:0},{purpose:"Trace",sampleRate:0}],t.AppInsightStandardLoggerConfig=[{purpose:"CriticalError",sampleRate:1},{purpose:"CustomerAction",sampleRate:1},{purpose:"Verbose",sampleRate:1},{purpose:"Trace",sampleRate:0}],t.EtwStandardLoggerConfig=[{purpose:"CriticalError",sampleRate:1},{purpose:"CustomerAction",sampleRate:1},{purpose:"Verbose",sampleRate:1},{purpose:"Trace",sampleRate:0}],t.snapEmbededLoggerConfig=[{purpose:"SnapShotEmbedUserAction",sampleRate:1}],t})();t.TelemetryConfigurations=i})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r=(function(){function r(){}return r.getFullName=function(){return e.session.userInfo.givenName+" "+e.session.userInfo.surname},r.isInternalUser=function(){if(!e.session.userInfo||!e.session.userInfo.name)return!1;var t=e.session.userInfo.name.toLowerCase();return t.indexOf("@microsoft.com")>=0||t.indexOf(".microsoft.com")>=0},r.getUPN=function(){return t.userInfo.name},r.getEmailAddressForReceivingMail=function(){var t=e.session.userInfo;return null==t?"":_.isEmpty(t.alternateEmail)?t.name:t.alternateEmail},r})();t.UserInfoUtils=r})(t=e.session||(e.session={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.pbiClientName="PowerBI.com",e.httpActivityIdHeader="ActivityId",e.httpRequestIdHeader="RequestId"})(t=e.telemetryConstants||(e.telemetryConstants={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){!(function(e){e[e.Verbose=0]="Verbose",e[e.CustomerAction=1]="CustomerAction",e[e.CriticalError=2]="CriticalError",e[e.Trace=3]="Trace",e[e.SnapShotEmbedUserAction=4]="SnapShotEmbedUserAction"})(e.TelemetryCategory||(e.TelemetryCategory={}));e.TelemetryCategory;!(function(e){e[e.Localytics=1]="Localytics",e[e.AppInsightDeprecated=2]="AppInsightDeprecated",e[e.AppInsight=4]="AppInsight",e[e.Etw=8]="Etw",e[e.Mobile=16]="Mobile",e[e.WinJs=32]="WinJs",e[e.Designer=64]="Designer"})(e.LoggerServiceType||(e.LoggerServiceType={}));e.LoggerServiceType})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t){return new n(e,t)}e.createTelemetryService=t;var r=(function(){function e(){}return e})();e.PerfEvent=r;var o=18e5,i=12e4,n=(function(){function t(e,t){this.userActivityContextService=t,this.loggerServices=e?e.getLoggerServices():[],this.hostData=e?e.getHostData():{},this.startSession(),this.startSessionTimeout(),this.isSuspended=!1,this.perfEvents=[]}return t.prototype.startSession=function(){for(var t=0,r=this.loggerServices.length;t<r;t++)this.loggerServices[t].initialize(this.hostData);this._rootEvent=e.telemetry.DashboardRootSession("",!1),this.logEventInternal(this._rootEvent)},t.prototype.startSessionTimeout=function(){var e=this;this.sessionExpirationTimerId=setTimeout((function(){
e.hostData.sessionId=jsCommon.Utility.generateGuid(),e.startSession()}),o)},t.prototype.resetSessionTimeout=function(){window.clearTimeout(this.sessionExpirationTimerId),this.startSessionTimeout()},t.prototype.suspend=function(){this.isSuspended=!0,window.clearTimeout(this.sessionExpirationTimerId)},t.prototype.resume=function(){this.isSuspended=!1,this.resetSessionTimeout()},t.prototype.flush=function(){for(var e=this.getLoggerServices(),t=0,r=e.length;t<r;t++)e[t].flush()},t.prototype.removeEvent=function(e){for(var t=0,r=this.perfEvents.length;t<r;t++)if(this.perfEvents[t].telemetryEvent.event.id===e)return this.perfEvents[t].resolved=!0,0===this.perfEvents[t].childCount&&(this.perfEvents.splice(t,1),!0)},t.prototype.removeScopeEvent=function(e){for(var t=0,r=this.perfEvents.length;t<r;t++)if(this.perfEvents[t].scopeId===e)return this.perfEvents[t].resolved=!0,0===this.perfEvents[t].childCount&&(this.perfEvents.splice(t,1),!0)},t.prototype.resolveParent=function(e){for(var t=0,r=this.perfEvents.length;t<r;t++)if(this.perfEvents[t].telemetryEvent.event.id===e)return void(0===--this.perfEvents[t].childCount&&this.perfEvents[t].resolved&&this.perfEvents[t].telemetryEvent.resolve())},t.prototype.forceResolve=function(e,t,r){for(var o=0,i=this.perfEvents.length;o<i;o++)if(this.perfEvents[o].scopeId===e)return this.perfEvents[o].childCount=0,void(0===t?this.perfEvents[o].telemetryEvent.resolve():this.perfEvents[o].telemetryEvent.reject(r))},t.prototype.rejectForTimeout=function(e){for(var t=0,r=this.perfEvents;t<r.length;t++){var o=r[t],n=o&&o.telemetryEvent&&o.telemetryEvent.event;if(n===e){if(_.isEmpty(o.childCount)){var a={errorCode:"Timeout",errorMessage:"Timeout after "+i+" ms with request id "+e.id};o.telemetryEvent.reject(a),o.parentTelemetryId&&this.rejectParentDueToChildTimeOut(o.parentTelemetryId,a)}return}}},t.prototype.rejectParentDueToChildTimeOut=function(e,t){for(var r=0,o=this.perfEvents;r<o.length;r++){var i=o[r];i.telemetryEvent.event&&i.telemetryEvent.event.id===e&&(i.childCount=0,i.resolved=!1,i.telemetryEvent.reject(t),i.parentTelemetryId&&this.rejectParentDueToChildTimeOut(i.parentTelemetryId,t))}},t.prototype.startPerfEventDeprecated=function(e,t){for(var r=this,o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];var s,l=null,d=this.perfEvents.length;if(e&&d>0){this.forceResolve(e.$id,0),d=this.perfEvents.length;for(var c=e.$parent;c&&!l;){for(var u=c.$id,p=0;p<d;p++)if(this.perfEvents[p].scopeId===u&&this.perfEvents[p].telemetryEvent.event.id){l=this.perfEvents[p].telemetryEvent.event.id,this.perfEvents[p].childCount++;break}c=c.$parent}}l?o.push(l):o.push(this.getParentId());var g={info:{}};t&&(g=t.apply(null,o),this.updateRootActivity(g.info),jsCommon.QueryStringUtil.getQueryStringValue("unmin")&&(g.info.isDebug="true"),this.startTimedEventInternal(g));var f;s=new a(g,function(o){var i=g.id;if(i){if(!r.removeEvent(i))return}else if(!r.removeScopeEvent(e.$id))return;r.userActivityContextService.popParentContext(o),t&&r.endTimedEventInternal(o),l&&r.resolveParent(l),null!=f&&clearTimeout(f)}),f=setTimeout((function(){return r.rejectForTimeout(g)}),i);var m={scopeId:e?e.$id:null,telemetryEvent:s,parentTelemetryId:l,childCount:0,resolved:!1};return this.perfEvents.push(m),s},t.prototype.logEvent=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.push(this.getParentId());var o=e.apply(null,t);return o&&o.info&&this.updateRootActivity(o.info),this.logEventInternal(o),o},t.prototype.logChildEvent=function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];r.push(e.id);var i=t.apply(null,r);return i&&i.info&&this.updateRootActivity(i.info),this.logEventInternal(i),i},t.prototype.startEvent=function(e){for(var t=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.push(this.getParentId());var i=e.apply(null,r);return i&&i.info&&this.updateRootActivity(i.info),this.startTimedEventInternal(i),new a(i,function(e){return t.endTimedEventInternal(e)})},t.prototype.startChildEvent=function(e,t){for(var r=this,o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];o.push(e.id);var n=t.apply(null,o);return n&&n.info&&this.updateRootActivity(n.info),this.startTimedEventInternal(n),new a(n,function(e){return r.endTimedEventInternal(e)})},t.prototype.logTrace=function(t){var r=e.telemetry.Trace(t.type,t.text);this.logEventInternal(r)},t.prototype.getParentId=function(){var e=this.userActivityContextService.getParentContext();return e?e.activityId:this.root.id},t.prototype.updateRootActivity=function(e){if(e){var t=this.userActivityContextService.getRootContext();t&&(e.activityName=t.activityName,e.activityId=t.activityId)}},t.prototype.startTimedEventInternal=function(e){this.resetSessionTimeout();for(var t=this.getLoggerServices(),r=0,o=t.length;r<o;r++)t[r].startTimedEvent(e)},t.prototype.endTimedEventInternal=function(e){this.resetSessionTimeout();for(var t=this.getLoggerServices(),r=0,o=t.length;r<o;r++)t[r].endTimedEvent(e)},t.prototype.logEventInternal=function(t){t.category===e.TelemetryCategory.CustomerAction&&jsCommon.QueryStringUtil.getQueryStringValue("unmin")&&(t.info.isDebug="true"),this.resetSessionTimeout();for(var r=this.getLoggerServices(),o=0,i=r.length;o<i;o++)r[o].logEvent(t)},Object.defineProperty(t.prototype,"sessionId",{get:function(){return this.hostData.sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._rootEvent},enumerable:!0,configurable:!0}),t.prototype.getLoggerServices=function(){return this.isSuspended?[]:this.loggerServices},t})(),a=(function(){function t(e,t){this.event=e,this.end=t}return t.prototype.resolve=function(){this.end(this.event)},t.prototype.reject=function(t){var r=this.event;r.info.isError=!0,r.info.errorSource=t&&t.errorSource?t.errorSource:e.telemetry.ErrorSource.PowerBI,r.info.errorCode=t?t.errorCode:"UnknownError",r.info.errorMessage=t?t.errorMessage:void 0,this.end(r)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new o}e.createUserActivityContextService=t;var r=(function(){function e(e,t){this.activityName=e,t&&(this.activityId=t)}return e})();e.ActivityContext=r;var o=(function(){function e(){e.currentActivityContextStack=[]}return e.prototype.pushParentContext=function(t){if(t){var r={activityId:t.id,activityName:t.name};this.spliceParentContextStack(r,!0),e.currentActivityContextStack.push(r)}},e.prototype.popParentContext=function(e){if(e){var t={activityId:e.id,activityName:e.name};this.spliceParentContextStack(t)}},e.prototype.getParentContext=function(){var t=e.currentActivityContextStack.length;if(t>0)return e.currentActivityContextStack[t-1]},e.prototype.getRootContext=function(){var t=e.currentActivityContextStack.length;if(t>0)return e.currentActivityContextStack[0]},e.prototype.spliceParentContextStack=function(t,r){var o=e.currentActivityContextStack.map((function(e){return e.activityName})).indexOf(t.activityName);o>=0&&(r?e.currentActivityContextStack.splice(0,o+1):e.currentActivityContextStack.splice(o,1))},e})()})(powerbi||(powerbi={}));var jsCommon;!(function(e){var t;!(function(e){function t(e,t,r){if(e||t||r)return!e||t||r?e||!t||r?e||t||!r?$.extend(e,t,r):r:t:e}e.mergeUnionType=t})(t=e.UnionExtensions||(e.UnionExtensions={}))})(jsCommon||(jsCommon={}));var InJs;!(function(e){var t;!(function(e){e.infoNavErrorCodeTemplate="{0} ({1})",e.errorCodeText="Error Code",e.errorActivityIdText="Activity Id",e.errorRequestIdText="Request Id",e.correlationIdText="Correlation Id",e.errorLineNumberText="Line number",e.errorColumnNumberText="Column number",e.errorStackTraceText="Stack trace",e.errorSourceFileText="Source file",e.errorTimestampText="Time",e.showDetailsText="Show technical details",e.dialogCloseActionLabel="Close",e.dialogRefreshPageActionLabel="Refresh Page",e.errorDialogTitle="oops, something went wrong",e.unsupportedBrowserMessageTitle="Unsupported browser detected",e.unsupportedBrowserMessageText="Power BI Q&A requires Internet Explorer 10 or higher, please upgrade your browser and try again",e.errorDialogHelperText="Please try again later or contact support. If you contact support, please provide these details."})(t=e.UnlocalizedStrings||(e.UnlocalizedStrings={}))})(InJs||(InJs={}));var jsCommon;!(function(e){var t=(function(){function e(){}return e.getCookie=function(e,t){if(t&&t.document&&t.document.cookie)for(var r=t.document.cookie.split(";"),o=0,i=r;o<i.length;o++){var n=i[o],a=n.split("=");if(a.length>0&&a[0].trim()===e)return a[1]}return null},e.setCookie=function(e,t,r){r&&r.document&&(r.document.cookie=e+" = "+t)},e})();e.CookieUtil=t})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t=(function(){function t(t,r,o){this.operation=t,this.timerFactory=r||e.TimerPromiseFactory.instance,this.batches=[],o&&(this.maxBatchSize=o,this.batchSize=0)}return t.prototype.enqueue=function(){var e,t=this,r=this.batches;return++this.batchSize,0===r.length?(e=$.Deferred(),r.push(e),this.timerFactory.create(0).done((function(){return t.completeBatches()}))):this.maxBatchSize&&this.batchSize>=this.maxBatchSize?(this.batchSize=0,e=$.Deferred(),r.push(e)):e=r[r.length-1],e.promise()},t.prototype.completeBatches=function(){for(var e;e=this.batches.pop();)this.completeBatch(e)},t.prototype.completeBatch=function(e){this.operation().done((function(t){return e.resolve(t)})).fail((function(t){return e.reject(t)}))},t})();e.DeferredBatch=t})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t;!(function(e){function t(e){Object.freeze(e);for(var r=0,o=Object.getOwnPropertyNames(e);r<o.length;r++){var i=o[r],n=e[i];n&&"object"==typeof n&&t(n)}}e.deepFreeze=t})(t=e.FreezeUtility||(e.FreezeUtility={}))})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t;!(function(e){function t(e){return e&&e.requestId&&e.responseRequestId?e.requestId===e.responseRequestId:null}function r(e){return e&&e.responseRequestId?e.responseRequestId:null}e.clientAndServerRequestIdMatch=t,e.getResponseRequestId=r})(t=e.HttpUtils||(e.HttpUtils={}))})(jsCommon||(jsCommon={}));var InJs;!(function(e){e.RtlDirAttrVal="rtl";var t=(function(){function t(){}return t.constructAdditionalErrorInfoBlock=function(r,o,i,n,a,s){var l=$("<p />");if(!_.isEmpty(r)){var d=r;_.isEmpty(o)||(d=jsCommon.StringExtensions.format(e.UnlocalizedStrings.infoNavErrorCodeTemplate,r,o)),l.append(t.constructErrorField(e.UnlocalizedStrings.errorCodeText,d))}return _.isEmpty(i)||l.append(t.constructErrorField(e.UnlocalizedStrings.errorActivityIdText,i)),_.isEmpty(n)||l.append(t.constructErrorField(e.UnlocalizedStrings.errorRequestIdText,n)),s&&(s.sourceUrl&&l.append(t.constructErrorField(e.UnlocalizedStrings.errorSourceFileText,s.sourceUrl)),s.lineNumber&&l.append(t.constructErrorField(e.UnlocalizedStrings.errorLineNumberText,s.lineNumber.toString())),s.columnNumber&&l.append(t.constructErrorField(e.UnlocalizedStrings.errorColumnNumberText,s.columnNumber.toString())),s.stack&&l.append(t.constructErrorField(e.UnlocalizedStrings.errorStackTraceText,s.stack))),a||(a=new Date),l.append(t.constructErrorField(e.UnlocalizedStrings.errorTimestampText,a.toString())),l},t.constructShowDetailsContainer=function(r,o){var i=$("<div />"),n=$("<a class=\"showAdditionalDetailsLink\" href='javascript:' />");return n.addClass(t.infonavShowAdditionalErrorClass),n.text(o||e.UnlocalizedStrings.showDetailsText),n.on(jsCommon.DOMConstants.mouseClickEventName,(function(e){i.find(jsCommon.Utility.createClassSelector(t.infonavShowAdditionalErrorClass)).remove(),i.find(jsCommon.Utility.createClassSelector(t.infonavAdditionalErrorClass)).css(jsCommon.CssConstants.displayProperty,jsCommon.CssConstants.blockValue)})),r.css(jsCommon.CssConstants.displayProperty,jsCommon.CssConstants.noneValue),r.addClass(t.infonavAdditionalErrorClass),i.append(n),i.append(r),i},t.constructErrorField=function(e,r){var o=$(t.infoNavErrorInfoFieldTemplate.replace("{FieldTitle}",e));return o.find(".infonav-errorInfoText").multiline(r),o},t.isRTL=function(){var t=$("html").attr("dir");return t===e.RtlDirAttrVal},t.infonavAdditionalErrorClass="infonav-additionalError",t.infonavShowAdditionalErrorClass="infonav-showAdditionalError",t.infoNavErrorInfoFieldTemplate='<div class="infonav-errorInfoItem"><span class="infonav-errorInfoHeader">{FieldTitle}</span><span class="infonav-errorInfoText">{FieldValue}</span></div>',t})();e.InfoNavUtility=t})(InJs||(InJs={}));var jsCommon;!(function(e){var t;!(function(e){function t(e,t,r){try{return JSON.parse(e,t)}catch(e){}}function r(e){if(e&&"string"==typeof e){try{JSON.parse(e)}catch(e){return!1}return!0}return!1}e.tryParseJSON=t,e.isJsonString=r})(t=e.JsonExtensions||(e.JsonExtensions={}))})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t;!(function(e){function t(e,t){return null==e||isNaN(e)?t:null==t||isNaN(t)?e:Math.min(e,t)}function r(e,t){return null==e||isNaN(e)?t:null==t||isNaN(t)?e:Math.max(e,t)}function o(e){return-1*Math.round(-e)}e.min=t,e.max=r,e.roundHalfDown=o})(t=e.MathExtensions||(e.MathExtensions={}))})(jsCommon||(jsCommon={}));var jsCommon;!(function(e){var t;!(function(e){function t(){try{return window.self!==window.top}catch(e){return!0}}function r(){return t()&&o(document.referrer)!==o(document.URL)}function o(e){var t=document.createElement("a");return t.href=e,t.hostname}e.isHostedInIFrame=t,e.isHostedInCrossDomainIFrame=r,e.getHostName=o})(t=e.iFrameUtility||(e.iFrameUtility={}));var r;!(function(t){function r(t){if(t)try{var r=atob(t),o=pako.inflate(r,{to:"string"});return o}catch(t){var i="Error while uncompressing TileData: {0}";e.Trace.error(e.StringExtensions.format(i,JSON.stringify(t)),null==t.stack)}return null}function o(t){if(t)try{var r=pako.gzip(t,{to:"string"}),o=btoa(r);return o}catch(t){return e.Trace.error(e.StringExtensions.format("Error while compressing TileData: {0}",JSON.stringify(t)),null==t.stack),null}return null}t.uncompress=r,t.compress=o})(r=e.GzipUtility||(e.GzipUtility={}));var o=(function(){function e(e,t,r,o){this.rsaMaxLength=85,this.rsaEncryptedLength=128,this.callback=o,this.plainTextBytes=this.toUTF8Array(e),this.publicKey=t,this.entropy=r,this.segments=Math.ceil(this.plainTextBytes.length/this.rsaMaxLength),this.currentSegment=0,this.encryptedBytes=new Uint8Array(this.segments*this.rsaEncryptedLength)}return e.prototype.RSAEncrypt=function(){var e=this,t=this.toSupportedRSAPublicKey(this.publicKey),r=this.toSupportedArray(t);msrCrypto.subtle.forceSync=!0,msrCrypto.initPrng&&msrCrypto.initPrng(this.entropy);var o=msrCrypto.subtle.importKey("jwk",r,{name:"RSA-OAEP",hash:{name:"sha-1"}});o.oncomplete=function(t){return e.rsaPublicKeyImportComplete(t)}},e.generateEntropy=function(){for(var e=[],t=0;t<48;t++)e.push(Math.floor(256*Math.random()));return e},e.prototype.rsaPublicKeyImportComplete=function(e){this.publicKeyHandle=e.target.result,this.rsaEncryption()},e.prototype.rsaEncryption=function(){var e=this,t=msrCrypto.subtle.encrypt({name:"RSA-OAEP",hash:{name:"sha-1"}},this.publicKeyHandle,this.plainTextBytes.subarray(this.currentSegment*this.rsaMaxLength,(this.currentSegment+1)*this.rsaMaxLength));t.oncomplete=function(t){return e.rsaEncryptionSegmentComplete(t)}},e.prototype.rsaEncryptionSegmentComplete=function(e){this.encryptedBytes.set(new Uint8Array(e.target.result),this.currentSegment*this.rsaEncryptedLength),this.currentSegment++,this.currentSegment<this.segments?this.rsaEncryption():this.callback(this.arrayToBase64String(this.encryptedBytes))},e.prototype.toSupportedRSAPublicKey=function(e){return'{                 "kty" : "RSA",                 "extractable" : true,                 "n" : "'+e+'",                 "e" : "AQAB"             }'},e.prototype.arrayToBase64String=function(e){for(var t="",r=e.length,o=0;o<r;o++)t+=String.fromCharCode(e[o]);return window.btoa(t)},e.prototype.toSupportedArray=function(e){var t="undefined"!=typeof Uint8Array,r=Object.prototype.toString.call(e);switch(r=r.substring(8,r.length-1)){case"Array":return t?new Uint8Array(e):e;case"ArrayBuffer":return new Uint8Array(e);case"Uint8Array":return e;case"Uint16Array":case"Uint32Array":return new Uint8Array(e);case"String":for(var o=e.length,i=t?new Uint8Array(o):new Array(o),n=0;n<o;n++)i[n]=e.charCodeAt(n);return i;default:throw new Error("toSupportedArray : unsupported data type "+r)}},e.prototype.toUTF8Array=function(e){for(var t=[],r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t.push(o):o<2048?t.push(192|o>>6,128|63&o):o<55296||o>=57344?t.push(224|o>>12,128|o>>6&63,128|63&o):(r++,o=65536+((1023&o)<<10|1023&e.charCodeAt(r)),t.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o))}var i=new Uint8Array(t.length);return i.set(t,0),i},e})();e.EncryptionContext=o})(jsCommon||(jsCommon={}));

window.parseTimeMarkers['powerbiportal.dependencies.bundle.min.js'].end = Date.now();
