var powerbi;!function(e){var t;!function(t){function i(){return window.resourceLoaderUrl||"/explore/resourcePackageItem/"}function a(e){return new r(e)}t.getResourceLoaderUrl=i,t.createJQueryResourceItemProxy=a;var r=function(){function t(e){this.promiseFactory=e}return t.prototype.get=function(e,t,a){var r=this.promiseFactory.defer(),o=window.clusterUri,n=window.powerBIAccessToken;top&&top.powerBIAccessToken&&(n=top.powerBIAccessToken);var s=i(),u={authorization:"Bearer "+n};window.isAnonymousEmbed&&(o=window.clusterApiUri,s=window.resourceLoaderUrl+e+"/",u["X-PowerBI-ResourceKey"]=window.powerBIResourceKey);var l=o+s+encodeURIComponent(a),c={url:l,headers:u};return $.ajax(c).then(function(e){return r.resolve(e)},function(e){return r.reject(e)}),r.promise},t.prototype.getBlob=function(t,i,a){return e.createJQueryPromiseFactory().reject()},t}()}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(){var t=e.createJQueryPromiseFactory(),i={get:function(e){return e},getOptional:function(e){return e}},o={messageProxy:a.createWindowMessageProxy(t,window.parent),promiseFactory:t,resourceProvider:i};return new r(o)}var a=e.visualHost;t.createResourceLoaderHost=i;var r=function(){function t(e){var t=this;this.messageProxy=e.messageProxy,this.promiseFactory=e.promiseFactory,this.resourceProvider=e.resourceProvider,this.messageProxy.on(a.events.WindowMessageProxyMessageEvent,function(e){return t.onMessageReceived(e)})}return t.prototype.onMessageReceived=function(e){switch(e.message.eventName){case"loadVisualPluginWithContent":return this.loadVisualPluginWithContent.apply(this,e.message.arguments)}},t.prototype.loadVisualPluginWithContent=function(t){var i=this.promiseFactory.defer(),r=t.pluginName,o=t.mappedPluginContent,n=o[0].content,s=o[1].content;try{a.resourceInjector.injectJsCode(r,n),a.resourceInjector.injectCssCode(r,s);var u=e.visuals.plugins[r];u.iconUrl=a.visualPluginServiceHelpers.getPluginIconUrl(r),u.content={js:n,css:s,iconBase64:u.iconUrl},e.extensibility.visualPluginAdapter.transformPlugin(u),u.capabilities.objects=e.data.services.DataViewObjectDescriptorSerializer.serialize(u.capabilities.objects,this.resourceProvider),i.resolve(u)}catch(e){i.reject(e)}return i.promise},t}();t.ResourceLoaderHost=r}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(i,r){void 0===r&&(r=!1);var o=e.createJQueryPromiseFactory(),n=e.visualHost.createWindowMessageProxy(o,window.parent),s={get:function(e){return e},getOptional:function(e){return e}};t.SandboxVisualHostServices.initialize();var u={promiseFactory:o},l=t.createSandboxTelemetryProxyService(n),p={$element:i,hostServices:t.createVisualHostServices(n),dataProxy:a(o,l),promiseFactory:o,messageProxy:n,resourceLoader:e.visualHost.createResourceLoader(u,null),resourceProvider:s,telemetryProxyService:l};return new c(p,r)}function a(t,i){var a={dsr:{name:"dsr",reader:function(i){return new e.data.dsr.DsrDataReader(i,{execute:function(){return t.reject()}})}}},r={promiseFactory:function(){return t}},o=e.data.createDataReaderProvider(e.data.createDataReaderFactory(a,{}),r);return e.data.createDataProxy(t,o,i)}var r=e.data.segmentation.DataViewMerger,o=e.data.services.DataViewObjectDescriptorSerializer,n=e.visualHost.services.VisualObjectInstanceSerializer,s=e.visualHost.services.VisualObjectRepetitionSerializer,u=e.visualHost.VisualStyleSerializer,l=e.extensibility.createVisualApiAdapter;t.relayMouseEvents=["click","mouseup","MSPointerUp","pointerup"],t.relayTouchEvents=["tap","touchend","touchcancel"],t.relayUIEvents=t.relayMouseEvents.concat(t.relayTouchEvents),t.relayUIEventProps=["type","bubbles","which","buttons","button","ctrlKey","altKey","metaKey","shiftKey","x","y","clientX","clientY","pageX","pageY","movementX","movementY","layerX","layerY","changedTouches"],t.createSandboxHost=i;var c=function(){function i(i,a){void 0===a&&(a=!1);var r=this;this.isolate=a,this.isVisualInitialized=!1,this.messageQueue=[],this.relayUIEventListener=function(e){var i=_.pick(e.originalEvent,t.relayUIEventProps),a={eventName:"onRelayUIEvent",arguments:[i]};r.messageProxy.postMessage(a)},this.container=i.$element,this.hostServices=i.hostServices,this.dataProxy=i.dataProxy,this.promiseFactory=i.promiseFactory,this.messageProxy=i.messageProxy,this.resourceLoader=i.resourceLoader,this.resourceProvider=i.resourceProvider,this.telemetryProxyService=i.telemetryProxyService,this.messageProxy.on(e.visualHost.events.WindowMessageProxyMessageEvent,function(e){return r.onMessageReceived(e)})}return Object.defineProperty(i.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),i.prototype.init=function(e){var t={animation:e.animation,element:this.container,host:this.hostServices,interactivity:e.interactivity,style:u.deserializeVisualStyle(e.style),viewport:e.viewport};this.attachRelayUIEventListener(),this.attachWindowResizeListener(),this.visual.init(t)},i.prototype.destroy=function(){this.detachRelayUIEventListener(),this.detachWindowResizeListener(),this.messageProxy.off(e.visualHost.events.WindowMessageProxyMessageEvent),this.messageProxy.destroy(),this.visual&&this.visual.destroy&&this.visual.destroy()},i.prototype.update=function(t){var i,a=this;t.dataTransforms&&(i=e.data.services.DataViewTransformActionsSerializer.deserializeDataViewTransformActions(t.dataTransforms,this.plugin.capabilities.objects||{})),this.transformDataViewSource(t.dataViewSource,i,!0).then(function(i){var r=a.lastVisualUpdateOptions={dataViews:i.dataViews,suppressAnimations:t.suppressAnimations,viewMode:t.viewMode,editMode:t.editMode,viewport:t.viewport,type:t.type,operationKind:e.VisualDataChangeOperationKind.Create,resizeMode:t.resizeMode,isInFocus:t.isInFocus};t.concatenatedValues&&r.dataViews&&r.dataViews.length>0&&r.dataViews[0]&&r.dataViews[0].categorical&&r.dataViews[0].categorical.categories&&r.dataViews[0].categorical.categories.length>0&&r.dataViews[0].categorical.categories[0]&&r.dataViews[0].categorical.categories[0].values&&(r.dataViews[0].categorical.categories[0].values=t.concatenatedValues),a.visual.update(r),a.sendUpdateResult()}).catch(function(e){return a.sendError(e)})},i.prototype.updateWithCachedData=function(t){var i;t.dataTransforms&&(i=e.data.services.DataViewTransformActionsSerializer.deserializeDataViewTransformActions(t.dataTransforms,this.plugin.capabilities.objects||{})),this.lastDataViewTransformApplyOptions.transforms=i;var a=e.data.DataViewTransform.apply(this.lastDataViewTransformApplyOptions),r=this.lastVisualUpdateOptions={dataViews:a,suppressAnimations:t.suppressAnimations,viewMode:t.viewMode,viewport:t.viewport,type:t.type,operationKind:e.VisualDataChangeOperationKind.Create,resizeMode:t.resizeMode,isInFocus:t.isInFocus};this.visual.update(r),this.sendUpdateResult()},i.prototype.loadResourcePackage=function(e){var t=this;this.resourceLoader.loadVisualPlugin(e).then(function(e){t.plugin=e,t.createAdapter()}).catch(function(){var i=new Error("Unable to load plugin, resource package id: "+e.id);return t.sendError(i)})},i.prototype.createAdapter=function(){var e=this.plugin;if(this.container.addClass("visual-"+e.name),this._visual=l(e,e.create,this.promiseFactory,this.telemetryProxyService),!e||!this.visual){var t=new Error("Unable to create visual from plugin "+e.name);return this.sendError(t)}this.flushQueue(),this.isVisualInitialized=!0,this.sendSandboxReady()},i.prototype.loadWithoutResourcePackage=function(t){var i=t.content;e.visualHost.resourceInjector.injectJsCode(t.name,i.js,this.isolate),e.visualHost.resourceInjector.injectCssCode(t.name,i.css),this.plugin=e.visuals.plugins[t.name],t.apiVersion&&(this.plugin.iconUrl=t.iconUrl,this.plugin.capabilities=t.capabilities),e.extensibility.visualPluginAdapter.transformPlugin(this.plugin),this.createAdapter()},i.prototype.enumerateObjectInstances=function(e){if(this.visual.enumerateObjectInstances){var t=this.visual.enumerateObjectInstances(e);if(t){var i=t;return i&&i.instances?{instances:n.serialize(i.instances),containers:i.containers?n.serializeContainers(i.containers,this.resourceProvider):null}:n.serialize(t)}}},i.prototype.enumerateObjectRepetition=function(){if(this.visual.enumerateObjectRepetition){var e=this.visual.enumerateObjectRepetition();return e?s.serialize(e):void 0}},i.prototype.sendUpdateResult=function(){var e=this.container.children("*").length,t={eventName:"onUpdateResult",arguments:[e]};this.messageProxy.postMessage(t)},i.prototype.sendSandboxReady=function(){var e=this.plugin.capabilities;e.objects&&(e.objects=o.serialize(this.plugin.capabilities.objects,this.resourceProvider));var t={name:this.plugin.name,watermarkKey:this.plugin.watermarkKey,capabilities:e,class:this.plugin.class,iconUrl:this.plugin.iconUrl,custom:!0,create:function(){return null}},i={eventName:"onPluginReady",arguments:[t]};this.messageProxy.postMessage(i)},i.prototype.flushQueue=function(){for(;this.messageQueue.length>0;){var e=this.messageQueue.shift();this.executeMessage(e)}},i.prototype.sendError=function(e,t){var i={eventName:"onError",arguments:[],error:{id:t?t.id:null,eventName:t?t.eventName:null,name:e.name,message:e.message,pluginName:this.plugin.name}};this.messageProxy.postMessage(i)},i.prototype.onMessageReceived=function(e){return this.isVisualInitialized||"loadResourcePackage"===e.message.eventName||"loadWithoutResourcePackage"===e.message.eventName?this.executeMessage(e.message):void this.messageQueue.push(e.message)},i.prototype.executeMessage=function(e){try{if($.isFunction(this[e.eventName]))return this[e.eventName].apply(this,e.arguments);if(this.visual&&$.isFunction(this.visual[e.eventName]))return this.visual[e.eventName].apply(this.visual,e.arguments)}catch(t){this.sendError(t,e)}},i.prototype.transformDataViewSource=function(t,i,a){var r=this,o=this.promiseFactory.defer(),n=t?this.createDataView(t):this.promiseFactory.resolve({dataView:null});return n.then(function(t){var n=e.data.DataViewTransform.apply(r.lastDataViewTransformApplyOptions={prototype:t.dataView,objectDescriptors:r.plugin.capabilities?r.plugin.capabilities.objects:void 0,dataViewMappings:r.plugin.capabilities?r.plugin.capabilities.dataViewMappings:void 0,dataRoles:r.plugin.capabilities?r.plugin.capabilities.dataRoles:void 0,drillCapabilities:r.plugin.capabilities&&r.plugin.capabilities.drilldown,transforms:i,colorAllocatorFactory:e.visuals.createColorAllocatorFactory(),bypassConcatenation:a});o.resolve({dataViews:n})}).catch(function(e){return r.sendError(e)}),o.promise},i.prototype.createDataView=function(t){var i=this,a=this.promiseFactory.defer(),r={type:t.type,query:{dataSources:null,command:t.data}};return this.dataProxy.execute(r).then(function(t){var r=t&&t.dataReaderResult?t.dataReaderResult.dataView:null,o=e.DataViewAnalysis.validateAndReshape(r,i.plugin.capabilities?i.plugin.capabilities.dataViewMappings:null);a.resolve({dataView:o.dataView})}).catch(function(e){return i.sendError(e)}),a.promise},i.prototype.attachWindowResizeListener=function(){$(window).on("resize",this.windowResizeListener.bind(this)),$(window).trigger("resize")},i.prototype.detachWindowResizeListener=function(){$(window).off("resize")},i.prototype.windowResizeListener=function(){if(this.lastVisualUpdateOptions){var t=$(window).height(),i=$(window).width(),a=e.Prototype.inherit(this.lastVisualUpdateOptions);a.viewport={width:i,height:t},a.type=e.VisualUpdateType.Resize,a.resizeMode=1,this.visual.update(a)}},i.prototype.attachRelayUIEventListener=function(){this.container.on(t.relayUIEvents.join(" "),this.relayUIEventListener)},i.prototype.detachRelayUIEventListener=function(){this.container.off(t.relayUIEvents.join(" "),this.relayUIEventListener)},i.prototype.handleLoadMoreDataResult=function(t){var i=t?t.dataReaderResult.dataView:null;if(i){r.mergeDataViews(this.lastDataViewTransformApplyOptions.prototype,i),this.lastVisualUpdateOptions.dataViews=e.data.DataViewTransform.apply(this.lastDataViewTransformApplyOptions),this.lastVisualUpdateOptions.operationKind=e.VisualDataChangeOperationKind.Append,this.visual.update(this.lastVisualUpdateOptions);var a={eventName:"stopProgressBar",arguments:[]};this.messageProxy.postMessage(a)}},i}();t.SandboxHost=c}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return new i(e)}e.createSandboxVisualHostTooltipService=t;var i=function(){function e(e){this.messageProxy=e,this.rootElement=window.document.body}return e.prototype.show=function(e){var t={eventName:"showTooltip",arguments:[e]};this.messageProxy.postMessage(t)},e.prototype.move=function(e){var t={eventName:"moveTooltip",arguments:[e]};this.messageProxy.postMessage(t)},e.prototype.hide=function(e){var t={eventName:"hideTooltip",arguments:[e]};this.messageProxy.postMessage(t)},e.prototype.container=function(){return this.rootElement},e.prototype.enabled=function(){return!0},e}()}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return new r(e)}var a;!function(e){e.VisualApiUsage="VisualApiUsage",e.VisualException="VisualException"}(a=t.proxiedTelemetryEventType||(t.proxiedTelemetryEventType={})),t.createSandboxTelemetryProxyService=i;var r=function(){function t(e){this.windowMessageProxy=e}return t.prototype.suspend=function(){},t.prototype.resume=function(){},t.prototype.flush=function(){},t.prototype.startPerfEventDeprecated=function(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var r,n={info:{}};return r=new o(n)},t.prototype.logEvent=function(t){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var o=null;return t===e.telemetry.VisualApiUsage?o=a.VisualApiUsage:t===e.telemetry.VisualException&&(o=a.VisualException),i.unshift(o),this.windowMessageProxy.postMessageAsync({eventName:"logEvent",arguments:i}),null},t.prototype.logChildEvent=function(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a]},t.prototype.startActivity=function(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var r,n={info:{}};return r=new o(n)},t.prototype.startEvent=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var a,r={info:{}};return a=new o(r)},t.prototype.startChildEvent=function(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var r,n={info:{}};return r=new o(n)},t.prototype.logTrace=function(e){},Object.defineProperty(t.prototype,"sessionId",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){},enumerable:!0,configurable:!0}),t.prototype.setHostInfo=function(e,t){},t}(),o=function(){function e(e){this.event=e}return e.prototype.resolve=function(){},e.prototype.reject=function(e){},e}()}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e){return new s(e)}var a=e.data.services.DataViewObjectSerializer,r=e.visualHost.services.VisualObjectInstanceSerializer,o={"0.00 %;-0.00 %;0.00 %":"Percentage","0.0 %;-0.0 %;0.0 %":"Percentage1"},n={NullValue:"(Blank)",BooleanTrue:"True",BooleanFalse:"False",NaNValue:"NaN",InfinityValue:"+Infinity",NegativeInfinityValue:"-Infinity",Restatement_Comma:"{0}, {1}",Restatement_CompoundAnd:"{0} and {1}",DisplayUnitSystem_EAuto_Title:"Auto",DisplayUnitSystem_E0_Title:"None",DisplayUnitSystem_E3_LabelFormat:"{0}K",DisplayUnitSystem_E3_Title:"Thousands",DisplayUnitSystem_E6_LabelFormat:"{0}M",DisplayUnitSystem_E6_Title:"Millions",DisplayUnitSystem_E9_LabelFormat:"{0}bn",DisplayUnitSystem_E9_Title:"Billions",DisplayUnitSystem_E12_LabelFormat:"{0}T",DisplayUnitSystem_E12_Title:"Trillions",Percentage:"#,0.##%",Percentage1:"#,0.#%",TableTotalLabel:"Total",Tooltip_HighlightedValueDisplayName:"Highlighted",Waterfall_DecreaseLabel:"Decrease",Waterfall_IncreaseLabel:"Increase",Waterfall_TotalLabel:"Total",GeotaggingString_Continent:"continent",GeotaggingString_Continents:"continents",GeotaggingString_Country:"country",GeotaggingString_Countries:"countries",GeotaggingString_State:"state",GeotaggingString_States:"states",GeotaggingString_City:"city",GeotaggingString_Cities:"cities",GeotaggingString_Town:"town",GeotaggingString_Towns:"towns",GeotaggingString_Province:"province",GeotaggingString_Provinces:"provinces",GeotaggingString_County:"county",GeotaggingString_Counties:"counties",GeotaggingString_Village:"village",GeotaggingString_Villages:"villages",GeotaggingString_Post:"post",GeotaggingString_Zip:"zip",GeotaggingString_Code:"code",GeotaggingString_Place:"place",GeotaggingString_Places:"places",GeotaggingString_Address:"address",GeotaggingString_Addresses:"addresses",GeotaggingString_Street:"street",GeotaggingString_Streets:"streets",GeotaggingString_Longitude:"longitude",GeotaggingString_Longitude_Short:"lon",GeotaggingString_Longitude_Short2:"long",GeotaggingString_Latitude:"latitude",GeotaggingString_Latitude_Short:"lat",GeotaggingString_PostalCode:"postal code",GeotaggingString_PostalCodes:"postal codes",GeotaggingString_ZipCode:"zip code",GeotaggingString_ZipCodes:"zip codes",GeotaggingString_Territory:"territory",GeotaggingString_Territories:"territories"},s=function(){function i(e){this.messageProxy=e,this.visualHostTooltipService=t.createSandboxVisualHostTooltipService(e),this.queryDictionary=i.parseUrlParameters()}return i.initialize=function(){e.visuals.valueFormatter.setLocaleOptions(i.createLocaleOptions()),e.visuals.TooltipManager&&e.visuals.TooltipManager.setLocalizedStrings(i.createTooltipLocaleOptions())},i.createLocaleOptions=function(){return{null:n.NullValue,true:n.BooleanTrue,false:n.BooleanFalse,NaN:n.NaNValue,infinity:n.InfinityValue,negativeInfinity:n.NegativeInfinityValue,beautify:function(e){return i.beautify(e)},describe:function(e){return i.describeUnit(e)},restatementComma:n.Restatement_Comma,restatementCompoundAnd:n.Restatement_CompoundAnd,restatementCompoundOr:n.Restatement_CompoundOr}},i.createTooltipLocaleOptions=function(){return{highlightedValueDisplayName:n.Tooltip_HighlightedValueDisplayName}},i.prototype.getLocalizedString=function(e){return n[e]},i.prototype.onSelecting=function(e){e.action=0},i.prototype.onSelect=function(t){var i;if(e.extensibility.legacy.isOldSelectEventArgs(t)){var r=t;i={data:a.serializeSelectors(r.data),data2:a.serializeSelectorsByColumn(r.data2),selectors:a.serializeSelectors(t.selectors)}}else i={visualObjects:a.serializeVisualObjects(t.visualObjects)};var o={eventName:"onSelect",arguments:[i]};this.messageProxy.postMessage(o)},i.prototype.persistProperties=function(e){var t,i=e;t=i.merge||i.remove||i.replace?{merge:i.merge?r.serialize(i.merge):null,replace:i.replace?r.serialize(i.replace):null,remove:i.remove?r.serialize(i.remove):null}:r.serialize(e);var a={eventName:"persistProperties",arguments:[t]};this.messageProxy.postMessage(a)},i.prototype.loadMoreData=function(){var e={eventName:"loadMoreData",arguments:null};this.messageProxy.postMessage(e)},i.prototype.tooltips=function(){return this.visualHostTooltipService},i.prototype.locale=function(){var e=this.queryDictionary&&this.queryDictionary.locale;return e||navigator.language},i.prototype.loader=function(){var e=this;return{require:function(){return e.promiseFactory().reject()}}},i.parseUrlParameters=function(e){void 0===e&&(e=window.location.search);var t={},i=e;if(i&&"?"===i.substr(0,1))for(var a=i.substr(1).split("&"),r=0;r<a.length;r++){var o=a[r]&&a[r].split("=");o&&2===o.length&&(t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]))}return t},i.prototype.destroy=function(){this.messageProxy.destroy(),this.messageProxy=null},i.prototype.onDragStart=function(){},i.prototype.onContextMenu=function(){},i.prototype.canSelect=function(){return!1},i.prototype.onCustomSort=function(e){},i.prototype.getViewMode=function(){return 0},i.prototype.getEditMode=function(){return 0},i.prototype.setWarnings=function(e){},i.prototype.setToolbar=function(e){},i.prototype.shouldRetainSelection=function(){return!1},i.prototype.geocoder=function(){return e.visuals.services.createGeocoder()},i.prototype.geolocation=function(){return e.visuals.services.createGeolocation()},i.prototype.promiseFactory=function(){return e.createJQueryPromiseFactory()},i.prototype.analyzeFilter=function(e){},i.prototype.getIdentityDisplayNames=function(e){},i.prototype.setIdentityDisplayNames=function(e){},i.prototype.getUIComponentFactory=function(){},i.beautify=function(e){var t=o[e];return t?n[t]||e:e},i.describeUnit=function(e){var t=e===-1?"Auto":e.toString(),i=n["DisplayUnitSystem_E"+t+"_Title"],a=e<=0?"{0}":n["DisplayUnitSystem_E"+t+"_LabelFormat"];if(i||a)return{title:i,format:a}},i}();t.SandboxVisualHostServices=s,t.createVisualHostServices=i}(t=e.visualSandbox||(e.visualSandbox={}))}(powerbi||(powerbi={}));